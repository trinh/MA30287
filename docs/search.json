[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "MA30287: Mathematics of Planet Earth",
    "section": "",
    "text": "Preface\nWelcome to to the 2023-24 delivery of MA30287 Maths of Planet Earth at the University of Bath.\nHere is a picture that represents the course.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#lectures-and-office-hours",
    "href": "index.html#lectures-and-office-hours",
    "title": "MA30287: Mathematics of Planet Earth",
    "section": "Lectures and office hours",
    "text": "Lectures and office hours\n\\(\\nextSection\\)\nLectures take place at the following times and locations:\n\nTuesdays 9:15 in 6W 1.2\nWednesdays 11:15 in 6W 1.2\nThursdays 15:15 in 8W 3.22\n\nOffice hours: You will be able to find me for an office hour in 4W 2.18 on Thursdays (following the lecture). Typically it is best to set this up, beforehand, by email appointment.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#coursework-and-examinations",
    "href": "index.html#coursework-and-examinations",
    "title": "MA30287: Mathematics of Planet Earth",
    "section": "Coursework and examinations",
    "text": "Coursework and examinations\n\\(\\nextSection\\)\nYour final mark will be 25% coursework and 75% final exam.\nDetails of the coursework will be released in Week 7 and it will be due in Week 101.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#resources",
    "href": "index.html#resources",
    "title": "MA30287: Mathematics of Planet Earth",
    "section": "Resources",
    "text": "Resources\n\\(\\nextSection\\)\nIn general, you will have access to a few kinds of resources:\n\nThe Moodle portal will be the main organisation portal.\nLecture notes, coursework, and other resources will be found in an online format and will be linked on Moodle.\nCoding will be done via Noteable, accessed via the Moodle website.\n\nNaturally, because this is a relatively new module at Bath, there will be a fair amount of activity as we settle the material over the semester. Whenever we complete a lecture note (i.e. a ‘chapter’), we will use a box like this to indicate when the material was covered and in which lecture:\n\n\n\n\n\n\n2023-24 note\n\n\n\nThe material in this note was covered in Lecture XX.\n\n\nHopefully by the time the module ends, every relevant chapter will have such a note. This allows you to judge what material has been ‘finalised’.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#prerequisites",
    "href": "index.html#prerequisites",
    "title": "MA30287: Mathematics of Planet Earth",
    "section": "Prerequisites",
    "text": "Prerequisites\n\\(\\nextSection\\)\nThis course officially requires MA20221 (modeling and dynamical systems) or XX20231 (mathematical and statistical methods for the life sciences).\nIt is designed to be somewhat stand-alone in the sense that applied mathematical techniques learned in other courses will be introduced in some capacity. Such techniques will involve:\n\nSolutions of ordinary differential equations (MA10230 and MA20220).\nMultivariable calculus, partial differentiation, and multiple integrals (MA10230 and MA10236); some review/introduction of concepts from MA20223.\nDynamical systems, stability, phase planes (MA20221, MA30060).\nNumerical methods in Python (MA10276).\n\nWhenever possible, I have isolated such reviews/introductions and these can be found in the Mathematical methods section of these notes.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#resources-1",
    "href": "index.html#resources-1",
    "title": "MA30287: Mathematics of Planet Earth",
    "section": "Resources",
    "text": "Resources\n\\(\\nextSection\\)\nThis course is designed around the following sources:\n\nSustainable energy – without the hot air by (MacKay 2009)\nMathematics & Climate by (Kaper and Engler 2013)\nMathematical Geoscience by (Fowler 2011)\nA gentle introduction to numerical simulations with Python\n\n\n\n\n\nFowler, Andrew. 2011. Mathematical Geoscience. Vol. 36. Springer.\n\n\nKaper, Hans, and Hans Engler. 2013. Mathematics and Climate. SIAM.\n\n\nMacKay, D. J. C. 2009. Sustainable Energy – Without the Hot Air. UIT Cambridge Ltd.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#footnotes",
    "href": "index.html#footnotes",
    "title": "MA30287: Mathematics of Planet Earth",
    "section": "",
    "text": "Subject to confirmation.↩︎",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "lectureplan.html",
    "href": "lectureplan.html",
    "title": "Lecture plan",
    "section": "",
    "text": "A lecture plan can be found at this link.",
    "crumbs": [
      "Lecture plan"
    ]
  },
  {
    "objectID": "part-01-intro/intro.html",
    "href": "part-01-intro/intro.html",
    "title": "Introduction",
    "section": "",
    "text": "Mathematics of Planet Earth seems like an incredibly broad description for a course, but perhaps in order to give a rough idea of what such a course might include, we can consider the following diagram, which illustrates different categories and subject areas that are involved in the modelling of a full Earth system.\n\n\n\n\n\n\nFigure 1: The many components of a full Earth System Model\n\n\n\nIt would be possible to spend a lifetime studying any one aspects of the above categories, and they span many different areas of study, including: (i) engineering (civil, fluids, mechanical, etc.); (ii) physics (geosciences, mechanics); (iii) Earth sciences; (iv) policy and health; and so forth and so on. As mathematicians, we also have a unique perspective, and applied mathematics plays important roles in many of the above categories.\nIn essence, this course will include topics and themes are united by aspects of mathematical modelling and mathematical analysis and this is what distinguishes our style of study from adjacent areas of science and social science.\nWe will study so-called conceptual or box models of the climate. This involves some of the blue elements of the above figure, and thus we use coarse-grained models of describing the climate. This will involve applying some of the dynamical systems (phase-plane analysis of ODEs) you have learned previously, along with new methods of computation and analysis. The source for this part of the course will be (Kaper and Engler 2013).\nA secondary part of this course will involve more in-depth analysis of the physical models that govern the blue elements of the above figure. This moves us from the toy box models studied above to digging into the underlying physics—this also falls into the category of Mathematical Geoscience. For example, we will use partial differential equations to study the atmosphere and develop a deeper understanding of greenhouse gases. The source for this part of the course will be (Fowler 2011).\n\n\n\n\nFowler, Andrew. 2011. Mathematical Geoscience. Vol. 36. Springer.\n\n\nKaper, Hans, and Hans Engler. 2013. Mathematics and Climate. SIAM.",
    "crumbs": [
      "Introduction"
    ]
  },
  {
    "objectID": "part-01-intro/intro-PDEs.html",
    "href": "part-01-intro/intro-PDEs.html",
    "title": "1  Conservation laws and constitutive laws",
    "section": "",
    "text": "1.1 Derivation of the 1D heat equation\nIn order to demonstrate some of the basic principles of this course, let us demonstrate the derivation of the heat equation. We are interested in modelling the heat in a volume, \\(V\\), which, for the sake of concreteness is given by a long cylinder with its axis along \\(x \\in [0, L]\\). We assume that the side walls of the cylinder are insulated and the temperature only varies along the \\(x\\) direction.\nAt any point along this rod, the internal heat is given by \\(\\rho c T(x, t)\\), where \\(\\rho\\) is the density of the material (kg/m3), \\(c\\) is the specific heat capacity (J/(kg K)), and \\(T\\) is the temperature (K). Therefore, the heat energy along any segment in the rod is calculated from\nIf the heat changes, then the rate of change of heat energy is given the time derivative of the above quantity. By conservation of energy, any change of the internal energy must be equal to the inflow or outflow of heat at the ends, \\(x = a\\) or \\(x = b\\). We therefore write \\(q\\) for the flux (or flow) of heat.\nWe need a constitutive law that dictates how energy is exchanged at the boundaries. Based on intuition, it is sensible to assume that the flow of heat proceeds from hot to cold. For example, hot air rises towards cool air; or heat from a hot mug of tea flows and diffuses outwards into a cold room. Therefore, we write this as\nThis is known as Fourier’s law. The quantity \\(k\\) is the thermal conductivity, and its units are W/(m K). Because a Watt is a Joule/s, you can also see that the units of \\(k\\) are J/(m K s). The quantity \\(q\\) is the flux, and you can verify that it is given in units of J/(m2 s).\nTherefore by energy conservation, we have \\[\n\\frac{\\mathrm{d}}{\\mathrm{d}t}  \\int_a^b \\rho c T \\, \\mathrm{d}x = {\\color{blue}q(x = a, t) - q(x = b, t)},\n\\] i.e. the change in internal heat is equal to the flow through the ends. Note that we have added-in the heat flux due to \\(x = a\\) assuming positive \\(q\\) refers to heat moving from left-to-right. Conversely, we subtract it away from \\(x = b\\). We can alternatively write this as \\[\n\\frac{\\mathrm{d}}{\\mathrm{d}t}  \\int_a^b \\rho c T \\, \\mathrm{d}x = {\\color{blue} -\\int_a^b \\frac{\\partial q}{\\partial x} \\, \\mathrm{d}x}.\n\\]\nSubstitution Fourier’s law, we can then write \\[\n\\int_a^b \\rho c \\frac{{\\partial}T}{{\\partial}t} \\, \\mathrm{d}x = \\int_a^b k \\frac{{\\partial}^2 T}{{\\partial}x^2} \\, \\mathrm{d}x.\n\\] Because the above integral identity needs to be true for all possible values of \\(a\\) and \\(b\\), then it must be true everywhere (this is sometimes referred to as the du Bois-Reymond lemma or the bump lemma. Therefore we are left with the classic heat equation.\nIn order to produce a sensible physical solution, partial differential equations are typically supplemented by initial conditions and boundary conditions. The initial condition prescribes the state of the function at some initial time, typically \\(t = 0\\). Boundary conditions prescribe how the function behaves on the boundary of its domain, which in this case is \\(x = 0\\) and \\(x = L\\). An example might be\nwhich expresses, respectively, that the temperature starts from a constant temperature, \\(T_0\\), and where the ends of the rod are kept at temperature \\(T_a\\) and \\(T_b\\).",
    "crumbs": [
      "Introduction",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Conservation laws and constitutive laws</span>"
    ]
  },
  {
    "objectID": "part-01-intro/intro-PDEs.html#derivation-of-the-1d-heat-equation",
    "href": "part-01-intro/intro-PDEs.html#derivation-of-the-1d-heat-equation",
    "title": "1  Conservation laws and constitutive laws",
    "section": "",
    "text": "Internal heat energy\n\n\n\n\\[\n\\text{heat energy in $[a, b]$} = \\int_a^b \\rho c T \\, \\mathrm{d}x.\n\\]\n\n\n\n\n\n\n\n\n\n\nFourier’s law\n\n\n\nFourier’s law in 1D specifies that the heat flux is given by \\[\nq(x, t) = -k \\frac{{\\partial}T}{{\\partial}x}.\n\\]\n\n\n\n\n\n\n\n\n\n\n\nHeat equation\n\n\n\n\\[\n\\rho c\\frac{{\\partial}T}{{\\partial}t} = k \\frac{{\\partial}^2 T}{{\\partial}x^2}.\n\\tag{1.1}\\]\n\n\n\n\n\n\n\n\n\nInitial conditions (IC) and boundary conditions (BC)\n\n\n\n\\[\n\\begin{gathered}\nT(x, 0) = T_0 \\\\\nT(0, 0) = T_a \\\\\nT(L, 0) = T_b\n\\end{gathered}\n\\]\n\n\n\n\n1.1.1 Steady states and long-time behaviours\n\\(\\nextSection\\)\n\n\n\n\n\n\n2024 note\n\n\n\nThis was a new addition in 2024.\n\n\nWhen we refer to a steady-state solution, we are typically referring to a time-independent solution.\n\nDefinition 1.1 (Steady-state solutions) Given an evolving system described by a functio, say \\(f(x, t)\\), defined on some spatial domain and with \\(t &gt; 0\\), the steady-state solution refers to time-independent solutions with \\[\n\\frac{{\\partial} f}{{\\partial}t} = 0.\n\\]\n\nOne can envisage that as the system evolves with \\(t \\to \\infty\\), it reaches a state that is independent of time. However, not all systems will approach a steady state. Moreover, not all steady states are stable or attractive (and might never be reacheable in a real-life experiment).\nFor the case of heat flow, such a steady-state solution would be \\(T(x, t) = T(x)\\). In this case, \\[\n\\frac{{\\partial}T}{{\\partial}t} = 0 \\Longrightarrow\nk \\frac{{\\partial}^2 T}{{\\partial}x^2} = 0.\n\\]\nTherefore, for the heatflow along a segment of length \\(L\\) with left boundary held at \\(T_a\\) and right boundary held at \\(T_b\\) we have \\[\nT_\\text{steady}(x) = \\left(\\frac{T_b - T_a}{L}\\right) x + T_a.\n\\]",
    "crumbs": [
      "Introduction",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Conservation laws and constitutive laws</span>"
    ]
  },
  {
    "objectID": "part-01-intro/intro-PDEs.html#deriving-the-1d-transport-continuity-equation",
    "href": "part-01-intro/intro-PDEs.html#deriving-the-1d-transport-continuity-equation",
    "title": "1  Conservation laws and constitutive laws",
    "section": "1.2 Deriving the 1D transport (continuity) equation",
    "text": "1.2 Deriving the 1D transport (continuity) equation\n\\(\\nextSection\\)\n\n\n\n\n\n\n2024 note\n\n\n\nThis was a new addition in 2024.\n\n\nConsider the mass transport of some substance with density \\(\\rho(x, t)\\), immersed in a fluid, along a one-dimensional line in \\(x\\). If desired, you may consider the substance as existing in three-dimensional space, and propagating along the \\(x\\)-direction, with its behaviour independent of \\(y\\) and \\(z\\). Initially, when considered at time \\(t\\), the mass of the substance between two points, \\(a\\), and \\(b\\), is:\n\\[\nm_\\text{blob}(t) = \\int_{a(t)}^{b(t)} \\rho (x, t) \\, \\mathrm{d}x.\n\\]\nAs time increases the particles of the substance will move due to the fluid moving; at the same time, the fluid volume which is initially contained in \\(x\\in [a(0), b(0)]\\) will also move. We want to find how the mass of the blob changes in time, and hence consider the quantity \\[\n\\frac{\\mathrm{d}m_\\text{blob}}{\\mathrm{d}t}  = \\int_a^b \\frac{{\\partial}\\rho}{{\\partial}t} \\, \\mathrm{d}x + \\rho(b, t) \\frac{\\mathrm{d}b}{\\mathrm{d}t} - \\rho(a, t) \\frac{\\mathrm{d}a}{\\mathrm{d}t}.\n\\]\nThe above considers the intrinsic rate of change of the function within the integrand, but then adds the extra mass due to the right boundary shifting rightwards (\\(b\\)) and subtracts the mass due to the left boundary shifting rightwards (\\(a\\)). It is known as the Leibniz integral rule. We can thus write this within the integral as\n\\[\n\\frac{\\mathrm{d}m_\\text{blob}}{\\mathrm{d}t}  = \\int_a^b \\left[ \\frac{{\\partial}\\rho}{{\\partial}t} + \\frac{{\\partial}}{{\\partial}x} \\left(\\rho(x, t) \\frac{\\mathrm{d}x}{\\mathrm{d}t}\\right) \\right] \\, \\mathrm{d}x.\n\\]\nHowever, the quantity \\[\n\\frac{\\mathrm{d}x}{\\mathrm{d}t} \\equiv u(x, t)\n\\]\nrepresents the velocity of the fluid (which for the moment we assume to be a known and provided quantity). Therefore we can write the mass change as\n\\[\n\\frac{\\mathrm{d}m_\\text{blob}}{\\mathrm{d}t}  = \\int_a^b \\left[ \\frac{{\\partial}\\rho}{{\\partial}t} + \\frac{{\\partial}}{{\\partial}x} \\left(\\rho u\\right) \\right] \\, \\mathrm{d}x.\n\\]\nThis result, which explains how to pass a derivative through an integral express mass of a substance within a flow is known as the Reynolds Transport Theorem. We have just derived it in 1D.\n\n\n\n\n\n\nReynolds Transport Theorem\n\n\n\nLet \\(\\rho = \\rho(x, t)\\) be some quantity (such as density) that is advected along a one-dimensional line in \\(x\\) due to a fluid with velocity \\(u(x, t)\\). Then \\[\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{a(t)}^{b(t)} \\rho \\, \\mathrm{d}x = \\int_{a(t)}^{b(t)} \\left[ \\frac{{\\partial}\\rho}{{\\partial}t} + \\frac{{\\partial}}{{\\partial}x}(\\rho u)\\right] \\mathrm{d}x.\n\\]\n\n\nWe may now consider the substance being transported along the \\(x\\)-direction. If there is no interior creation or destruction of the source, then by conservation of mass, it must be the case that \\[\n\\frac{\\mathrm{d}m_\\text{blob}}{\\mathrm{d}t} = 0.\n\\]\nThus, again since the above integral identity applies to all possible values of \\(a\\) and \\(b\\), it must be the case that the integrand is zero. Thus we conclude with the so-called tranport equation.\n\n\n\n\n\n\nOne-dimensional transport equation\n\n\n\nThe transport of a substance described by \\(\\rho(x, t)\\) advected along a one-dimensional line in \\(x\\) due to a fluid with velocity \\(u(x, t)\\) is given by \\[\n\\frac{{\\partial}\\rho}{{\\partial}t} + \\frac{{\\partial}}{{\\partial}x}(\\rho u) = 0.\n\\]\n\n\nAgain, we must consider the above problem in combination with potential initial conditions and boundary conditions. For instance, we might specify that the substance begins from some initial state, say \\[\n\\rho(x, 0) = \\rho_0(x).\n\\]\nThe boundary conditions are more subtle. It is not always obvious what the boundary conditions should be on a problem.\nHere is an example of a solution of such a problem.\n\n\n\n\n\n\nLinear advection equation with constant speed\n\n\n\nSolve the problem given by \\[\n\\frac{{\\partial}\\rho}{{\\partial}t} + c\\frac{{\\partial}\\rho}{{\\partial}x} = 0,\n\\] where the velocity \\(u = c\\) is constant. You may assume the initial condition is given by \\[\n\\rho(x, 0) = \\rho_0(x) = e^{-x^2}.\n\\]\n\n\n\n\n\n\n\n\nSolution\n\n\n\nThe general solution is given by \\[\n\\rho(x, t) = F(x - ct),\n\\] where \\(F\\) is an arbitrary (differentiable) function. You can verify this via the chain rule, noting that \\[\n\\frac{\\partial F}{\\partial t} = -c F'(x - ct) \\quad \\text{and} \\quad\n\\frac{\\partial F}{\\partial x} = F'(x - ct).\n\\] Applying the initial condition at \\(t = 0\\) gives \\(F(x) = \\rho_0(x)\\) and thus \\[\n\\rho(x, t) = e^{-(x - ct)^2}.\n\\]\nYou may plot this to discover that it is, as perhaps expected, a Gaussian profile moving to the right at constant speed (for \\(c &gt; 0\\)).\n\n\n\n\n\n\nFowler, Andrew. 2011. Mathematical Geoscience. Vol. 36. Springer.",
    "crumbs": [
      "Introduction",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Conservation laws and constitutive laws</span>"
    ]
  },
  {
    "objectID": "part-01-intro/intro-nondim.html",
    "href": "part-01-intro/intro-nondim.html",
    "title": "2  Dimensional scaling analysis",
    "section": "",
    "text": "2.1 Dimensional quantities\nEvery physical quantity, say Q, can be expressed as a product of a dimensional unit, denoted [Q], and a magnitude, say Q’. Thus we write \\[\nQ = Q'[Q]\n\\] For example, if \\(x\\) corresponds to the physical length in a problem, we might select \\([x] = \\mathrm{km}\\) or \\([x] = \\mathrm{yards}\\) or \\([x] = \\mathrm{m}\\). It is important to choose the dimensionalisation to suit the problem under consideration.",
    "crumbs": [
      "Introduction",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Dimensional scaling analysis</span>"
    ]
  },
  {
    "objectID": "part-01-intro/intro-nondim.html#dimensional-quantities",
    "href": "part-01-intro/intro-nondim.html#dimensional-quantities",
    "title": "2  Dimensional scaling analysis",
    "section": "",
    "text": "2.1.1 SI units\n\\(\\nextSection\\)\nThe International System (SI) of Base Units sets out a distinct selection of choices for dimensions in certain physical quantities. The seven fundamental dimensional units are\n\n[Length] = metre\n[Time] = seconds\n[Mass] = kilogram\n[Temperature] = Kelvin\n[Electric current] = ampere\n[Light intensity] = candela\n[Material quantity] = mole\n\nDimensional units that can be expressed in terms of other fundamental units are known as derived units. For example:\n\n[Speed] = metre/second\n[Acceleration] = metre/second2\n[Force] = kilogram . metre/second2",
    "crumbs": [
      "Introduction",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Dimensional scaling analysis</span>"
    ]
  },
  {
    "objectID": "part-01-intro/intro-nondim.html#dimensional-homogeneity-and-non-dimensionalisation",
    "href": "part-01-intro/intro-nondim.html#dimensional-homogeneity-and-non-dimensionalisation",
    "title": "2  Dimensional scaling analysis",
    "section": "2.2 Dimensional homogeneity and non-dimensionalisation",
    "text": "2.2 Dimensional homogeneity and non-dimensionalisation\n\\(\\nextSection\\)\nAll terms in any equation must have the same dimensions. This is the principle of dimensional homogenuity. For example, Newton’s second law expresses the fact that \\[\nF = m \\frac{\\mathrm{d}^2x}{\\mathrm{d}t^2}\n\\] We can check, then, that the units do indeed match up on either side. Here, the RHS has units of [m] [x]/[t]2 or in SI units, kg . metres / seconds2. This indeed matches our previous given SI unit decomposition for force.\nNotice in addition that the input to functions like \\(\\cos\\theta\\) and \\(e^z\\) must be non-dimensional (or dimensionless).\nThe process of nondimensionalisation is then as follows. Given an equation, we know that each term must have the same dimension. Therefore, we can scale all the dependent and independent variables by dimensional constants in order to yield a non-dimensional equation.\nWhy this is an important tool is demonstrated by the below.",
    "crumbs": [
      "Introduction",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Dimensional scaling analysis</span>"
    ]
  },
  {
    "objectID": "part-01-intro/intro-nondim.html#returning-to-the-heat-equation",
    "href": "part-01-intro/intro-nondim.html#returning-to-the-heat-equation",
    "title": "2  Dimensional scaling analysis",
    "section": "2.3 Returning to the heat equation",
    "text": "2.3 Returning to the heat equation\n\\(\\nextSection\\)\n\n\n\n\n\n\n2023-24 note\n\n\n\nThe below has been cleaned up to match the notation on the 13 Feb 2023 delivery.\n\n\nExact units are not relevant for dynamics, and it is instead the ratio of units that we care about. To apply this principle, let us non-dimensionalise the equation Equation 1.1. Let us consider the heat equation as given by the system \\[\n\\begin{aligned}\n\\frac{\\partial T}{\\partial t} &= \\kappa \\frac{\\partial^2 T}{\\partial x^2} \\\\\nT(x, 0) &= T_\\text{init} \\\\\nT(0, t) &= T_a \\\\\nT(L, t) &= T_b.\n\\end{aligned}\n\\]\nNote that the constant \\(\\kappa\\) is known as the thermal diffusivity, and is given by \\[\n\\kappa = \\frac{k}{\\rho c},\n\\] which were the units previously introduced.\nWe introduce typical scales for each of the variables. For example, we non-dimensionalise the temperature, distance, and time by setting \\[\nT = [T] T', \\qquad x = [x] x', \\qquad t = [t] t'.\n\\] Remember that via the chain rule, we have that \\[\n\\frac{\\mathrm{d}}{\\mathrm{d}x} = \\frac{\\mathrm{d}x'}{\\mathrm{d}x} \\frac{\\mathrm{d}}{\\mathrm{d}x'} = \\frac{1}{[x]} \\frac{\\mathrm{d}}{\\mathrm{d}x'}.\n\\]\nSubstitution into the equation now yields \\[\n\\begin{aligned}\n\\frac{\\partial T'}{\\partial t'} &= \\frac{\\kappa[t]}{[x]^2}\\frac{\\partial^2 T}{\\partial x^2} \\\\\nT'(x', 0) &= T_\\text{init} \\\\\nT'(0, t') &= \\frac{T_a}{[T]} \\\\\nT'(L/[x], t') &= \\frac{T_b}{[T]}.\n\\end{aligned}\n\\]\nBe sure to work out the above for yourself. For example, notice that the previous boundary at \\(x = L\\) is now sent to \\(x' = L/[x]\\). Now we see that the final equation is beautifully simple: At this point, we can identify a crucial non-dimensional parameter given by \\[\n\\Pi = \\frac{\\kappa [t]}{[x]^2} = \\frac{k [t]}{\\rho c [x]^2}.\n\\]\nAlthough this looks quite complicated, you can test that this parameter is indeed non-dimensional by looking up the units for thermal conductivity, \\(k\\), density \\(\\rho\\), and specific heat \\(c\\), and verifying that indeed \\(\\Pi\\) is non-dimensional.",
    "crumbs": [
      "Introduction",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Dimensional scaling analysis</span>"
    ]
  },
  {
    "objectID": "part-01-intro/intro-nondim.html#choice-of-units",
    "href": "part-01-intro/intro-nondim.html#choice-of-units",
    "title": "2  Dimensional scaling analysis",
    "section": "2.4 Choice of units",
    "text": "2.4 Choice of units\n\\(\\nextSection\\)\nIt is important to remember that there are technically no wrong choices for the scales [x], [T], and [t], as long as they yield consistent balances. However, some choices are better than others for the context of the problem. Let us select: \\[\n[x] = L \\qquad [T] = T_\\text{init}.\n\\]\nThis means our unit of length is “one pipe” (if this is indeed a pipe), and our unit of temperature is whatever the initial temperature was set to be. The choice of time is free at the moment, and therefore we can select time as \\[\n\\Pi = \\frac{\\kappa [t]}{[x]^2} = 1 \\Longrightarrow [t] = \\frac{L^2}{k}.\n\\]\nNow we see that the final equation is beautifully simple: \\[\n\\begin{aligned}\n\\frac{\\partial T'}{\\partial t'} &= \\frac{\\partial^2 T}{\\partial x^2} \\\\\nT'(x', 0) &= 1 \\\\\nT'(0, t') &= \\frac{T_a}{T_\\text{init}} \\equiv A, \\\\\nT'(1, t') &= \\frac{T_b}{T_\\text{init}} \\equiv B.\n\\end{aligned}\n\\tag{2.1}\\]\n\n2.4.1 Interpretation\n\\(\\nextSection\\)\nWhat is the whole point of the above exercise?\nIn the original problem, there were five parameters: \\[\n\\kappa, \\qquad T_\\text{init}, \\qquad T_a, \\qquad T_b, \\qquad L.\n\\]\nImagine a situation where you are performing an analysis of heat spread in different pipes of different materials (characterised by \\(\\kappa\\)) and lengths (\\(L\\)), with different initial and boundary temperatures. That is potentially a highly complicated parameter space to search (five-dimensional).\nRather than solving the problem again and again for each change in parameters, what the analysis yielding (Equation 2.1) reveals is that the parameter space only needs to be two-dimensional, for parameters \\(A\\) and \\(B\\). Therefore, by solving the problem at many different values of \\(A\\) and \\(B\\), the solution space can be completely mapped.\nHere is an example. Consider heat diffusion through common brick, which possesses a thermal diffusivity of \\[\n\\kappa = 5.2 \\times 10^{-7} \\mathrm{m}^2/\\mathrm{s}.\n\\] Therefore a brick that is about L = 10cm = 0.1m in size has a typical timescale of \\[\n[t] = \\frac{L^2}{\\kappa} \\approx 1.9 \\times 10^4 \\mathrm{s} \\approx 5 \\mathrm{hrs}.\n\\]\nThe above choice of [t] is representative of the typical timescale you can expect for heat to diffuse through the brick. As you can see it’s very long.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nIn summary, we have gone from a system where we needed to consider five parameters to a system where we only need to specify two (essentially, the ratio of the initial heat to the boundary values). This is an enormous simplification.\nMoreover, your analysis has further identified the key non-dimensional parameters that appear, including: \\[\n\\Pi = \\frac{\\kappa [t]}{[x]^2}, \\qquad A = \\frac{T_a}{T_\\mathrm{init}}, \\qquad B = \\frac{T_b}{T_\\text{init}}, \\qquad \\frac{L}{[x]}\n\\]\nIn this particular problem, you had the freedom to choose \\(L\\) to remove one parameter (the ratio of lengths), and time could be chosen to set \\(\\Pi = 1\\).\n\n\n\n\n\n\n\n\n\n\nFowler, Andrew. 2011. Mathematical Geoscience. Vol. 36. Springer.",
    "crumbs": [
      "Introduction",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Dimensional scaling analysis</span>"
    ]
  },
  {
    "objectID": "part-01-intro/basic-energy-model.html",
    "href": "part-01-intro/basic-energy-model.html",
    "title": "3  Basic energy models",
    "section": "",
    "text": "3.1 The basic energy model\nThe basic model is derived as follows.\nNote that the primary components of the global energy balance are radiative fluxes: we receive short-wave radiation (UV and visible light) from the Sun, and emit longwave radiation (infra-red) to space.\nFirst we consider incoming energy.\nNext we consider outgoing energy.\nNow combining the above equations, we have \\[\nE_{\\mathrm{in}} - E_{\\mathrm{out}} = \\pi R^2 Q (1 - a) - 4\\pi R^2 \\sigma \\gamma T^4,\n\\tag{3.5}\\] which gives the incoming energy per unit time.\nPutting in (Equation 3.5) and taking the limit of \\(\\Delta t \\to 0\\), we finally have a heat equation for the Earth’s temperature.\nThe above equation Equation 3.7 is time-dependent, but we may consider that the surface temperature, either over long-time or in an averaged sense, is dictated by the steady-state (time-independent) solution. Setting \\(\\mathrm{d}T/\\mathrm{d}t\\) to zero, we see that there is a unique steady-state given by \\[\nT = \\left(\\frac{Q(1-a)}{4\\sigma\\gamma}\\right)^{1/4}.\n\\]\nIf we take \\(Q \\approx 1370 \\,\\mathrm{W m}^{-2}\\), \\(a \\approx 0.3\\), \\(\\sigma \\approx 5.67 \\times 10^{-8} \\mathrm{W} \\,\\mathrm{m}^{-2} \\mathrm{K}^{-4}\\), we then get \\[\nT \\approx 255 \\mathrm{K} = -18^\\circ \\mathrm{C}.\n\\] under the assumption that \\(\\gamma = 1\\). That’s pretty cold! The actual average temperature is around \\(288 \\mathrm{K} \\approx 15 ^\\circ \\mathrm{C}\\).\nThe above back-of-the-envelope calculation seems to suggest that the parameter \\(\\gamma &lt; 1\\) plays an important role in keeping the Earth warm enough for us to live on, and indeed the value of \\(\\gamma\\) inferred by the above is roughly \\(\\gamma \\approx 0.61\\). Later on in the course, we will develop a more rigorous model to predict such a \\(\\gamma\\) by studying the properties of the atmosphere.",
    "crumbs": [
      "Introduction",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Basic energy models</span>"
    ]
  },
  {
    "objectID": "part-01-intro/basic-energy-model.html#the-basic-energy-model",
    "href": "part-01-intro/basic-energy-model.html#the-basic-energy-model",
    "title": "3  Basic energy models",
    "section": "",
    "text": "By considering the incoming radiation from the sun, obtain an estimate for the incoming energy, \\(E_{\\text{in}}\\).\nUse a constitutive law that indicates how much outgoing energy is produced by an object heated to some temperature.\nEquate the change in internal energy to be equal to the difference between the above two items.\n\n\n\n\n\n\n\n\nFigure 3.1: Radiation in the atmosphere\n\n\n\n\n\n\n\n\n\n\nEnergy from the Sun\n\n\n\nFirst, note that the shortwave radiation (UV and radiation) recieved from the sun is \\(Q \\approx 1370 \\text{ W$\\cdot$m$^{-2}$}\\) (which we consider measured at a point near the planet).\nIf we consider only that radiation that is absorbed into the Earth, we have \\[\nE_{\\mathrm{in}} = \\pi R^2 Q (1 - a),\n\\tag{3.2}\\] where \\(R\\) is the Earth’s radius.\nIn the above formula, we have multiplied the flux, \\(Q\\), with the visible surface area, \\(\\pi R^2\\). There is an additional multiplication by \\((1 - a)\\) where \\(a\\) is the planetary albedo, which characterises amount of energy reflected due to the surface properties. Light surfaces like snow will have high albedo, \\(a \\approx 0.9\\), while darker surfaces like the ocean have smaller albedo, \\(a \\approx 0.3\\). The global average albedo is \\(a \\approx 0.3\\).\n\n\n\n\n\n\n\n\n\nEnergy from the Earth\n\n\n\nWe now wish to characterise the energy, \\(E_{out}\\), and in the case of Earth, this will correspond to longwave radiation (infra-red) emitted into space. All bodies characterised by a temperature, say \\(T_e\\), will emit radiation, \\(Q_e\\). As a model, we can consider \\(Q_e\\) to be given by the Stefan-Boltzmann law, which states that \\[\nQ_e = \\sigma T_e^4,\n\\tag{3.3}\\] where \\(\\sigma \\approx 5.67 \\times 10^{-8} W m^{-2} K^{-4}\\) is the Stefan-Boltzmann constant.\nNow although the Earth’s surface may emit radiation according to (Equation 3.3), some of this radiation will be absorbed by the atmosphere and reflected back. This is the greenhouse effect. As a consequence of the greenhouse gas, the surface temperature of the Earth, \\(T\\), will be larger than the effective emitting temperature, \\(T_e\\). For the moment, we model this as \\[\nT_e = \\gamma^{1/4} T_e,\n\\tag{3.4}\\] where \\(\\gamma &lt; 1\\) is a greenhouse gas factor, which depends on the properties of the atmosphere.\n\n\n\n\n\n\n\n\n\nInternal heat energy\n\n\n\nDue to this incoming energy, the Earth will cool or heat in response. We need to know how the internal temperature of an object responds to an input in energy. The general formula is \\[\n\\text{Internal heat energy} = \\text{volume} \\times (\\rho c_p) \\times T.\n\\] The key quantity is the experimentally determined, \\(c_p\\), which corresponds to the specific heat capacity. It is given in the SI units of \\(\\mathrm{J} \\cdot \\mathrm{kg}^{-1} \\cdot \\mathrm{K}^{-1}\\), i.e. energy per unit mass per unit temperature. Note that this applied to a shell around the planet of thickness \\(d\\) in the atmosphere, and so the mass is given by \\[\n\\text{mass} = (4 \\pi R^2) d \\rho\n\\tag{3.6}\\] where \\(\\rho\\) is the average density of the atmosphere. Let us imagine the increase in temperature, \\(\\Delta T\\),during an interval of time, \\(\\Delta t\\). You can now verify that \\[\n\\Bigl[ (4 \\pi R^2) d \\rho \\Bigr] c_p (\\Delta T)\n\\] returns the units of Joules—i.e. this is the internal energy produced during the time \\(\\Delta t\\). We then have \\[\n\\Bigl[ (4 \\pi R^2) d \\rho \\Bigr] c_p \\Delta T =  \\Delta t (E_{in} - E_{out}).\n\\]\n\n\n\n\n\n\n\n\n\nZero-dimensional model for the surface temperature of the Earth\n\n\n\nThe Earth’s temperature, as measured on a layer of thickness \\(d\\) at the troposphere is given by the following ordinary differential equation (ODE) for \\(T = T(t)\\): \\[\nC \\frac{\\mathrm{d}T}{\\mathrm{d}t} = \\frac{1}{4} Q(1 - a) - \\sigma \\gamma T^4,\n\\tag{3.7}\\] where we have defined \\[\nC = \\rho c_p d\n\\] as the heat capacity of the atmosphere. Above, the solar flux, Q is often taken to be \\(Q = 1370\\) W/m2, \\(\\sigma = 5.67 \\times 10^{-8}\\) W/(m2K4), and \\(\\gamma \\leq 1\\) is the greenhouse gas factor.",
    "crumbs": [
      "Introduction",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Basic energy models</span>"
    ]
  },
  {
    "objectID": "part-01-intro/basic-energy-model.html#the-history-of-global-warming",
    "href": "part-01-intro/basic-energy-model.html#the-history-of-global-warming",
    "title": "3  Basic energy models",
    "section": "3.2 The history of global warming",
    "text": "3.2 The history of global warming\n\\(\\nextSection\\)\nThe history of global warming (and hence the estimation of \\(\\gamma\\)) is convoluted, but the origins can be considered as far back as the work of (Fourier 1827) and (Pouillet 1838), and is discussed in the work by (Van der Veen 2000).\n\n\n\n\n\n\nFigure 3.2: An illustration of Fourier’s glass box",
    "crumbs": [
      "Introduction",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Basic energy models</span>"
    ]
  },
  {
    "objectID": "part-01-intro/basic-energy-model.html#next-in-the-study-of-energy-balance-models",
    "href": "part-01-intro/basic-energy-model.html#next-in-the-study-of-energy-balance-models",
    "title": "3  Basic energy models",
    "section": "3.3 Next in the study of energy balance models?",
    "text": "3.3 Next in the study of energy balance models?\n\\(\\nextSection\\)\nAt this stage, the basic energy balance model studied in this chapter can be made more complex and realistic through many different extensions. For instance:\n\nConsider the effects of a non-constant and nonlinear albedo. Since the albedo depends on the material property (water vs. ice vs. land), we can incorporate a toy model for spatial variability by allowing the albedo to depend on temperature, \\(a = a(T)\\).\nConsider the time-dependence. What happens if the system starts out of the steady state? Does it tend to relax to its equilibrium profile? Can we analyse the temporal properties of the solutions?\nCan we incorporate latitude (or longitudinal) dependence into the model. For instance, should the albedo and solar radiation be considered as functions of the latitude?\nShould we incorporate the effects of diffusion (heat spreading out) or convection (heat transported with flows)?\nTo what extent should we consider the effects of the atmosphere on the absorption and reflection properties of the incoming (and outgoing) energy?\n\nMany of these questions are much more involve, as they require differential or partial differential equations. Therefore in the next few chapters, we will discuss, in a very general way, the collection of applied and numerical mathematics techniques that can be used when studying problems in the physical sciences.\n\n\n\n\nFourier, Joseph. 1827. “Mémoire Sur Les Températures Du Globe Terrestre Et Des Espaces Planétaires.” Mémoires de l’Académie Royale Des Sciences de l’Institut de France 7: 570–604.\n\n\nPouillet, Claude Servais Mathias. 1838. “Memoire Sur Le Chaleur Solaire.” Paris.\n\n\nVan der Veen, CJ. 2000. “Fourier and the ‘Greenhouse Effect’.” Polar Geography 24 (2): 132–52.",
    "crumbs": [
      "Introduction",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Basic energy models</span>"
    ]
  },
  {
    "objectID": "part-01-intro/problemclass01.html",
    "href": "part-01-intro/problemclass01.html",
    "title": "4  Problem class 1",
    "section": "",
    "text": "4.1 Projectile motion\nA projectile of mass \\(M\\) (in kg) is launched vertically with initial velocity \\(V_0\\) (in m/s) from a position \\(Y_0\\) (in m) above the surface. Thus the mass’s position, \\(Y(t)\\) is governed by Newton’s second law (applied to the mass and the mass of the Earth) and the set of equations \\[\n\\begin{gathered}\nM Y_{tt} = - \\frac{g R_E^2 M}{(R_E + Y)^2}, \\\\\nY(0) = Y_0,\n\\end{gathered}\n\\] where \\(g = 9.81 m/s^2\\) and \\(R_E = 6.4 \\times 10^6 m\\) is the radius of the Earth.",
    "crumbs": [
      "Introduction",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Problem class 1</span>"
    ]
  },
  {
    "objectID": "part-01-intro/problemclass01.html#projectile-motion",
    "href": "part-01-intro/problemclass01.html#projectile-motion",
    "title": "4  Problem class 1",
    "section": "",
    "text": "Non-dimensionalise the equation using arbitary length and time scales.\nIdentify the non-dimensional constants, \\(\\Pi_i\\).\nChoose a length scale of \\(L = Y_0\\) and time scale of \\(T = (L/g)^{1/2}\\). Discuss the resultant equation and the interpretation of choosing these scales.\nDoes your above choice allow you to easily study the limit of \\(R_E \\to \\infty\\)? If the limit can be taken, reduce the governing system to a simpler equation.\nDoes your choice in 3. allow you to easily study the limit of \\(Y_0 \\to 0\\)? If not, choose an alternative choice of length and time scales and in that case, reduce the set of equations.",
    "crumbs": [
      "Introduction",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Problem class 1</span>"
    ]
  },
  {
    "objectID": "part-01-intro/problemclass01.html#terminal-velocity",
    "href": "part-01-intro/problemclass01.html#terminal-velocity",
    "title": "4  Problem class 1",
    "section": "4.2 Terminal velocity",
    "text": "4.2 Terminal velocity\n\\(\\nextSection\\)\nA ball of radius \\(R\\) (in m) and uniform density \\(\\rho\\) (in kg/m3) falls in a viscous fluid. The fluid has density \\(\\rho_f\\) (in kg/m3) and viscosity (a measure of friction or resistance) \\(\\mu\\) (in kg/(m s)). The equation that governs the velocity is \\[\n\\begin{gathered}\n\\frac{4}{3} \\pi R^3 \\rho \\frac{\\mathrm{d}V}{\\mathrm{d}t} = \\frac{4}{3} \\pi R^3 (\\rho - \\rho_f) g - 6\\pi \\mu R V, \\\\\nV(0) = V_0.\n\\end{gathered}\n\\]\n\nChoose appropriate velocity and time scales to non-dimensionalise the equation so as to leave only a single non-dimensional number on the drag term (the last term on the right hand-side).\nDefine the non-dimensional parameter expressing a ratio between drag force and gravity force by the Stokes number (St) and confirm that it is \\[\nSt = \\frac{9\\mu V_0}{2(\\rho - \\rho_f) g R^3}.\n\\]\nComment on the two limits of \\(St \\to 0\\) and \\(St \\to \\infty\\). Can the problem be reduced in these two limits? If so, reduce and solve.",
    "crumbs": [
      "Introduction",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Problem class 1</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/techniques.html",
    "href": "part-05-techniques/techniques.html",
    "title": "Practical applied mathematics",
    "section": "",
    "text": "As we go deeper into formulating the equations that model or govern aspects of Planet Earth, we will quickly come to the realisation that many such equations, even for the simplest minimal models, are not exactly solvable.\nFor example, in the analysis of the Ocean models later in the course, we develop the following “simple” model for the temperature in the ocean: \\[\n\\begin{aligned}\n\\frac{\\mathrm{d}x}{\\mathrm{d}t} &= \\delta(1 - x) - |f(x, y)|x, \\\\\n\\frac{\\mathrm{d}y}{\\mathrm{d}t} &= 1 - y - |f(x, y)|y,\n\\end{aligned}\n\\] where we have introduced the function, \\[\nf(x, y; R, \\lambda) = \\frac{1}{\\lambda}(Rx - y),\n\\]\nThis is quite a difficult problem! This is essentially a set of two nonlinear differential equations for two unknowns and three parameters. What kind of practical applied mathematics can we apply to study such problems?\nThe intention of this part is to introduce (and in some cases, review) three key concepts:\n\nAsymptotic approximations.\nNumerical solutions of differential equations.\nNumerical solutions of nonlinear equations (Newton’s method).\n\nas well as any additional tools you may need to study the kinds of differential equations involved in Maths of Planet Earth!",
    "crumbs": [
      "Practical applied mathematics"
    ]
  },
  {
    "objectID": "part-05-techniques/asymptotics01.html",
    "href": "part-05-techniques/asymptotics01.html",
    "title": "5  Asymptotic approximations I",
    "section": "",
    "text": "5.1 A simple quadratic\nIf \\(\\epsilon = 0\\), then \\(x = 1\\). Moreover, if we substitute \\(x = 1\\) into the equation, then we see that the error is small and proportional to \\(\\epsilon\\). It is natural to seek an approximation in powers of \\(\\epsilon\\). We call this an . We write \\[\nx = x_0 + \\epsilon x_1 + \\epsilon^2 x_2 + \\ldots\n\\] Substitution into the equation yields \\[\n\\epsilon \\Bigl(x_0 + \\epsilon x_1 + \\epsilon^2 x_2 + \\ldots\\Bigr)^2 + \\Bigl( x_0 + \\epsilon x_1 + \\epsilon^2 x_2 + \\ldots \\Bigr) - 1 = 0.\n\\] Expand and collect terms in powers of \\(\\epsilon\\): \\[\n\\Bigl( x_0 - 1 \\Bigr) + \\epsilon\\Bigl(x_1 + x_0^2\\Bigr) + \\epsilon^2\\Bigl(x_2 + 2 x_0 x_1\\Bigr) + \\ldots = 0.\n\\] Now we equate coefficients at each order in \\(\\epsilon\\). This gives \\[\n\\begin{aligned}\nx_0 - 1 &= 0 \\Longrightarrow x_0 = 1 \\\\\nx_1 + x_0^2 &= 0 \\Longrightarrow x_1 = -1 \\\\\nx_2 + 2 x_0 x_1 &= 0 \\Longrightarrow x_2 = 2\n\\end{aligned}\n\\] We therefore have obtained the three-term approximation, \\[\nx = 1 - \\epsilon + 2\\epsilon^2 + \\ldots\n\\] Clearly we could continue this process ad infinitum obtaining increasingly accurate approximations to one of the roots.",
    "crumbs": [
      "Practical applied mathematics",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Asymptotic approximations I</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/asymptotics01.html#a-simple-quadratic",
    "href": "part-05-techniques/asymptotics01.html#a-simple-quadratic",
    "title": "5  Asymptotic approximations I",
    "section": "",
    "text": "A singular quadratic\n\n\n\nConsider the solution of \\[\n\\epsilon x^2 + x - 1 = 0,\n\\tag{5.1}\\] where \\(\\epsilon\\) is a fixed and very small positive number, say \\(0.000001\\). Forget that we know how to solve a quadratic equation: is it possible to develop a systematic approximation method?\n\n\n\n\n5.1.1 The singular root\n\\(\\nextSection\\)\nBut where has the other quadratic root gone?\nThe problem is that in considering \\(\\epsilon\\) to be small, we began by ignoring the leading term, \\(\\epsilon x^2\\). We effectively assumed that the equation was primarily balanced by setting the \\(x\\) term with the \\(-1\\) term, and the sum of the two terms approximately equalling zero.\nBut if \\(|x|\\) is large, then clearly our assumption that \\(\\epsilon x^2\\) being small may not be necessarily true for it depends on how large \\(|x|\\) is compared to \\(\\epsilon\\). Note that if \\(|x|\\) is large, then necessarily the last term, \\(-1\\), is negligible in comparison. Therefore, in order for \\(\\epsilon x^2\\) to balance \\(x\\), we see that \\(|x|\\) must be of size \\(1/\\epsilon\\).\nTherefore this suggests that we should re-scale our solution as follows \\[\nx = \\frac{X}{\\epsilon}.\n\\]\nSubstitution into the original quadratic now yields \\[\nX^2 + X - \\epsilon = 0.\n\\] Now notice that \\(\\epsilon = 0\\) expresses the correct balance in order to detect that missing root. Again we write \\[\nX = X_0 + \\epsilon X_1 + \\epsilon^2 X_2 + \\ldots\n\\] and attempt to solve order by order. Substitution into the equation yields \\[\n\\Bigl(X_0 + \\epsilon X_1 + \\epsilon^2 X_2 + \\ldots\\Bigr)^2 + \\Bigl(X_0 + \\epsilon X_1 + \\epsilon^2 X_2 + \\ldots\\Bigr) - \\epsilon = 0.\n\\] Expand and collect orders of \\(\\epsilon\\): \\[\n\\begin{aligned}\nX_0^2 + X_0 &= 0 \\Longrightarrow X_0 = -1 \\\\\n2X_0 X_1 + X_1 -1 &= 0 \\Longrightarrow X_0 = -1,\n\\end{aligned}\n\\] and thus to two orders, we have \\[\nX = -1 - \\epsilon + \\ldots \\Longrightarrow x = - \\frac{1}{\\epsilon} - 1 + \\ldots\n\\]\nOf course, we have used a very simple example (a solvable quadratic) to illustrate the idea of asymptotic approximations, but you should hopefully see that this method is extensible to much more complicated equations.\n\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nep = np.linspace(1,0.1, 20)\nroot1 = (-1 + np.sqrt(1-4*ep*(-1)))/(2*ep)\nroot2 = (-1 - np.sqrt(1-4*ep*(-1)))/(2*ep)\nasym1 = 1 - ep\nasym2 = -1/ep - 1\nplt.plot(ep, root1, 'o')\nplt.plot(ep, root2, 'o')\nplt.plot(ep, asym1, '-')\nplt.plot(ep, asym2, '-')\nplt.legend(['$x_1$', '$x_2$', '2-term asymp.', '2-term asym'])\nplt.xlabel('$\\epsilon$')\nplt.ylabel('x');",
    "crumbs": [
      "Practical applied mathematics",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Asymptotic approximations I</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/asymptotics01.html#order-notation-and-the-tilde-sign-for-asymptotic",
    "href": "part-05-techniques/asymptotics01.html#order-notation-and-the-tilde-sign-for-asymptotic",
    "title": "5  Asymptotic approximations I",
    "section": "5.2 Order notation and the tilde sign for asymptotic",
    "text": "5.2 Order notation and the tilde sign for asymptotic\n\\(\\nextSection\\)\nWe define precisely what we mean when we say that two functions, say \\(f\\) and \\(g\\), exhibit the same behaviour in some limit, say \\(\\epsilon \\to 0\\) or \\(x \\to x_0\\) or \\(x \\to \\infty\\) and so forth. For instance, we claim that the graphs of \\(\\sin(x)\\) and \\(x\\) look very similar as \\(x \\to 0\\). Thus we might write \\[\n    \\sin(x) \\sim x \\quad \\text{as $x \\to 0$.}\n\\tag{5.2}\\]\nThis notation of similarity allows us to specify functional behaviours at a deeper level than just limits. As you can see, it is not as useful to specify that \\[\n\\lim_{x \\to 0} \\sin{x} = \\lim_{x\\to 0} x.\n\\] In contrast, the asymptotic relation is much more prescriptive about the way that the functions are approaching the limit.\n\n\n\n\n\n\nDefinition of \\(\\sim\\), \\(\\gg\\), and \\(\\ll\\)\n\n\n\nFirst, the notation \\[\nf(x) \\ll g(x), \\qquad x \\to x_0,\n\\] is read as “\\(f(x)\\) is much smaller than \\(g(x)\\) as \\(x \\to x_0\\)” and means \\[\n\\lim_{x\\to x_0} \\frac{f(x)}{g(x)} = 0.  \n\\] We may analogously use \\(g(x) \\gg f(x)\\) for “much greater than”.\nSecond, the notation \\[\nf(x) \\sim g(x), \\qquad x \\to x_0,\n\\] is read as “\\(f(x)\\) is asymptotic to \\(g(x)\\) as \\(x \\to x_0\\)”, and means that the error between \\(f\\) and \\(g\\) tends to zero as \\(x \\to x_0\\), or \\[\n\\lim_{x\\to x_0} \\frac{f(x)}{g(x)} = 1.  \n\\] We will often say “\\(f\\) is like \\(g\\)” or “\\(f\\) behaves like \\(g\\)”,\n\n\nHere are some examples.\n\n\n\n\n\n\nExamples\n\n\n\n\n\\(\\sin x \\sim x \\sim \\tan x\\) as \\(x \\to 0\\)\n\\(x^2 + x + 1 \\sim \\dfrac{x^3 + \\sin x}{1 + x}\\) as \\(x \\to \\infty\\)\n\\(\\sin x \\ll \\cos x\\) as \\(x \\to 0\\)\n\n\n\nIn the examination of limiting processes, often the main issue of consideration is the relative sizes of quantities defined according to their powers. For example, if \\(x\\) is a very small number, with \\(x = 10^{-5}\\), then \\(x^5\\) is much smaller than \\(x\\) (in terms of our notation, \\(x^5 \\ll x\\) as \\(x \\to 0\\)). On the other hand, we might not care so much about the difference between \\[\nx^5 \\quad \\text{vs.} \\quad 5 x^5\n\\] The point is that the of \\(x^5\\) and \\(5 x^5\\) is the same as \\(x \\to 0\\). The “Big-Oh” notation formalises this distinction.\n\n\n\n\n\n\nDefinition of Big-Oh\n\n\n\nWe write \\(f = O(g)\\) as \\(x \\to x_0\\) to mean that there exists constants \\(K &gt; 0\\) and \\(x^* &gt; 0\\) such that \\[\n|f| &lt; K |g| \\quad \\text{for all $|x - x_0| &lt; x^*$}.\n\\]\n\n\nIn practice, the use of the order symbol is very natural and you will not need to work with the technical definition. For example, when you derive the terms of the Maclaurin/Taylor series, you are naturally clustering all the terms of the same order (power) together. For us, the \\(O\\) symbol provides a very convenient way of separating terms of different sizes.\n\n\n\n\n\n\nExamples\n\n\n\n\n\\(2\\sin x = O(\\tan x)\\) as \\(x \\to 0\\)\n\\(x^2 + x + 1 = O\\left(\\dfrac{5x^3 + \\sin x}{1 + x}\\right)\\) as \\(x \\to \\infty\\)\n\n\n\nLet us return to the case of the quadratic example (Equation 5.1). Using the O notation, we can write \\[\nx =\n\\begin{cases}\n1 - \\epsilon + 2 \\epsilon^2 + O(\\epsilon^3) \\\\\n-\\frac{1}{\\epsilon} - 1 + O(\\epsilon^2)\n\\end{cases}\n\\] for the two roots. Alternatively, we can truncate the expansions and simply using the \\(\\sim\\) symbol: \\[\nx \\sim\n\\begin{cases}\n1 - \\epsilon  \\\\\n-\\frac{1}{\\epsilon} - 1\n\\end{cases}\n\\]",
    "crumbs": [
      "Practical applied mathematics",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Asymptotic approximations I</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/asymptotics02.html",
    "href": "part-05-techniques/asymptotics02.html",
    "title": "6  Asymptotic approximations II",
    "section": "",
    "text": "6.1 Returning to the projectile problem\nIn Chapter 4 and Chapter 25 you studied the non-dimensionalisation of the projectile problem. Once re-scaled, it takes the following form: \\[\n\\begin{aligned}\n\\frac{\\mathrm{d}^2 y}{\\mathrm{d}t^2} &= -\\frac{1}{(1 + \\epsilon y)^2}, \\qquad t &gt; 0 \\\\\ny(0) &= 0, \\\\\ny'(0) &= 1.\n\\end{aligned}\n\\tag{6.1}\\]\nThis is a difficult problem without, in fact, any explicit solutions. However, we can estimate the solution in the limit \\(\\epsilon \\to 0\\). We expand the solution as \\[\ny(t) = y_0(t) + \\epsilon y_1(t) + \\epsilon^2 y_2(t) + \\ldots\n\\] In order to expand the denominator, you can use Taylor’s theorem to expand the function \\[\nf(x) = (1 + x)^\\alpha = f(0) + f'(0)x + \\ldots = 1 + \\alpha x + \\ldots\n\\] around \\(x = 0\\).\nThe differential equation now yields \\[\ny_0'' + \\epsilon y_1'' + \\epsilon^2 y_2'' + \\ldots = -\\left[1 - 2\\epsilon \\left(y_0 + \\epsilon y_1 + \\ldots\\right) + \\ldots \\right]\n\\] so grouping terms together order-by-order yields \\[\n\\Bigl[ y_0'' + 1 \\Bigr] + \\epsilon \\Bigl[ y_1'' - 2y_0\\Bigr] + \\ldots = 0.\n\\]\nWe can similarly substitute the expansion into the initial conditions. Altogether, at leading order, we obtain the following system to solve: \\[\n\\begin{aligned}\ny_0'' + 1 &= 0, \\\\\ny_0(0) &= 0, \\\\\ny_0'(0) &= 1.\n\\end{aligned}\n\\] Integrating twice and applying the boundary conditions gives us \\[\ny_0(t) = -\\frac{1}{2}t^2 + t.\n\\] In fact, this is simply the parabolic motion you would expect from school Physics. The \\(\\epsilon = 0\\) solution corresponds to assuming that the mass at the centre of the planet is dominant and then acceleration is constant.\nHowever, we can now proceed to higher order and examine the nonlinear effects. Proceeding to \\(O(\\epsilon)\\), we have the following system to solve: \\[\n\\begin{aligned}\ny_1'' &= 2y_0, \\\\\ny_1(0) &= 0, \\\\\ny_1'(0) &= 0.\n\\end{aligned}\n\\] Notice the boundary conditions come from the fact there are no \\(\\epsilon\\) corrections in the original boundary conditions, so \\(y_n(0) = y_n'(0) = 0\\) for all \\(n &gt; 0\\). Again this system is simple to integrate. Integrating the solution for \\(y_0\\) twice and substitution of the initial conditions yields \\[\ny_1(t) = -\\frac{1}{12}t^4 + \\frac{1}{3}t^3.\n\\] We have thus solved for the asymptotic approximation to two orders. We have \\[\ny(t) \\sim \\Bigl[ -\\frac{1}{2}t^2 + t\\Bigr] + \\epsilon \\Bigl[ -\\frac{1}{12}t^4 + \\frac{1}{3}t^3\\Bigr].\n\\] This was quite an accomplishment! We have taken a problem that was not easily solvable in explicit form and through fairly simple integrations, obtained an approximation to two orders in \\(\\epsilon\\). How good is it? Let us solve the problem numerically and compare with the asymptotic approximation.",
    "crumbs": [
      "Practical applied mathematics",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Asymptotic approximations II</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/asymptotics02.html#sec-asym2-num",
    "href": "part-05-techniques/asymptotics02.html#sec-asym2-num",
    "title": "6  Asymptotic approximations II",
    "section": "6.2 Numerical solutions of IVPs",
    "text": "6.2 Numerical solutions of IVPs\n\\(\\nextSection\\)\nWe first demonstrate how to solve ODEs (initial-value-problems, IVPs) using black-box functions in Python. For starters, most numerical formulations for ODEs will require that the problem be posed in terms of a first-order system of equations. To convert (Equation 6.1) into such a form, create a set of unknowns for the derivatives. Set \\[\n\\mathbf{Y}(t) =\n\\begin{pmatrix}\ny_1(t) \\\\\ny_2(t)\n\\end{pmatrix}\n= \\begin{pmatrix}\ny(t) \\\\\ny'(t)\n\\end{pmatrix}\n\\]\nThen we have the following first-order system:\n\\[\n\\begin{aligned}\n\\mathbf{Y}'(t) &= \\mathbf{F}(t, \\mathbf{Y}(t)) = \\begin{pmatrix}\ny_1' \\\\\n- \\frac{1}{(1 + \\epsilon y_1)^2}\n\\end{pmatrix} \\\\\n\\mathbf{Y}(0) &= \\begin{pmatrix}\n0 \\\\\n1\n\\end{pmatrix}\n\\end{aligned}\n\\tag{6.2}\\]\nYou can find a little guide on using solve_ivp in Python here. Here is the Python code to solve the differential equation.\n\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom scipy.integrate import solve_ivp\n\nep = 0.2 # epsilon value\ntmax = 2 # max time\nt = np.linspace(0, tmax, 100) # mesh used for plotting\n\n# Define function for the ODE\ndef f(t, Y):\n    ep = 0.2\n    y, yp = Y\n    ypp = -1/(1 + ep*y)**2\n    return [yp, ypp]\n\n# define the initial condition\nY0 = [0, 1]\n\nsol = solve_ivp(f, [0, tmax], Y0, dense_output=True)\n\n# Prior to plotting, re-interpolate solution on a fine grid\nyy = sol.sol(t)\n# Asymptotic solutions\ny0 = -1/2*t**2 + t\ny1 = -1/12*t**4 + 1/3*t**3\n\n# Plot it all\nplt.plot(t, yy[0,])\nplt.plot(t, y0, '--')\nplt.plot(t, y0 + ep*y1, '--')\nplt.xlabel('t')\nplt.ylabel('y(t)')\n\nText(0, 0.5, 'y(t)')\n\n\n\n\n\n\n\n\n\nThe two-term approximation does beautifully well, even at this moderate value of \\(\\epsilon = 0.2\\).",
    "crumbs": [
      "Practical applied mathematics",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Asymptotic approximations II</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/euler.html",
    "href": "part-05-techniques/euler.html",
    "title": "7  Numerical solutions of IVPs",
    "section": "",
    "text": "In the previous section, we used built-in ODE solvers to develop numerical solutions. It is important to gain an understanding how a simple ODE solver works. The simplest scheme is called Euler’s method, and this we now explain.\nBegin from the system (Equation 6.2). We assume that the solution is represented by a discrete set of points, \\(\\mathbf{Y}_n = \\mathbf{Y}(t_n)\\) at the times \\(t_0 = 0\\), \\(t_1 = \\Delta t\\), \\(t_2 = 2\\Delta t\\), and so on. The time derivative is written as a discrete derivative while we approximate the right hand side by its value at the nth time step: \\[\n\\frac{\\mathbf{Y}_{n+1} - \\mathbf{Y}_{n}}{\\Delta t} = \\mathbf{F}(t_n, \\mathbf{Y}_n)\n\\]\nRearranging yields a very simple algorithm for solving the ODE: \\[\n\\mathbf{Y}_{n} = \\mathbf{Y}_{n-1} + \\mathbf{F}(t_{n-1}, \\mathbf{Y}_{n-1}) \\Delta t\n\\] for \\(n = 1, 2, 3, \\ldots\\)\nThis would be implemented via the following pseudocode:\n\n\n\n\n\n\nEuler’s method\n\n\n\n1. Input: function f(t, Y)  \n            time step, dt\n            initial condition, Y0\n\n2. Set initial condition Y = Y0\n\n2. Take one Euler step and overwrite previous value\n\n                 Y = Y + f(t, Y)\n\n3. Increment t by dt and goto 2\n\n\nEuler’s method is conceptually simple but quite inaccurate. But in this case, we see that it works fairly well in comparison to the built-in solvers.\n\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom scipy.integrate import solve_ivp\n\nep = 0.2            # epsilon value\ntmax = 2            # max time\nN = 20              # number of steps\nt = np.linspace(0, tmax, N) # mesh used for plotting\ndt = t[1] - t[0]\n\n# Define function for the ODE\ndef f(t, Y, ep):\n    y, yp = Y\n    ypp = -1/(1 + ep*y)**2\n    return np.array([yp, ypp])\n\n# define the initial condition\nY = [0.0, 1.0]\nti = 0\n\n# define the solution vector\nfor i in range(1, N):\n    ti = ti + dt  # Increment time\n    Y = Y + f(ti, Y, ep)*dt # Euler step\n    plt.plot(ti, Y[0], 'k.')\n\n# Asymptotic solutions\ny0 = -1/2*t**2 + t\ny1 = -1/12*t**4 + 1/3*t**3\nplt.plot(t, y0, '--')\nplt.plot(t, y0 + ep*y1, '--')\nplt.xlabel('t');\nplt.ylabel('y');",
    "crumbs": [
      "Practical applied mathematics",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Numerical solutions of IVPs</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/asymptotics03.html",
    "href": "part-05-techniques/asymptotics03.html",
    "title": "8  Asymptotic approximations III",
    "section": "",
    "text": "8.1 Regular vs. singular problems\nIn Chapter 6, we studied how asymptotic expansions can be used to approximate equations like \\[\n\\frac{\\mathrm{d}^2 y}{\\mathrm{d}t^2} = -\\frac{1}{(1 + \\epsilon y)^2}\n\\] by expanding the solution as \\(y(t) = y_0(t) + \\epsilon y_1(t) + \\ldots\\). These are known as regular problems because a small perturbation, \\(\\epsilon\\), does not seem to fundamentally change the \\(\\epsilon = 0\\) solution beyond a small perturbation. This is not always the case. In singular problems, the situation of \\(\\epsilon \\neq 0\\) is fundamentally different than the situation from \\(\\epsilon = 0\\). You have already seen such an example in Chapter 5. The equation \\[\n\\epsilon x^2 + x - 1 = 0\n\\] has one root for \\(\\epsilon = 0\\) and two roots for non-zero small \\(\\epsilon\\)—even infinitesimally small values! This is quite interesting. From a wider scientific perspective, you may wonder what other problems in nature possess such singular effects.\nThe point of this lecture is study a technique known as matched asymptotics. These matched asymptotics are often necessary for singularly perturbed differential equations.",
    "crumbs": [
      "Practical applied mathematics",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Asymptotic approximations III</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/asymptotics03.html#a-singular-first-order-ode-problem",
    "href": "part-05-techniques/asymptotics03.html#a-singular-first-order-ode-problem",
    "title": "8  Asymptotic approximations III",
    "section": "8.2 A singular first-order ODE problem",
    "text": "8.2 A singular first-order ODE problem\n\\(\\nextSection\\)\nPreviously in Chapter 3, we derived a basic equation that governs the temperature on the surface of the planet. This equation had the following form: \\[\n(\\rho c_p V) \\frac{\\mathrm{d}T}{\\mathrm{d}t} = E_{\\text{in}}(t, T) - E_{\\text{out}}(t, T).\n\\]\nFor the purpose of this section, let us make up a toy model. We suggest, in non-dimensional form, \\[\n\\begin{aligned}\n\\epsilon \\frac{\\mathrm{d}T}{\\mathrm{d}t} &= R(t) - T, \\quad t \\geq 0 \\\\\nT(0) &= T^*,\n\\end{aligned}\n\\tag{8.1}\\] where we consider \\(\\epsilon &gt; 0\\) and \\(\\epsilon \\ll 1\\). You can think of the above model as modelling the temperature on a substance that radiates heat in a fashion proportional to itself (\\(-T\\)) and is being subjected to an (incoming) heat source, \\(R\\). Let us take as an example, \\[\nR(t) = 1 + A \\cos(t).\n\\] Our choice for \\(R\\) is not so important. This equation is, in fact, solvable in closed form (how?) but let us get additional practice solving numerically.\n\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom scipy.integrate import solve_ivp\n\nTs = 0\nep = 0.2\nA = 0.1\nf = lambda t, T: 1/ep*(1 + A*np.cos(t) - T)\n\ntmax = 50\nsol = solve_ivp(f, [0, tmax], [Ts], dense_output=True)\n\nt = np.linspace(0, tmax, 1000)\ny = sol.sol(t)\nplt.plot(t, y[0])\nplt.plot(t, 1 + A*np.cos(t), '--')\n\n\n\n\n\n\n\n\nWhat do we observe? If \\(\\epsilon = 0\\), then we expect the solution \\(T \\sim R(t)\\). This is shown with the dashed line. However, this solution does not satisfy the necessary initial condition. We observe that near \\(t = 0\\), the exact solution seems to very rapidly diverge from the approximation in order to satisfy the proper boundary condition. The region in \\(t\\) where this rapid change occurs is called a boundary layer.\nIf we repeat the experiment with an even smaller value of \\(\\epsilon\\), we would observe that the size of this boundary layer seems to tends to zero as \\(\\epsilon \\to 0\\). This numerical experiment thus inspires the following method.",
    "crumbs": [
      "Practical applied mathematics",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Asymptotic approximations III</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/asymptotics03.html#boundary-layer-theory",
    "href": "part-05-techniques/asymptotics03.html#boundary-layer-theory",
    "title": "8  Asymptotic approximations III",
    "section": "8.3 Boundary layer theory",
    "text": "8.3 Boundary layer theory\n\\(\\nextSection\\)\nWe seek a method that will allow us to develop a uniformly valid approximation, i.e. an approximation that is good everywhere in the relevant domain, \\(t \\geq 0\\). Begin by performing the usual asymptotic approximation: \\[\nT(t) = T_0(t) + \\epsilon T_1(t) + \\epsilon^2 T_2(t) + \\ldots\n\\] Substitution into the ODE (Equation 8.1) yields at leading order, \\[\n0 = R(t) - T_0(t) \\Longrightarrow T_0(t) = R(t) = 1 + A \\cos(t).\n\\] As we have noted, this approximation fails to satisfy the initial condition, \\(T(0) = T^*\\) in general. It is possible to go to higher order but this is not so important at the moment. So for now, we have obtained: \\[\nT_{\\text{outer}} \\sim \\Bigl[ 1 + A\\cos t\\Bigr].\n\\] We have chosen to refer to this as the outer solution for reasons that will be abundantly clear. But rather than satisfying \\(T(0) = T^*\\), this approximation has the limiting behaviour of \\[\n\\lim_{t \\to 0} T_{\\text{outer}} \\sim \\Bigl[ 1 + A\\Bigr]\n\\] Above, we have only included the leading term in the limit expression.\n\n8.3.1 The inner scaling\n\\(\\nextSection\\)\nOur intuition follows a very similar logic to the examination of the singular root in Section 5.1.1. Above, our naive assumption was that \\(\\epsilon T'(t)\\) could be ignored since \\(\\epsilon\\) is a small number. However, this may not be the case if the gradient is very large.\nOur intuition further suggests that the boundary layer occurs near \\(t = 0\\) and that it scales in size with \\(\\epsilon\\). Therefore, let us set \\[\nt = \\epsilon^{\\alpha} s,\n\\] as a change of coordinates. We expect \\(\\alpha &gt; 0\\) (otherwise \\(t\\) is not small), and within this region, we expect the new coordinate, \\(s\\), to be \\(O(1)\\) (of moderate size). We then transform the unknown function: \\[\nT(t) = T(\\epsilon s) = U(s),\n\\] and seek a new differential equation for \\(U\\). By the chain rule, \\[\n\\frac{\\mathrm{d}T}{\\mathrm{d}t} = \\epsilon^{-\\alpha} \\frac{\\mathrm{d}U}{\\mathrm{d}s}.\n\\] Before substituting into the equation, we are prudent to examine the behaviour of \\(R(t)\\) near \\(t = 0\\). We know by Taylor’s theorem that \\[\nR(t) = 1 + A \\left(1 - \\frac{t^2}{2} + \\ldots \\right).\n\\] Therefore, under the substitution, we may approximate \\(R\\) by its leading terms: \\[\nR( \\epsilon^{\\alpha} s) \\sim 1 + A.\n\\] For now, we will not need more terms than this. Substituting into the ODE now gives \\[\n\\epsilon^{1-\\alpha} \\frac{\\mathrm{d}U}{\\mathrm{d}s} \\sim \\Bigl[1 + A\\Bigr] - U.\n\\] Now in order to involve the first term, it is sensible to select \\[\n1 - \\alpha = 0 \\Longrightarrow \\alpha = 1.\n\\]\n\n\n8.3.2 The inner equation\n\\(\\nextSection\\)\nTherefore, the correct coordinate re-scaling was the ‘obvious’ one: \\[\nt = \\epsilon s.\n\\]\nSubstituting this again in (Equation 8.1): \\[\n\\begin{aligned}\n\\frac{\\mathrm{d}U}{\\mathrm{d}s} &= 1 + A\\cos(\\epsilon s) - U, \\\\\nU(0) &= T^*.\n\\end{aligned}\n\\]\nThe procedure is now exactly the same. We expand \\[\nU(s) = U_0(s) + \\epsilon U_1(s) + \\epsilon^2 U_2(s) + \\ldots\n\\] At leading order, we get \\[\n\\begin{aligned}\nU_0' &= 1 + A - U_0 \\\\\nU_0(0) &= T^*.\n\\end{aligned}\n\\]\nThe above ODE can be solved by integrating factors. Multiplying both sides be \\(e^s\\), we have \\[\n(U_0 e^s)' = (1 + A)e^s.\n\\] Integrate and use the initial condition: \\[\nU_0(s) = (1 + A) + (T^* - (1 +A))e^{-s}.\n\\] This is exactly what we expect. Notice that \\[\n\\lim_{s \\to \\infty} U_0(s) = \\lim_{t \\to 0} T_{\\text{outer}}\n\\tag{8.2}\\] therefore the outer limit of our inner solution matches the inner limit of our outer solution. In terms of outer coordinates, our inner solution is approximated as follows: \\[\nT_{\\text{inner}} \\sim (1 + A) + (T^* - (1 +A))e^{-t/\\epsilon}.\n\\]\nLet’s finally plot this with our previous curves:\n\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom scipy.integrate import solve_ivp\n\nTs = 0\nep = 0.2\nA = 0.1\nf = lambda t, T: 1/ep*(1 + A*np.cos(t) - T)\n\ntmax = 20\nsol = solve_ivp(f, [0, tmax], [Ts], dense_output=True)\n\nt = np.linspace(0, tmax, 1000)\ny = sol.sol(t)\nplt.plot(t, y[0])\nplt.plot(t, 1 + A*np.cos(t), '--')\nplt.plot(t, (1 + A) + (Ts - (1 + A))*np.exp(-t/ep), '--')\n\n\n\n\n\n\n\n\nIt works beautifully!\n\n\n8.3.3 Summary\n\\(\\nextSection\\)\nLet us summarise the procedure of matched asymptotics.\n\nExpand the solution of the differential equation naively in the typical asymptotic expansion (e.g. in powers of \\(\\epsilon\\)).\nNotice that the approximation does not satisfy certain boundary conditions.\nRe-scale the coordinates in the ‘inner’ regions.\nDevelop an inner solution that satisfies the boundary condition. Ensure it matches the outer solution.\n\nYou will get more practice of this procedure in the problem sets.",
    "crumbs": [
      "Practical applied mathematics",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Asymptotic approximations III</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/problemclass02.html",
    "href": "part-xx-exercises/problemclass02.html",
    "title": "9  Problem class 2",
    "section": "",
    "text": "This problem class will involve the completition of the ODE studied in asymptotic approximations III. We will then study the boundary-value problem which forms part of the third problem set, namely: \\[\n\\begin{gathered}\n\\epsilon T'' + 2T' + T = 0, \\\\\nT(0) = 0 \\quad \\text{and} \\quad T(1) = 1.\n\\end{gathered}\n\\] The associated Python note is in lectures/lecture12-SolvingBVPs. You will gain an appreciation for some of the unique elements that are introduced when looking at \\(\\epsilon \\to 0\\) in boundary-value problems.",
    "crumbs": [
      "Practical applied mathematics",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Problem class 2</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/newtons.html",
    "href": "part-05-techniques/newtons.html",
    "title": "10  Nonlinear root finding",
    "section": "",
    "text": "10.1 Demo of Newton’s method for scalar equations\nHere is a simple demonstration of Newton’s method in order to solve for one of the roots of the following: \\[\nf(x) = x^3 + x - 1.\n\\]\nWe will start with the initial guess of \\(x_0 = 0\\). We can do this by hand in lectures using a pocket calculator. The solution is \\(x^* \\approx 0.6823278..\\)\nimport numpy as np\n\nx0 = 0\nN = 10\n\ndef Newton(f, df, x, maxiter=10):\n    i = 0\n    while (i &lt; maxiter):\n        err = f(x)\n        x = x - err / df(x)\n        print(\"f(x) = \", np.abs(err), \", x = \", x)\n        i = i + 1\n    return x, err\n\nf = lambda x: x**3 + x - 1\ndf = lambda x: 3*x**2 + 1\n\nx, err = Newton(f, df, x0, N)\nprint(\"Final approximation = \", x)\n\nf(x) =  1 , x =  1.0\nf(x) =  1.0 , x =  0.75\nf(x) =  0.171875 , x =  0.686046511627907\nf(x) =  0.008941036638283384 , x =  0.6823395825973142\nf(x) =  2.823062168566537e-05 , x =  0.6823278039465127\nf(x) =  2.839946056099052e-10 , x =  0.6823278038280194\nf(x) =  2.220446049250313e-16 , x =  0.6823278038280193\nf(x) =  1.1102230246251565e-16 , x =  0.6823278038280193\nf(x) =  1.1102230246251565e-16 , x =  0.6823278038280193\nf(x) =  1.1102230246251565e-16 , x =  0.6823278038280193\nFinal approximation =  0.6823278038280193\nIt is a good idea to also learn how to do this using built-in packages. The ‘fsolve’ function provides a Newton-like nonlinear solver. In fact, it can estimate the Jacobian (derivative), so only the function values need to be provided.\nimport numpy as np\nfrom scipy.optimize import fsolve\n\nf = lambda x: x**3 + x - 1\n\nx0 = 1\nx, info, ier, msg = fsolve(f, x0, full_output=True)\n\nprint(msg)\nprint(x)\n\nThe solution converged.\n[0.6823278]",
    "crumbs": [
      "Practical applied mathematics",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Nonlinear root finding</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/newtons.html#demo-of-newtons-method-for-scalar-equations",
    "href": "part-05-techniques/newtons.html#demo-of-newtons-method-for-scalar-equations",
    "title": "10  Nonlinear root finding",
    "section": "",
    "text": "i\nxi\nf(xi)\nf’(xi)\n-f(xi)/f’(xi)\nerror\n\n\n\n\n0\n\n\n\n\n\n\n\n1\n\n\n\n\n\n\n\n2",
    "crumbs": [
      "Practical applied mathematics",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Nonlinear root finding</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/newtons.html#newtons-method-for-systems-of-nonlinear-equations",
    "href": "part-05-techniques/newtons.html#newtons-method-for-systems-of-nonlinear-equations",
    "title": "10  Nonlinear root finding",
    "section": "10.2 Newton’s method for systems of nonlinear equations",
    "text": "10.2 Newton’s method for systems of nonlinear equations\n\\(\\nextSection\\)\nNewton’s method generalises naturally to the case of a system of equations. Suppose we wish to solve for the \\(n\\) unknowns \\(\\mathbf{x} = (x_1, \\ldots, x_n)\\) via \\[\n\\mathbf{F(\\mathbf{x}}) =\n\\begin{pmatrix}\nF_1(\\mathbf{x}) \\\\\nF_2(\\mathbf{x}) \\\\\n\\ldots \\\\\nF_n(\\mathbf{x})\n\\end{pmatrix} = 0.\n\\]\nWe have, via Taylor’s formula, \\[\n\\mathbf{F}(\\mathbf{x}_{i+1}) \\sim  \\mathbf{F(\\mathbf{x}_i}) + J(\\mathbf{x}_i)(\\mathbf{x}_{i+1} - \\mathbf{x}_i) + \\mathcal{O}(||\\mathbf{x}_{i+1} - \\mathbf{x}_i||^2),\n\\] where \\(J\\) is the Jacobian matrix \\[\nJ(\\mathbf{x}) = \\nabla \\mathbf{F}(\\mathbf{x}) =\n\\begin{pmatrix}\n\\frac{\\mathrm{\\partial}F_1}{\\mathrm{\\partial}x_1} &\n\\cdots &\n\\frac{\\mathrm{\\partial}F_1}{\\mathrm{\\partial}x_n} \\\\\n\\vdots & \\ddots & \\vdots \\\\\n\\frac{\\mathrm{\\partial}F_n}{\\mathrm{\\partial}x_1} &\n\\cdots &\n\\frac{\\mathrm{\\partial}F_n}{\\mathrm{\\partial}x_n}\n\\end{pmatrix}.\n\\] Therefore, Newton’s method forms the iterates of \\[\n\\mathbf{x}_{i+1} = \\mathbf{x}_i {\\color{blue}-} J^{-1}(\\mathbf{x}_i) \\mathbf{F}(\\mathbf{x}_i),\n\\] which takes a very similar form to the scalar case.\nHowever, solution of the inverse of \\(J\\) is typically inefficient, and it is better to instead solve for \\(\\delta_{i+1} = \\mathbf{x}_{i+1} - \\mathbf{x}_i\\) via \\[\nJ(\\mathbf{x}_i) \\delta_{i+1} = - \\mathbf{F}(\\mathbf{x}_i),\n\\] and then calculate \\(\\mathbf{x}_{i+1} = \\mathbf{x}_i + \\delta_{i+1}\\). There are many ways of solving the above matrix problem efficiently using built-in routines that perform, e.g. Gaussian elimination.",
    "crumbs": [
      "Practical applied mathematics",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Nonlinear root finding</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/newtons.html#secant-method",
    "href": "part-05-techniques/newtons.html#secant-method",
    "title": "10  Nonlinear root finding",
    "section": "10.3 Secant method",
    "text": "10.3 Secant method\n\\(\\nextSection\\)\nIn many situations, evaluation of the Jacobian (or derivative) is the most time-consuming or difficult part of a nonlinear solver. Built-in solvers like ‘fsolve’, in fact, have the ability to approximate the derivative numerically.\nThe Secant Method is similar to Newton’s Method but replaces the derivative by a finite difference. Geometrically, the tangent line is replaced with a line through the two last known guesses. The algorithm goes as follows.\n\n\n\n\n\n\nSecant method\n\n\n\n\nDevelop two initial guesses to the solution, x0 and x1\nCompute \\[\nx_{n+1} = x_n - \\frac{f(x_n)}{\\frac{f(x_n) - f(x_{n-1})}{x_n - x_{n-1}}} =  x_n - \\frac{f(x_n)(x_n - x_{n-1})}{f(x_n) - f(x_{n-1})}.\n\\]",
    "crumbs": [
      "Practical applied mathematics",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Nonlinear root finding</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/problemclass03.html",
    "href": "part-xx-exercises/problemclass03.html",
    "title": "11  Problem class 3",
    "section": "",
    "text": "11.1 Numerical solutions\nAn example code that uses first-order explicit Euler timestepping is given in lecture15-winecellar on the lectures coding folder. A typical numerical output is given here:",
    "crumbs": [
      "Practical applied mathematics",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Problem class 3</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/problemclass03.html#numerical-solutions",
    "href": "part-xx-exercises/problemclass03.html#numerical-solutions",
    "title": "11  Problem class 3",
    "section": "",
    "text": "Numerical solution of the wine cellar problem",
    "crumbs": [
      "Practical applied mathematics",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Problem class 3</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/problemclass03.html#analytical-solution",
    "href": "part-xx-exercises/problemclass03.html#analytical-solution",
    "title": "11  Problem class 3",
    "section": "11.2 Analytical solution",
    "text": "11.2 Analytical solution\n\\(\\nextSection\\)\nBefore we begin, it is useful for the purposes of manipulation to write the boundary condition as \\[\nT(0, t) = A \\Re (e^{i\\omega t}) = A\\Re(\\cos (\\omega t) + i \\sin(\\omega t)) = A\\cos(\\omega t).\n\\] This has the advantage that we can manipulate exponentials much more easily.\nTo solve the problem analytically, we attempt a solution method called separation of variables. Let \\[\nT(x, t) = G(t) H(x).\n\\] Substitution into the PDE gives \\[\nG'(t) H(x) = \\kappa G(t) H''(x),\n\\] and we attempt to separate the functions of \\(t\\) to one side and the functions of \\(x\\) to the other. \\[\n\\frac{G'(t)}{G'(t)} = \\kappa \\frac{H''(x)}{H(x)}\n\\] Now in order for two completely different functions dependent on two completely different independent variables to be equal in this way, then this implies that both sides must be equal to a constant. So we have \\[\n\\begin{aligned}\nG' &= \\lambda G \\\\\nH''  &= \\lambda \\kappa H.\n\\end{aligned}\n\\] Therefore \\(G = \\mathrm{const} \\times e^{\\lambda t}\\). Because of the boundary conditions that would require \\(T = A e^{i\\omega t}\\), you can check that \\(\\lambda = 0\\) and \\(\\lambda\\) real are both impossible. The only way to satisfy the boundary conditions is if \\(\\lambda = i\\omega\\). So we conclude that \\[\nG(t) = \\mathrm{const.} \\times e^{i\\omega t}.\n\\] To solve \\[\nH'' = (i\\omega/\\kappa) H,\n\\] you can attempt the substitution \\(H(x) = e^{rx}\\) and solve the resultant equation for the characteristic polynomial in \\(r\\). You will do this in the problem set, and obtain \\[\nr = \\pm \\sqrt{i} \\sqrt{\\omega/\\kappa} = \\pm \\sqrt{\\omega/\\kappa} \\frac{1 + i}{\\sqrt{2}}.\n\\] Therefore \\[\nH(x) = C_1 e^{\\sqrt{\\omega/(2\\kappa)}x}e^{\\sqrt{\\omega/(2\\kappa)}ix}+ C_2 e^{-\\sqrt{\\omega/(2\\kappa)}x}e^{-\\sqrt{\\omega/(2\\kappa)}ix}.\n\\] The first solution should be discarded since it blows up as \\(x \\to \\infty\\).\nFinally, we conclude that the solution is given by \\[\nT = e^{i\\omega t} e^{-\\sqrt{\\omega/(2\\kappa)}x}e^{-\\sqrt{\\omega/(2\\kappa)}ix}.\n\\] Move the imaginary arguments together: \\[\nT = \\text{const.} \\times  e^{-\\sqrt{\\omega/(2\\kappa)}x}e^{i(-\\sqrt{\\omega/(2\\kappa)}x + \\omega t)}.\n\\] Now we take the real part, giving \\[\nT = A e^{-\\sqrt{\\omega/(2\\kappa)}x} \\cos\\left(-\\sqrt{\\omega/(2\\kappa)}x + \\omega t\\right),\n\\tag{11.1}\\] and we see that having set the constant to \\(A\\) the solution indeed satisfies \\(T(0, t) = A\\cos(\\omega t)\\).",
    "crumbs": [
      "Practical applied mathematics",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Problem class 3</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/problemclass03.html#selection-of-optimal-depth",
    "href": "part-xx-exercises/problemclass03.html#selection-of-optimal-depth",
    "title": "11  Problem class 3",
    "section": "11.3 Selection of optimal depth",
    "text": "11.3 Selection of optimal depth\n\\(\\nextSection\\)\nThe optimal depth of the wine cellar is selected by taking the depth to be such that the cosine is completely out of phase with the surface solution. This means that \\[\n-\\sqrt{\\omega/(2\\kappa)}x + \\omega t + \\pi = \\omega t.\n\\] You can substitute other multiples of \\(\\pi\\). Thus we have \\[\nx = \\pi \\sqrt{\\frac{2\\kappa}{\\omega}}.\n\\] We can estimate the numbers as follows. Converting from 1 year to seconds yields \\[\n\\omega = \\frac{2\\pi}{3.15 \\times 10^7 \\mathrm{s}}.\n\\] Also, the \\(\\kappa\\) for dry soil is around \\(0.002 \\mathrm{cm}^2/\\mathrm{s}\\).\nPutting these numbers in yields \\[\nx \\approx 445 \\mathrm{cm} = 4.45 \\mathrm{m}.\n\\]",
    "crumbs": [
      "Practical applied mathematics",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Problem class 3</span>"
    ]
  },
  {
    "objectID": "part-03-box/box-energy-model.html",
    "href": "part-03-box/box-energy-model.html",
    "title": "12  EBM with nonlinear albedo",
    "section": "",
    "text": "12.1 Steady-state analysis\nBelow, we shall let \\(T = T_\\infty\\) be the steady-state solution that is independent of time. Whenever convenient, we will drop the subscript notation and simply refer to the steady state as \\(T\\).\nPreviously, we have assumed that the planetary albedo, \\(a\\), is constant and independent of temperature. In actuality, water can turn to snow and ice and vice versa; since snow and ice have much higher albedo than open water, then we should consider \\(a = a(T)\\).\nLet us assume that there are two relevant ranges to consider: T &lt; 150K (cold) and T &gt; 280K (hot). Let us assume that the albedo is, in these two regions: \\[\na(T) \\approx\n\\begin{cases}\n0.7 & \\mathrm{if }\\ T &lt; 150\\mathrm{K}, \\\\\n0.3 & \\mathrm{if }\\ T &gt; 280\\mathrm{K}.\n\\end{cases}\n\\] The above guarantees that more energy is reflected if temperatures are low. To model this process, we can use a ramp function to specify the albedo over all temperatures: \\[\na(T) = A - B \\mathrm{tanh}\\left(k(T - 265)\\right).\n\\tag{12.2}\\] where \\(A = 0.5\\), \\(B = {\\color{blue}0.2}\\), \\(k = 0.1\\), and \\(T_0 = 265 \\mathrm{K}\\). Recall that the tanh function is given by \\[\n\\mathrm{tanh}(x) = \\frac{\\mathrm{sinh}(x)}{\\mathrm{cosh}(x)} = \\frac{e^x - e^{-x}}{e^x + e^{-x}}.\n\\]\nLet us further assume that the system is in steady state, so that the temperature is determined by solving the equation \\[\nf(T) = Q[1 - a(T)] - \\sigma \\gamma T^4 = 0.\n\\tag{12.3}\\]\nIn the following code, we plot the two terms that make up \\(f\\), and their intersections indicate roots of \\(f = 0\\). We then use the Python ‘fsolve’ function to approximate the roots given initial guesses.\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport scipy.optimize as sciopt\n\nQ = 342\nsigma = 5.67e-8 \ngamma = 0.62\n\nTT = np.linspace(220,310,50)\n\ndef fun(T):\n    a = 0.5 - 0.2*np.tanh((T - 265)/10)\n    x = (1-a)*Q\n    return x\nLHS = fun(TT)\n\nplt.plot(TT, LHS)\nplt.plot(TT, gamma*sigma*TT**4, 'k--')\n\ndef eq(T):\n    x = fun(T) - gamma*sigma*T**4\n    return x\nT1 = sciopt.fsolve(eq, 230)\nT2 = sciopt.fsolve(eq, 265)\nT3 = sciopt.fsolve(eq, 290)\nprint(\"T1 = {:.2f}\".format(T1[0]))\nprint(\"T2 = {:.2f}\".format(T2[0]))\nprint(\"T3 = {:.2f}\".format(T3[0]))\n\nT1 = 232.55\nT2 = 265.56\nT3 = 286.74\nTherefore multiple equilibria are observed.",
    "crumbs": [
      "Energy balance models",
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>EBM with nonlinear albedo</span>"
    ]
  },
  {
    "objectID": "part-03-box/box-energy-model.html#bifurcation-diagram",
    "href": "part-03-box/box-energy-model.html#bifurcation-diagram",
    "title": "12  EBM with nonlinear albedo",
    "section": "12.2 Bifurcation diagram",
    "text": "12.2 Bifurcation diagram\n\\(\\nextSection\\)\nDuring the lectures, the above script plotting the steady-state solutions will be examined in order to understand the effects of changing \\(Q\\).\nIt will be observed that dependent on the solar radiation, there may be one or three steady-state solutions. This leads to the following key bifurcation diagram.\n\n\n\n\n\n\nFigure 12.1: Bifurcation diagram of \\(Q/Q_0\\) vs \\(T_\\infty\\)\n\n\n\nWe noted the following:\n\nThe system has three steady states, given by the green, red, and blue curves.\nThe middle state is unstable (shown dashed).\nThe system exhibits hysteresis. Note that if we decrease \\(Q/Q_0\\) past the tipping point, marked \\(Q_{T1}\\) in the image, then we would evolve to the lower stable steady state (which is the ice state). However, while we are in the ice stated, if we were to attempt to increase the solar radiation to return to the green branch, we would need to arrive at \\(Q_{T2}\\) to do so; this irreversibility is known as hysteresis. ## Dynamics and phase line solutions\n\nThe full time-dependent model is given by \\[\nC \\frac{\\mathrm{d}T}{\\mathrm{d}t} = f(T),\n\\] so we may use the positivity or negativity of \\(f\\) in order to sketch the time-dependent behaviour of the system.\nTo see this, we can perform an asymptotic analysis near the fixed points. Let the initial condition be considered near the fixed point: \\[\nT(t = 0) = T_\\infty + \\delta,\n\\] where \\(\\delta \\ll 1\\). Then we expand the solution into an asymptotic expansion, \\[\nT(t) = T_\\infty + \\delta T_1(t) + \\delta T^2(t) + \\ldots\n\\] Substitution into the above ODE gives, at \\(O(\\delta)\\), \\[\nC \\frac{\\mathrm{d}T_1}{\\mathrm{d}t} = f'(T_\\infty) T_1,\n\\] and hence, with \\(T_1(0) = 1\\), we have \\[\nT_1(t) = e^{f'(T_\\infty) t/C}.\n\\] Therefore, depending on the positivity or negativity of the gradient function, the perturbation will either decay or grow as \\(t\\to\\infty\\).\nIt can then be verified that the centre equilbria is unstable while the other two are stable. The higher temperature corresponds to the one that the Earth is currently in, but according to this model, there seems to be the possibility of a colder climate (50 degrees colder) where the Earth is entirely covered with snow and ice.\nInterestingly, there is some evidence that the Earth’s climate may have been in this so-called state up to four times between 750 million and 580 million years ago (Neoproterozoic age). Observations of geological deposits suggest that the Earth has undergone periods of complete global glaciation where there have been very minimal biological activity. During this period, there is a massive build-up of CO2 in the atmopshere, leading to huge greenhouse effect. As \\(\\gamma\\) decreases in our model, the equilibrium can then shift, suddenly transitioning the Planet into the warm state.",
    "crumbs": [
      "Energy balance models",
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>EBM with nonlinear albedo</span>"
    ]
  },
  {
    "objectID": "part-03-box/box-energy-model.html#sec-budyko",
    "href": "part-03-box/box-energy-model.html#sec-budyko",
    "title": "12  EBM with nonlinear albedo",
    "section": "12.3 Re-scaling and Budyko’s model",
    "text": "12.3 Re-scaling and Budyko’s model\n\\(\\nextSection\\)\nTo model the outgoing radiation, we use the quartic Stefan-Boltzmann law. However, over the range of temperatures we are interested-in, it seems that a simpler approximation is sufficient. In your homework, you will investigate the re-scaling and shifting of temperature, such that \\[\nT = T_0 + [T]\\tilde{T},\n\\] where \\(T_0 = 265 \\mathrm{K}\\). Then under the assumption that temperatures are not-so-far from \\(T_0\\), we expand \\[\n(T_0 + [T]\\tilde{T})^4 \\sim T_0^4 + 4 T_0^3 [T] \\tilde{T} =\nC_1 + C_2 \\tilde{T}.\n\\] This simplifies the model considerably.\nThis is, in fact, a theoretical justification of Budyko’s model, first suggested by Budyko (Budyko 1969), where instead of the Stefan-Boltmann law that provides the cumbersome quartic power of \\(T\\), we use instead \\[\nE_\\text{out} = \\sigma \\gamma T^4 \\approx A + BT,\n\\] where \\(A\\) and \\(B\\) will vary with location and climate. For instance, for the Northern Hemisphere, (Kaper and Engler 2013) gives the values of \\(A = 203.3\\text{Wm}^{-2}\\) and \\(B = 2.09 \\text{Wm}^{-2}\\text{deg}^{-1}\\) and where temperature is measured in degrees Celcius. As shown above, one can interpret this as a linear expansion of the Stefan-Boltzmann law (after which similar values of \\(A\\) and \\(B\\) are derived).\nThe above Budyko model will be a staple of the latitude-dependent model introduced in the next chapter.\n\n\n\n\n\nBudyko, Mikhail I. 1969. “The Effect of Solar Radiation Variations on the Climate of the Earth.” Tellus 21 (5): 611–19.\n\n\nKaper, Hans, and Hans Engler. 2013. Mathematics and Climate. SIAM.",
    "crumbs": [
      "Energy balance models",
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>EBM with nonlinear albedo</span>"
    ]
  },
  {
    "objectID": "part-03-box/box-energy-model2.html",
    "href": "part-03-box/box-energy-model2.html",
    "title": "13  EBM with latitude I",
    "section": "",
    "text": "13.1 Incoming energy\nWe make the following remarks about \\(E_{\\text{in}}\\).\nFinally the function \\(s(y)\\) is fitted to data. We can assume it to be given by \\[\ns(y) = 1 - S_2 P_2(y), \\qquad S_2 = 0.482, \\quad P_2(y) = (3y^2 - 1)/2.\n\\tag{13.3}\\]\nimport numpy as np\nimport matplotlib.pyplot as plt\n\ny = np.linspace(0, 1, 20)\nplt.plot(y, 1 - 0.482*(3*y**2 - 1)/2)\nplt.xlabel('y'); plt.ylabel('s(y)');\nWe assume that an ice sheet forms if the temperature is sufficiently low, and \\(T &lt; T_c = 10^\\circ \\mathrm{C}\\). The ice forms at an ice line, where \\(y = y_s\\). We then have the following form form the albedo: \\[\na(y) = \\begin{cases}\na_i = 0.62 & y &gt; y_s, \\\\\na_w = 0.32 & y &lt; y_s, \\\\\n\\frac{1}{2}(a_i + a_w) & y = y_s.\n\\end{cases}\n\\] Therefore we are using a discontinuous model for the albedo. Note that the ice boundary \\(y_s\\) is an unknown to be determined by the model.\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nys = 0.7\ny = np.array([0, ys-0.0001, ys, ys+0.0001, 1])\nai = 0.62; aw = 0.32; \na = np.piecewise(y, [y &lt; ys, y == ys, y &gt; ys], [aw, 0.5*(aw+ai), ai])\nplt.plot(y, a, '-o') \nplt.xlabel('y'); plt.ylabel('a(y)');\nThe above forms what is referred to as a free-boundary problem, as the boundary \\(y = y_s\\) is solved as part of the model. Because \\(y_s\\) is essentially determined by where the temperature reaches the critical value, i.e. \\(T(y_s, t) = T_c\\), then the above albedo not only depends on latitude, but also on the current temperature distribution as well.",
    "crumbs": [
      "Energy balance models",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>EBM with latitude I</span>"
    ]
  },
  {
    "objectID": "part-03-box/box-energy-model2.html#incoming-energy",
    "href": "part-03-box/box-energy-model2.html#incoming-energy",
    "title": "13  EBM with latitude I",
    "section": "",
    "text": "Notice that now, compared to the previous model, we have weighted the incoming solar constant \\(Q\\) with a term \\(s(y)\\) and also our albedo no longer directly depends on temperature but instead depends on the latitude.\nPoints on Earth that are closer to the equator receive more direct sunlight and experience more hours of daylight on average. We thus define a function \\(s(x)\\) to account for this and consider the incoming radiation as weighted by \\(Qs(y)\\).\nNote that the total solar input is calculated by a surface integral: \\[\n\\int_{\\theta = 0}^{\\theta = 2\\pi} \\int_{\\varphi = -\\pi/2}^{\\pi/2} Q s(y = \\sin\\varphi) (a^2 \\cos\\varphi) \\, \\mathrm{d}\\varphi \\mathrm{d}\\theta = 4\\pi a^2 Q \\int_0^1 s(y) \\, \\mathrm{d}y = 4\\pi a^2 Q,\n\\] if the function \\(s(y)\\) has been normalised appropriately so that its integral is equal to one, and furthermore the radiation is assumed symmetric about the equator.\nThe above is equal to the solar flux intercepted by an area of the circular disk of the earth seen by the sun, which is \\(\\pi a^2 S\\) for \\(S = 1370 \\mathrm{W}/\\mathrm{m}^2\\). Therefore \\(Q = S/4 \\approx 342 \\mathrm{W}/ \\mathrm{m}^2\\).",
    "crumbs": [
      "Energy balance models",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>EBM with latitude I</span>"
    ]
  },
  {
    "objectID": "part-03-box/box-energy-model2.html#outgoing-energy",
    "href": "part-03-box/box-energy-model2.html#outgoing-energy",
    "title": "13  EBM with latitude I",
    "section": "13.2 Outgoing energy",
    "text": "13.2 Outgoing energy\n\\(\\nextSection\\)\nThe outgoing energy is approximated via the linear Budyko approximation discussed in Section 12.3. \\[\nE_{\\text{out}} = A + BT,\n\\] where \\(A = 202 \\mathrm{W}/ \\mathrm{m}^2\\) and \\(B = 1.9 \\mathrm{W}/(\\mathrm{m}^2 {}^\\circ \\mathrm{C})\\). These figures are taken from a 1993 paper by Graves, Lee, and North.",
    "crumbs": [
      "Energy balance models",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>EBM with latitude I</span>"
    ]
  },
  {
    "objectID": "part-03-box/box-energy-model2.html#transport-energy",
    "href": "part-03-box/box-energy-model2.html#transport-energy",
    "title": "13  EBM with latitude I",
    "section": "13.3 Transport energy",
    "text": "13.3 Transport energy\n\\(\\nextSection\\)\nThe next term we should consider is the transport. In the case of this simple model, transport is taken to be modelled via a “Newton law of cooling” type expression. We assume that \\[\n\\text{rate of change of heat energy} = k(\\bar{T} - T),\n\\] where it can be verified (exercise) that the global mean temperature is the same as the hemispherically averaged temperature, i.e.  \\[\n\\bar{T} = \\frac{1}{\\text{surface area}} \\iint T \\, \\mathrm{S} = \\int_0^1 T(y) \\, \\mathrm{d}y.\n\\] Above, we shall use a value of \\(k = 1.6B\\), again estimated based on data and studies.\nThis completes our review of all the components (Equation 13.2) that make up the EBM model (Equation 13.1).",
    "crumbs": [
      "Energy balance models",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>EBM with latitude I</span>"
    ]
  },
  {
    "objectID": "part-03-box/box-energy-model2.html#steady-state-temperature",
    "href": "part-03-box/box-energy-model2.html#steady-state-temperature",
    "title": "13  EBM with latitude I",
    "section": "13.4 Steady-state temperature",
    "text": "13.4 Steady-state temperature\n\\(\\nextSection\\)\nLet \\(T_\\infty(y)\\) be the steady-state temperature and \\(\\bar{T}_\\infty\\) be the corresponding global mean temperature. Then from setting the LHS of (Equation 13.1) to zero, we have the fact that \\(T_\\infty\\) is given by solving the implicit equation: \\[\nT_\\infty(y) = \\Phi(T_\\infty) = \\frac{{\\color{blue}k}\\bar{T}_\\infty + Qs(y)(1 {\\color{blue}-} \\alpha(y)) - A}{B + C}.\n\\] It is important to remember that the albedo, \\(\\alpha(y)\\), implicitly depends on \\(T_\\infty\\) because at each location \\(y\\), we must decide if the temperature is less or greater than the threshold \\(T_c\\), which is the temperature of the ice line.\nThe above equation is somewhat tricky because of its implicit nature; it is made even trickier by virtue that multiple equilibria exist at the same parameter values. We will begin studying this problem, but before doing so, let us make a few remarks:\n\nIt is possible to solve for the steady-state global mean, \\(\\bar{T}_\\infty\\), as a function of the ice line location, \\(y_s\\).\nIt is possible to solve for the ice line location, \\(y_s\\), although not entirely explicitly. Up to four solutions are possible.\nOnce the ice line is known it is possible to solve for the steady-state.\n\nThe next few chapters will investigate the above steady-state properties. However note that a numerical solution can be developed without the need to go through the above procedures, as well, albeit in a complicated fashion (In 2024, this was addressed during the Lecture 25; see the visualiser notes).",
    "crumbs": [
      "Energy balance models",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>EBM with latitude I</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/problemclass04.html",
    "href": "part-xx-exercises/problemclass04.html",
    "title": "14  Problem class 4",
    "section": "",
    "text": "This problem class will be devoted to getting started on problems from Problem Set 4 Chapter 28.",
    "crumbs": [
      "Energy balance models",
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Problem class 4</span>"
    ]
  },
  {
    "objectID": "part-03-box/latitude2.html",
    "href": "part-03-box/latitude2.html",
    "title": "15  EBM with latitude II",
    "section": "",
    "text": "15.1 Development of an equation for the ice line\nIt turns out to be possible to develop an equation for the ice line. First, note from your problem set 5 in Chapter 29, you find that it is possible to solve for the steady-state mean temperature, which we write as \\(\\bar{T}_\\infty\\). In your problem set, you will develop the following equation by integrating over (Equation 15.1) from \\(y = 0\\) to \\(y = 1\\).\nTaking the steady-state limit of (Equation 29.1) this yields  \\[\n\\bar{T}_\\infty = \\frac{Q(1 - \\bar{a}) - A}{B}.\n\\tag{15.4}\\] The quantity \\(\\bar{a}\\) is given by integrating the albedo as follows: \\[\n\\bar{a} = \\int_0^1 s(y) a(y) \\, \\mathrm{d}y = a_i + (a_w {\\color{blue}-} a_i)y_s[1 - 0.241 (y_s^2 - 1)],\n\\tag{15.5}\\] which is given by (Equation 29.2). You may check that the above formula has the right signs by considering either the complete ice case (ice line at the equator \\(y_s = 0\\)) or the complete water/land case (ice line at \\(y_s = 1\\)).\nNow we return to the implicit equation for the temperature, which is given by (Equation 15.3) and repeated here: \\[\nT_\\infty(y) = \\Phi(T_\\infty) = \\frac{k\\bar{T}_\\infty + Qs(y)(1 - a(y)) - A}{B + k}.\n\\] Substitute the mean temperature in, and this now yields \\[\nT_\\infty(y) = \\frac{Q}{B + k} \\left[ s(y) [1 - a(y)] + \\frac{k}{B}(1 - \\bar{a})\\right] - \\frac{A}{B}.\n\\tag{15.6}\\] This ice line is then found by setting \\(T = T_C\\) at \\(y = y_s\\) in the above formula. Notice, though, that since \\(s(y)\\) is a cubic function, then we would need to solve a cubic equation in general.",
    "crumbs": [
      "Energy balance models",
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>EBM with latitude II</span>"
    ]
  },
  {
    "objectID": "part-03-box/latitude2.html#a-word-about-the-parameter-space",
    "href": "part-03-box/latitude2.html#a-word-about-the-parameter-space",
    "title": "15  EBM with latitude II",
    "section": "15.2 A word about the parameter space",
    "text": "15.2 A word about the parameter space\n\\(\\nextSection\\)\nSolutions to our latitude-dependent EBM can be symbolically written as follows: \\[\nT = T(t, y) = G(y; A, b, k, C, Q, a_i, a_w).\n\\] As you can see, even though it is a relatively simple equation in the sense it is only an ODE in time (and does not involve any spatial derivatives in \\(y\\)), is still complicated because the behaviour of the system can depend in a non-trivial way on all the parameters.\nYou can schematically think of the solution space as a being plotted in 8-dimensional space (or even higher, since the albedo \\(a\\) can be specified more generally). So for instance, bifurcation diagrams can then be plotted for some norm of the solution, say \\(\\bar{T}\\) versus the seven other parameters.\nThere are other representations of the bifurcation diagram(s). For example, you might plot \\(y_s\\) vs \\(Q\\) or \\(\\bar{T}\\) vs \\(A\\), and so forth.",
    "crumbs": [
      "Energy balance models",
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>EBM with latitude II</span>"
    ]
  },
  {
    "objectID": "part-03-box/latitude2.html#a-bifurcation-diagram-for-q-vs-y_s",
    "href": "part-03-box/latitude2.html#a-bifurcation-diagram-for-q-vs-y_s",
    "title": "15  EBM with latitude II",
    "section": "15.3 A bifurcation diagram for \\(Q\\) vs \\(y_s\\)",
    "text": "15.3 A bifurcation diagram for \\(Q\\) vs \\(y_s\\)\n\\(\\nextSection\\)\nReturning to the ice line, we are interested in keeping all other parameters fixed, and then attempting to understand how the ice line evolves as the solar constant \\(Q\\) is changed. For example, we might believe that as \\(Q\\) increases (and hence temperatures rise), the ice line will move towards the North Pole. And as \\(Q\\) decreases, the ice line moves towards the equator.\nWe return to (Equation 15.6) and consider inverting the formulation. For each given ice line location, \\(y_s \\in (0, 1)\\), we solve for the \\(Q\\) value. This gives \\[\nQ = K(y_s) \\equiv \\frac{\\left(T_C + \\frac{A}{B}\\right)(B + k)}{s(y_s)[1 - \\frac{1}{2}(a_i + a_w)] + \\frac{k}{B}(1 - \\bar{a})}.\n\\tag{15.7}\\] Above, we have used the fact that \\(a(y_s) = \\frac{1}{2}(a_i + a_w)\\). This can now be plotted in Python, either in the notebook written during lectures, or via the code below.\n\nimport numpy as np\nimport matplotlib.pyplot as plt\nA = 202 # outgoing radiation\nB = 1.9 # outgoing radiation\nk = 1.6*B # transport parameter\ns = lambda y: 1 - 0.482*(3*y**2 - 1)/2 # solar weighting\naw = 0.32 # water albedo\nai = 0.62 # ice albedo\nTc = -10.0 # critical temperature for ice formation\nQ0 = 342.0 # solar constant (1370 W/m^2 divided by 4)\n\nabar = lambda ys: ai + (aw - ai)*ys*(1 - 0.241*(ys**2 - 1))\nQfunc = lambda ys: (Tc + A/B)*(B+k)/(s(ys)*(1 - (ai+aw)/2) + k/B*(1 - abar(ys)))\n\n# Solve for the ice line\nys = np.linspace(0, 1, 100);\nQs = Qfunc(ys);\nplt.plot(Qs, ys, 'k')\nplt.plot([Q0, Q0], [0, 1], '--')\nplt.xlabel('Q');\nplt.ylabel('ys');\nplt.grid(1)\n\n\n\n\n\n\n\n\nOn the above graph, we have plotted the reference line, which is at \\(Q = 342\\) W-m-sq. So amazingly, there are two intersections with the black curve, which in fact indicates that two ice lines seem to be possible. One ice line as \\(y_s\\) near \\(0.95\\) and the other has \\(y_s\\) much lower down and near the equator.\nMoreover, the above graph is not complete! When we computed it, we specified that \\(a(y_s) = \\frac{1}{2}(a_i + a_w)\\) but this would not be true if there were no ice line, or equivalently if the ice line is located directly at \\(y = 1\\) or \\(y = 0\\). These yield the so-called ice-free states and ice-covered states, respectively.",
    "crumbs": [
      "Energy balance models",
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>EBM with latitude II</span>"
    ]
  },
  {
    "objectID": "part-03-box/latitude2.html#ice-free-state",
    "href": "part-03-box/latitude2.html#ice-free-state",
    "title": "15  EBM with latitude II",
    "section": "15.4 Ice-free state",
    "text": "15.4 Ice-free state\n\\(\\nextSection\\)\nThe ice-free state is the state for which \\(a = a_w = \\bar{a}\\) for all \\(y \\in [0, 1)\\). In this case, the solution can be directly calculated from Equation 15.6. It would then be given by \\[\nT_\\infty(y) = \\frac{Q(1 - a_w)}{B + k}\\left[s(y) + \\frac{k}{B}\\right] - \\frac{A}{B}.\n\\] This solution has a requirement, which is that when considering the solar constant \\(Q\\), the solar constant cannot be so weak so that an ice line appears for \\(y &lt; 1\\). The minimum value of \\(Q\\) is therefore determined by pinning the ice line right at the North Pole. Thus \\[\nQ &gt; \\frac{(B + k)(T_C + A/B)}{(1 - a_w)[s(1) + k/B]} \\approx 330 \\mathrm{W} \\, \\mathrm{m}^{-2}.\n\\] It is of interest to verify that the global mean temperature for a system in this state is a warm \\(16\\) degrees Celsius. According to this model, then, if the mean temperature is above this value, it is possible to have a state where there is no ice anywhere!",
    "crumbs": [
      "Energy balance models",
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>EBM with latitude II</span>"
    ]
  },
  {
    "objectID": "part-03-box/latitude2.html#ice-covered-state",
    "href": "part-03-box/latitude2.html#ice-covered-state",
    "title": "15  EBM with latitude II",
    "section": "15.5 Ice-covered state",
    "text": "15.5 Ice-covered state\n\\(\\nextSection\\)\nA similar argument applies setting \\(a = a_i = \\bar{a}\\) for all \\(y\\in (0, 1]\\). In this case, \\[\nT_\\infty(y) = \\frac{Q(1 - a_i)}{B + k}\\left[s(y) + \\frac{k}{B}\\right] - \\frac{A}{B}.\n\\] This time, there is a maximal condition on \\(Q\\) such that any higher value would require an ice line somewhere within the domain, i.e. \\(y &gt; 0\\). Thus \\[\nQ &lt; \\frac{(B + k)(T_C + A/B)}{(1 - a_i)[s(0) + k/B]} \\approx 441 \\mathrm{W} \\, \\mathrm{m}^{-2}.\n\\] Again we may verify that this corresponds to a mean temperature of \\(-38\\) degrees Celsius.\n\nimport numpy as np\nimport matplotlib.pyplot as plt\nA = 202 # outgoing radiation\nB = 1.9 # outgoing radiation\nk = 1.6*B # transport parameter\ns = lambda y: 1 - 0.482*(3*y**2 - 1)/2 # solar weighting\naw = 0.32 # water albedo\nai = 0.62 # ice albedo\nTc = -10.0 # critical temperature for ice formation\nQ0 = 342.0 # solar constant (1370 W/m^2 divided by 4)\n\nQmin = ((B+k)*(Tc + A/B))/((1-aw)*(s(1)+k/B)) \nQmax = ((B+k)*(Tc + A/B))/((1-ai)*(s(0)+k/B))\nprint(\"Minimal Q for ice-free state = \", Qmin)\nprint(\"Max Q for ice-covered state = \", Qmax)\n\n# Note version in lectures was a 1/2 factor off on the second grouping of terms; \n# now corrected to match Q6 of PS4\nabar = lambda ys: ai + (aw - ai)*ys*(1 - 0.241*(ys**2 - 1))\nQfunc = lambda ys: (Tc + A/B)*(B+k)/(s(ys)*(1 - (ai+aw)/2) + k/B*(1 - abar(ys)))\n\n# Solve for the ice line\nys = np.linspace(0, 1, 100);\nQs = Qfunc(ys);\nplt.plot(Qs, ys, 'k')\nplt.plot([Q0, Q0], [0, 1], '--')\nplt.plot([250, Qmax], [0, 0], 'b')\nplt.plot([Qmin, 550], [1, 1], 'b')\nplt.xlabel('Q');\nplt.ylabel('ys');\nplt.grid(1)\n\nMinimal Q for ice-free state =  330.3616063989335\nMax Q for ice-covered state =  440.72694936919913",
    "crumbs": [
      "Energy balance models",
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>EBM with latitude II</span>"
    ]
  },
  {
    "objectID": "part-03-box/latitude2.html#partially-ice-covered-states",
    "href": "part-03-box/latitude2.html#partially-ice-covered-states",
    "title": "15  EBM with latitude II",
    "section": "15.6 Partially ice-covered states",
    "text": "15.6 Partially ice-covered states\n\\(\\nextSection\\)\nIn lectures, we demonstrated, that there are four possible solutions of the latitude EBM. Two of the solutions, developed above, correspond to completely covered ice-state and ice-free states. The other two solutions are partially-iced states.\n\n\n\n\n\n\nFigure 15.1: The four possible solutions; orange and blue show the completely-ice and ice-free states; red and green show the partial ice-covered state. These are shown for \\(A = 202\\), \\(B = 1.9\\), \\(k = 1.6 B\\), and \\(Q\\) = 342$",
    "crumbs": [
      "Energy balance models",
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>EBM with latitude II</span>"
    ]
  },
  {
    "objectID": "part-03-box/latitude3.html",
    "href": "part-03-box/latitude3.html",
    "title": "16  EBM with latitude III",
    "section": "",
    "text": "16.1 Studying the mean temperature\nFollowing the previous chapter, we now have a better understanding of the relationship between the ice line, \\(y_s\\), and the solar forcing, \\(Q\\). We demonstrated that for the baseline case of \\(Q = 342\\), (at least) four solutions are possible.\nExamination of the root shows that the two non-trivial ice lines are approximately at \\(y_s = 0.256\\) and \\(y_s = 0.939\\) for \\(Q = 342\\). Using the script developed in lectures, we can study a similar graph of the mean temperature versus the solar forcing.\nThis yields the following picture:\nDuring the lecture, we discussed the so-called Snowball Earth scenario where decreasing the solar constant may cause the stable state of the planet to jump down to the green branch shown above (completely frozen Earth). The solution exhibits hysteresis which describes the non-reversibility shown in the bifurcation diagram. This will be further expounded in the following discussion on stability.",
    "crumbs": [
      "Energy balance models",
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>EBM with latitude III</span>"
    ]
  },
  {
    "objectID": "part-03-box/latitude3.html#studying-the-mean-temperature",
    "href": "part-03-box/latitude3.html#studying-the-mean-temperature",
    "title": "16  EBM with latitude III",
    "section": "",
    "text": "Figure 16.1: The iceline\n\n\n\n\n\n\n\n\n\n\n\nFigure 16.2: Mean temperature",
    "crumbs": [
      "Energy balance models",
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>EBM with latitude III</span>"
    ]
  },
  {
    "objectID": "part-03-box/latitude3.html#stability",
    "href": "part-03-box/latitude3.html#stability",
    "title": "16  EBM with latitude III",
    "section": "16.2 Stability",
    "text": "16.2 Stability\n\\(\\nextSection\\)\nSo far, we have only discussed the steady-state solutions of the latitude-dependent EBM, repeated below: \\[\nC \\frac{\\mathrm{\\partial}T}{\\mathrm{\\partial}t} = Qs(y)[1 - a(y)] - (A + BT) + k(\\bar{T} - T).\n\\] In this section, we investigate the stability analysis for the mean temperature, \\(\\bar{T}\\). This was given in Equation 29.1 and repeated below: \\[\nC \\frac{\\mathrm{d}\\bar{T}}{\\mathrm{d}t} = G(\\bar{T}) \\equiv Q(1 - \\bar{a}) - (A + B\\bar{T}),\n\\tag{16.1}\\] The following linearisation argument was presented by Cahalan and North (1979), with some additional details to avoid confusion. Let us linearise this about a steady-state solution, writing \\[\n\\bar{T} = \\bar{T}^* + u(t),\n\\] where \\(u \\ll 1\\). By Taylor series, \\[\nG(\\bar{T}) = G(\\bar{T}^*) + G'(\\bar{T}^*)u + O(u^2),\n\\] so substitution into the ODE yields the linear equation \\[\nC \\frac{\\mathrm{d}u}{\\mathrm{d}t} = G'(\\bar{T}^*) u.\n\\tag{16.2}\\] We need to calculate the derivative term on the RHS. First, using the equation for \\(G\\) in Equation 16.1, we have \\[\nG'(T^*) = -B - Q \\frac{\\mathrm{d}\\bar{a}}{\\mathrm{d}\\bar{T}}\\biggr\\rvert_{\\bar{T} = \\bar{T}^*}.\n\\tag{16.3}\\] The above calculation assumes that \\(Q\\) is a fixed number, as it should, since \\(Q\\) is regarded as a parameter (we choose a value of \\(Q\\), then this allows us to evolve the ODE).\n\n\n\n\n\n\nCalahan & North’s “trick”\n\n\n\nThe following presentation took about 3 lines of text in the presentation of Cahalan & North (1979), between eqns (1.2) and (1.3) in the image below. Students have inquired about the manipulations.\n\n\n\n\n\n\nFigure 16.3: From Cahalan & North, p.1179\n\n\n\n\n\nThe problem is what to do with the derivative of \\(\\bar{a}\\) that appears in (Equation 16.3). This is a strange quantity, since \\(\\bar{a}\\) does not explicitly depend on \\(\\bar{T}\\), and is given in (Equation 15.5). The issue is that there is a hidden dependence: \\(\\bar{a}\\) depends on the ice line, \\(y_s\\), which depends on not only \\(Q\\), but is multivalued as well! \nCahalan & North, whether knowingly or unknowingly, applied a trick, which is to consider that \\(Q\\) is not a parameter, but that it can be viewed as depending on \\(\\bar{T}^*\\), the steady state (this dependence is shown in Figure 16.2). Therefore, Cahalan & North returned to the equation (Equation 15.4) that gives the steady-state: \\[\nT^* = \\frac{Q(1 - \\bar{a}) - A}{B}.\n\\] We differentiate this equation with respect to \\(\\bar{T^*}\\), but now assume both \\(Q\\) and \\(\\bar{a}\\) depend on \\(\\bar{T^*}\\). This yields \\[\n1 = \\frac{1}{B} \\frac{\\mathrm{d}Q}{\\mathrm{d}\\bar{T^*}}(1 - \\bar{a}) - \\frac{Q}{B} \\frac{\\mathrm{d}\\bar{a}}{\\mathrm{d}\\bar{T}^*} \\Longrightarrow\nB = \\frac{\\mathrm{d}Q}{\\mathrm{d}\\bar{T^*}}(1 - \\bar{a}) - Q \\frac{\\mathrm{d}\\bar{a}}{\\mathrm{d}\\bar{T}^*}\n\\tag{16.4}\\]\nWe substitute the above value of \\(B\\) into (Equation 16.3), and then finally into the equation for the linearisation (Equation 16.2). Then we have \\[\nC \\frac{\\mathrm{d}u}{\\mathrm{d}t} = -\\left[(1 - \\bar{a}) \\frac{\\mathrm{d}Q}{\\mathrm{d}\\bar{T}^*}\\right]u(t) = -\\gamma u(t),\n\\] where the constant \\(\\gamma\\) has been defined by the above. Thus, the solution is given by \\[\nu(t) = u(0) e^{-\\gamma t/C}.\n\\]\nNote then that the crucial quantity is \\[\n\\gamma \\equiv (1 - \\bar{a}) \\frac{\\mathrm{d}Q}{\\mathrm{d}\\bar{T}^*}.\n\\] If \\(\\gamma\\) is positive, the equilibrium point is stable, while if \\(\\gamma\\) is negative, the equilibrium is unstable. Because \\((1 - \\bar{a}) &gt; 0\\), then this yields the so-called slope-stability theorem coined by Cahalan and North (1979): \\[\n\\begin{aligned}\n\\frac{\\mathrm{d}Q}{\\mathrm{d}\\bar{T}^*} &gt; 0 &\\Longrightarrow \\text{stable}, \\\\\n\\frac{\\mathrm{d}Q}{\\mathrm{d}\\bar{T}^*} &lt; 0 &\\Longrightarrow \\text{unstable}.\n\\end{aligned}\n\\]\nWe may now plot the bifurcation diagram, shown in \\((Q, \\bar{T})\\)-space. First, return to Figure 16.2. In lecture 21, we drew the following picture:\n\n\n\n\n\n\nFigure 16.4: Bifurcation diagram for \\((Q, \\bar{T})\\)\n\n\n\nNote the following characteristics.\n\nThere are up to four steady states (green, orange, two blacks).\nThose branches with positive gradient are stable; there is only one branch with a negative gradient and it is thus unstable. In the image, these are shown solid for stable and dashed for unstable.\nThe diagram indicates tipping points and hysteresis. As explained in the lectures, one can encounter a situation where, beginning from the upper orange branches, the solar radiation is decreased past the tipping point. The solution must then evolve to the lowermost stable state (green). However, increasing \\(Q\\) does not return us to the original non-frozen state—unless \\(Q\\) is increased by a massive amount. This ‘hysteresis’ loop is shown with the maroon colours in the image above.",
    "crumbs": [
      "Energy balance models",
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>EBM with latitude III</span>"
    ]
  },
  {
    "objectID": "part-03-box/latitude4.html",
    "href": "part-03-box/latitude4.html",
    "title": "17  EBM with latitude IV",
    "section": "",
    "text": "//Temporary spare lecture//",
    "crumbs": [
      "Energy balance models",
      "<span class='chapter-number'>17</span>  <span class='chapter-title'>EBM with latitude IV</span>"
    ]
  },
  {
    "objectID": "part-03-box/part-morebox.html",
    "href": "part-03-box/part-morebox.html",
    "title": "Fast-slow dynamics",
    "section": "",
    "text": "This material will study the incidence of fast-flow dynamics that occur in generic dynamical systems. The emphasis will be on the posited fast-slow dynamics that occur in ice ages.",
    "crumbs": [
      "Fast-slow dynamics"
    ]
  },
  {
    "objectID": "part-03-box/iceages01.html",
    "href": "part-03-box/iceages01.html",
    "title": "18  Ice ages I: an introduction",
    "section": "",
    "text": "18.1 Background\nWe have mainly been concerned about time periods in the decades, but it is now time to discuss much longer time periods. In particular, we are interested in the Pleistocene era, which lasts from around 2.5 million years go to 11,700 years ago; this period marked the evolution of Homo sapiens. Begin by examining this figure:\nThis figure indicates temperature changes tracked via various measures at different locations. The top two graphs show the temperatures derived from two different ice core measurements. The lower curve is the total ice cover. In this figure, you see evidence for the four complete glacial cycles with the Earth temperature dropping into the ice ages. A key observation concerns the regular periodic behaviour, with regular cycles appearing every 100k years.\nTurn now to this graph:\nThis graph goes back even further. The key observation is that between 1 million and 2.5 million years, the periods seem to be predominantly 41k years. Thus sudden transition is referred to as the Mid-Pleistocene Transition (MPT). The question of how or why the periods can suddenly change in such a manner is referred to as the 100,000-year problem.",
    "crumbs": [
      "Fast-slow dynamics",
      "<span class='chapter-number'>18</span>  <span class='chapter-title'>Ice ages I: an introduction</span>"
    ]
  },
  {
    "objectID": "part-03-box/iceages01.html#background",
    "href": "part-03-box/iceages01.html#background",
    "title": "18  Ice ages I: an introduction",
    "section": "",
    "text": "Figure 18.1: Figure from here",
    "crumbs": [
      "Fast-slow dynamics",
      "<span class='chapter-number'>18</span>  <span class='chapter-title'>Ice ages I: an introduction</span>"
    ]
  },
  {
    "objectID": "part-03-box/iceages01.html#milankovitch-cycles",
    "href": "part-03-box/iceages01.html#milankovitch-cycles",
    "title": "18  Ice ages I: an introduction",
    "section": "18.2 Milankovitch cycles",
    "text": "18.2 Milankovitch cycles\n\\(\\nextSection\\)\nThe most natural theory to explain the ice age periods is to consider that the Earth’s orbit is affected by the gravitational attractions of the Sun, Moon, and the other planets. The complex interaction results in a slow, cyclic change in three important parameters of the orbit (Taylor 2005):\n\nThe eccentricity of the ellipse that the Earth describes in its orbit around the Sun each year (100kyr);\nThe angle between the equatorial plane and the orbital plane, known as the Earth’s obliquity (41kyr);\nThe precession of the spin axis around the normal to the orbital plane (20kyr).\n\n\n\n\n\n\n\nFigure 18.2: Figure from here\n\n\n\nThe name given to these cycles is Milkankovich cycles.\nHowever, the key problem is that the Milankovich cycles do not seem to explain the MPT problem. The Milankovich cycles exhibit the necessary periods on both the 100kyr scale and 41kyr scale, but it cannot explain why there was a sudden transition. Moreover, the response of EBMs to the 100kyr forcing (due to the eccentricity) is not enough to explain why this forcing period takes precedence since it is the 41kyr cycle due to the obliquity that produces the largest effect on the solar radiation.\n\n\n\nFigure from here",
    "crumbs": [
      "Fast-slow dynamics",
      "<span class='chapter-number'>18</span>  <span class='chapter-title'>Ice ages I: an introduction</span>"
    ]
  },
  {
    "objectID": "part-03-box/iceages01.html#the-mathematicians-perspective-on-models",
    "href": "part-03-box/iceages01.html#the-mathematicians-perspective-on-models",
    "title": "18  Ice ages I: an introduction",
    "section": "18.3 The mathematician’s perspective on models",
    "text": "18.3 The mathematician’s perspective on models\n\\(\\nextSection\\)\nWe start with some discussion of the perspective of a mathematician. The last few weeks, we have been studying models of Planet Earth that take the form of first-order autonomous systems: \\[\nC \\frac{\\mathrm{d}T}{\\mathrm{d}t} = G(T),\n\\] or perhaps in the more recognisable ‘dynamical-systems’ form of \\[\n\\dot{x} = f(x),\n\\] for some function \\(x = x(t)\\). Because this is such a simple model, the analysis of the time-dependent evolution can be done on a phase line. Solutions can only exhibit two behaviours as \\(t \\to \\infty\\): they can tend towards a fixed point or they can diverge (to \\(\\pm \\infty\\)).\nThere are numerous ways to extend the basic EBM. For instance:\n\n(Latitude variation) Add latitude variation, with \\(G \\mapsto G(y, T)\\). Indeed this is what we had done in the last few chapters, and using a toy model (Newton’s law of cooling) that imposes a driver \\(k(\\bar{T} - T)\\) into the ODE.\n(PDEs) A more accurate model is to add a diffusion term, e.g. \\(k \\nabla^2 T\\). The Laplacian operator is then turned into a surface derivative in spherical coordinates along the planet. This turns the equation into a PDE, so is more involved to solve.\n(Non-autonomous forcing) We can consider the addition of temporal forcing, for instance, \\[\nG \\mapsto G(T) + \\epsilon f(t).\n\\] This would model, for instance, some oscillatory source input. For instance, this might model extra oscillatory effects due to the influence of the other planets.\n(Systems of DEs ) We might be interested in extending the model so that, in addition to modelling the evolution of the temperature, we also model the evolution of CO2 in the atmosphere. Or we might want a model where the albedo, itself, can evolve in time. An example of such a model is \\[\n\\begin{aligned}\nC \\frac{\\mathrm{d}T}{\\mathrm{d}t} &= Q[1 - a(t)] - \\sigma \\gamma T^4, \\\\\nD \\frac{\\mathrm{d}a}{\\mathrm{d}a} &= a_{\\text{eq}}(T) - a.\n\\end{aligned}\n\\]\n\nThe above provides a model for ice sheet dynamics.",
    "crumbs": [
      "Fast-slow dynamics",
      "<span class='chapter-number'>18</span>  <span class='chapter-title'>Ice ages I: an introduction</span>"
    ]
  },
  {
    "objectID": "part-03-box/iceages01.html#phase-plane-analysis-for-two-dimensional-systems",
    "href": "part-03-box/iceages01.html#phase-plane-analysis-for-two-dimensional-systems",
    "title": "18  Ice ages I: an introduction",
    "section": "18.4 Phase plane analysis for two-dimensional systems",
    "text": "18.4 Phase plane analysis for two-dimensional systems\n\\(\\nextSection\\)\nComing back now to the standard non-autonomous system of two ODEs, we have \\[\n\\begin{aligned}\n\\dot{x} &= f_1(x, y), \\\\\n\\dot{y} &= f_2(x, y).\n\\end{aligned}\n\\] What is the difference between these kinds of systems and the simpler 1D equations? The main difference is that the analysis is done in the phase plane given by \\((x, y)\\). Fixed points lie in the phase plane, but now there is the additional possibility of oscillations or circular orbits.\nAn example of this is the system \\[\n\\begin{aligned}\n\\dot{x} &= y - g(x), \\\\\n\\dot{y} &= h(x) - y.\n\\end{aligned}\n\\]\nFor instance, choosing \\(h(x) = 4(2-x)\\) and \\(g(x) = \\sin x\\) yields the following phase plane diagram: \nYou can reproduce the phase plane via the code snippet in lectures/Chap20-TypicalPhasePlot.ipynb.\nWe see there exists a fixed point at where the two nullclines (dashed) intersect. Analysis near this fixed point would reveal that solutions encircle in a clockwise direction and tend towards the fixed point. This is shown by the solution plot on the right.\nTherefore, one way to extend our EBMs is to consider coupling to another component. Keep this in mind as this is where we will be going in the next lecture.",
    "crumbs": [
      "Fast-slow dynamics",
      "<span class='chapter-number'>18</span>  <span class='chapter-title'>Ice ages I: an introduction</span>"
    ]
  },
  {
    "objectID": "part-03-box/iceages02.html",
    "href": "part-03-box/iceages02.html",
    "title": "19  Ice ages II: a model for fast-slow dynamics",
    "section": "",
    "text": "19.1 The van der Pol oscillator\nIn an article by Ditlevsen and Ashwin (2018) the authors argued that the following van der Pol oscillator presents a good toy model for understanding some of the dynamics that occur in ice ages: \\[\n\\frac{\\mathrm{d}^2 x}{\\mathrm{d}\\tau^2} = \\frac{1}{\\sqrt{\\epsilon}} (1 - x^2) \\frac{\\mathrm{d}x}{\\mathrm{d}\\tau} - \\alpha x + F(\\tau),\n\\] where \\(x = x(t)\\), \\(F(\\tau) = A \\cos(\\omega_F \\tau)\\) and \\(\\omega_F = (2\\pi/41) \\mathrm{kyr}^{-1}\\) represents a model for astronomical forcing. We will not discuss their ‘derivation’ of the above model (presented in their sec. 5), though it seems best to consider it solely as a toy model since otherwise their derivation of its validity based on EBM arguments is somewhat sketchy.\nIn any case, we are firstly interested in the case of zero forcing, \\(F \\equiv 0\\). It can be verified that through a transformation of time, \\(\\tau \\mapsto t\\), the above equation becomes \\[\n\\epsilon \\frac{\\mathrm{d}^2 x}{\\mathrm{d}t^2} + (x^2 - 1) \\frac{\\mathrm{d}x}{\\mathrm{d}t} + x = 0,\n\\] where we have chosen, without loss of generality, for \\(\\alpha = 1\\). Again we are considering \\(\\epsilon \\ll 1\\). This is a very well-known problem in nonlinear oscillations and it is the canonical example of fast-slow dynamics.",
    "crumbs": [
      "Fast-slow dynamics",
      "<span class='chapter-number'>19</span>  <span class='chapter-title'>Ice ages II: a model for fast-slow dynamics</span>"
    ]
  },
  {
    "objectID": "part-03-box/iceages02.html#the-van-der-pol-oscillator",
    "href": "part-03-box/iceages02.html#the-van-der-pol-oscillator",
    "title": "19  Ice ages II: a model for fast-slow dynamics",
    "section": "",
    "text": "19.1.1 The Lienard transformation\n\\(\\nextSection\\)\nWe first explain how to transform the above second-order equation so that it resembles the system of two linear differential equations shown above. Notice that the equation can be written in the form \\[\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\left(\\epsilon \\frac{\\mathrm{d}x}{\\mathrm{d}t} + \\frac{1}{3} x^3 - x \\right) + x = 0.\n\\tag{19.1}\\] We then define \\[\ny \\equiv \\epsilon \\frac{\\mathrm{d}x}{\\mathrm{d}t} + \\frac{1}{3} x^3 - x  \n\\] which can be re-arranged to yield \\[\n\\epsilon \\dot{x} = y - S(x), \\qquad S(x) \\equiv \\frac{1}{3}x^3 - x,\n\\] where we have used dots to indicate derivatives in time. The second equation is found by Equation 19.1 itself, since this yields \\[\n\\dot{y} = -x.\n\\] Therefore together, we have our system: \\[\n\\begin{aligned}\n\\epsilon \\dot{x} &= y - S(x), \\\\\n\\dot{y} &= -x.\n\\end{aligned}\n\\]\n\n\n19.1.2 An investigation in Python\n\\(\\nextSection\\)\nThe lecture will now investigate the scripts to see the qualitative behaviour of the ODE. We will design a phase plane plotter in Python and see why this is called a fast-slow system.\nThe script can be found in the Noteable notes via lectures/Chap21-DynamicsFastSlow.ipynb.\nDuring the lecture, we discussed the following image:\n\n\n\nPhase plot of the above system\n\n\nWe interpreted the dynamics that follow either the slow manifold, \\(y = S(x)\\), and also the fast transitions that occur between the branches of the cubic. Also shown on the right side of the above plots are the profiles, \\(x\\) and \\(y\\) versus \\(t\\). In the limit \\(\\epsilon \\to 0\\), the transitions begin to resemble shocks.",
    "crumbs": [
      "Fast-slow dynamics",
      "<span class='chapter-number'>19</span>  <span class='chapter-title'>Ice ages II: a model for fast-slow dynamics</span>"
    ]
  },
  {
    "objectID": "part-03-box/iceages03.html",
    "href": "part-03-box/iceages03.html",
    "title": "20  Ice ages III: analysis of the van der Pol equation",
    "section": "",
    "text": "20.1 Analysis of the slow manifold\nLet \\[\nx(t) = x_0(t) + \\epsilon x_1(t) + \\epsilon^2 x_2(t) + \\ldots, \\qquad y(t) = y_0(t) + \\epsilon y_1(t) + \\epsilon^2 y_2(t) + \\ldots\n\\] At leading order, we get the following system of equations: \\[\n\\begin{aligned}\n0 &= y_0 - S(x), \\\\\n\\dot{y_0} &= -x_0.\n\\end{aligned}\n\\tag{20.1}\\]\nFirst, examine the differential equation on the second line. Since the rate-of-change of \\(y\\) is equal to \\(-x\\), we can analyse the motion in the phase plane by the following cases: \\[\ny_0 \\text{ is }\n\\begin{cases}\n\\text{decreasing} & \\text{for $x_0 &gt; 0$} \\\\\n\\text{increasing} & \\text{for $x_0 &lt; 0$}\n\\end{cases}.\n\\] Therefore, we conclude that the \\(y\\) axis is nullcline in this leading-order approximation. The remaining equation restricts the solution to lie along the slow manifold, \\[\ny_0 = S(x) = \\frac{1}{3}x_0^3 - x_0.\n\\]\nAccording to our analysis, we should have both \\(y \\sim S(x)\\) as \\(\\epsilon \\to 0\\) and also \\(y\\) increasing on \\(x &lt; 0\\) while decreasing on \\(x &gt; 0\\). But this yields an apparent contradiction as \\(x\\to \\pm 1\\) and \\(y \\to \\mp 2/3\\).\nThe issue is that, at the critical point(s) where \\(x \\to \\pm 1\\), say \\(t = t^*\\), the solution encounters a shock or boundary layer where the gradient \\(\\dot{x}\\) is no longer small. Thus our prior assumption where we neglected \\(\\epsilon \\dot{x}\\) is invalid.",
    "crumbs": [
      "Fast-slow dynamics",
      "<span class='chapter-number'>20</span>  <span class='chapter-title'>Ice ages III: analysis of the van der Pol equation</span>"
    ]
  },
  {
    "objectID": "part-03-box/iceages03.html#analysis-of-the-slow-manifold",
    "href": "part-03-box/iceages03.html#analysis-of-the-slow-manifold",
    "title": "20  Ice ages III: analysis of the van der Pol equation",
    "section": "",
    "text": "Illustration of dynamics along the slow manifold",
    "crumbs": [
      "Fast-slow dynamics",
      "<span class='chapter-number'>20</span>  <span class='chapter-title'>Ice ages III: analysis of the van der Pol equation</span>"
    ]
  },
  {
    "objectID": "part-03-box/iceages03.html#fast-analysis",
    "href": "part-03-box/iceages03.html#fast-analysis",
    "title": "20  Ice ages III: analysis of the van der Pol equation",
    "section": "20.2 Fast analysis",
    "text": "20.2 Fast analysis\n\\(\\nextSection\\)\nNear a shock, we re-scale \\[\nT = \\frac{t - t^*}{\\epsilon^\\alpha} \\Longrightarrow t = t^* + \\epsilon^\\alpha T,\n\\] and set \\(x(t) = X(T)\\) and \\(y(t) = Y(T)\\) under this new coordinate change. Essentially, this re-scales the coordinate axes, originally in \\(t\\), near the unknown location of the shock, \\(t = t^*\\). We can verify that the correct balance for re-scaling is chosen with \\(\\alpha = 1\\). From the chain rule, we convert derivatives as follows: \\[\n\\frac{\\mathrm{d}}{\\mathrm{d}t} = \\frac{\\mathrm{d}T}{\\mathrm{d}t} \\frac{\\mathrm{d}}{\\mathrm{d}T} = \\frac{1}{\\epsilon} \\frac{\\mathrm{d}}{\\mathrm{d}T}.\n\\] Then the system becomes \\[\n\\begin{aligned}\n\\frac{\\mathrm{d}X}{\\mathrm{d}T} &= Y - S(X) \\\\\n\\frac{\\mathrm{d}Y}{\\mathrm{d}T} &= -\\epsilon X.\n\\end{aligned}\n\\]\nWe expand now in the typical fashion, setting \\[\n\\begin{aligned}\nX &= X_0(T) + \\epsilon X_1(T) + \\ldots \\\\\nY &= Y_0(T) + \\epsilon Y_1(T) + \\ldots\n\\end{aligned}\n\\]\nAt leading order, this now yields \\[\n\\begin{aligned}\n\\frac{\\mathrm{d}X_0}{\\mathrm{d}T} &= Y_0 - S(X_0) \\\\\n\\frac{\\mathrm{d}Y_0}{\\mathrm{d}T} &= 0.\n\\end{aligned}\n\\]\nTherefore, from the second equation, we obtain \\[\nY_0 = \\text{constant}\n\\] which is to be expected from the phase-plane diagrams we have shown. Since we have established that the max/min of the slow manifold, \\(S(X)\\), is given by \\(\\pm 2/3\\), then we know that the above constant is this value if the solution had begun from the slow manifold (see comment later about the initial condition).\nNext, the equation for \\(X_0\\) has the form of a first-order nonlinear differential equation that can be studied by phase-line analysis. If the constant \\(Y_0\\) is indeed \\(\\pm 2/3\\), then the differential equation for the other component takes the form \\[\n\\frac{\\mathrm{d}X_0}{\\mathrm{d}T} = Y_0 - S(X_0) = \\pm \\frac{2}{3} - S(X_0).\n\\]\nThis leads to the following picture.\n\n\n\n\n\n\nFigure 20.1: Fast dynamics\n\n\n\nTo begin, we consider the evolution from the points marked ‘A’ and ‘B’. This occurs along the slow manifold. At the point ‘B’, time reaches the critical point, \\(t \\to t^*\\), and the solutions enter the fast dynamics, following along points ‘B’ to ‘C’. Notice that along this segment in the phase plane, \\[\n\\frac{2}{3} - S(X_0) &gt; 0,\n\\] therefore \\(X_0\\) must increase during this time. However, upon approaching the point ‘C’, the above LHS tends to zero, and hence \\(X_0\\) slows its increase. This exists the fast dynamics layer and again the solution continues along the slow manifold from ‘C’ to ‘D’. Upon reaching ‘D’, it again enters a stage of fast dynamics (the \\(t^*\\) point here is a new one).",
    "crumbs": [
      "Fast-slow dynamics",
      "<span class='chapter-number'>20</span>  <span class='chapter-title'>Ice ages III: analysis of the van der Pol equation</span>"
    ]
  },
  {
    "objectID": "part-03-box/iceages03.html#initial-conditions",
    "href": "part-03-box/iceages03.html#initial-conditions",
    "title": "20  Ice ages III: analysis of the van der Pol equation",
    "section": "20.3 Initial conditions",
    "text": "20.3 Initial conditions\n\\(\\nextSection\\)\nYou will notice that above, we have not really discussed the effect of the initial conditions, say, \\[\n\\begin{aligned}\nx(0) &= A, \\\\\ny(0) &= B.\n\\end{aligned}\n\\]\nPerhaps more specifically, we have performed our asymptotic analysis with the assumption that the solution starts directly on the slow manifold, i.e. \\(y \\sim S(x)\\). Returning to the slow analysis leading to Equation 20.1 notice that the above conditions will not in general be compatible with the equations (since ‘A’ and ‘B’ might be chosen completely different from those values where \\(y = S(x)\\)). The conclusion is then that the slow analysis applied cannot be valid near the initial condition.\nThis turns out to be very similar to the example studied in Chapter 8, which also had a time-dependent problem where the initial condition was incompatible.\nTherefore near \\(t = 0\\), we must introduce an analogous boundary layer. This analysis will be identical to the above fast-scale dynamics except that \\(t^* = 0\\). The conclusion is that if we begin off the manifold \\(y = S(x)\\), the solution will rapidly tend left or right in the phase plane (at near-constant values of \\(y\\)). Once it intersects with the manifold, the trajectories then resume the slow and fast dynamics observed above.\nThis is now shown below for the initial condition of \\(x(0) = 2.5\\), \\(y(0) = -1.5\\) and \\(\\epsilon = 0.05\\).\n\nNotice the red circle in the left phase plot showing the initial condition. We see that the solutions then exhibit the fast dynamics, with \\(x\\) decreasing, until encountering the slow manifold. Thereafter it follows the standard slow-fast dynamics.\nOn the right image, notice the significant shock or boundary layer near \\(t = 0\\). If desired, we could confirm the size of this boundary-layer regions scales with \\(\\epsilon\\).",
    "crumbs": [
      "Fast-slow dynamics",
      "<span class='chapter-number'>20</span>  <span class='chapter-title'>Ice ages III: analysis of the van der Pol equation</span>"
    ]
  },
  {
    "objectID": "part-03-box/iceages04.html",
    "href": "part-03-box/iceages04.html",
    "title": "21  Fast-slow dynamics for higher-order systems",
    "section": "",
    "text": "21.1 Late-time behaviour\nNote that as \\(t\\to\\infty\\), all the derivative terms are set to zero. This tells us that \\[\ns \\to 0, qquad c \\to 0.\n\\] Note that it is not immediately obvious what the limit of \\(p\\) is. But it can be shown (see below) that \\(p \\to 1\\).",
    "crumbs": [
      "Fast-slow dynamics",
      "<span class='chapter-number'>21</span>  <span class='chapter-title'>Fast-slow dynamics for higher-order systems</span>"
    ]
  },
  {
    "objectID": "part-03-box/iceages04.html#slow-analysis",
    "href": "part-03-box/iceages04.html#slow-analysis",
    "title": "21  Fast-slow dynamics for higher-order systems",
    "section": "21.2 Slow analysis",
    "text": "21.2 Slow analysis\n\\(\\nextSection\\)\nWe thus expand the solutions in the typical way, setting \\[\n\\begin{aligned}\ns(t) &= s_0(t) + \\epsilon s_1(t) + \\ldots \\\\\nc(t) &= c_0(t) + \\epsilon c_1(t) + \\ldots \\\\\np(t) &= p_0(t) + \\epsilon p_1(t) + \\ldots\n\\end{aligned}\n\\]\nThis yields at leading order, \\[\n\\begin{aligned}\n\\frac{\\mathrm{d}s_0}{\\mathrm{d}t} &= -s_0(1 - c_0) + \\lambda c_0, \\\\\n0 &= s_0(1 - c_0) - \\mu c_0,\\\\\n\\frac{\\mathrm{d}p_0}{\\mathrm{d}t} &= (\\mu - \\lambda)c_0,\n\\end{aligned}\n\\tag{21.2}\\]\nThe second equation yields the slow manifold, for which we expect \\[\ns(c_0) = \\frac{\\mu c_0}{1 - c_0}.\n\\tag{21.3}\\]\n\n\n\n\n\n\nFigure 21.3: Numerical solution as before but now plotted in the \\((c, s)\\) phase plane. The dashed line is the approximation derived above.",
    "crumbs": [
      "Fast-slow dynamics",
      "<span class='chapter-number'>21</span>  <span class='chapter-title'>Fast-slow dynamics for higher-order systems</span>"
    ]
  },
  {
    "objectID": "part-03-box/iceages04.html#fast-dynamics-near-the-initial-condition",
    "href": "part-03-box/iceages04.html#fast-dynamics-near-the-initial-condition",
    "title": "21  Fast-slow dynamics for higher-order systems",
    "section": "21.3 Fast dynamics near the initial condition",
    "text": "21.3 Fast dynamics near the initial condition\n\\(\\nextSection\\)\nAs with our van der Pol example, the initial condition, where \\(c(0) = 0\\) and \\(s(0) = 1\\), does not lie on the slow manifold above. Therefore we expect that there is a boundary layer where the system rapidly begins from the initial condition and tends to the slow manifold. The distinguished scaling on time can be confirmed to be \\[\nt = \\epsilon^\\alpha T = \\epsilon T,\n\\] where \\(\\alpha = 1\\). We then set \\[\ns = S(T) \\qquad c = C(T),\n\\] for our new unknowns within this later. Under the scaling, the first two ODEs in (Equation 21.1) become \\[\n\\begin{aligned}\n\\frac{\\mathrm{d}S_0}{\\mathrm{d}T} &= 0,  & S_0(0) &= 1 \\\\\n\\frac{\\mathrm{d}C_0}{\\mathrm{d}T} &= S_0(1 - C_0) - \\mu C_0. & C_0 &= 0.\n\\end{aligned}\n\\]\nTherefore, you see that the leading-order value of \\(S\\) is expected to be constant, and it remains at its initial value, \\[\nS_0(T) \\equiv 1.\n\\] Although we could solve for the concentration of \\(c\\) or \\(C\\), this turns out not to be necessary. It should first be remarked that as the outer solution, \\(s \\sim s_0\\), tends to the initial condition, \\(t \\to 0\\), we should have \\[\n\\lim_{t \\to 0} s_0(t) = 1 = \\lim_{T\\to \\infty} S_0(T).\n\\] Compare this with the condition (Equation 8.2) when we initially studied the method of matched asymptotics. Therefore, even though there is a boundary layer necessary for the concentration \\(c\\) near \\(t = 0\\), we do not need to resolve it.",
    "crumbs": [
      "Fast-slow dynamics",
      "<span class='chapter-number'>21</span>  <span class='chapter-title'>Fast-slow dynamics for higher-order systems</span>"
    ]
  },
  {
    "objectID": "part-03-box/iceages04.html#an-equation-for-the-substrate-and-product",
    "href": "part-03-box/iceages04.html#an-equation-for-the-substrate-and-product",
    "title": "21  Fast-slow dynamics for higher-order systems",
    "section": "21.4 An equation for the substrate and product",
    "text": "21.4 An equation for the substrate and product\n\\(\\nextSection\\)\nTake now (Equation 21.3), which yields \\[\nc_0 = \\frac{s_0}{\\mu + s_0},\n\\] and substitute this into the first and third equations (Equation 21.2). This gives \\[\n\\begin{aligned}\n\\frac{\\mathrm{d}s_0}{\\mathrm{d}t} &= - \\frac{\\mu - \\lambda}{\\mu + s_0} s_0, \\\\\n\\frac{\\mathrm{d}p_0}{\\mathrm{d}t} &= \\frac{\\mu - \\lambda}{\\mu + s_0} s_0\n\\end{aligned}\n\\]\nNotice that actually, if we add these two equations, we come out with \\[\n\\frac{\\mathrm{d}}{\\mathrm{d}t}(s_0 + p_0) = 0,\n\\] which is a conservation of mass/concentration statement that indicates that the total substrate and product is conserved. Therefore, if we only solve the first equation for \\(s_0\\): \\[\n\\frac{\\mathrm{d}s_0}{\\mathrm{d}t} = - \\frac{\\mu - \\lambda}{\\mu + s_0} s_0, \\qquad s_0(0) = 1,\n\\tag{21.4}\\] we can obtain the product concentration by \\(p_0 = 1 - s_0\\).\nThe above equation (Equation 21.4) is in fact a famous result in biochemistry. It indicates that the substrate concentration follows a nonlinear rate and is called the Michaelis-Menten law. We have significantly simplified the necessary mathematical analysis down from the analysis of coupled system of three equations to a single equation for a single unknown (\\(s_0\\))!\n\n\n\n\n\n\nFigure 21.4: Numerical solution of the single differential equation",
    "crumbs": [
      "Fast-slow dynamics",
      "<span class='chapter-number'>21</span>  <span class='chapter-title'>Fast-slow dynamics for higher-order systems</span>"
    ]
  },
  {
    "objectID": "part-03-box/basic-ocean-model.html",
    "href": "part-03-box/basic-ocean-model.html",
    "title": "22  Basic models of the ocean",
    "section": "",
    "text": "22.1 Terminology and context\nThe ocean plays a significant role in regulating the Earth’s climate, as it acts as a massive heat sink and helps to distribute heat and moisture around the planet. In addition, carbon dioxide is water soluble, and through precipitation and wave motion, is transferred into the oceans. Thus the ocean acts as a sink, absorbing large amounts of this greenhouse gas from the atmosphere.\nThe thermohaline circulation (THC), also known as the global ocean conveyor belt, is a complex ocean circulation pattern that is driven by differences in water temperature and salinity. It is an important component of the Earth’s climate system, as it helps to distribute heat and other properties throughout the planet’s oceans.\nThe thermohaline circulation is driven by the sinking of cold, dense water in the polar regions, which then spreads out and flows towards the equator. As the water warms and becomes less dense, it rises to the surface and returns to the poles, creating a continuous loop of ocean currents. The role of salinity in driving the thermohaline circulation is due to the fact that the dissolved salts in seawater increase its density.\nThis circulation pattern has a significant impact on global climate, as it helps to regulate the exchange of heat and other properties between the oceans and the atmosphere. Changes in the thermohaline circulation, such as those caused by global warming, can have far-reaching effects on the planet’s climate and weather patterns.",
    "crumbs": [
      "Box models of the ocean and environment",
      "<span class='chapter-number'>22</span>  <span class='chapter-title'>Basic models of the ocean</span>"
    ]
  },
  {
    "objectID": "part-03-box/basic-ocean-model.html#terminology-and-context",
    "href": "part-03-box/basic-ocean-model.html#terminology-and-context",
    "title": "22  Basic models of the ocean",
    "section": "",
    "text": "Figure 22.1: The thermohaline circulation. In the Atlantic, the circulation carries warm water (red) north near the surface and cold deep water (blue) south. Image from NASA/JPL.",
    "crumbs": [
      "Box models of the ocean and environment",
      "<span class='chapter-number'>22</span>  <span class='chapter-title'>Basic models of the ocean</span>"
    ]
  },
  {
    "objectID": "part-03-box/basic-ocean-model.html#temperature",
    "href": "part-03-box/basic-ocean-model.html#temperature",
    "title": "22  Basic models of the ocean",
    "section": "22.2 Temperature",
    "text": "22.2 Temperature\n\\(\\nextSection\\)\n\n\n\n\n\n\nExtra content\n\n\n\nThe material in this subsection is not examinable and is given here for further context. It can be safely ignored.\n\n\nIn regards to the temperature, the ocean can be divided into three layers.\n\nThe top layer is thin (on the order of metres) and is heated from the Sun. Mixing is a dominant effect due to wind and waves, and so the temperature in this region is mostly constant.\nThe thermocline region is the intermediate layer. Here, the temperature decreaes approximately linearly.\nThe deep abyssal zone comprises 98% of the total volume of the oceans. The temperature in this region is mostly constant, and a few degrees above freezing.\n\nWithin the intermediate region, the temperature can be modelled by an advection diffusion equation, \\[\n\\frac{\\mathrm{\\partial}T}{\\mathrm{\\partial}t} + w \\frac{\\mathrm{\\partial}T}{\\mathrm{\\partial}z} = \\kappa \\frac{\\mathrm{\\partial}^2 T}{\\mathrm{\\partial}z^2},\n\\tag{22.1}\\] where \\(w\\) is the upswelling velocity and \\(\\kappa\\) is the diffusion coefficient of the fluid.\nLet us assume that the temperature in this region is near steady state and that the upwards velocity is constant. Then we integrate the ODE to find \\[\nT(z) = T_0 + T_1 \\mathrm{e}^{-z/z^*},\n\\] where \\(T_0\\) and \\(T_1\\) are constants. From (Kaper and Engler 2013), the typical orders for the parameters are \\(\\kappa \\sim 10^{-2} \\,\\mathrm{m}^{2} \\,\\mathrm{s}^{-1}\\) and \\(z^* \\sim 10^2 \\, \\mathrm{m}\\), so \\(w \\sim 10^{-4} \\,\\mathrm{m} \\,\\mathrm{s}^{-1}\\), which is quite slow.\n\n\n\n\n\n\nFigure 22.2: Cross section of the Atlantic Ocean, showing the temperature and salinity profiles on the right. Image from (Kaper and Engler 2013).",
    "crumbs": [
      "Box models of the ocean and environment",
      "<span class='chapter-number'>22</span>  <span class='chapter-title'>Basic models of the ocean</span>"
    ]
  },
  {
    "objectID": "part-03-box/basic-ocean-model.html#salinity-and-density",
    "href": "part-03-box/basic-ocean-model.html#salinity-and-density",
    "title": "22  Basic models of the ocean",
    "section": "22.3 Salinity and density",
    "text": "22.3 Salinity and density\n\\(\\nextSection\\)\n\n\n\n\n\n\nExtra content\n\n\n\nThe material in this subsection is not examinable and is given here for further context. It can be safely ignored.\n\n\nSalinity is a key component in the oceans since the salts have a large effect on the water density (which consequently drives motion). Salinity is measured in psu or practical salinity units, which is a non-dimensional ratio of conductivities. In the mixed layer, the sainity ranges from 31-39 psu, and is about 35 in the abyssal zone. You can inspect the profile in Figure 22.2.\nBelow in the study of the ocean, we will need a so-called equation of state, which connects the density, \\(\\rho\\), with the salinity, say \\(S\\), and temperature, say \\(T\\). Here is a typical graph of the relationship.\n\n\n\n\n\n\nFigure 22.3: Image from (Kaper and Engler 2013)",
    "crumbs": [
      "Box models of the ocean and environment",
      "<span class='chapter-number'>22</span>  <span class='chapter-title'>Basic models of the ocean</span>"
    ]
  },
  {
    "objectID": "part-03-box/basic-ocean-model.html#two-box-model-of-the-ocean",
    "href": "part-03-box/basic-ocean-model.html#two-box-model-of-the-ocean",
    "title": "22  Basic models of the ocean",
    "section": "22.4 Two-box model of the ocean",
    "text": "22.4 Two-box model of the ocean\n\\(\\nextSection\\)\nModelling the THC is a challenging task! In principal, this might involve the solution of multiple coupled PDEs for the flows and temperatures, which would then need to be solved on a very complicated domain. In addition, such models require a number of empirical equations of state (connecting density to temperature and salinity).\nToy models can be developed much more easily at the ‘systems level’ via box models.",
    "crumbs": [
      "Box models of the ocean and environment",
      "<span class='chapter-number'>22</span>  <span class='chapter-title'>Basic models of the ocean</span>"
    ]
  },
  {
    "objectID": "part-03-box/basic-ocean-model.html#a-one-dimensional-model-constant-temperature",
    "href": "part-03-box/basic-ocean-model.html#a-one-dimensional-model-constant-temperature",
    "title": "22  Basic models of the ocean",
    "section": "22.5 A one-dimensional model (constant temperature)",
    "text": "22.5 A one-dimensional model (constant temperature)\n\\(\\nextSection\\)\nConstruction and assumptions of the box model.\n\nWe consider two boxes, labeled ‘1’ and ‘2’, respectively via subscripts. Box 1 corresponds to high latitudes (near poles) and Box 2 to low latitudes (near equator). Each box has a corresponding temperature, \\(T_i\\), and salinity, \\(S_i\\). In each box, the temperature and salinities are well mixed, so they take different values in either box, in general.\nDifferences between the two boxes will drive a flow through the capillary pipe that connects the boxes at the bottom. A compensating flow at the surface ensures that the volume of water in each box does not change. Together, these two exchanges (top and bottom) represent the overturning circulation of the THC.\nWe assume (see above) that the strength of the exchange flow between the boxes is linearly proportional to their differences of temperature and salinity. In particular, let \\(\\rho_1\\) and \\(\\rho_2\\) be the two densities in the corresponding boxes. The flow \\(q\\) in the capillary pipe is driven by the difference \\[\nq = k \\frac{\\rho_1 - \\rho_2}{\\rho_0},\n\\tag{22.2}\\] where \\(k\\) is the hydraulic constant and takes the typical value of \\(k = 1.5 \\cdot 10^{-6} \\, \\mathrm{s}^{-1}\\). The reference density \\(\\rho_0\\) is defined in conjunction with the equation of state.\nIn the normal state of the planet, \\(q &gt; 0\\) when the flow through the capillary goes in the direction of the equator as a result of higher densities at high latitudes.\nWe need an equation of state that connects the densities, \\(\\rho\\), with the temperature and salinities. This concerns the figure Figure 22.3. We assume that \\[\n\\rho = \\rho_0(1 - \\alpha(T - T_0) + \\beta(S - S_0)),\n\\tag{22.3}\\] where \\(T_0\\) and \\(S_0\\) are average values of temperature and salinity; \\(\\rho_0\\) is the density if \\(T = T_0\\) and \\(S = S_0\\); \\(\\alpha\\) and \\(\\beta\\) are constants with typical values \\(\\alpha = 1.5 \\times 10^{-4} \\mathrm{deg}^{-1}\\) and \\(\\beta = 8 \\times 10^{-4} \\mathrm{psu}^{-1}\\). Combining (Equation 22.2) with (Equation 22.3) gives \\[\nq = k[ \\alpha(T_2 - T_1) - \\beta(S_2 - S_1)].\n\\tag{22.4}\\]\nExternal wind forces and Coriolis effects are ignored.\nWe assume that in each box, there is an exchange of heat and salinity to the surrounding environment. For instance, salinity will exchange due to evaporation, precipitation, and runoff. These will have constant of proportionalities of \\(c\\) and \\(d\\) in the equations below.\nPrecipitation, evaporation, and runoff from the continents and atmosphere will also cause the salinity in either box to change. We therefore assume that this is modeled by a flux \\(H\\).\nRemember that in general, \\(T_2 &gt; T_1\\) (the temperatures at the equator are higher). Consequently, evaporation dominates Box 2; there is a net loss of salt-free moisture in the atmosphere and this causes a compensating virtual flux of salt, \\(H &gt; 0\\), into Box 2. At the same time, there is higher precipitation and runoff into Box 1 (due to lower temperatures), causing a net gain of salt-free moisture and therefore a loss of virtual salt, say \\(-H &lt; 0\\). We assume these two virtual salt fluxes sum to zero.\nNote that in the normal state of affairs, \\(S_2 &gt; S_1\\), and the lower latitude water is saltier than that of high latitudes.\n\nAn image of the box model is shown below.\n\n\n\n\n\n\nFigure 22.4: Two-box model of the North Atlantic with evaporation and precipitation. Image from (Kaper and Engler 2013)\n\n\n\nThe equations are given as follows. \\[\n\\begin{aligned}\n\\frac{\\mathrm{d}T_1}{\\mathrm{d}t} &= c(T_1^* - T_1) + |q|(T_2 - T_1) \\\\\n\\frac{\\mathrm{d}T_2}{\\mathrm{d}t} &= c(T_2^* - T_2) + |q|(T_1 - T_2) \\\\\n\\frac{\\mathrm{d}S_1}{\\mathrm{d}t} &= -H + d(S_1^* - S_1) + |q|(S_2 - S_1) \\\\\n\\frac{\\mathrm{d}S_2}{\\mathrm{d}t} &= H + d(S_2^* - S_2) + |q|(S_1 - S_2)\n\\end{aligned}\n\\tag{22.5}\\]\nNote that in the exchange terms corresponding to the flow \\(q\\) in the capillary pipes, we use an absolute value since it does not matter (flows are exchanged in both lower and upper pipes).\nNote also that \\(q = q(T_1, T_2, S_1, S_2)\\) as given in (Equation 22.4).",
    "crumbs": [
      "Box models of the ocean and environment",
      "<span class='chapter-number'>22</span>  <span class='chapter-title'>Basic models of the ocean</span>"
    ]
  },
  {
    "objectID": "part-03-box/basic-ocean-model.html#reducing-the-equations-via-symmetry",
    "href": "part-03-box/basic-ocean-model.html#reducing-the-equations-via-symmetry",
    "title": "22  Basic models of the ocean",
    "section": "22.6 Reducing the equations via symmetry",
    "text": "22.6 Reducing the equations via symmetry\n\\(\\nextSection\\)\n\n\n\n\n\n\nExtra content\n\n\n\nThe manipulations in this subsection are, unfortunately, necessary but are not examinable. You simply should accept the final set of equations as the baseline. In essence, it is possible to shift the temperatures and salinities so as to eliminate two constants from the model. Unfortunately, the complexity of such models means you have to do a lot to `prepare’ them for analysis.\n\n\n\nBy adding the equations (Equation 22.5), it can be verified that in the limit \\(t \\to \\infty\\), the average temperature in the system, \\(1/2(T_1 + T_2)\\) tends to the average temperature in the surrounding basins \\(1/2(T_1^* + T_2^*)\\). The same conclusion can be drawn for the corresponding salinities.\nIt is then sensible to write all temperature and salinity in terms of this baseline scenario. So let us write \\[\n\\begin{aligned}\nT_1 &= \\frac{1}{2}m + U_1, \\\\\nT_2 &= \\frac{1}{2}m + U_2,\n\\end{aligned}\n\\] where \\(m = T_1^* + T_2^*\\). Then the first equation becomes \\[\n\\begin{aligned}\n\\frac{\\mathrm{d}U_1}{\\mathrm{d}t} &= c\\left(T_1^* - U_1 - \\frac{1}{2}m\\right) + |q| (U_2 - U_1)\\\\\n&= c\\left(- T^*  - U_1\\right) + |q| (U_2 - U_1).\n\\end{aligned}\n\\] where \\(T^* = \\frac{1}{2}(T_2^* - T_1^*)\\).\nThe analogous manipulations are done to the quantities for the salinity. In the end, if we (confusingly) re-write \\(T\\) for \\(U\\), then we obtain \\[\n\\begin{aligned}\n\\frac{\\mathrm{d}T_1}{\\mathrm{d}t} &= c(-T^* - T_1) + |q|(T_2 - T_1) \\\\\n\\frac{\\mathrm{d}T_2}{\\mathrm{d}t} &= c(T^* - T_2) + |q|(T_1 - T_2) \\\\\n\\frac{\\mathrm{d}S_1}{\\mathrm{d}t} &= -H + d(-S^* - S_1) + |q|(S_2 - S_1) \\\\\n\\frac{\\mathrm{d}S_2}{\\mathrm{d}t} &= H + d(S^* - S_2) + |q|(S_1 - S_2)\n\\end{aligned}\n\\tag{22.6}\\]\nComparing the above to Equation 22.5, the main difference is that, in expressing the temperature and salinities with respect to the average values in the basin, we have eliminated two of the constants from the set \\((T_1^*, T_1^*, S_1^*, S_2^*)\\) now only into two constants \\((T^*, S^*)\\).\nIn the situation of zero salt flux. \\(H = 0\\), the above model reduces to Stommel’s box model studied later in this course.",
    "crumbs": [
      "Box models of the ocean and environment",
      "<span class='chapter-number'>22</span>  <span class='chapter-title'>Basic models of the ocean</span>"
    ]
  },
  {
    "objectID": "part-03-box/basic-ocean-model.html#sec-ocean-toysalinity",
    "href": "part-03-box/basic-ocean-model.html#sec-ocean-toysalinity",
    "title": "22  Basic models of the ocean",
    "section": "22.7 Analysis of a reduced 1D model for the salinity",
    "text": "22.7 Analysis of a reduced 1D model for the salinity\n\\(\\nextSection\\)\n\n\n\n\n\n\nReduced models (non-examinable)\n\n\n\n\n\nThis material was not taught in 23-24, but concerns a reduction of the above ocean box model. It is not examinable this year but you may find it useful to know this was taught—for revising with respect to last year’s exam.\nIt is possible to do some analysis on the system (Equation 22.6), though we may prefer to simply move on to study the more historically well-known reduction called Stommel’s box model.\nWe make the following assumptions:\n\nWe assume that on the timescale of interest in the THC, the temperature of each box equilibrates quickly with the surrounding basin. Therefore the system can be regarded as being in steady state.\n\nThe difference in temperatures between the two boxes is small; together with the top assumption, this implies that \\(T_1(t) = -T^*\\) and \\(T_2(t) = T^*\\).\nSalinity exchanges by negligible amounts with its surrounding basin, i.e. \\(d = 0\\)\n\nThis leaves us with \\[\\begin{align*}\n\\frac{\\mathrm{d}S_1}{\\mathrm{d}t} &= -H + |q|(S_2 - S_1) \\\\\n\\frac{\\mathrm{d}S_2}{\\mathrm{d}t} &= H + |q| (S_1 - S_2),\n\\end{align*}\\] where \\(q = k(2\\alpha T^* - \\beta(S_2 - S_1))\\).\nNow, the formulation for the salinities can be placed into a single equation for \\(\\Delta S = S_2 - S_1\\), which satisfies \\[\n\\frac{\\mathrm{d}\\Delta S}{\\mathrm{d}t} = 2H - 2k|\\alpha \\Delta T - \\beta \\Delta S| \\Delta S.\n\\tag{22.7}\\]\nThis is now a much simpler and elegant formulation for study. Under a suitable non-dimensionalisation and scaling, we can even place the above equation in the final simplified form of \\[\n\\dot{x} = \\lambda - |1 - x| x,\n\\] where \\(\\lambda &gt; 0\\) (for temperatures in the usual configuration, with \\(T_2 - T_1 &gt; 0\\), and a suitably defined function \\(x = x(t)\\).\n\n\n\n\n\n\n\n\nKaper, Hans, and Hans Engler. 2013. Mathematics and Climate. SIAM.",
    "crumbs": [
      "Box models of the ocean and environment",
      "<span class='chapter-number'>22</span>  <span class='chapter-title'>Basic models of the ocean</span>"
    ]
  },
  {
    "objectID": "part-03-box/stommel.html",
    "href": "part-03-box/stommel.html",
    "title": "23  Stommel’s box model",
    "section": "",
    "text": "23.1 Non-dimensionalisation\nWe can then nondimensionalise the system by setting \\[\nx = \\frac{\\Delta S}{\\Delta S^*}, \\quad y = \\frac{\\Delta T}{\\Delta T^*}, \\quad t' = ct,\n\\] where \\(t'\\) is nondimensional time. Dropping the primes henceforth, we have the following set of non-dimensional equations to study for the unknowns, \\(x = x(t)\\), and \\(y = y(t)\\): \\[\n\\begin{aligned}\n\\frac{\\mathrm{d}x}{\\mathrm{d}t} &= \\delta(1 - x) - |f(x, y)|x, \\\\\n\\frac{\\mathrm{d}y}{\\mathrm{d}t} &= 1 - y - |f(x, y)|y,\n\\end{aligned}\n\\tag{23.2}\\] where we have introduced the function, \\[\nf(x, y; R, \\lambda) = \\frac{1}{\\lambda}(Rx - y),\n\\tag{23.3}\\] where there are now three non-dimensional parameters given by \\[\n\\begin{aligned}\n\\delta &= d/c, \\\\\n\\lambda &= c/(2\\alpha k \\Delta T^*), \\\\\nR &= \\beta \\Delta S^*/(\\alpha \\Delta T^*).\n\\end{aligned}\n\\]\nTogether Equation 23.2 and Equation 23.3 form a system of equations for \\((x(t), y(t))\\), with parameters \\(\\delta\\), \\(\\lambda\\), and \\(R\\).\nAlthough there are many parameters, it is important to note that the quantity \\(f\\) is crucial since it corresponds to the direction of flow in the bottom pipe of the Ocean model. By convention, the system was set up so that \\(f &gt; 0\\) corresponds to flow through the bottom pipe goes in the direction of the equator (Box 1) as a result of higher densities at the high latitudes. We are subsequently interested in whether it is possible for \\(f\\) to switch sign, which would correspond to a bottom flow going from equator to poles, and the entire system switching direction.",
    "crumbs": [
      "Box models of the ocean and environment",
      "<span class='chapter-number'>23</span>  <span class='chapter-title'>Stommel's box model</span>"
    ]
  },
  {
    "objectID": "part-03-box/stommel.html#sec-ocean2-equil",
    "href": "part-03-box/stommel.html#sec-ocean2-equil",
    "title": "23  Stommel’s box model",
    "section": "23.2 Equilibrium states",
    "text": "23.2 Equilibrium states\n\\(\\nextSection\\)\nLet the equilibrium states be given by \\((x^*, y^*)\\) with \\(f(x^*, y^*) = f^*\\). Then setting the right hand sides of (Equation 23.2) to zero and solving, we find \\[\nx^* = \\frac{\\delta}{\\delta + |f^*|} \\quad \\text{and} \\quad\ny^* = \\frac{1}{1 + |f^*|}.\n\\tag{23.4}\\] We can solve for \\(f^*\\) in both equations and equate the result to one another. This gives \\[\n\\delta \\frac{1-x^*}{x^*} = \\frac{1 - y^*}{y^*} = |f^*|.\n\\] Therefore the equilibrium points lie along the above curve. Let us generate different values of \\(f^*\\) and plot the combination.\n\nimport numpy as np\nimport matplotlib.pyplot as plt\n\ndelt = 1/6\nfmat = np.linspace(1e-3, 10, 101)\nxs = delt/(delt + np.abs(fmat))\nys = 1/(1 + np.abs(fmat))\nplt.plot(xs, ys, '.-')\nplt.xlim((0,1))\nplt.ylim((0,1))\nplt.xlabel(\"$x^*$\"); plt.ylabel(\"$y^*$\");\nplt.grid(1)\n\n\n\n\n\n\n\n\nThe above plot shows the steady-state values at \\(\\delta = 1/6\\). Each point refers to a different value of \\(|f^*|\\). Note that as \\(|f^*| \\to \\infty\\), then \\((x^*, y^*) \\to (0, 0)\\) while as \\(|f^*| \\to 0\\), then \\((x^*, y^*) \\to (1,1)\\). Now the above does not tell us what equilibrium states will exist at a specific value of \\(\\delta\\) since it requires information about \\(f^*\\). We take (Equation 23.3) and combine with (Equation 23.4). We conclude that the equilibrium points must satisfy \\[\n\\lambda f^* = \\phi(f^*),\n\\] where we have defined the function \\(\\phi\\) according to \\[\n\\phi(f^*) = \\frac{\\delta R}{\\delta + |f^*|} - \\frac{1}{1 + |f^*|}.\n\\tag{23.5}\\] Therefore, for each combination of the parameters \\((\\lambda, \\delta, R)\\), we must solve \\(\\delta f^* = \\phi(f^*)\\) to determine \\(f^*\\). Once the values of \\(f^*\\) are known, then the steady-states \\((x^*, y^*)\\) are also known. Here is a typical graph showing the potential intersections at the values of \\(\\lambda = 1/5\\), \\(\\delta = 1/6\\) and \\(R = 2\\).\n\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport scipy.optimize as sciopt\n\nlam = 1/5;\ndelt = 1/6;\nR = 2;\n\nf = np.linspace(-2.5, 2.5, 101)\nphi = delt*R/(delt + np.abs(f)) - 1/(1 + np.abs(f))\n\nplt.plot(f, phi, 'k', label='$\\phi$')\nplt.plot(f, lam*f, 'b', label='$\\lambda f$' )\nplt.ylim((-1.5,2))\nplt.xlabel(\"$f$\")\nplt.ylabel(\"$\\phi$\")\nplt.legend()\nplt.grid(1)\n\n\n\n\n\n\n\n\nAlthough there are many parameters that can alter the shape of the overall graphs, note that if \\(\\lambda\\) is increased from its current value of \\(\\lambda = 1/6\\), then two of the left roots will disappear, leaving only a single root.",
    "crumbs": [
      "Box models of the ocean and environment",
      "<span class='chapter-number'>23</span>  <span class='chapter-title'>Stommel's box model</span>"
    ]
  },
  {
    "objectID": "part-03-box/stommel.html#stability",
    "href": "part-03-box/stommel.html#stability",
    "title": "23  Stommel’s box model",
    "section": "23.3 Stability",
    "text": "23.3 Stability\n\\(\\nextSection\\)\nFor our purposes, we will mainly proceed using numerics, and bypass the need to study the above results analytically.\nIn the accompanying lecture script, lecture29-StommelPhasePlane.ipynb, we will obtain the eigenvalues numerically, and generate the phase plane. At the test point \\(R = 2\\), \\(\\delta = 1/6\\), and \\(\\lambda = 1/5\\), we generate the following phase plane picture.\n\n\n\n\n\n\nFigure 23.1: Phase plane for \\(R = 2\\), \\(\\lambda = 1/5\\) and \\(\\delta = 1/6\\). The blue, red, and green fixed points correspond to \\(f_1\\), \\(f_2\\), and \\(f_3\\) in order. The blue point is a stable node, the red point is an unstable saddle, and the green point is a stable spiral.\n\n\n\n\n\n\n\n\n\nDetails on the stability analysis\n\n\n\n\n\nThis part is only for additional detail in the course; it involves some (non-interesting) algebra so is only included here for additional context.\nWe let \\(x = x^* + \\xi\\) and \\(y = y^* + \\eta\\) and linearise the system about the fixed points. This gives \\[\n\\begin{pmatrix}\n\\dot{\\xi} \\\\\n\\dot{\\eta}\n\\end{pmatrix} = A\n\\begin{pmatrix}\n\\xi \\\\ \\eta\n\\end{pmatrix},\n\\] where the matrix \\(A\\) is given by \\[\nA =\n\\begin{pmatrix}\n-(\\delta + |f^*|) \\mp \\frac{Rx^*}{\\lambda} & \\pm \\frac{x^*}{\\lambda} \\\\\n\\mp \\frac{Ry^*}{\\lambda} & -(1 + |f^*|) \\pm \\frac{y^*}{\\lambda}\n\\end{pmatrix}\n\\] if \\(f^* \\gtrless 0\\).\nThere are two ways or proceeding. We can numerically substitute the fixed points into the above matrix for \\(A\\) and then calculate the eigenvalues (numerically or otherwise). Or we can directly proceed analytically.\nIf proceeding analytically, we can then calculate the trace and determinant, giving \\[\n\\begin{aligned}\nT &= -(1 + \\delta + 3 |f^*|), \\\\\nD &= (\\delta + 2|f^*|)(1 + |f^*|) \\pm (1 - \\delta) \\frac{y^*}{\\lambda}.\n\\end{aligned}\n\\]\nUsing the above, we can analytically calculate the key discriminant expression of \\(T^2 - 4D\\) (or numerically) in order to verify stability. The details of the classification scheme is given in the appendix Chapter 40.",
    "crumbs": [
      "Box models of the ocean and environment",
      "<span class='chapter-number'>23</span>  <span class='chapter-title'>Stommel's box model</span>"
    ]
  },
  {
    "objectID": "part-03-box/stommel.html#bifurcation-diagrams",
    "href": "part-03-box/stommel.html#bifurcation-diagrams",
    "title": "23  Stommel’s box model",
    "section": "23.4 Bifurcation diagrams",
    "text": "23.4 Bifurcation diagrams\n\\(\\nextSection\\)\nOnce the above stability analysis, it is possible to sketch the final bifurcation diagram.\nFirst, we can note that as \\(\\lambda\\) increases, the graph in Section 23.2 indicates that there may either be three intersections (as shown) or if \\(\\lambda\\) increases then two of the intersections may disappear. We can note that:\n\n\n\n\\(f_i^*\\)\n\\(\\lambda \\to 0^+\\)\n\\(\\lambda \\to \\infty\\)\n\n\n\n\n\\(f_1^*\\)\n\\(-\\infty\\)\nnone\n\n\n\\(f_2^*\\)\nfixed point &lt; 0\nnone\n\n\n\\(f_3^*\\)\nfixed point &gt; 0\n0\n\n\n\nWe can also ascertain that there should be a point, say \\(\\lambda = \\lambda^*\\) where the two roots coalesce, \\(f_1^* = f_2^*\\), and thereafter disappear. This allows us to now plot the bifurcation \\((\\lambda, f^*)\\)-plane:\n\n\n\n\n\n\nFigure 23.2",
    "crumbs": [
      "Box models of the ocean and environment",
      "<span class='chapter-number'>23</span>  <span class='chapter-title'>Stommel's box model</span>"
    ]
  },
  {
    "objectID": "part-03-box/stommel.html#stommels-conclusion",
    "href": "part-03-box/stommel.html#stommels-conclusion",
    "title": "23  Stommel’s box model",
    "section": "23.5 Stommel’s conclusion",
    "text": "23.5 Stommel’s conclusion\n\\(\\nextSection\\)\nWhat is the final takeaway message(s)?\n\nIt is possible to pose a conceptual model of the ocean and the thermohaline circulation, which governs the exchange of hot-and-cold waters and salty waters from equatorial-to-pole zones.\nThis conceptual model suggests that tipping points and hysteresis are possible in such systems. In particular, it is possible, according to these models, for the flow directions to entirely change!\n\n\n\n\n\n\n\nAs noted by (Kaper and Engler 2013):\n\n\n\n“Clearly, two-box models are only a caricature of the THC. At best, they account for the pole-to-equator circulation in single ocean basin (the North Atlantic). They certainly do not account for the fact that all the Earth’s oceans are connected, nor for the fact that the oceans are coupled to the atmosphere and other components of the climate system. Nevertheless, the finding that such simple models predict the possibility of two distinct stable modes of circulation, and that transitions from one more to another can be induced by changing the forcing parameters [–] has had a significant impact in oceanography and climate science.”\n\n\n\n\n\n\nKaper, Hans, and Hans Engler. 2013. Mathematics and Climate. SIAM.\n\n\nStommel, Henry. 1961. “Thermohaline Convection with Two Stable Regimes of Flow.” Tellus 13 (2): 224–30.",
    "crumbs": [
      "Box models of the ocean and environment",
      "<span class='chapter-number'>23</span>  <span class='chapter-title'>Stommel's box model</span>"
    ]
  },
  {
    "objectID": "part-03-box/flood.html",
    "href": "part-03-box/flood.html",
    "title": "24  Box models for flood estimation",
    "section": "",
    "text": "24.1 Terminology\nFirst, examine a typical geometry in the image below.\nIn flooding, hydrologists are primarily interested in two related concepts of streamflow and runoff. Streamflow is typically measured at a prominent outlet, such as the mouth of a river or the outflow to a lake, and consists of the amount of water that flows through a cross section, expressed as cubic metres per second. At any given point in the above diagram, we can also measure the runoff, which is expressed in millimetres per day (mm/d). Given the river path in the figure above, we could theoretically convert from runoff to streamflow: we for each grid, we multiply the runoff by the surface area, which yields the volumetric per time quantity of streamflow.\nIn the above diagram, the upstream area of an outlet (the lake or the gauging station, for instance), is called a basin, catchment, or watershed.\nFor reference, these models are re-interpreted and cleaned up versions of what appears in the work by Jothityangkoon et al. (2001).",
    "crumbs": [
      "Box models of the ocean and environment",
      "<span class='chapter-number'>24</span>  <span class='chapter-title'>Box models for flood estimation</span>"
    ]
  },
  {
    "objectID": "part-03-box/flood.html#terminology",
    "href": "part-03-box/flood.html#terminology",
    "title": "24  Box models for flood estimation",
    "section": "",
    "text": "Typical geometry of consideration; image from Gauch and Lin (2020)",
    "crumbs": [
      "Box models of the ocean and environment",
      "<span class='chapter-number'>24</span>  <span class='chapter-title'>Box models for flood estimation</span>"
    ]
  },
  {
    "objectID": "part-03-box/flood.html#a-basic-flood-model",
    "href": "part-03-box/flood.html#a-basic-flood-model",
    "title": "24  Box models for flood estimation",
    "section": "24.2 A basic flood model",
    "text": "24.2 A basic flood model\n\\(\\nextSection\\)\nThe basic flood model or rainfall-runoff model is essentially a water balance equation. Here is a simple model with one store and one parameter. We consider the total water exchange that occurs in a given area. Prepitation input, \\(P(t)\\), measured in mm/day is obtained. The quantity \\(S(t)\\), measured in mm, then measures the current “storage” in the soil moisture. Actual evaporation \\(E_a(t)\\) will remove moisture from the soil. Then: \\[\n\\frac{\\mathrm{d}S}{\\mathrm{d}t} = P(T) - Q_{se}(t) - E_a(t).\n\\tag{24.1}\\] The makeup of the right hand-side are as follows.\nThe term \\(Q_{se}\\) measures the saturation excess overland flow. This is essentially the quantity that arises when the soil cannot support additional moisture, and produces runoff. We can consider it modelled as: \\[\nQ_{se}(T) = P(t) \\sigma(S - S_\\text{max}),\n\\] where \\(\\sigma\\) is the sigmoid or activation function. For instance, we might take \\[\n\\sigma(S - S_\\text{max}) = H(S - S_{\\text{max}} = \\begin{cases}\n1 & S &gt; S_{\\text{max}} \\\\\n0 & S &lt; S_{\\text{max}} \\\\\n1/2 & S = S_{\\text{max}},\n\\end{cases}\n\\] where \\(H\\) is the Heaviside step function, which for convenience takes the midpoint value when evaluated at zero.\nThe above model for \\(Q_{se}\\) makes some sense. If the soil has not exceed some ‘maximum soil moisture storage’ value \\(S_\\text{max}\\), then there is no saturation excess and the total runoff is zero. However, once this threshold is exceed, the precipitation is routed directly to the runoff.\nThe actual evaporation (or more accurately evapotranspiration) includes interception loss from plant canopies at the land surface, and combined evaporation and transpiration taken out of the soil water. We take it to be written in a fashion proportional to the total soil moisture: \\[\nE_a(t) = \\frac{E_p(t)}{S_\\text{max}} S(t).\n\\] We assume that the metereological data provides estimates of the potential evaporation, . You do not have to know about the specifics of the difference between actual and potential evaporation, though see a description of how these two quantities are measured at this link. Above, it is nice to think of the fact that the dimensions of must be measured in storage units (mm) per time. The quantity \\[\n\\frac{S_\\text{max}}{E_p},\n\\] is the approximate time it would take for a bucket with \\(S_\\text{max}\\) to completely evaporate.\nTherefore, on the assumption that metereological data provides values of precipitation \\(P\\) and potential evapotranspiration (or simply evaporation), we can use the above to calculate the soil moisture \\(S\\). The key quantity to predict is the runoff, which in this case is simply the saturation excess: \\[\n\\text{runoff} = Q_{se}(t).\n\\]\nIn summary, the above model consists of a single store and a single parameter (\\(S_\\text{max}\\)). In theory, you would obtain time-series data of streamflow or runoff, and then attempt to calibrate the parameter.",
    "crumbs": [
      "Box models of the ocean and environment",
      "<span class='chapter-number'>24</span>  <span class='chapter-title'>Box models for flood estimation</span>"
    ]
  },
  {
    "objectID": "part-03-box/flood.html#a-flood-model-with-slow-and-fast-flows",
    "href": "part-03-box/flood.html#a-flood-model-with-slow-and-fast-flows",
    "title": "24  Box models for flood estimation",
    "section": "24.3 A flood model with slow and fast flows",
    "text": "24.3 A flood model with slow and fast flows\n\\(\\nextSection\\)\nIf the above model is tested on real data, we would typically observe that it performs well in predicting long-time runoffs, but that it does not cope very well with inter-annual variations. Indeed, it fails to capture a key mechanism of water transfer, which suggests that runoff should be separated into two components: a delayed subsurface runoff, \\(Q_{ss}(t)\\), when soil moisture storage in the bucket exceeds some field capacity threshold (think of this as groundwater flow); and the previous saturation excess (think of this as overland flow).\nIn addition, we might want to separate the evopotranspiration as \\[\nE_a = E_b + E_v,\n\\] where \\(E_b\\) measures the bare soil evaporation while \\(E_v\\) measures the transpiration due to vegetation. In theory, this would allow us to partition land into soil-covered or vegetation-covered.\nThe model is then \\[\n\\frac{\\mathrm{d}S}{\\mathrm{d}t} = P(t) - [Q_{se}(t) + Q_{ss}(t)] - [E_b(t) + E_v(t)].\n\\] First, the saturation excess overland flow is as it was previously: \\[\nQ_{se}(t) = P(t) \\sigma (S - S_\\text{max}),\n\\] where again for simplicity, we could take \\(\\sigma = H\\) and use the Heaviside step function as the activation function..\nWe also allow now for the subsurface flow, \\(Q_{ss}(t)\\), (again in mm/day), modelled via \\[\nQ_{ss}(t) = a(S - S_{fc}) \\sigma (S - S_{fc}),\n\\] which produces flow proportional to how much the soil has exceeded its field capacity value, \\(S_{fc}\\), subject to a proportionality constant \\(a\\).\nAs for the two evaporation rates, they are subsequently weighted by a factor dependent on \\(M\\), the forest fraction parameter, with \\(0 &lt; M &lt; 1\\). We do not go into detail on their forms, but refer the reader to the original work by Jothityangkoon et al. (2001), from which this model was taken. The evaporation rates are, \\[\nE_b = (1 - M) E_p(t) \\frac{S}{S_\\text{max}}.\n\\] The above is the usual expression for the evaporation rate, but additional weighted by the \\((1 - M)\\) factor, which is zero if the area is entirely forest-covered. Next, the vegetation-covered evaporation is, \\[\nE_v = \\begin{cases}\nM E_p & S &gt; S_{fc}, \\\\\n\\frac{S}{S_{fc}} M E_p & S &lt; S_{fc},\n\\end{cases}\n\\] and so the model depends on whether the groundwater region is entirely saturated or not. If the groundwater region is entirely saturated, then the maximal transpiration occurs, specifically with \\(E_v = E_p\\) for the completely forest-covered region. On the other hand, if the groundwater region is not completely saturated, then we allow the vegetative transpiration rate to be a fraction of \\(E_p\\), dependent on the soil moisture storage \\(S\\).\nAgain, the runoff is calculated via \\[\nQ = Q_{se} + Q_{ss}.\n\\] This model has one store and 4 parameters: \\(S_\\text{max}\\) (mm), \\(S_{fc}\\) (mm), \\(a\\) (1/day), and \\(0 &lt; M &lt; 1\\). Like all other models, you can attempt to train the model by processing known data and fitting the parameters.",
    "crumbs": [
      "Box models of the ocean and environment",
      "<span class='chapter-number'>24</span>  <span class='chapter-title'>Box models for flood estimation</span>"
    ]
  },
  {
    "objectID": "part-03-box/flood.html#calibration-and-analaysis",
    "href": "part-03-box/flood.html#calibration-and-analaysis",
    "title": "24  Box models for flood estimation",
    "section": "24.4 Calibration and analaysis",
    "text": "24.4 Calibration and analaysis\n\\(\\nextSection\\)\n\n\n\n\n\n\nNon-examinable\n\n\n\nThe following is presented, but is not examinable. Still, it is interesting to know briefly how the above hydrological models can be used in practice.\n\n\nThe procedure is now as follows. We obtain calibration data, primarily of precipitation \\(P(t)\\), potential evapotranspiration \\(E_p(t)\\), and streamflow or runoff.",
    "crumbs": [
      "Box models of the ocean and environment",
      "<span class='chapter-number'>24</span>  <span class='chapter-title'>Box models for flood estimation</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/part-exercises.html",
    "href": "part-xx-exercises/part-exercises.html",
    "title": "Exercises",
    "section": "",
    "text": "Exercises and problem sets to be released as the term progresses.",
    "crumbs": [
      "Exercises"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps01.html",
    "href": "part-xx-exercises/ps01.html",
    "title": "25  Problem set 1",
    "section": "",
    "text": "Q1. Bump lemma\nProve the following one-dimensional lemma, which was used in the derivation of the heat equation.\nIf \\(\\int_a^b g(x) \\, \\mathrm{d}x = 0\\) for all \\(a\\) and \\(b \\in [0, 1]\\), then \\(g(x) \\equiv 0\\) for all \\(x\\in [0, 1]\\).\nHint: think of a proof by contradiction.",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>25</span>  <span class='chapter-title'>Problem set 1</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps01.html#q2.-a-source-in-the-heat-equation",
    "href": "part-xx-exercises/ps01.html#q2.-a-source-in-the-heat-equation",
    "title": "25  Problem set 1",
    "section": "Q2. A source in the heat equation",
    "text": "Q2. A source in the heat equation\n\\(\\nextSection\\)\nConsider the same heat experiment discused in Chapter 1 but now consider a bar that has an internal source or sink generating or removing heat, such as the case of a boiler with an internal heating element. By adapting a similar derivation to the one presented, explain why the modified conservation of heat equation is \\[\n\\frac{\\mathrm{\\partial}}{\\mathrm{\\partial}t} \\int_a^b \\rho c T \\, \\mathrm{d}x = {\\color{blue}q(x = a, t) - q(x = b, t)} + \\int_a^b R(x, t) \\, \\mathrm{d}x.\n\\]\nIn addition:\n\nBy studying the dimensions of the other terms in the above equation, find what the dimensions of \\(R\\) are. What does \\(R &gt; 0\\) mean and \\(R &lt; 0\\)?\nHence derive the partial differential equation that governs the temperature \\(T\\).\nBy introducing the appropriate scalings on each of the variables, \\(x\\), \\(t\\), and \\(T\\), non-dimensionalise the PDE and discuss the non-dimensional parameters (there will be two).",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>25</span>  <span class='chapter-title'>Problem set 1</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps01.html#q3.-choice-of-scalings",
    "href": "part-xx-exercises/ps01.html#q3.-choice-of-scalings",
    "title": "25  Problem set 1",
    "section": "Q3. Choice of scalings",
    "text": "Q3. Choice of scalings\n\\(\\nextSection\\)\nConsider the dimensional problem for the motion of a projectile launched from close to the surface of the Earth. The dimensional height of the projectile, \\(y(t)\\), is given by \\[\n\\begin{aligned}\n\\frac{\\mathrm{d}^2 y}{\\mathrm{d}t^2} &= - \\frac{GM}{(R+y)^2}, \\\\\ny(0) &= 2 \\, \\mathrm{m}, \\\\\ny'(0) &= -V_0 \\, \\mathrm{m/s}.\n\\end{aligned}\n\\] Assume that the Earth is spherical and of uniform density, with its mass given by \\(M = (4/3) \\pi R^3 \\rho\\). Non-dimensionalise the height using \\(y = L \\tilde{y}\\) and time using \\(t = T\\tilde{t}\\). Consider the following cases:\n\n\\(R\\) fixed, \\(V_0 \\to \\infty\\), \\(\\rho\\) fixed;\n\\(R\\) fixed, \\(V_0\\) fixed, \\(\\rho \\to \\infty\\);\n\\(R\\) fixed, \\(V_0\\) fixed, \\(\\rho \\to 0\\);\n\\(R \\to 0\\), \\(V_0\\) fixed, \\(M\\) fixed.\n\nFor each case:\n\nExplain the physical interpretation of the limits.\nChoose the scalings \\(L\\) and \\(T\\) to normalise as many terms as possible.\nChoose the scalins so that the time it takes for the projectile to fall should be finite for the given limit, and for the speed, acceleration, and initial height to be well behaved (finite).\nWrite out the scaled problem and identify all remaining nondimensional parameters.\nIdentify the limiting small parameter for each case. Write out the problem (leading-order problem) when the parameter is set to zero.",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>25</span>  <span class='chapter-title'>Problem set 1</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps01.html#q4.-the-unique-timescale-in-the-heat-equation",
    "href": "part-xx-exercises/ps01.html#q4.-the-unique-timescale-in-the-heat-equation",
    "title": "25  Problem set 1",
    "section": "Q4. The unique timescale in the heat equation",
    "text": "Q4. The unique timescale in the heat equation\n\\(\\nextSection\\)\nDuring our investigation of the heat equation, we found that it was possible to scale time so as to scale out the only non-dimensional parameter that appears in the PDE (\\(\\Pi\\)). This produced (Equation 2.1). The disappearance of all non-dimensional parameters is due to the fact that only a single sensible timescale exists.\nBy adjusting the boundary conditions, we may create a new problem involving heat flow where a unique ‘special’ timescale can no longer be chosen.\nConsider a system where one side of the rod is heated in some periodic fashion, e.g. set the initial and boundary conditions to be \\[\n\\begin{aligned}\nT(x, 0) &= T_0 \\\\\nT(0, t) &= T_a \\cos (\\omega t), \\\\\nT(L, t) &= T_b.\n\\end{aligned}\n\\]\n\nWhat must the units of \\(\\omega\\) be?\nNon-dimensionalise as usual and, without selecting the timescale, \\([t]\\), identify the key non-dimensional parameters that remain. Write a brief sentence to describe their physical interpretation.\nThere are two sensible choices for setting the timescale, \\([t]\\). Identify the two choices and present the reduced set of equations in each case.",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>25</span>  <span class='chapter-title'>Problem set 1</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps01.html#q5.-timescale-in-the-surface-energy",
    "href": "part-xx-exercises/ps01.html#q5.-timescale-in-the-surface-energy",
    "title": "25  Problem set 1",
    "section": "Q5. Timescale in the surface energy",
    "text": "Q5. Timescale in the surface energy\n\\(\\nextSection\\)\nTake the basic zero-dimensional energy model studied in (Equation 3.7) for the temperature of the troposphere: \\[\nC \\frac{\\mathrm{d}T}{\\mathrm{d}t} = \\frac{1}{4} Q(1 - a) - \\sigma \\gamma T^4.\n\\]\n\nNon-dimensionalise the model by choosing \\(T = [T]T'\\), \\(t = [t]t'\\), and \\(Q = [Q]Q'\\). Show that it is possible to select the scalings on the temperature and time so as to completely remove all constants from the problem when \\(Q\\) is assumed to be constant.\nThus, show that the analysis of the above equation is equivalent to studying \\[\n\\frac{\\mathrm{d}T}{\\mathrm{d}t} = 1 - T^4,\n\\] where we have dropped the primes and assumed that the albedo is such that \\(1 - a \\neq 0\\).\nFrom your choice of \\([t]\\), estimate the typical dimensional value using \\(d \\approx 10 \\mathrm{km}\\), \\(\\rho \\approx 1 \\mathrm{kg} \\,\\mathrm{m}^{-3}\\), \\(c_p \\approx 10^3 \\mathrm{J} \\,\\mathrm{kg}^{-1} \\,\\mathrm{K}^{-1}\\).\n\nUse a pocket calculator to verify your calculations and conclude that this time-scale is on the order of a month. What is the relevance of this approximation as it concerns the steady-state solution?",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>25</span>  <span class='chapter-title'>Problem set 1</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps02.html",
    "href": "part-xx-exercises/ps02.html",
    "title": "26  Problem set 2",
    "section": "",
    "text": "26.1 Getting started with Noteable\nUse your Moodle course page to access the Noteable Python interface by clicking on the appropriate link in the course materials. Follow the instructions on the Moodle page to add the Git repository to your directory.",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>26</span>  <span class='chapter-title'>Problem set 2</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps02.html#getting-started-with-noteable",
    "href": "part-xx-exercises/ps02.html#getting-started-with-noteable",
    "title": "26  Problem set 2",
    "section": "",
    "text": "Navigate to the welcome screen for MA30287 and follow the instructions in Welcome.ipynb and FirstTimeSetup.ipynb in order to create your own local directory at /MA30287_workspace/\nNavigate to the workspace folder. Click New -&gt; Notebook. If asked, select the kernel Python 3 (ipykernel).\nIn the first line of input, select, in toolbar Code -&gt; Markdown. This allows you to annotate your notebook with Markdown-style text input.\nIn the first line of input, type # Problem set 2. Then either type Shift + Enter or press the play button which will execute the line(s) of input. Your markdown text should render as a nicely formatted entry.\nRename the file to something appropriate, like ps02_scripts. You can do this by right-clicking the filename in the file manager and selecting Rename.\nProceed to the next question.",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>26</span>  <span class='chapter-title'>Problem set 2</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps02.html#sec-ps2-cubic",
    "href": "part-xx-exercises/ps02.html#sec-ps2-cubic",
    "title": "26  Problem set 2",
    "section": "26.2 Testing the solutions of a cubic",
    "text": "26.2 Testing the solutions of a cubic\n\\(\\nextSection\\)\nIn this question, you will develop the numerical solutions for the roots of the cubic equation: \\[\n\\epsilon x^3 - x + 1 = 0, \\qquad \\epsilon &gt; 0\n\\]\nType the following code into your Jupyter notebook. This code uses a command, which you will learn in a later week, called fsolve, in order to solve nonlinear equations. When writing the below code, you may want to separate the import commands into their own input field in the notebook.\n\nimport numpy as np\nfrom scipy.optimize import fsolve\n\nep = 0.1        # epsilon value\nxguess = 1.1    # Initial guess of root\n\nf = lambda x: ep*x**3 - x + 1\nxsol = fsolve(f, xguess)\nprint(\"Solved root at x = \", xsol)\n\nSolved root at x =  [1.15346731]",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>26</span>  <span class='chapter-title'>Problem set 2</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps02.html#analysis-of-singular-cubic-equation",
    "href": "part-xx-exercises/ps02.html#analysis-of-singular-cubic-equation",
    "title": "26  Problem set 2",
    "section": "26.3 Analysis of singular cubic equation",
    "text": "26.3 Analysis of singular cubic equation\n\\(\\nextSection\\)\nConsider the cubic equation \\[\n\\epsilon x^3 - x + 1 = 0,\n\\] with \\(\\epsilon \\ll 1\\) and \\(\\epsilon &gt; 0\\).\n\nDevelop the first three terms of an asymptotic expansion about the root by setting \\[\nx = x_0 + \\epsilon x_1 + \\epsilon^2 x_2 + \\ldots\n\\]\nFill out the following table.\n\n\n\n\\(\\epsilon\\)\n\\(x_{\\text{exact}}\\)\n\\(x_{\\text{exact}} - x_0\\)\n\n\n\n\n0.1\n–\n–\n\n\n0.08\n–\n–\n\n\n0.06\n–\n–\n\n\n0.04\n–\n–\n\n\n0.02\n–\n–\n\n\n\nUse your code in Section 26.2 to input numerical approximations to the above entries.\nCreate a graph by hand of the data (it does not have to be extremely accurate), as plotted in the \\((\\epsilon, x_{\\text{exact}} - x_0)\\)-plane. Fit a line to this graph and estimate the gradient. Is this consistent with what you derived above?\nBy rescaling \\(x\\) appropriately in terms of \\(\\epsilon\\), derive the first three terms of the asymptotic approximations of the remaining roots.",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>26</span>  <span class='chapter-title'>Problem set 2</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps02.html#a-damped-projectile-problem",
    "href": "part-xx-exercises/ps02.html#a-damped-projectile-problem",
    "title": "26  Problem set 2",
    "section": "26.4 A damped projectile problem",
    "text": "26.4 A damped projectile problem\n\\(\\nextSection\\)\nIn Chapter 6 you performed the asymptotic analysis for a projectile. The small parameter was \\(\\epsilon\\) and represented \\(v_0^2/(gR_E)\\) (a parameter that includes the initial velocity, \\(v_0\\), gravity \\(g\\), and the radius of the Earth, \\(R_E\\).\nIf air resistance is included, then the non-dimensional toy model is instead \\[\\begin{equation}\n\\begin{gathered}\n\\frac{\\mathrm{d}^2 y}{\\mathrm{d}t^2} = - \\frac{1}{(1 + \\epsilon y)^2} - \\frac{\\alpha}{(1 + \\epsilon y)} \\frac{\\mathrm{d}y}{\\mathrm{d}t}, \\\\\ny(0) = 0, \\\\\ny'(0) = 1.\n\\end{gathered}\n\\end{equation}\\] where \\(\\alpha \\geq 0\\) is the parameter that controls air resistance.\n\nBegin by assuming that \\(\\alpha\\) is a fixed number and consider the limit where \\(\\epsilon \\ll 1\\). Find a one-term asymptotic expansion of the solution for small \\(\\epsilon\\).\n(Challenging) Is the effect of the air resistance to increase or decrease the flight time? Justify based on your analytical solution.",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>26</span>  <span class='chapter-title'>Problem set 2</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps02.html#ode-solvers-and-eulers-method",
    "href": "part-xx-exercises/ps02.html#ode-solvers-and-eulers-method",
    "title": "26  Problem set 2",
    "section": "26.5 ODE solvers and Euler’s method",
    "text": "26.5 ODE solvers and Euler’s method\n\\(\\nextSection\\)\nReturn to the setup of the above question.\n\nModify the script shown in Section 6.2 in order to solve the initial-value problem from the previous question at a prescribed value of \\(\\epsilon\\) and \\(\\alpha\\).\nUsing a pocket calculator (or your phone calculator) apply Euler’s method with \\(\\Delta t = 0.2\\), \\(\\epsilon = 0.2\\), and \\(\\alpha = 1\\) to determine the position of the projectile at \\(t = 0.6\\).\nCompare your hand calculation with the result from the Python output, as well as with your asymptotic approximations.",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>26</span>  <span class='chapter-title'>Problem set 2</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps03.html",
    "href": "part-xx-exercises/ps03.html",
    "title": "27  Problem set 3",
    "section": "",
    "text": "Q1. Conversion to first-order system\nBy using the procedure reviewed in Section 6.2, convert (Equation 27.1) to a first-order system of equations.",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>27</span>  <span class='chapter-title'>Problem set 3</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps03.html#q2.-numerical-solutions",
    "href": "part-xx-exercises/ps03.html#q2.-numerical-solutions",
    "title": "27  Problem set 3",
    "section": "Q2. Numerical solutions",
    "text": "Q2. Numerical solutions\n\\(\\nextSection\\)\nBy adapting the code studied in lectures (script lecture12-SolvingBVPs), write a numerical code to solve (Equation 27.1) using Python’s built-in functions. Use your code to investigate the solution profiles for different values of \\(\\epsilon\\).",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>27</span>  <span class='chapter-title'>Problem set 3</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps03.html#q3.-investigation-of-the-boundary-layer",
    "href": "part-xx-exercises/ps03.html#q3.-investigation-of-the-boundary-layer",
    "title": "27  Problem set 3",
    "section": "Q3. Investigation of the boundary layer",
    "text": "Q3. Investigation of the boundary layer\n\\(\\nextSection\\)\nUsing your code, use the following command in order to investigate the maxima \\((x_m, T_m)\\) as \\(\\epsilon\\) varies:\nind = np.argmax(Y[0])\nprint(ep, z[ind], Y[0, ind])\nYou may want to consider, as an example, the values \\(\\epsilon = \\{0.05, 0.1, 0.15, 0.2\\}\\) and fill the following table.\n\n\n\n\\(\\epsilon\\)\n\\(x_m\\)\n\\(T_m\\)\n\n\n\n\n0.05\n\n\n\n\n0.1\n\n\n\n\n0.15\n\n\n\n\n0.2\n\n\n\n\n\nCreate a plot of \\((\\epsilon, x_m)\\) and discuss the observed trend and its implications.",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>27</span>  <span class='chapter-title'>Problem set 3</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps03.html#q4.-outer-asymptotic-solutions",
    "href": "part-xx-exercises/ps03.html#q4.-outer-asymptotic-solutions",
    "title": "27  Problem set 3",
    "section": "Q4. Outer asymptotic solutions",
    "text": "Q4. Outer asymptotic solutions\n\\(\\nextSection\\)\nBegin by setting \\[\nT = T_{\\text{outer}} = T_0(z) + \\epsilon T_1(z) + \\epsilon^2 T_2(z) + \\ldots\n\\] Substitute the above expansion into the system and solve for the first two orders.\nYou may verify that the solution is given by\n\\[\\begin{align}\nT_0 &= e^{1/2} e^{-z/2}, \\\\\nT_1 &= -\\frac{1}{8} e^{1/2} e^{-z/2} (z - 1).\n\\end{align}\\]",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>27</span>  <span class='chapter-title'>Problem set 3</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps03.html#q5.-inner-asymptotic-solutions",
    "href": "part-xx-exercises/ps03.html#q5.-inner-asymptotic-solutions",
    "title": "27  Problem set 3",
    "section": "Q5. Inner asymptotic solutions",
    "text": "Q5. Inner asymptotic solutions\n\\(\\nextSection\\)\nThere will be a boundary layer near \\(z = 0\\). Set \\(z = \\epsilon^{\\alpha} s\\) and \\(T(z) = U(s)\\). Follow the same procedure, as in Chapter 8 in order to determine the correct choice of \\(\\alpha\\) for the inner region. This choice should balance the two terms \\(\\epsilon T''\\) and \\(2T'\\).",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>27</span>  <span class='chapter-title'>Problem set 3</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps03.html#q6.-matching-and-comparison",
    "href": "part-xx-exercises/ps03.html#q6.-matching-and-comparison",
    "title": "27  Problem set 3",
    "section": "Q6. Matching and comparison",
    "text": "Q6. Matching and comparison\n\\(\\nextSection\\)\nExpanding the inner solution as \\(U = U_0(s) + \\epsilon U_1(s) + \\ldots\\), write down the equation and boundary conditions that \\(U_0\\) must satisfy. You will notice that \\(U_0\\) is governed by a second-order differential equation and therefore needs two boundary conditions. One boundary condition comes from \\(z = 0\\), i.e. \\[\nU_0(0) = 0.\n\\]\nThe other boundary condition is a matching condition: \\[\n\\lim_{s \\to \\infty} U_0(s) = \\lim_{z \\to 0} T_0(z),\n\\] which imposes that the inner solution, as it leaves the boundary layer, matches the outer solution, it tends into the inner region.\nSolve for \\(U_0\\).",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>27</span>  <span class='chapter-title'>Problem set 3</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps04.html",
    "href": "part-xx-exercises/ps04.html",
    "title": "28  Problem set 4",
    "section": "",
    "text": "Q1. The wine cellar problem I\nWithin Chapter 11, the heat system was studied: \\[\n\\begin{gathered}\n\\frac{\\partial T}{\\partial t} = \\kappa \\frac{\\partial^2 T}{\\partial x^2}, \\\\\nT(x = 0, t) = A \\cos(\\omega t), \\\\\n|T(x, t)| \\text{ is bounded as $x \\to \\infty$}.\n\\end{gathered}\n\\] for \\(x \\geq 0\\). The initial condition can be ignored.\nThe solution was sought in the form of \\(T(x, t) = G(t) H(x)\\) using a separation of variables procedure leading to \\[\n\\frac{G'}{G} = \\kappa \\frac{H''}{H} = \\lambda.\n\\] Go through an argument that the cases of \\(\\lambda = 0\\) and \\(\\lambda\\) real lead to incompatible solutions. Review the calculation that \\(\\lambda = i\\omega\\) leads to the desired solution given in (Equation 11.1).",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>28</span>  <span class='chapter-title'>Problem set 4</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps04.html#q2.-the-wine-cellar-problem-ii",
    "href": "part-xx-exercises/ps04.html#q2.-the-wine-cellar-problem-ii",
    "title": "28  Problem set 4",
    "section": "Q2. The wine cellar problem II",
    "text": "Q2. The wine cellar problem II\n\\(\\nextSection\\)\nReview the code written in lecture15-winecellar.ipynb.\nVerify how well the numerical solution matches the exact analytical solution by overlaying the numerical solution with the analytical solution.\nInvestigate the solutions under different choices of parameters and time-stepping tolerances until you are confident you know how the numerical algorithm works.",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>28</span>  <span class='chapter-title'>Problem set 4</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps04.html#q3.-ebms-with-variable-sun",
    "href": "part-xx-exercises/ps04.html#q3.-ebms-with-variable-sun",
    "title": "28  Problem set 4",
    "section": "Q3. EBMs with variable sun",
    "text": "Q3. EBMs with variable sun\n\\(\\nextSection\\)\nSatellite data indicates that \\(Q\\), varies roughly between 341.37 W/m2 and 341.75 W/m2, with a period of about 11 years.\n\nUse the simple EBM given in (Equation 12.3) and repeated below: \\[\nQ(1 - a) = \\sigma \\gamma T^4,\n\\] with a constant albedo, \\(a = 0.3\\) and greenhouse gas factor \\(\\gamma = 0.6\\) to estimate the resultant variation (max and min) in the Earth’s mean surface temperature \\(T\\).\nSimilar to (a) but this time, use the Budyko balance equation, \\[\nQ(1 - a) = A + BT\n\\] with \\(A = 203.3 \\, \\mathrm{W} \\mathrm{m}^{-2}\\) and \\(B = 2.09 \\, \\mathrm{W}/(\\mathrm{m}^{2} \\, {}^\\circ \\mathrm{C})\\) to estimate the resultant variation in the surface temperature. Use \\(a = 0.3\\).\nThe actual variation in surface temperature is in fact less than what you computed above. Why might this be?",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>28</span>  <span class='chapter-title'>Problem set 4</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps04.html#q4.-ebms-and-phase-line-analysis",
    "href": "part-xx-exercises/ps04.html#q4.-ebms-and-phase-line-analysis",
    "title": "28  Problem set 4",
    "section": "Q4. EBMs and phase line analysis",
    "text": "Q4. EBMs and phase line analysis\n\\(\\nextSection\\)\nConsider the energy balance equation \\[\nC \\frac{\\mathrm{d}T}{\\mathrm{d}t} = Q(1 - a(T)) - \\sigma \\gamma T^4 \\equiv G(T).\n\\tag{28.1}\\] with \\(a\\) given by (Equation 12.2). Because the differential equation is autonomous, we can apply phase-line analysis in order to qualitatively understand the evolution. Below is a plot of the function \\(G\\):\n\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nQ = 342; sigma = 5.67e-8; gam = 0.6;\na = lambda T: 0.5 - 0.2*np.tanh(0.1*(T-265));\nT = np.linspace(220, 310, 100);\nG = Q*(1-a(T)) - sigma*gam*T**4\nfig, ax = plt.subplots()\nax.plot(T, G)\nax.grid(); ax.minorticks_on();\n# Customize the major grid\nax.grid(which='major', linestyle='-', linewidth='0.5', color='red')\n# Customize the minor grid\nax.grid(which='minor', linestyle=':', linewidth='0.5', color='black')\nplt.xlabel('T (in Kelvins)'); plt.ylabel('G(T)');\n\n\n\n\n\n\n\n\n\nSketch the solution \\(T(t)\\) of this equation for \\(t &gt; 0\\) if \\(T(0) = 230, 240, 260, 270\\) and \\(300\\).\nSketch the solution \\(T(t)\\) of this equation for \\(t &gt; 0\\) if \\(T(0) = 285\\). Then sketch the solution of this equation with the same initial data in the same coordinate system if \\(C\\) is twice as large. Explain your answer.\nIf \\(\\gamma\\) is decreased due to the increased greenhouse effect, the entire curve is shifted upwards. Sketch the solution if \\(T(0) = 280\\). Sketch the solution with the same initial data if \\(\\gamma\\) is decreased. Explain your answer.",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>28</span>  <span class='chapter-title'>Problem set 4</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps05.html",
    "href": "part-xx-exercises/ps05.html",
    "title": "29  Problem set 5",
    "section": "",
    "text": "Q1. Evolution\nConsider again the basic time-dependent EBM given in (Equation 28.1). Let \\(T^*\\) be a steady-state solution and set \\(T = T^* + u(t)\\) where \\(u(t)\\) is a small perturbation from the steady state.",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>29</span>  <span class='chapter-title'>Problem set 5</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps05.html#q1.-evolution",
    "href": "part-xx-exercises/ps05.html#q1.-evolution",
    "title": "29  Problem set 5",
    "section": "",
    "text": "Show that the perturbation satisfies \\[\nC \\dot{u} = -D u + O(u^2).\n\\] and hence solve for the general solution of the leading-order perturbation (ignoring quadratic terms). What are the conditions on \\(T^*\\) so that the steady state is linearly stable?\nAssuming \\(T^*\\) is linearly stable, find the typical response time to a perturbation. For instance, what is the time it takes for the perturbation to reach the value \\(u(t) = 0\\) if \\(u(0) = 1\\)? How does this response time change with \\(C\\)? What is the physical interpretation of this regarding the climate?",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>29</span>  <span class='chapter-title'>Problem set 5</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps05.html#q2.-integral-of-energy-over-the-planet",
    "href": "part-xx-exercises/ps05.html#q2.-integral-of-energy-over-the-planet",
    "title": "29  Problem set 5",
    "section": "Q2. Integral of energy over the planet",
    "text": "Q2. Integral of energy over the planet\n\\(\\nextSection\\)\nIgnoring the effects of albedo, the total radiation absorbed over the surface of the planet (per unit time) is given by \\[\n\\iint_{\\text{planet}} Qs(y=\\sin\\varphi) \\, \\mathrm{d}S.\n\\] This is what is known as a surface integral (Section 41.1). In the case of the spherical coordinate system, this is calculated by \\[\n\\int_{\\theta=0}^{2\\pi} \\int_{\\varphi = -\\pi/2}^{\\pi/2} Qs(y = \\sin\\varphi) R_E^2 \\cos\\varphi \\, \\mathrm{d}\\varphi \\mathrm{d}\\theta.\n\\] Use the properties of \\(s(y)\\) in (Equation 13.3) to conclude that the total radiation absorbed is \\(4\\pi R_E^2 Q\\).",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>29</span>  <span class='chapter-title'>Problem set 5</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps05.html#q3.-mean-temperature-in-the-latitude-dependent-ebm",
    "href": "part-xx-exercises/ps05.html#q3.-mean-temperature-in-the-latitude-dependent-ebm",
    "title": "29  Problem set 5",
    "section": "Q3. Mean temperature in the latitude-dependent EBM",
    "text": "Q3. Mean temperature in the latitude-dependent EBM\n\\(\\nextSection\\)\nConsider now the latitude-dependent EBM \\[\nC \\frac{\\mathrm{\\partial}T}{\\mathrm{\\partial}t} = Qs(y)[1 - a(y)] - (A + BT) + k(\\bar{T} - T).\n\\] Recall the albedo is given by \\(a = a_i\\) for \\(y &gt; y_s\\) and \\(a = a_w\\) for \\(y &lt; y_s\\).\n\nBy integrating the above equation over \\(y \\in [0, 1]\\), show that the mean temperature is given by \\[\nC \\frac{\\mathrm{d}\\bar{T}}{\\mathrm{d}t} = Q(1 - \\bar{a}) - (A + B\\bar{T}),\n\\tag{29.1}\\] where \\[\n\\bar{a} = \\int_0^1 s(y) a(y) \\, \\mathrm{d}y = \\alpha_w \\int_0^{y_s} s(y) \\, \\mathrm{d}y + a_i \\int_{y_s}^1 s(y) \\, \\mathrm{d}y.\n\\]\nIn the case that \\(s\\) is given by (Equation 13.3), show that \\[\n\\bar{a} = a_i + (a_w - a_i) y_s[1 - 0.241(y_s^2 - 1)].\n\\tag{29.2}\\] What is \\(\\bar{a}\\) in the two situations of a completely ice-covered world and an ice-free world?",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>29</span>  <span class='chapter-title'>Problem set 5</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps05.html#q4.-sensitivity-of-the-climate",
    "href": "part-xx-exercises/ps05.html#q4.-sensitivity-of-the-climate",
    "title": "29  Problem set 5",
    "section": "Q4. Sensitivity of the climate",
    "text": "Q4. Sensitivity of the climate\n\\(\\nextSection\\)\nConsider the equation for the global average temperature given in (Equation 29.1): \\[\nC \\frac{\\mathrm{d}\\bar{T}}{\\mathrm{d}t} = Q(1 - \\bar{a}) - (A + B\\bar{T}).\n\\] We would like to understand how the climate behaves under a small perturbation in the solar forcing. In general, though, the ‘constants’, \\(A\\), \\(B\\), and \\(\\bar{a}\\) will depend on \\(T\\). For example, their values may have been calibrated under a static situation. Therefore, let \\(A = A(T)\\), \\(B = B(T)\\), and \\(\\bar{a} = \\bar{a}(T)\\).\nBelow, we drop all bars for convenience.\n\nConsider a perturbation of the solar radiation, say \\(Q = Q_0 + \\delta\\) where \\(\\delta\\) is small in comparison to \\(Q_0\\). Expand now the temperature into a series: \\[\nT = T_0 + \\delta T_1  + \\ldots\n\\] Show that at \\(O(\\delta)\\), the perturbation is governed by \\[\nC \\frac{\\mathrm{d}T_1}{\\mathrm{d}t} = (1 - a(T_0)) - B(T_0) T_1 - A'(T_0) T_1 - T_0 B'(T_0) T_1 - Q_0 a'(T_0) T_1.\n\\]\nConsequently, show that the temperature perturbation can be written as \\[\nB(T_0) \\tau \\frac{\\mathrm{\\partial}T_1}{\\mathrm{\\partial}t} = [1 - a(T_0)]  - \\frac{B(T_0)}{g} T_1,\n\\tag{29.3}\\] where\n\n\\[\n\\begin{aligned}\n\\tau &= \\frac{C}{B(T_0)} \\\\\ng &= \\frac{1}{1-f} \\\\\nf &= f_1 + f_2 \\\\\nf_1 &= \\frac{1}{B(T_0)} \\left(-T_0 B'(T_0) - A'(T_0)\\right),\\\\\nf_2 &= \\frac{1}{B(T_0)} \\left(-Q_0 a'(T_0)\\right)\n\\end{aligned}\n\\]\nThe parameter \\(\\tau\\) measures the time scale of the climate system’s thermal inertia. It involves the thermal inertia of the atmosphere and also the much larger inertia of the oceans. The factor \\(g\\) is the climate gain; it amplifies any response to the radiative perturbation by a factor of \\(g\\). Also \\(f_1\\) incorporates the effect of water-vapor feedback and \\(f_2\\) that of ice and snow albedo feedback.\n\nConsider (Equation 29.3) at steady state, so therefore the perturbed equilibrium temperature is equal to \\[\n\\delta T_1 =  \\frac{[1 - a(T_0)] \\delta g}{B(T_0)}.\n\\] If the CO2 level in the atmosphere doubles, then the radiative forcing might be adjusted as: \\[\n(1 - a(T_0)) \\delta = 3.7 \\,  \\mathrm{W} \\cdot \\mathrm{m}^{-2}.\n\\] Assuming that the climate gain is \\(g = 3\\) and \\(B(T_0) = 1.9 \\mathrm{W} \\cdot \\mathrm{m}^{-2} \\cdot ({}^\\circ \\mathrm{C})^{-1}\\), what is the expected increase in temperature?",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>29</span>  <span class='chapter-title'>Problem set 5</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps06.html",
    "href": "part-xx-exercises/ps06.html",
    "title": "30  Problem set 6",
    "section": "",
    "text": "Q1. A van der Pol equation\nConsider the van der Pol equation for \\(x(t)\\) with \\(0 &lt; \\epsilon \\ll 1\\): \\[\n\\epsilon \\frac{\\mathrm{d}^2 x}{\\mathrm{d}t^2} + (3x^2 - 6x - 9) \\frac{\\mathrm{d}x}{\\mathrm{d}t} + 4x = 0.\n\\]",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>30</span>  <span class='chapter-title'>Problem set 6</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps06.html#q1.-a-van-der-pol-equation",
    "href": "part-xx-exercises/ps06.html#q1.-a-van-der-pol-equation",
    "title": "30  Problem set 6",
    "section": "",
    "text": "Determine \\(f(x)\\) so that this equation can be written as a Liénard phase plane system in the form \\[\n\\begin{aligned}\n\\epsilon \\dot{x} &= f(x) + 4y, \\\\\n\\dot{y} &= -x.\n\\end{aligned}\n\\]\nFor fixed \\(\\epsilon &gt; 0\\), find the equilibrium point(s) in the phase plane, find their eigenvalues, and classify their linear stability.\nUse the expansions \\(x(t) = x_0(t) + \\epsilon x_1(t) + O(\\epsilon^2)\\) to determine the equations for the leading-order slow solution. Sketch the slow manifold, indicate the directions motion on each part, and identify the two attracting points on the curve.\nUse the expansions \\(x(t) = X_0(T) + \\epsilon X_1(T) + O(\\epsilon^2)\\) and \\(y(t) = Y_0(T) + \\epsilon Y_1(T) + O(\\epsilon^2)\\) with \\(T = t/\\epsilon\\) to obtain the leading-order fast solution.\nUse the phase plane to determine the maximum and minimum values of \\(x(t)\\) during an oscillation. Sketch \\(x(t)\\) as a function of time.",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>30</span>  <span class='chapter-title'>Problem set 6</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps06.html#q2.-fast-slow-dynamics-with-three-variables",
    "href": "part-xx-exercises/ps06.html#q2.-fast-slow-dynamics-with-three-variables",
    "title": "30  Problem set 6",
    "section": "Q2. Fast-slow dynamics with three variables",
    "text": "Q2. Fast-slow dynamics with three variables\n\\(\\nextSection\\)\nConsider the limit of \\(\\epsilon \\ll 1\\) for each of the following cases.\n\nConsider the system \\[\n\\begin{aligned}[c]\n\\dot{x} &= 2 - y, \\\\\n\\dot{y} &= x-z, \\\\\n\\epsilon\\dot{z} &= y - y^2 + \\frac{1}{3}y^3 - z,\n\\end{aligned}\n\\] with the initial conditions of \\(x(0) = 1\\), \\(y(0) = 3\\), and \\(z(0) = 0\\).\n\n\nIdentify the surface \\(z = S(x, y)\\) that defines the slow manifold.\nFind the equilibrium point of the leading-order slow phase plane system and show that it is asymptotically stable for \\(t \\to \\infty\\).\nAlso determine the form of the initial layer that describes the transition from the initial conditions to the slow manifold.\n\n\nConsider the system \\[\n\\begin{aligned}[c]\n\\dot{x} &= 2 - y, \\\\\n\\epsilon\\dot{y} &= x-z, \\\\\n\\dot{z} &= y - y^2 + \\frac{1}{3}y^3 - z,\n\\end{aligned}\n\\] with the initial conditions of \\(x(0) = 0\\), \\(y(0) = 3\\), and \\(z(0) = 1\\).\n\n\nShow that the slow manifold reduces to a curve that could be written in parametric form as \\(x = x(z), y = y(z), z = z\\).\nDetermine the asymptotic solution for \\(t \\to \\infty\\).\nAlso determine the form of the initial layer that describes the transition from initial conditions to the slow manifold.",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>30</span>  <span class='chapter-title'>Problem set 6</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps06.html#q3.-visualising-fast-slow-dynamics",
    "href": "part-xx-exercises/ps06.html#q3.-visualising-fast-slow-dynamics",
    "title": "30  Problem set 6",
    "section": "Q3. Visualising fast-slow dynamics",
    "text": "Q3. Visualising fast-slow dynamics\n\\(\\nextSection\\)\nBy modifying the standard scripts developed in lectures, plot visualisations of Q1 and Q2(a) in order to verify your understanding of the fast-slow dynamics.",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>30</span>  <span class='chapter-title'>Problem set 6</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps07.html",
    "href": "part-xx-exercises/ps07.html",
    "title": "31  Problem set 7",
    "section": "",
    "text": "Q1. Non-dimensionalisation of the Stommel box model\nConsider the Stommel box model given in (Equation 23.1). By following the procedure outlined in Section 23.1 non-dimensionalise the model in order to produce the set of equations given in (Equation 23.2), repeated here: \\[\n\\begin{aligned}\n\\frac{\\mathrm{d}x}{\\mathrm{d}t} &= \\delta(1 - x) - |f(x, y)|x, \\\\\n\\frac{\\mathrm{d}y}{\\mathrm{d}t} &= 1 - y - |f(x, y)|y,\n\\end{aligned}\n\\] where we have introduced the function, \\[\nf(x, y; R, \\lambda) = \\frac{1}{\\lambda}(Rx - y).\n\\]\nProvide a brief description of the physical interpretations of the parameters \\(\\lambda\\), \\(\\delta\\), and \\(R\\).",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>31</span>  <span class='chapter-title'>Problem set 7</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps07.html#q2.-investigations-for-r",
    "href": "part-xx-exercises/ps07.html#q2.-investigations-for-r",
    "title": "31  Problem set 7",
    "section": "Q2. Investigations for \\(R\\)",
    "text": "Q2. Investigations for \\(R\\)\n\\(\\nextSection\\)\nUsing the script available on Noteable, investigate the behaviour of the system in the above question under changing values of \\(R\\) and fixed values of the other parameters. Based on your intuition, what do you expect to be the features of the bifurcation diagram, as shown in the \\((R, f)\\)-plane?",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>31</span>  <span class='chapter-title'>Problem set 7</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps07.html#q3.-alternative-scalings-of-the-stommel-box-model",
    "href": "part-xx-exercises/ps07.html#q3.-alternative-scalings-of-the-stommel-box-model",
    "title": "31  Problem set 7",
    "section": "Q3. Alternative scalings of the Stommel box model",
    "text": "Q3. Alternative scalings of the Stommel box model\n\\(\\nextSection\\)\nIt is possible to scale the problem differently, and this may allow for simpler analysis. Consider the set of equations in Q2. Write instead \\[\nx = [x] s, \\qquad y = [y] \\theta, \\qquad t = [t] t',\n\\] Choose the correct scalings, \\([x]\\), \\([y]\\), and \\([t]\\), so that we obtain a re-scaled version: \\[\n\\begin{aligned}\n\\frac{\\mathrm{d}s}{\\mathrm{d}t'} &= 1 - (\\epsilon + |q|) s, \\\\\n\\frac{\\mathrm{d}\\theta}{\\mathrm{d}t'} &= 1 - (\\mu + |q|)\\theta,\n\\end{aligned}\n\\]\nwhere now the flow term is given by \\[\nq = \\kappa(-\\theta + \\tilde{R}s).\n\\] In addition to the choice of scalings, you will need to describe how the new parameters, \\(\\epsilon\\), \\(\\mu\\), \\(\\kappa\\), and \\(\\tilde{R}\\), are related to the older parameters.",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>31</span>  <span class='chapter-title'>Problem set 7</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps07.html#q4.-box-models-for-flooding-1",
    "href": "part-xx-exercises/ps07.html#q4.-box-models-for-flooding-1",
    "title": "31  Problem set 7",
    "section": "Q4. Box models for flooding 1",
    "text": "Q4. Box models for flooding 1\n\\(\\nextSection\\)\nConsider the basic flooding model given in (Equation 24.1), and repeated below: \\[\n\\frac{\\mathrm{d}S}{\\mathrm{d}t} = P(t) - P(t)H(S - S_{\\text{max}}) - E_p(t) \\frac{S}{S_{\\text{max}}}.\n\\] Consider the initial condition of \\(S(0) = S_0 \\geq 0\\), and a constant rainfall \\(P(t) = P\\) and constant potential evapotranspiration \\(E_p(t) = E_p\\). Describe, using analysis, the evolution of the system.\nDraw graphs of the storage, \\(S\\), and saturation excess runoff \\(Q_{se}\\) (the second term of the above equation).",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>31</span>  <span class='chapter-title'>Problem set 7</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps07.html#q5.-box-models-for-flooding-2",
    "href": "part-xx-exercises/ps07.html#q5.-box-models-for-flooding-2",
    "title": "31  Problem set 7",
    "section": "Q5. Box models for flooding 2",
    "text": "Q5. Box models for flooding 2\n\\(\\nextSection\\)\n\n\n\n\n\n\nNote\n\n\n\nTo add following lectures in Week 11",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>31</span>  <span class='chapter-title'>Problem set 7</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps01sol.html",
    "href": "part-xx-exercises/ps01sol.html",
    "title": "32  Problem set 1 solutions",
    "section": "",
    "text": "Q1 The bump lemma\nProve the following one-dimensional lemma, which was used in the derivation of the heat equation.\nIf \\(\\int_a^b g(x) \\, \\mathrm{d}x = 0\\) for all \\(a\\) and \\(b \\in [0, 1]\\), then \\(g(x) \\equiv 0\\) for all \\(x\\in [0, 1]\\).\nHint: think of a proof by contradiction.",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>32</span>  <span class='chapter-title'>Problem set 1 solutions</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps01sol.html#q1-the-bump-lemma",
    "href": "part-xx-exercises/ps01sol.html#q1-the-bump-lemma",
    "title": "32  Problem set 1 solutions",
    "section": "",
    "text": "Solution\n\n\n\n\n\nAssume by contradiction that \\(f(x) \\neq 0\\) between two arbitrary points, say \\(x_0\\) and \\(x_1\\), both in the interval \\([a, b]\\). Then \\(\\int_{x_0}^{x_1} f(x) \\mathrm{d}x \\neq 0\\). This assumes some degree of smoothness and integrability (as long as \\(f\\) is not too pathological).",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>32</span>  <span class='chapter-title'>Problem set 1 solutions</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps01sol.html#q2.-a-source-in-the-heat-equation",
    "href": "part-xx-exercises/ps01sol.html#q2.-a-source-in-the-heat-equation",
    "title": "32  Problem set 1 solutions",
    "section": "Q2. A source in the heat equation",
    "text": "Q2. A source in the heat equation\n\\(\\nextSection\\)\nConsider the same heat experiment discussed in Chapter 1 but now consider a bar that has an internal source or sink generating or removing heat, such as the case of a boiler with an internal heating element. By adapting a similar derivation to the one presented, explain why the modified conservation of heat equation is \\[\n\\frac{\\mathrm{\\partial}}{\\mathrm{\\partial}t} \\int_a^b \\rho c T \\, \\mathrm{d}x = q(x = a, t) - q(x = b, t) + \\int_a^b R(x, t) \\, \\mathrm{d}x.\n\\]\nIn addition:\n\nBy studying the dimensions of the other terms in the above equation, find what the dimensions of \\(R\\) are. What does \\(R &gt; 0\\) mean and \\(R &lt; 0\\)?\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\nOn the left, density has units kg/m^3, specific heat J/(kg K), and temperature K. But then dx has units of m. And d/dt has units of 1/s. So altogether, we have the following SI units on the left: \\[\n\\frac{J}{m^2 \\cdot s}\n\\]\nSo its energy per unit area per unit time. The reason why it’s per unit area is because you have not integrated over the sides of the cylinder/bar.\nSo therefore this needs to match the units on the right, which are [R] [dx]. So you conclude that \\[\n[R] = \\frac{J}{m^3 \\cdot s}\n\\] i.e. energy per unit time per unit volume. This is energy density.\nR &gt; 0 means heat is added into the system (source). R &lt; 0 means heat is removed from the system (sink).\n\n\n\n\nHence derive the partial differential equation that governs the temperature \\(T\\).\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\nThe derivation follows exactly as in the notes, except you have an additional term on the RHS. Use Fourier’s law to convert \\(q = -k \\partial T/\\partial x\\). Write everything under the integral and this yields: \\[\n\\rho c \\frac{\\mathrm{\\partial}T}{\\mathrm{\\partial}t} = k \\frac{\\mathrm{\\partial}^2 T}{\\mathrm{\\partial}x^2} + R.\n\\]\n\n\n\n\nBy introducing the appropriate scalings on each of the variables, \\(x\\), \\(t\\), and \\(T\\), non-dimensionalise the PDE and discuss the non-dimensional parameters (there will be two).\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\nSame derivation as in the notes. Let \\[\nx = L x', T = [T]T' \\quad \\text{and} \\quad t = [t]t'.\n\\] This time you will remember to scale out the typical source strength, so \\[\nR = [R]R'.\n\\]\nThis leads to \\[\n\\frac{\\mathrm{\\partial}T'}{\\mathrm{\\partial}t'}\n= \\left(\\frac{k[t]}{L^2 \\rho c}\\right) \\frac{\\mathrm{\\partial}^2 T'}{\\mathrm{\\partial}x'^2} + \\left(\\frac{[R][t]}{\\rho c [T]}\\right)R'.\n\\] So this gives the two sets of non-dimensional numbers\n\\[\\begin{align}\n\\Pi_1 &= \\frac{k[t]}{L^2 \\rho c} \\\\\n\\Pi_2 &= \\frac{[R][t]}{\\rho c [T]}.\n\\end{align}\\]\nIf you want, you can write it in the alternative form by taking the time scaling to be \\([t] = L/U\\), where \\(U\\) is some unspecified velocity scale.\nFor the interpretation, you can simply take \\(\\Pi_1\\) to be a measure of diffusive effects (heat spreading out) and \\(\\Pi_2\\) to be a measure of source strength. Note that this problem can be simplified even further by choosing the time scale so as to set \\(\\Pi_1 = 1\\). If you do this, you will be left with a single non-dimensional parameter that balances diffusion with the strength of the source.",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>32</span>  <span class='chapter-title'>Problem set 1 solutions</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps01sol.html#q3.-choice-of-scalings",
    "href": "part-xx-exercises/ps01sol.html#q3.-choice-of-scalings",
    "title": "32  Problem set 1 solutions",
    "section": "Q3. Choice of scalings",
    "text": "Q3. Choice of scalings\n\\(\\nextSection\\)\nConsider the dimensional problem for the motion of a projectile launched from close to the surface of the Earth. The dimensional height of the projectile, \\(y(t)\\), is given by \\[\\begin{align}\n\\frac{\\mathrm{d}^2 y}{\\mathrm{d}t^2} &= - \\frac{GM}{(R+y)^2}, \\\\\ny(0) &= 2 \\, \\mathrm{m}, \\\\\ny'(0) &= -V_0 \\, \\mathrm{m/s}.\n\\end{align}\\] Assume that the Earth is spherical and of uniform density, with its mass given by \\(M = (4/3) \\pi R^3 \\rho\\). Non-dimensionalise the height using \\(y = L \\tilde{y}\\) and time using \\(t = T\\tilde{t}\\). Consider the following cases:\n\n\\(R\\) fixed, \\(V_0 \\to \\infty\\), \\(\\rho\\) fixed;\n\\(R\\) fixed, \\(V_0\\) fixed, \\(\\rho \\to \\infty\\);\n\\(R\\) fixed, \\(V_0\\) fixed, \\(\\rho \\to 0\\);\n\\(R \\to 0\\), \\(V_0\\) fixed, \\(M\\) fixed.\n\n\n\n\n\n\n\nNB!\n\n\n\nThis problem ended up a lot longer than expected. Nevertheless do at least of the few cases to get a feel.\n\n\nFor each case:\n\nExplain the physical interpretation of the limits.\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n\nVery fast initial velocity\nVery heavy object\nVery light object\nVery small Earth radius\n\n\n\n\n\nChoose the scalings \\(L\\) and \\(T\\) to normalise as many terms as possible.\nChoose the scalings so that the time it takes for the projectile to fall should be finite for the given limit, and for the speed, acceleration, and initial height to be well behaved (finite).\nWrite out the scaled problem and identify all remaining nondimensional parameters.\nIdentify the limiting small parameter for each case. Write out the problem (leading-order problem) when the parameter is set to zero.\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\nThe solution for parts (b) to (d) is given below. The solution for part (e) is simply setting \\(\\epsilon = 0\\) in each case.",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>32</span>  <span class='chapter-title'>Problem set 1 solutions</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps01sol.html#q4.-the-unique-timescale-in-the-heat-equation",
    "href": "part-xx-exercises/ps01sol.html#q4.-the-unique-timescale-in-the-heat-equation",
    "title": "32  Problem set 1 solutions",
    "section": "Q4. The unique timescale in the heat equation",
    "text": "Q4. The unique timescale in the heat equation\n\\(\\nextSection\\)\nDuring our investigation of the heat equation, we found that it was possible to scale time so as to scale out the only non-dimensional parameter that appears in the PDE. As explained in lectures, the disappearance of all non-dimensional parameters is due to the fact that only a single sensible timescale exists.\nBy adjusting the boundary conditions, we may create a new problem involving heat flow where a unique ‘special’ timescale can no longer be chosen.\nConsider a system where one side of the rod is heated in some periodic fashion, e.g. set the initial and boundary conditions to be \\[\\begin{align}\nT(x, 0) &= T_0 \\\\\nT(0, t) &= T_a \\cos (\\omega t), \\\\\nT(L, t) &= T_b.\n\\end{align}\\]\n\nWhat must the units of \\(\\omega\\) be?\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\nNote \\(\\omega t\\) must be unitless. Therefore \\([\\omega] = 1/s\\).\n\n\n\n\nNon-dimensionalise as usual and, without selecting the timescale, \\([t]\\), identify the key non-dimensional parameters that remain. Write a brief sentence to describe their physical interpretation.\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\nThis is exactly the same as in the above heat question. You will still obtain\n\\[\n\\frac{\\mathrm{\\partial}T'}{\\mathrm{\\partial}t'}\n= \\Pi_1 \\frac{\\mathrm{\\partial}^2 T'}{\\mathrm{\\partial}x'^2}\n\\] where the non-dimensional parameters is the Peclet number introduced in lectures: \\[\n\\Pi_1 = \\left(\\frac{k[t]}{L^2 \\rho c}\\right).\n\\]\nThe main difference is that now, your boundary conditions are \\[\nT'(0, t') = \\Pi_3 \\cos (\\Pi_2 t') \\quad \\text{and} \\quad\nT'(1, t') = \\Pi_4\n\\] where \\[\n\\Pi_2 = \\omega [t], \\qquad \\Pi_3 = \\frac{T_a}{T_0}, \\qquad Pi_4 = T_b/T_0.\n\\]\nThe scaling on the temperature was taken to be such that the final initial condition is set to unity: \\[\nT'(x', 0) = 1.\n\\]\n\n\n\n\nThere are two sensible choices for setting the timescale, \\([t]\\). Identify the two choices and present the reduced set of equations in each case.\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\nSo there are now two ways of choosing the time scale. Either choose it to set \\(\\Pi_1 = 1\\) or choose it to set \\(\\Pi_2 = 1\\). In the former choice, you are choosing to set time according to the diffusive rate. In the latter, you are setting time according to how the boundary is heated.",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>32</span>  <span class='chapter-title'>Problem set 1 solutions</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps01sol.html#q5.-timescale-in-the-surface-energy",
    "href": "part-xx-exercises/ps01sol.html#q5.-timescale-in-the-surface-energy",
    "title": "32  Problem set 1 solutions",
    "section": "Q5. Timescale in the surface energy",
    "text": "Q5. Timescale in the surface energy\n\\(\\nextSection\\)\nTake the basic zero-dimensional energy model studied in (Equation 3.7) for the temperature of the troposphere: \\[\nc \\frac{\\mathrm{d}T}{\\mathrm{d}t} = \\frac{1}{4} Q(1 - a) - \\sigma \\gamma T^4.\n\\]\n\nNon-dimensionalise the model by choosing \\(T = [T]T'\\), \\(t = [t]t'\\), and \\(Q = [Q]Q'\\). Show that it is possible to select the scalings on the temperature and time so as to completely remove all constants from the problem when \\(Q\\) is assumed to be constant.\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\nThe question’s suggestion of setting \\(Q = [Q]Q'\\) was excessive since \\(Q\\) is just a constant in this case. So proceeding as usual:\nSet in the scalings. This time it is easier to balance the right had-side first. \\[\n\\frac{c[T]}{[t']}\\frac{\\mathrm{\\partial}T'}{\\mathrm{\\partial}t'} = \\left(\\frac{Q(1-a)}{4}\\right) - \\left(\\sigma \\gamma [T]^4\\right) T'^4.\n\\] So select the temperature scaling so that both coefficients on the RHS are equal. \\[\n[T] = \\left(\\frac{Q(1-a)}{4\\sigma \\gamma}\\right)^{1/4}.\n\\] Now choose the time scaling also to match the LHS coefficient to the RHS coefficient. \\[\nc \\frac{[T]}{[t]} = \\sigma \\gamma [T]^4 \\Longrightarrow\n[t] = \\frac{c}{\\sigma \\gamma [T]^4}\n\\] Once you have done this, the equation transforms to the one given in part b.\n\n\n\n\nThus, show that the analysis of the above equation is equivalent to studying \\[\n\\frac{\\mathrm{d}T}{\\mathrm{d}t} = 1 - T^4,\n\\] where we have dropped the primes and assumed that the albedo is such that \\(1 - a \\neq 0\\).\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\nDone above.\n\n\n\n\nFrom your choice of \\([t]\\), estimate the typical dimensional value using \\(d \\approx 10 \\mathrm{km}\\), \\(\\rho \\approx 1 \\mathrm{kg} \\,\\mathrm{m}^{-3}\\), \\(c_p \\approx 10^3 \\mathrm{J} \\,\\mathrm{kg}^{-1} \\,\\mathrm{K}^{-1}\\).\n\nUse a pocket calculator to verify your calculations and conclude that this time-scale is on the order of a month. What is the relevance of this approximation as it concerns the steady-state solution?\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\nBelow (Equation 3.7), we defined \\(C = \\rho c_p d\\). So the scaling on time is (put in the scaling for [T]): \\[\n[t] = \\left(\\frac{4}{(1-a)}\\right)^{3/4} \\left(\\frac{C}{(\\sigma \\gamma)^{1/4} Q^{3/4}}\\right).\n\\]\nSo we know that \\(\\sigma = 5.67 \\times 10^{-8}\\) J/(m^2 s K^4), \\(Q = 1.38 \\times 10^3\\) J/(m^2 s). We can also calculate \\[\nC = \\rho c_p d = 10^7 J/(K \\cdot m^2).\n\\]\nWe can use \\(\\gamma = 1\\) for an estimate. The right-most factor is \\[\n\\frac{10^7}{(5.67 \\times 10^{-8})^{1/4} (1.378 \\times 10^3)^{3/4}} s = 2.88 \\times 10^6 s\n\\]\nIf we use a = 0.3 then this gives a total of \\[\n[t] = 3.7 \\times 2.88 \\times 10^6 s.\n\\] To convert to days, note 1 day = 24 hours = 2460 minutes = 2460*60 seconds. This is then \\[\n[t] = \\frac{1.65 \\times 10^7}{8.64 \\times 10^4} \\text{days} = 0.19 \\times 10^3 \\text{days} = 190 \\text{days}.\n\\] So on the order of 6 months. Any answer you get that’s roughly on the order of months sounds about right. This is the rough approximation of how long time-scale effects take to appear.",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>32</span>  <span class='chapter-title'>Problem set 1 solutions</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps02sol.html",
    "href": "part-xx-exercises/ps02sol.html",
    "title": "33  Problem set 2 solutions",
    "section": "",
    "text": "33.1 Getting started with Jupyter",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>33</span>  <span class='chapter-title'>Problem set 2 solutions</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps02sol.html#getting-started-with-jupyter",
    "href": "part-xx-exercises/ps02sol.html#getting-started-with-jupyter",
    "title": "33  Problem set 2 solutions",
    "section": "",
    "text": "Note\n\n\n\nN/A",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>33</span>  <span class='chapter-title'>Problem set 2 solutions</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps02sol.html#testing-the-solutions-of-a-cubic",
    "href": "part-xx-exercises/ps02sol.html#testing-the-solutions-of-a-cubic",
    "title": "33  Problem set 2 solutions",
    "section": "33.2 Testing the solutions of a cubic",
    "text": "33.2 Testing the solutions of a cubic\n\\(\\nextSection\\)\n\n\n\n\n\n\nNote\n\n\n\nSee notebook/ps2_sol.ipynb notebook for the code.",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>33</span>  <span class='chapter-title'>Problem set 2 solutions</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps02sol.html#analysis-of-singular-cubic-equation",
    "href": "part-xx-exercises/ps02sol.html#analysis-of-singular-cubic-equation",
    "title": "33  Problem set 2 solutions",
    "section": "33.3 Analysis of singular cubic equation",
    "text": "33.3 Analysis of singular cubic equation\n\\(\\nextSection\\)\nConsider the cubic equation \\[\n\\epsilon x^3 - x + 1 = 0,\n\\] with \\(\\epsilon \\ll 1\\) and \\(\\epsilon &gt; 0\\).\n\nDevelop the first three terms of an asymptotic expansion about the root by setting \\[\nx = x_0 + \\epsilon x_1 + \\epsilon^2 x_2 + \\ldots\n\\]\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\nSubstitution into the cubic gives \\[\n\\epsilon (x_0^3 + 3 x_0 x_1 + \\ldots) - (x_0 + \\epsilon x_1 + \\epsilon^2 x_2) + 1 = 0.\n\\] Equating at each order and solving gives \\[\\begin{gather}\n-x_0 + 1 = 0 \\Longrightarrow x_0 = 1 \\\\\nx_0^3 - x_1 = 0 \\Longrightarrow x_1 = 1 \\\\\n3x_0 x_1 - x_2 = 0 \\Longrightarrow x_2 = 3\n\\end{gather}\\] So the three-term approximation is \\[\nx \\sim 1 + \\epsilon + 3 \\epsilon^2.\n\\]\n\n\n\n\nFill out the following table.\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n| $\\epsilon$ | $x_{\\text{exact}}$ | $x_{\\text{exact}} - x_0$ |\n| -----------| -------------------|--------------------------|\n| 0.1 | 1.1535 | 0.1535 |\n| 0.08 | 1.1092 | 0.1092 |\n| 0.06 | 1.0744 | 0.0744 |\n| 0.04 | 1.0457 | 0.0457|\n| 0.02 |1.0213 | 0.0213 |\nThis is a really excellent demonstration of an ‘organic’ discovery process. Below we plot the errors we found in the above table. I rounded the values to only the first two decimals. It is not so important to be extremely accurate (in fact, this is the point of requiring you to do so by hand!)\n\n\n\n\n\n\nFigure 33.1: Hand drawn image\n\n\n\nWhen doing this, I tried to fit to a line because I knew the error was supposed to be \\[\nx - x_0 \\sim \\epsilon\n\\] so was expecting a line of unit gradient. But the gradient estimated above was a bit higher, at 1.6. Returning to Python, we see the problem.\n\n\n\n\n\n\nFigure 33.2: Python image\n\n\n\nSo over the range investigated of \\(0.02 &lt; \\epsilon &lt; 0.1\\), the behaviour is quadratic.This is a nice lesson on how to discover new results based on computation and analysis.\n\n\n\n\nBy rescaling \\(x\\) appropriately in terms of \\(\\epsilon\\), derive the first three terms of the asymptotic approximations of the remaining roots.\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\nWe expect the critical scaling to balance \\(\\epsilon x^3\\) with \\(x\\) since these two will be dominant when \\(x\\) is large. So we set \\[\nx = \\frac{X}{\\sqrt{\\epsilon}}\n\\]\nNow we have \\[\nX^3 - X + \\sqrt{\\epsilon} = 0.\n\\]\nYou will notice that the progression here should go in powers of \\(\\epsilon^{1/2}\\). Alternatively set \\(\\delta = \\epsilon^{1/2}\\) and now the problem is standard in \\(\\delta\\): \\[\nX^3 - X + \\delta = 0.\n\\] And we expand \\[\nX = X_0 + \\delta X_1 + \\delta^2 X_2 + \\ldots\n\\] We get \\[\\begin{gather}\nX_0^3 - X_0 = 0 \\Longrightarrow X_0^2 = 1 \\Longrightarrow X_0 = \\pm 1 \\\\\n3 X_0^2 X_1 - X_1 + 1 = 0 \\Longrightarrow X_1 = -\\frac{1}{2} \\\\\n3 X_0^2 X_2 + 3 X_0 X_1^2 - X_2 = 0 \\Longrightarrow X_2 = \\mp \\frac{3}{8}.\n\\end{gather}\\] So it seems that the three-term approximation for the other two roots is \\[\nx \\sim \\frac{1}{\\sqrt{\\epsilon}} \\left(\\pm 1 - \\sqrt{\\epsilon} \\frac{1}{2} \\mp \\epsilon \\frac{3}{8}\\right).\n\\]",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>33</span>  <span class='chapter-title'>Problem set 2 solutions</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps02sol.html#a-damped-projectile-problem",
    "href": "part-xx-exercises/ps02sol.html#a-damped-projectile-problem",
    "title": "33  Problem set 2 solutions",
    "section": "33.4 A damped projectile problem",
    "text": "33.4 A damped projectile problem\n\\(\\nextSection\\)\nIf air resistance is included, then the non-dimensional toy model is instead \\[\\begin{gather}\n\\frac{\\mathrm{d}^2 y}{\\mathrm{d}t^2} = - \\frac{1}{(1 + \\epsilon y)^2} - \\frac{\\alpha}{(1 + \\epsilon y)} \\frac{\\mathrm{d}y}{\\mathrm{d}t}, \\\\\ny(0) = 0, \\\\\ny'(0) = 1.\n\\end{gather}\\] where \\(\\alpha \\geq 0\\) is the parameter that controls air resistance.\n\nBegin by assuming that \\(\\alpha\\) is a fixed number and consider the limit where \\(\\epsilon \\ll 1\\). Find a one-term asymptotic expansion of the solution for small \\(\\epsilon\\).\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\nFirst, note that \\[\n(1 + \\epsilon y)^{\\alpha} = 1 + \\alpha (\\epsilon y) + O(\\epsilon y)^2.\n\\]\nYou will not need more terms than that. Substitute \\(y = y_0(t) + \\epsilon y_1(t) + \\ldots\\) into the equation. This gives, for the leading terms \\[\\begin{gather}\ny_0'' = -1 - \\alpha y_0' \\\\\ny_0(0) = 0 \\\\\ny_0'(0) = 1\n\\end{gather}\\] To solve this, you will need to refresh your memory on second-order differential equations learned in 2nd year. You can see Chapter 39 for references. To solve this set \\(y_0 = e^{rt}\\) and solve for \\(r\\) for the homogeneous equation. You will get \\[\ny_{\\text{homogeneous}} = (c_1 + c_2 e^{-\\alpha t}).\n\\] From here, we need a particular solution. This can be obtained by guessing (also see this reference). If we guess \\[\ny_p = C t,\n\\] we see that \\[\ny_p'' + \\alpha y_p' = \\alpha C = -1\n\\] implies \\(C = -1/\\alpha\\). Therefore the general solution is \\[\ny_0 = (c_1 + c_2 e^{-\\alpha t}) - \\frac{t}{\\alpha}.\n\\] We now select the constants to satisfy the initial conditions. This yields \\[\nc_1 + c_2 = 0 \\quad \\text{and} \\quad\n-\\alpha c_2 - 1/\\alpha = 1,\n\\] from which the solution can be easily derived. It is \\[\ny(t) \\sim \\left(\\frac{1}{\\alpha^2} + \\frac{1}{\\alpha}\\right) - \\left(\\frac{1}{\\alpha^2} + \\frac{1}{\\alpha}\\right)e^{-\\alpha t} - \\frac{t}{\\alpha}.\n\\]\nThe solution of \\(y_1\\) proceeds in the same way, but since we did not anticipate that this question would be so algebraically involved, we will not require solving for \\(y_1\\). This can be left as an exercise if you so wish.\n\n\n\n\n(Challenging) Is the effect of the air resistance to increase or decrease the flight time? Justify based on your analytical solution.\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\nThe above solution seems quite strange. After all, when \\(\\alpha = 0\\), we know that parabolic motion is expected. We found previously that \\[\ny_{\\alpha = 0}(t) \\sim -\\frac{1}{2}t^2 + t.\n\\] which matches our intuition about the expected flight being parabolic. However, notice that if \\(\\alpha\\) is small, we can expand the exponential, \\(e^{-\\alpha t} = 1 - \\alpha t + \\ldots\\). Substitution into the derived formula for \\(y_0\\) gives \\[\n\\color{blue}y(t) \\sim \\left(\\frac{1}{\\alpha^2} + \\frac{1}{\\alpha}\\right) - \\left(\\frac{1}{\\alpha^2} + \\frac{1}{\\alpha}\\right)\\left[1 - \\alpha t + \\ldots\\right] - \\frac{t}{\\alpha}.\n\\] We can now simplify the expression and we see that the \\(\\alpha \\to 0\\) limit is not problematic, because it now becomes: \\[\ny_0 \\sim \\left(-\\frac{1}{2}t^2 + t\\right) + \\alpha \\frac{1}{6} \\left(-3t^2 + t^3\\right) + O(\\alpha^2),\n\\] and the previous terms that we believed might tend to infinity as \\(\\alpha \\to 0\\) cancel. Inspecting the above solution, notice that the leading-order result agrees with the previously derived result for \\(\\alpha = 0\\). The next term shows the small effect of drag.\nYou can simply plot the curves and show the difference.\n\n\n\n\n\n\nFigure 33.3: With (solid) and without damping (dashed)\n\n\n\n\n\n\nNotice that the dashed line brings down the parabolic path initially.",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>33</span>  <span class='chapter-title'>Problem set 2 solutions</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps02sol.html#ode-solvers-and-eulers-method",
    "href": "part-xx-exercises/ps02sol.html#ode-solvers-and-eulers-method",
    "title": "33  Problem set 2 solutions",
    "section": "33.5 ODE solvers and Euler’s method",
    "text": "33.5 ODE solvers and Euler’s method\n\\(\\nextSection\\)\nReturn to the setup of the above question.\n\nModify the script shown in Section 6.2 in order to solve the equation from the previous question at a prescribed value of \\(\\epsilon\\) and \\(\\alpha\\).\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\nThis is found in problemsets/sol02_solutions.ipynb.\n\n\n\n\nUsing a pocket calculator (or your phone calculator) apply Euler’s method with \\(\\Delta t = 0.2\\), \\(\\epsilon = 0.2\\), and \\(\\alpha = 1\\) to determine the position of the projectile at \\(t = 0.6\\).\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\nEuler’s method is simply \\[\nY_{n+1} = Y_n + F(t_n, y_n)\\Delta t.\n\\] Here \\[\nF = \\begin{pmatrix}\ny' \\\\\n-\\frac{1}{(1 + \\epsilon y)^2} - \\frac{\\alpha}{(1 + \\epsilon y)}\n\\end{pmatrix}.\n\\]\nWe split the time steps into {0, 0.2, 0.4, 0.6}. We also round to two figures.\n\n\n\nt\nY\n\\(1 + \\epsilon y\\)\nF\n\\(F \\Delta t\\)\n\n\n\n\n0\n(0, 1)\n1\n(1, -2)\n(0.2, -0.4)\n\n\n0.2\n(0.2, 0.6)\n1.04\n(0.6, -1.5)\n(0.12, -0.3)\n\n\n0.4\n(0.32, 0.3)\n1.06\n(0.3, -1.16)\n(0.06, -0.23)\n\n\n0.6\n(0.38, 0.07)\n\n\n\n\n\n\nAfter three iterations, we get a value of \\(y(0.6) \\approx 0.38\\).\n\n\n\n\nCompare your hand calculation with the result from the Python output, as well as with your asymptotic approximations.\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\nWe have (rounded to two digits) \\[\n\\begin{aligned}\ny_{\\text{exact numerical}} \\approx 0.31 \\\\\ny_{\\text{euler}} \\approx 0.38 \\\\\ny_{\\text{asym}} \\approx 0.30\n\\end{aligned}\n\\]",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>33</span>  <span class='chapter-title'>Problem set 2 solutions</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps03sol.html",
    "href": "part-xx-exercises/ps03sol.html",
    "title": "34  Problem set 3 solutions",
    "section": "",
    "text": "34.1 Conversion to first-order system\nBy using the procedure reviewed in Section 6.2, convert (Equation 27.1) to a first-order system of equations.",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>34</span>  <span class='chapter-title'>Problem set 3 solutions</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps03sol.html#conversion-to-first-order-system",
    "href": "part-xx-exercises/ps03sol.html#conversion-to-first-order-system",
    "title": "34  Problem set 3 solutions",
    "section": "",
    "text": "Solution\n\n\n\n\n\nIntroduce \\(u(z) = T(z)\\) and \\(v(z) = T'(z)\\). Then \\[\n\\frac{\\mathrm{d}}{\\mathrm{d}z}\\begin{pmatrix}\nu \\\\\nv\n\\end{pmatrix} =\n\\begin{pmatrix}\nv \\\\\n-\\frac{1}{\\epsilon} (2v + u)\n\\end{pmatrix}\n\\]",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>34</span>  <span class='chapter-title'>Problem set 3 solutions</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps03sol.html#numerical-solutions",
    "href": "part-xx-exercises/ps03sol.html#numerical-solutions",
    "title": "34  Problem set 3 solutions",
    "section": "34.2 Numerical solutions",
    "text": "34.2 Numerical solutions\n\\(\\nextSection\\)\n\n\n\n\n\n\nSolution\n\n\n\n\n\nA script can be found in problemsets/ps03_solutions.ipynb",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>34</span>  <span class='chapter-title'>Problem set 3 solutions</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps03sol.html#investigation-of-the-boundary-layer",
    "href": "part-xx-exercises/ps03sol.html#investigation-of-the-boundary-layer",
    "title": "34  Problem set 3 solutions",
    "section": "34.3 Investigation of the boundary layer",
    "text": "34.3 Investigation of the boundary layer\n\\(\\nextSection\\)\nUsing your code, use the following command in order to investigate the maxima \\((x_m, T_m)\\) as \\(\\epsilon\\) varies:\nind = np.argmax(Y[0])\nprint(ep, z[ind], Y[0, ind])\nYou may want to consider, as an example, the values \\(\\epsilon = \\{0.05, 0.1, 0.15, 0.2\\}\\) and fill the following table.\n\n\n\n\\(\\epsilon\\)\n\\(z_m\\)\n\\(T_m\\)\n\n\n\n\n0.05\n0.1122\n1.5479\n\n\n0.1\n0.1924\n1.4742\n\n\n0.15\n0.2605\n1.4094\n\n\n0.2\n0.3226\n1.3501\n\n\n\nCreate a plot of \\((\\epsilon, x_m)\\) and discuss the observed trend and its implications.\n\n\n\n\n\n\nSolution\n\n\n\n\n\n\n\n\n\n\n\nFigure 34.1: A plot of the above data. This looks linear, and indeed this provides numerical confirmation that the boundary layer should be sized with \\(\\epsilon\\)",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>34</span>  <span class='chapter-title'>Problem set 3 solutions</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps03sol.html#outer-asymptotic-solutions",
    "href": "part-xx-exercises/ps03sol.html#outer-asymptotic-solutions",
    "title": "34  Problem set 3 solutions",
    "section": "34.4 Outer asymptotic solutions",
    "text": "34.4 Outer asymptotic solutions\n\\(\\nextSection\\)\nBegin by setting \\[\nT = T_{\\text{outer}} = T_0(z) + \\epsilon T_1(z) + \\epsilon^2 T_2(z) + \\ldots\n\\] Substitute the above expansion into the system and solve for the first two orders.\nYou may verify that the solution is given by\n\\[\\begin{align}\nT_0 &= e^{1/2} e^{-z/2}, \\\\\nT_1 &= -\\frac{1}{8} e^{1/2} e^{-z/2} (z - 1).\n\\end{align}\\]\n\n\n\n\n\n\nSolution\n\n\n\n\n\nRemember: as you solve the outer solution, you impose the boundary condition of \\(T(1) = 1\\).\nLeading-order: at leading order, we get the problem \\(2T_0' + T_0 = 0\\) subject to \\(T_0(1) = 1\\). This is solved either by separation of variables or by integrating factor. Using the technique of solving first-order linear equations, (see Chapter 39) we divide, \\[\nT_0' + \\frac{1}{2}T_0 = 0.\n\\] We then multiply both sides of the equation by \\(e^{z/2}\\). \\[\n\\frac{\\mathrm{d}}{\\mathrm{d}z}\\Bigl[T_0 e^{z/2}\\Bigr] = 0.\n\\] Integrate, and solve, giving \\(T_0 = Ce^{-z/2}\\). We now impose \\(T_0(1) = 1\\) which yields \\(C = e^{1/2}\\).\nFirst-order: at next order, we get \\[\n2T_1' + T_1 = -T_0'' \\Longrightarrow T_1' + \\frac{1}{2}T_1 = -\\frac{1}{2}T_0'' ,\n\\] along with the boundary conditions of \\(T_1(1) = 0\\).\nAgain place this into the appropriate form. Again, this is a linear first-order equation. We multiply by the integrating factor \\(e^{z/2}\\), placing the equation into the form \\[\n\\frac{\\mathrm{d}}{\\mathrm{d}z} \\Bigl[ T_1 e^{z/2} \\Bigr] = -\\frac{1}{2 }T_0'' e^{z/2} = -\\frac{1}{8} e^{1/2}.\n\\] We integrate once and simplify, yielding \\[\nT_1(z) = \\left(-\\frac{e^{1/2}}{8} z + C\\right)e^{-z/2},\n\\] and then impose the condition that \\(T_1(1) = 0\\). This yields \\(C = e^{1/2}/8\\) hence \\[\nT_1(z) = -\\frac{e^{1/2}}{8}(z - 1) e^{-z/2}.\n\\]",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>34</span>  <span class='chapter-title'>Problem set 3 solutions</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps03sol.html#inner-asymptotic-solutions",
    "href": "part-xx-exercises/ps03sol.html#inner-asymptotic-solutions",
    "title": "34  Problem set 3 solutions",
    "section": "34.5 Inner asymptotic solutions",
    "text": "34.5 Inner asymptotic solutions\n\\(\\nextSection\\)\nThere will be a boundary layer near \\(z = 0\\). Set \\(z = \\epsilon^{\\alpha} s\\) and \\(T(z) = U(s)\\). Follow the same procedure, as in Chapter 8 in order to determine the correct choice of \\(\\alpha\\) for the inner region. This choice should balance the two terms \\(\\epsilon T''\\) and \\(2T'\\).\n\n\n\n\n\n\nSolution\n\n\n\n\n\nWe re-scale \\(z = \\epsilon^\\alpha s\\) and let \\(T(s) = U(s)\\). Then the ODE becomes \\[\n\\epsilon^{1 - 2\\alpha} U'' + 2 \\epsilon^{-\\alpha} U' + U = 0.\n\\] Balancing the first two terms thus requires that \\[\n1 - 2 \\alpha = -\\alpha \\Longrightarrow \\alpha = 1.\n\\] Thus the differential equation now becomes \\[\nU'' + 2 U' + \\epsilon U = 0.\n\\]",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>34</span>  <span class='chapter-title'>Problem set 3 solutions</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps03sol.html#matching-and-comparison",
    "href": "part-xx-exercises/ps03sol.html#matching-and-comparison",
    "title": "34  Problem set 3 solutions",
    "section": "34.6 Matching and comparison",
    "text": "34.6 Matching and comparison\n\\(\\nextSection\\)\nExpanding the inner solution as \\(U = U_0(s) + \\epsilon U_1(s) + \\ldots\\), write down the equation and boundary conditions that \\(U_0\\) must satisfy. You will notice that \\(U_0\\) is governed by a second-order differential equation and therefore needs two boundary conditions. One boundary condition comes from \\(z = 0\\), i.e. \\[\nU_0(0) = 0.\n\\]\nThe other boundary condition is a matching condition: \\[\n\\lim_{s \\to \\infty} U_0(s) = \\lim_{z \\to 0} T_0(z),\n\\] which imposes that the inner solution, as it leaves the boundary layer, matches the outer solution, it tends into the inner region.\n\n\n\n\n\n\nSolution\n\n\n\n\n\nSolve for \\(U_0\\).\nWe thus expand \\(U = U_0 + \\epsilon U_1 + \\ldots\\). To leading order, we have \\[\nU_0'' + 2U_0' = 0.\n\\] Integrating, we find that the general solution is given by \\[\nU_0(s) = C_1 + C_2 e^{-2s}.\n\\] We require two boundary conditions. The first condition is given by \\(T(0) = 0\\) and hence \\(U(0) = 0\\). The second condition is given by requiring that the inner solution, as \\(s \\to \\infty\\), matches the outer solution, as \\(z \\to 0\\). Using our solution above, we find that \\[\n\\lim_{z \\to 0} T_0(z) = e^{1/2}.\n\\] Thus the second boundary condition is \\[\n\\lim_{s \\to \\infty} U_0(s) = e^{1/2}.\n\\] Together, both boundary conditions are used to conclude that \\[\nU_0(s) = e^{1/2}(1 - e^{-2s}),\n\\] or in terms of \\(z\\), the inner solution is \\[\nT_{\\text{inner}} \\sim e^{1/2}(1 - e^{-2z/\\epsilon}).\n\\]",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>34</span>  <span class='chapter-title'>Problem set 3 solutions</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps04sol.html",
    "href": "part-xx-exercises/ps04sol.html",
    "title": "35  Problem set 4 solutions",
    "section": "",
    "text": "Q1. The wine cellar problem I",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>35</span>  <span class='chapter-title'>Problem set 4 solutions</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps04sol.html#q1.-the-wine-cellar-problem-i",
    "href": "part-xx-exercises/ps04sol.html#q1.-the-wine-cellar-problem-i",
    "title": "35  Problem set 4 solutions",
    "section": "",
    "text": "Solution\n\n\n\n\n\nSeparation of variables leads to the equation \\[\n\\frac{G'}{G} = \\kappa \\frac{H''}{H} = \\lambda.\n\\]\nCrucially in considering possible solutions, we want solutions to obey the necessary boundary condition of \\(T(0, t) = A\\cos(\\omega t) = G(t)H(0)\\). This is highly restrictive.\nWe first consider \\(\\lambda = 0\\). Then we have that \\(G(t) = \\text{const.}\\). This is then no way to satisfy the time-varying boundary condition.\nWe next consider \\(\\lambda \\in \\mathbb{R}\\). Then \\(G(t) = C e^{\\lambda t}\\). So again the behaviour of the time-dependent part is incompatible with the oscillating boundary conditions.\nTherefore the only remaining possibility is \\(\\lambda = i\\alpha\\) where \\(\\alpha\\) is real. Then we have that \\[\nG(t) = C_1 e^{i\\alpha t} + C_2 e^{-i\\alpha t}.\n\\] Written in terms of real-valued functions, this gives essentially a linear combination of \\(\\cos(\\alpha t)\\) and \\(\\sin(\\alpha t)\\). In order to be compatible with the boundary conditions, we would thus need \\[\nG(t) = \\text{const.} \\cos(\\omega t) = \\text{const.} \\times \\mathrm{Re} (e^{i\\omega t}),\n\\] i.e. taking the imaginary part (if we wish to continue manipulating exponentials).\nNow solving for \\(H(x)\\), we set \\(H(x) = e^{rx}\\) as a solution ansatz, giving the characteristic equation \\[\nr^2 = i\\omega \\Longrightarrow r = \\pm \\sqrt{i \\omega}.\n\\] Therefore the general solution for \\(H\\) yields \\[\nH(x) = D_1 e^{\\sqrt{i\\omega}x} + D_2 e^{-\\sqrt{i\\omega}x}.\n\\] In order to parse the above form, it is best to re-write the real and complex parts of the exponential argument separately. We note that by Euler’s theorem, \\[\n\\sqrt{i} = (e^{\\pi i/2})^{1/2} = e^{\\pi i/4} = \\frac{1 + i}{\\sqrt{2}}.\n\\] So now we can re-write \\[\nH(x) = D_1 e^{\\sqrt{\\omega/2} x} e^{i\\sqrt{\\omega/2\\kappa}x} + D_2 e^{-\\sqrt{\\omega/2\\kappa} x} e^{-i\\sqrt{\\omega/2}x}.\n\\] By the boundedness assumption, we require that \\(H(x)\\) does not blow up as \\(x \\to \\infty\\). So therefore \\(D_1 = 0\\). We can finally put the results together, yielding: \\[\nT(x, t) = \\text{const.} \\times \\mathrm{Re} \\left[ e^{i\\omega t} e^{-\\sqrt{\\omega/2\\kappa} x} e^{-i\\sqrt{\\omega/2\\kappa}x}\\right]\n= \\text{const.} \\times \\mathrm{Re} \\left[ e^{-\\sqrt{\\omega/2\\kappa} x} e^{i(-\\sqrt{\\omega/2\\kappa}x + \\omega t)}\\right].\n\\] Note that the reason you have re-written it with the exponentials arranged in this fashion is because the portion of the exponential with the imaginary argument becomes oscillatory. Taking the real part yields \\[\nT(x, t) = A e^{-\\sqrt{\\omega/2} x} \\cos\\left(-\\sqrt{\\omega/2\\kappa} x + \\omega t\\right).\n\\] You can double check that the above solution satisfies all the required conditions, including the condition at \\(x = 0\\) (forcing us to choose the prefactor \\(A\\)).",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>35</span>  <span class='chapter-title'>Problem set 4 solutions</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps04sol.html#q2.-the-wine-cellar-problem-ii",
    "href": "part-xx-exercises/ps04sol.html#q2.-the-wine-cellar-problem-ii",
    "title": "35  Problem set 4 solutions",
    "section": "Q2. The wine cellar problem II",
    "text": "Q2. The wine cellar problem II\n\\(\\nextSection\\)\n\n\n\n\n\n\nSolution\n\n\n\n\n\nSolution script can be found on the solutions/ folder of the Noteable Python website.\nThe numerical solution is tricky for two reasons. First, you must consider the right range of parameters. Second, the numerical algorithm suffers from instability, so you must consider the right spatial and time discretisation.\nTo begin, from the notes Chapter 11, you are given that typical parameters are \\[\n\\omega = \\frac{2\\pi}{3.15 \\times 10^7 \\mathrm{s}}.\n\\] This has already been converted to seconds, so instead use \\[\n\\omega = 2\\pi \\, \\mathrm{yrs}^{-1}.\n\\] Indeed this value of \\(\\omega\\) was chosen so that \\(\\cos(\\omega t)\\) has a wavelength of 1 years.\nNext, it is given that \\[\n\\kappa = 0.002 \\mathrm{cm}^2/\\mathrm{s}.\n\\] We use the fact that \\[\n1 \\mathrm{yr} = 3.15 \\times 10^7 \\mathrm{s}, \\qquad 1 \\mathrm{cm} = 10^{-2} \\mathrm{m}.\n\\] So \\[\n\\kappa = \\frac{2 \\cdot 10^{-3} \\cdot 10^{-4} \\mathrm{m}^2}{3.15 \\times 10^{-7} \\mathrm{yr}} = (2/3.15) \\mathrm{m}^2 \\mathrm{yr}^{-1} \\approx 0.635 \\mathrm{m}^2 \\mathrm{yr}^{-1}.\n\\] When distributing the typical mesh in the \\(x\\) direction, we want to make sure we go deep enough. We had found that putting the cellar in about 4m deep was enough, so as long as your code solve for a range of \\(x\\) values, say, between \\(x = 0\\) and \\(x = 10\\), this should be sufficient.\nThe script is given in the solutions folder.",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>35</span>  <span class='chapter-title'>Problem set 4 solutions</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps04sol.html#q3.-ebms-and-variable-sun-output",
    "href": "part-xx-exercises/ps04sol.html#q3.-ebms-and-variable-sun-output",
    "title": "35  Problem set 4 solutions",
    "section": "Q3. EBMs and variable sun output",
    "text": "Q3. EBMs and variable sun output\n\\(\\nextSection\\)\n\nRegarding the resultant variation on the Earth’s mean surface.\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\nThe variation seems to be very small. Ignoring units, we have \\[\nT = \\left(\\frac{1-a}{\\sigma \\gamma}\\right)^{1/4} Q^{1/4} \\approx 67.3505 \\times Q^{1/4}.\n\\] Substituting the values of \\(Q\\) given this gives a temperature that ranges from \\(T = 289.499 \\, \\mathrm{K}\\) to \\(289.580 \\, \\mathrm{K}\\). Converting this to Celsius gives \\(16.35 \\, {}^\\circ \\mathrm{C}\\) to \\(16.43 \\, {}^\\circ \\mathrm{C}\\) i.e. a fraction of a degree.\n\n\n\n\nRegarding the variation using the Budyko model.\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\nWe obtain the range of approximately \\(T = 17.06 \\, {}^\\circ \\mathrm{C}\\) to \\(17.19 \\, {}^\\circ \\mathrm{C}\\).\n\n\n\n\nRegarding why the disparity between actual surface measurements.\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\nThere are many ways to respond, but one major factor is the oceans, which are ignored in our model. The oceans provide a massive energy sink for the planet, and so we would expect that the minor variations of \\(Q\\) due to the 11-year cycle would be smoothed out by the effects of the oceans.",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>35</span>  <span class='chapter-title'>Problem set 4 solutions</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps04sol.html#q4.-phase-line-analysis",
    "href": "part-xx-exercises/ps04sol.html#q4.-phase-line-analysis",
    "title": "35  Problem set 4 solutions",
    "section": "Q4. Phase line analysis",
    "text": "Q4. Phase line analysis\n\\(\\nextSection\\)\n\nSketch the solution \\(T(t)\\) of this equation for \\(t &gt; 0\\) if \\(T(0) = 230, 240, 260, 270\\) and \\(300\\).\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\nYou should be able to do this question by hand, but the following graph is generated via the accompanying Jupyter script in the solutions folder. The point is that once the steady-state solutions are known (dashed) then each solution given by the different initial condition can be approximated by whether it tends towards or away from the nearest fixed point.\n\n\n\n\n\n\nFigure 35.1: Graphical solution for Q3a\n\n\n\n\n\n\n\nSketch the solution \\(T(t)\\) of this equation for \\(t &gt; 0\\) if \\(T(0) = 285\\). Then sketch the solution of this equation with the same initial data in the same coordinate system if \\(C\\) is twice as large. Explain your answer.\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\nThe below numerical solution shows blue for \\(C = 1\\) and orange for \\(C = 4\\). Notice that increasing \\(C\\) seems to decrease the rate of change of the evolution. Indeed, since \\[\n\\frac{\\mathrm{\\partial}T}{\\mathrm{\\partial}t} \\propto \\frac{1}{C},\n\\] then multiplying \\(C\\) by factor is equivalent to slowing down the evolution by the inverse of that factor. A factor of \\(C\\) that is twice as large would slow down the evolution by half. Note that the oscillations shown in the graph below are numerical artifacts due to the tolerances on the ODE solver (how do you know this?)\n\n\n\nGraphical solution for Q3b\n\n\n\n\n\n\nIf \\(\\gamma\\) is decreased due to the increased greenhouse effect, the entire curve is shifted upwards. Sketch the solution if \\(T(0) = 280\\). Sketch the solution with the same initial data if \\(\\gamma\\) is decreased. Explain your answer.\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\nDecreasing \\(\\gamma\\) has the effect of shifting the curve upwards. The hottest steady state \\(T_3\\) is consequently increased. There are two main effects. First, the steady-state is much hotter, so the system will tend towards a much hotter state. Second, because decreasing $ $ will increase the rate of change of \\(T\\) (since we are subtracting less via the factor \\(-\\gamma T^4\\)), then the evolution towards the hotter state is initially much faster.\nYou see that in the following diagram.\n\n\n\nGraphical solution for Q3c\n\n\nThe above makes sense on a physical level. Decreasing \\(\\gamma\\) is equivalent to increasing greenhouse gases. We do expect the system to tend to a hotter state, then.",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>35</span>  <span class='chapter-title'>Problem set 4 solutions</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps05sol.html",
    "href": "part-xx-exercises/ps05sol.html",
    "title": "36  Problem set 5 solutions",
    "section": "",
    "text": "Q1. Evolution\nConsider again (Equation 28.1). Let \\(T^*\\) be a steady-state solution and set \\(T = T^* + u(t)\\) where \\(u(t)\\) is a small perturbation from the steady state.",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>36</span>  <span class='chapter-title'>Problem set 5 solutions</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps05sol.html#q1.-evolution",
    "href": "part-xx-exercises/ps05sol.html#q1.-evolution",
    "title": "36  Problem set 5 solutions",
    "section": "",
    "text": "Show that the perturbation satisfies \\[\nC \\dot{u} = -D u + O(u^2).\n\\] and hence solve for the general solution of the leading-order perturbation (ignoring quadratic terms). What are the conditions on \\(T^*\\) so that the steady state is linearly stable?\n\n\n\n\n\n\n\nSolution Q1a\n\n\n\n\n\nWe linearise via \\(T = T^* + u(t)\\) where \\(u \\ll 1\\). Then we have \\[\nC \\frac{\\mathrm{\\partial}T}{\\mathrm{\\partial}t} = G(T^*) + G'(T^*)u(t) + O(u^2).\n\\] The first term on the RHS is zero since \\(T^*\\) is a steady state. Ignoring quadratic terms, we see then that \\[\nC \\dot{u} = -D u\n\\] where \\(D = -G'(T^*)\\). The solution is thus \\[\nu(t) = A e^{-D t/C},\n\\] where \\(A\\) is a constant. In order to be linearly stable, we then need the above to tend to zero as \\(t \\to \\infty\\), which is guaranteed if \\(D/C &gt; 0\\). Since \\(C &gt; 0\\) then we only need \\[\nG(T^*) &lt; 0.\n\\]\n\n\n\n\nAssuming \\(T^*\\) is linearly stable, find the typical response time to a perturbation. For instance, what is the time it takes for the perturbation to reach the value \\(u(t) = 0\\) if \\(u(0) = 1\\)? How does this response time change with \\(C\\)? What is the physical interpretation of this regarding the climate?\n\n\n\n\n\n\n\nSolution Q1b\n\n\n\n\n\nThe question is somewhat ill-posed. By the behaviour of the system, we know that it would take infinite time for the perturbation, \\(u\\), to reach \\(u = 0\\). However, we can still provide a sensible answer.\nIf the system starts from \\(u(0) = 1\\), then to reach \\(u = \\delta\\), it would need to take the time \\[\ne^{-D t/C} = \\delta \\Longrightarrow t = -\\frac{C}{D} \\log \\delta = \\frac{C}{D} \\log(1/\\delta).\n\\] For instance, to reach \\(\\delta = 1/2\\) (half its original perturbation) would take \\(\\log 2 \\approx 0.69\\) times (C/D).\nThis response is proportional to \\(C\\) so for instance, doubling \\(C\\) takes twice as long as before to reach the same value of \\(\\delta\\). One can think of this as equivalent to decreasing the responsiveness of the planet to potential changes of stability.",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>36</span>  <span class='chapter-title'>Problem set 5 solutions</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps05sol.html#q2.-integral-of-energy-over-the-planet",
    "href": "part-xx-exercises/ps05sol.html#q2.-integral-of-energy-over-the-planet",
    "title": "36  Problem set 5 solutions",
    "section": "Q2. Integral of energy over the planet",
    "text": "Q2. Integral of energy over the planet\n\\(\\nextSection\\)\n\n\n\n\n\n\nSolution Q2\n\n\n\n\n\nThis is a straightforward calculation without tricks. Since \\(Q\\) is constant, we have \\[\nI = 2\\pi R_E^2  Q\\int_{\\varphi = -\\pi/2}^{\\pi/2} s(y = \\sin\\varphi) \\cos\\varphi \\, \\mathrm{d}\\varphi.\n\\] Converting now to integration in \\(y\\), we have \\[\nI = 2\\pi R_E^2  Q\\int_{y = -1}^{1} s(y) \\, \\mathrm{d}y.\n\\] Examining the function \\(s(y)\\) in Equation 13.3 we note that it is symmetric in \\(y\\) and has been defined so its integral is one. Thus \\[\nI = 4\\pi R_E^2  Q.\n\\] This is the solar constant multiplied by the surface area of the planet (a sphere).",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>36</span>  <span class='chapter-title'>Problem set 5 solutions</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps05sol.html#q3.-mean-temperature-in-the-latitude-dependent-ebm",
    "href": "part-xx-exercises/ps05sol.html#q3.-mean-temperature-in-the-latitude-dependent-ebm",
    "title": "36  Problem set 5 solutions",
    "section": "Q3. Mean temperature in the latitude-dependent EBM",
    "text": "Q3. Mean temperature in the latitude-dependent EBM\n\\(\\nextSection\\)\n\n\n\n\n\n\nSolution Q3a\n\n\n\n\n\nWe have from integration, \\[\nC \\frac{\\mathrm{\\partial}}{\\mathrm{\\partial}t} \\int_0^1 T \\, \\mathrm{d}y = Q\\int_0^1 s(y) \\, \\mathrm{d}y - Q \\int_0^1 s(y)a(y) \\, \\mathrm{d}y - (A + B\\bar{T}) + k\\bar{T} - k\\bar{T}.\n\\] Simplifying and using the property of \\(s\\) gives \\[\nC \\frac{\\mathrm{\\partial}\\bar{T}}{\\mathrm{\\partial}t} = Q(1 - \\bar{a}) - (A + B\\bar{T}),\n\\] where we have defined \\[\n\\bar{a} = \\int_0^1 s(y)a(y) \\, \\mathrm{d}y = \\int_0^{y_s} s(y) a_w \\, \\mathrm{d}y +\\int_{y_s}^1 s(y) a_i \\, \\mathrm{d}y.\n\\]\n\n\n\n\n\n\n\n\n\nSolution Q3b\n\n\n\n\n\nAgain this question is free of tricks and only involves the integration using \\[\ns(y) = 1 - S_2 P_2(y)\n\\] where \\(S_2 = 0.482\\) and \\(P_2(y) = \\frac{1}{2}(3y^2 - 1)\\). It is useful to compute the two quantities\n\\[\\begin{align}\n\\int_0^{y_s} s(y) \\, \\mathrm{d}y &= y_s - \\frac{S_2}{2} \\left(y_s^3 - y_s\\right), \\\\\n\\int_{y_s}^1 s(y) \\, \\mathrm{d}y &= 1 - y_s + \\frac{S_2}{2} \\left(y_s^3 - y_s\\right).\n\\end{align}\\]\nMultiply the first quantity by \\(a_w\\) and add to the second multiplied by \\(a_i\\) and simply to obtain \\[\n\\bar{a} = a_i + (a_w - a_i)y_s \\left[ 1 - \\frac{S_2}{2}(y_s^2 - 1)\\right].\n\\]",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>36</span>  <span class='chapter-title'>Problem set 5 solutions</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps05sol.html#q4.-sensitivity-of-the-climate",
    "href": "part-xx-exercises/ps05sol.html#q4.-sensitivity-of-the-climate",
    "title": "36  Problem set 5 solutions",
    "section": "Q4. Sensitivity of the climate",
    "text": "Q4. Sensitivity of the climate\n\\(\\nextSection\\)\n\nConsider a perturbation of the solar radiation, say \\(Q = Q_0 + \\delta\\) where \\(\\delta\\) is small in comparison to \\(Q_0\\). Expand now the temperature into a series: \\[\nT = T_0 + \\delta T_1  + \\ldots\n\\] Show that at \\(O(\\delta)\\), the perturbation is governed by \\[\nC \\frac{\\mathrm{d}T_1}{\\mathrm{d}t} = (1 - a(T_0)) - B(T_0) T_1 - A'(T_0) T_1 - T_0 B'(T_0) T_1 - Q_0 a'(T_0) T_1.\n\\]\n\n\n\n\n\n\n\nSolution Q4a\n\n\n\n\n\nEach of the functions should be expanded in the usual way. For example, from Taylor series we have \\[\nA(T) = A(T_0) + A'(T_0)(T - T_0) + O(T - T_0)^2.\n\\] Then using \\(T = T_0 + \\delta T_1 + \\ldots\\), we have \\[\nA(T) = A(T_0) + \\delta A'(T_0) T_1 + O(\\delta)^2.\n\\] Do the same for both \\(a(T)\\) and \\(B(T)\\). Then substituting into the equation gives (remember to drop bars): \\[\n\\text{LHS} = \\delta C \\frac{\\mathrm{d}T_1}{\\mathrm{d}t} + O(\\delta^2)\n\\] while for the right hand-side\n\\[\\begin{align}\n\\text{RHS} &= Q_0(1 - a(T_0)) - (A(T_0) + B(T_0) T_0) \\\\\n& \\quad + \\delta \\left[(1 - a(T_0)) - Q_0 a'(T_0)T_1  - A'(T_0)T_1 - B'(T_0)T_0 T_1 - B(T_0) T_1\\right] + O(\\delta)^2.\n\\end{align}\\]\nNow the first, \\(O(1)\\), grouping of terms above is zero by assumption that \\(T_0\\) is steady-state. So considering only those terms that are multiplied by \\(\\delta\\), we have \\[\nC \\frac{\\mathrm{d}T_1}{\\mathrm{d}t} = (1 - a(T_0)) - B(T_0) T_1 - A'(T_0) T_1 - T_0 B'(T_0) T_1 - Q_0 a'(T_0) T_1.\n\\]\n\n\n\n\nConsequently, show that the temperature perturbation can be written as \\[\nB(T_0) \\tau \\frac{\\mathrm{\\partial}T_1}{\\mathrm{\\partial}t} = [1 - a(T_0)]  - \\frac{B(T_0)}{g} T_1.\n\\]\n\n\n\n\n\n\n\nSolution Q4b\n\n\n\n\n\nThere is nothing tricky about this, but it just requires keeping track of bookwork. On the right hand-side, separate those terms proportional to \\(T_1\\) and write it in the desired form. Refer to the lecture videos where we completed this (modulo a possible sign!)\n\n\n\n\nConsider (Equation 29.3) at steady state, so therefore the perturbed equilibrium temperature is equal to \\[\n\\delta T_1 =  \\frac{[1 - a(T_0)] \\delta g}{B(T_0)}.\n\\] If the CO2 level in the atmosphere doubles, then the radiative forcing might be adjusted as: \\[\n(1 - a(T_0)) \\delta = 3.7 \\,  \\mathrm{W} \\cdot \\mathrm{m}^{-2}.\n\\] Assuming that the climate gain is \\(g = 3\\) and \\(B(T_0) = 1.9 \\mathrm{W} \\cdot \\mathrm{m}^{-2} \\cdot ({}^\\circ \\mathrm{C})^{-1}\\), what is the expected increase in temperature?\n\n\n\n\n\n\n\nSolution Q4c\n\n\n\n\n\nSo we know that \\((1 - a)\\delta = 3.7 W/m^2\\). So according to the equation, we have the fact that \\[\n\\delta T_1 = 3.7 \\frac{3}{1.9} \\approx 5.8^\\circ C.\n\\] So this is the expected increase in temperature. Note that if a climate gain factor of \\(g = 1\\) is used then this gives an expected increase of 1.9 degrees instead.. The range of current model predictions, in fact, is about 1.5 to 4.5 degrees so this is not bad.",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>36</span>  <span class='chapter-title'>Problem set 5 solutions</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps06sol.html",
    "href": "part-xx-exercises/ps06sol.html",
    "title": "37  Problem set 6 solutions",
    "section": "",
    "text": "Q1. A van der Pol equation",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>37</span>  <span class='chapter-title'>Problem set 6 solutions</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps06sol.html#q1.-a-van-der-pol-equation",
    "href": "part-xx-exercises/ps06sol.html#q1.-a-van-der-pol-equation",
    "title": "37  Problem set 6 solutions",
    "section": "",
    "text": "Determine \\(f(x)\\) so that this equation can be written as a Liénard phase plane system in the form \\[\n\\begin{aligned}\n\\epsilon \\dot{x} &= f(x) + 4y, \\\\\n\\dot{y} &= -x.\n\\end{aligned}\n\\]\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\nStart from the ODE and re-write \\[\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\left[\\epsilon \\dot{x} + (x^3 - 3x^2 - 9x)\\right] = - 4x.\n\\] Double check that the derivative of the LHS returns the original problem. Now set the quantity in brackets equal to one unknown: \\[\n\\tilde{y} = \\epsilon \\dot{x} + (x^3 - 3x^2 - 9x),\n\\] and solve for the derivative: \\[\n\\epsilon \\dot{x} = \\tilde{y} - (x^3 - 3x^2 - 9x).\n\\] The remaining equation is \\[\n\\dot{\\tilde{y}} = -4x.\n\\]\nNow in this question, we have chosen a slightly different choice to eliminate the factor of \\(4\\). Set \\(\\tilde{y} = 4y\\) to get the system\n\\[\\begin{align}\n\\epsilon \\dot{x} &= f(x) + 4y, \\\\\n\\dot{y} &= -x.\n\\end{align}\\]\nIt doesn’t really matter which choice you select. So here we see \\(f(x) = -x^3 + 9x + 3 x^2\\). What we often call the slow manifold in lectures is then \\[\ny = -f(x)/4 = \\frac{x^3 - 3 x^2 - 9x}{4} \\equiv S(x).\n\\]\n\n\n\n\nFor fixed \\(\\epsilon &gt; 0\\), find the equilibrium point(s) in the phase plane, find their eigenvalues, and classify their linear stability.\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\nThe only equilibrium point is \\((x_*, y_*) = (0,0)\\). Because the equilibrium point is at the origin, we can obtain the linear matrix by ignoring the higher-order powers in the differential equations. The matrix is \\[\nA = \\begin{pmatrix}\n\\frac{9}{\\epsilon} & \\frac{4}{\\epsilon} \\\\\n-1 & 0\n\\end{pmatrix}.\n\\] Subtract \\(\\lambda\\) from the diagonal elements and solve the resultant quadratic equation \\(\\lambda(\\lambda - 9/\\epsilon) + 4/\\epsilon = 0\\) to see that the eigenvalues are \\(\\lambda = (9 \\pm \\sqrt{81 - 16\\epsilon}/(2\\epsilon) &gt; 0\\), so the point is an unstable node.\n\n\n\n\nUse the expansions \\(x(t) = x_0(t) + \\epsilon x_1(t) + O(\\epsilon^2)\\) to determine the equations for the leading-order slow solution. Sketch the slow manifold, indicate the directions motion on each part, and identify the two attracting points on the curve.\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\nAs usual expand the solutions into a series in powers of \\(\\epsilon\\). The slow manifold is \\(y_0(x_0) = S(x_0) = (x_0^3 - 3 x_0^2 - 9 x_0)/4\\). In image of the slow manifold is shown below in blue. Notice that for \\(x &lt; 0\\), \\(y\\) is increasing and for \\(x &gt; 0\\), \\(y\\) is decreasing (due to the second differential equation).\n\n\n\n\n\n\nFigure 37.1: Illustration of slow manifold\n\n\n\n\n\n\n\nUse the expansions \\(x(t) = X_0(T) + \\epsilon X_1(T) + O(\\epsilon^2)\\) and \\(y(t) = Y_0(T) + \\epsilon Y_1(T) + O(\\epsilon^2)\\) with \\(T = t/\\epsilon\\) to obtain the leading-order fast solution.\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\nRescale \\(t = \\epsilon T\\) and re-write \\(x = X(T)\\) and \\(y = Y(T)\\). We get \\[\n\\begin{align}\n\\frac{\\mathrm{d}X}{\\mathrm{d}T} &= f(X) + 4Y \\\\\n\\frac{\\mathrm{d}Y}{\\mathrm{d}T} &= -\\epsilon X.\n\\end{align}\n\\]\nNow expand into powers of \\(\\epsilon\\) and take the leading-order: \\[\n\\begin{align}\n\\frac{\\mathrm{d}X_0}{\\mathrm{d}T} &= f(X_0) + 4Y_0 \\\\\n\\frac{\\mathrm{d}Y_0}{\\mathrm{d}T} &= 0.\n\\end{align}\n\\]\nThe second equation indicates that \\(Y_0\\) is constant. Its value, found in part (e) is either \\(5/4\\) or \\(27/4\\). The remaining equation for \\(X_0\\) is nonlinear and there is not much you can do with it. The important item of understanding is to examine its form: \\[\n\\frac{\\mathrm{d}X_0}{\\mathrm{d}T} = f(X_0) + 4 Y_0.\n\\] Now on the upper branch of the picture shown above \\(f(X_0) = 4 Y_0 &gt; 0\\) and therefore the solution increases its value in \\(X_0\\) until it intersects with the blue slow manifold, at which point its rate of change is zero and it descends the slow manifold. A similar behaviour occurs on the lower branch of the fast evolution.\n\n\n\n\nUse the phase plane to determine the maximum and minimum values of \\(x(t)\\) during an oscillation. Sketch \\(x(t)\\) as a function of time.\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\nBy checking the derivatives, we can see that the slow manifold has local extrema at \\((-1, 5/4)\\) and \\((3, 27/4)\\). In the fast evolution stages, \\(y\\) is constant and \\(x\\) evolves from one extrema value to the other on the slow manifold, satisfying \\(y = S(x)\\).\nHere is a plot of the key points.",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>37</span>  <span class='chapter-title'>Problem set 6 solutions</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps06sol.html#q2.-fast-slow-dynamics-with-three-variables",
    "href": "part-xx-exercises/ps06sol.html#q2.-fast-slow-dynamics-with-three-variables",
    "title": "37  Problem set 6 solutions",
    "section": "Q2. Fast-slow dynamics with three variables",
    "text": "Q2. Fast-slow dynamics with three variables\n\\(\\nextSection\\)\n\nFor the system \\[\n\\begin{aligned}[c]\n\\dot{x} &= 2 - y, \\\\\n\\dot{y} &= x-z, \\\\\n\\epsilon\\dot{z} &= y - y^2 + \\frac{1}{3}y^3 - z,\n\\end{aligned}\n\\] with the initial conditions of \\(x(0) = 1\\), \\(y(0) = 3\\), and \\(z(0) = 0\\).\n\nIdentify the surface \\(z = S(x, y)\\) that defines the slow manifold. Find the equilibrium point of the leading=order slow phase plane system and show that it is asymptotically stable for \\(t \\to \\infty\\). Also determine the form of the initial layer that describes the transition from the initial conditions to the slow manifold.\n\n\n\n\n\n\nSolution\n\n\n\n\n\nSetting \\(\\epsilon = 0\\) we see that the slwo manifold is \\(z = S(y) = y - y^2 + y^3/3\\). The leading-order slow system is\n\\[\\begin{align}\n\\frac{\\mathrm{d}x_0}{\\mathrm{d}t} &= 2 - y_0 \\\\\n\\frac{\\mathrm{d}y_0}{\\mathrm{d}t} &= x_0 - y_0 + y_0^2 - y_0^3/3.\n\\end{align}\\] $$ The only equilibrium point is \\((x^*, y^*) = (2/3, 2)\\). Linearisation gives eigenvalues of \\(\\lambda = 1/2(-1 \\pm 3i)\\) so the point is a stable spiral. Consequently the \\(t \\to \\infty\\) solution will be \\((x, y, z) = (2/3, 2, 2/3)\\). Note also that \\(2/3 = S(2)\\).\nNear the initial condition there is a boundary layer, found by setting \\[\nt = \\epsilon T,\n\\] and transforming \\(x = X(T)\\), \\(y = Y(T)\\), \\(z = Z(T)\\). We get at leading order,\n\\[\\begin{align}\n\\frac{\\mathrm{d}X_0}{\\mathrm{d}T} &= 0 \\\\\n\\frac{\\mathrm{d}T_0}{\\mathrm{d}T} &= 0 \\\\\n\\frac{\\mathrm{d}Z_0}{\\mathrm{d}T} &= Y_0 - Y_0^2 + Y_0^3/3 - Z_0.\n\\end{align}\\]\nThe initial condition sets \\(X_0 = 1\\) and \\(Y_0 = 3\\). We can finally solve the equation for \\(Z_0\\) to get \\[\nZ_0 = 3(1 - e^{-T}).\n\\]\n\n\n\n\nFor the system \\[\n\\begin{aligned}[c]\n\\dot{x} &= 2 - y, \\\\\n\\epsilon\\dot{y} &= x-z, \\\\\n\\dot{z} &= y - y^2 + \\frac{1}{3}y^3 - z,\n\\end{aligned}\n\\] with the initial conditions of \\(x(0) = 0\\), \\(y(0) = 3\\), and \\(z(0) = 1\\).\n\nShow that the slow manifold reduces to a curve that could be written in parametric form as \\(x = x(z), y = y(z), z = z\\). Determine the asymptotic solution for \\(t \\to \\infty\\). Also determine the form of the initial layer that describes the transition from initial conditions to the slow manifold.\n\n\n\n\n\n\nSolution\n\n\n\n\n\nSetting \\(\\epsilon = 0\\), we see that the second equation gives \\(x = z\\). Now if you use this result in the first equation you obtain \\(\\dot{z} = 2 - y\\). This is now equated with the third equation which yields an algebraic equation: \\[\n2 - y = y - y^2 + \\frac{y^3}{3} - z \\Longrightarrow z = \\frac{y^3}{3} - y^2 + 2y - 2.\n\\tag{37.1}\\] Therefore we conclude that \\(z = z(y)\\). We can verify that this equation is monotonically increasing in \\(y\\), so we can invert without issue, yielding \\(y = y(z)\\). Similarly, we obtain \\(x = z\\). So the slow manifold is given by \\[\n(x, y, z) = (z, y(z), z),\n\\] which is a curve in 3D.\nIn order to determine what happens as \\(t\\to\\infty\\), differentiate \\[\n\\frac{\\mathrm{d}y}{\\mathrm{d}t} = \\frac{\\mathrm{d}y}{\\mathrm{d}z} \\frac{\\mathrm{d}z}{\\mathrm{d}t} = \\frac{2 - y}{2 - 2y + y^2},\n\\] which follows from using the first equation of the system of ODEs and also the \\(z\\) derivative of (Equation 37.1). In particular, note that we do not have to invert this latter equation and we can take the \\(y\\)-derivative of (eq-PS5-Q3-tmp) and use \\[\n\\frac{1}{\\frac{\\mathrm{d}z}{\\mathrm{d}y}} = \\frac{1}{2 - 2y + y^2}.\n\\]\nTake \\(dy/dt = 0\\) for the steady state gives \\[\ny^* = 2,\n\\] as the only fixed point. At this value of \\(y\\), notice that \\(z^* = 2/3\\) from (Equation 37.1). So the fixed point is \\[\n(x^*, y^*, z^*) = (2/3, 2, 2/3).\n\\]\nThe procedure for the initial layer is the same as in part (a). This time, the fast system satisfies at leading order,\n\\[\\begin{align}\n\\frac{\\mathrm{d}X_0}{\\mathrm{d}T} &= 0 \\\\\n\\frac{\\mathrm{d}Y_0}{\\mathrm{d}T} &= X - Z \\\\\n\\frac{\\mathrm{d}Z_0}{\\mathrm{d}T} &= 0.\n\\end{align}\\]\nSo we obtain \\(X_0 = 0\\) and \\(Z_0 = 1\\) using the initial condition. Solving for the final equation for \\(Y_0\\) with \\(Y_0(0) = 3\\) gives \\[\nY_0 = -T  + 3.\n\\]",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>37</span>  <span class='chapter-title'>Problem set 6 solutions</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps07sol.html",
    "href": "part-xx-exercises/ps07sol.html",
    "title": "38  Problem set 7 solutions",
    "section": "",
    "text": "Q1. Non-dimensionalisation of the Stommel box model\nConsider the Stommel box model given in (Equation 23.1). Non-dimensionalise the model in order to produce the set of equations given in (Equation 23.2), repeated here:\n\\[\n\\begin{aligned}\n\\frac{\\mathrm{d}x}{\\mathrm{d}t} &= \\delta(1 - x) - |f(x, y)|x, \\\\\n\\frac{\\mathrm{d}y}{\\mathrm{d}t} &= 1 - y - |f(x, y)|y,\n\\end{aligned}\n\\]\nwhere we have introduced the function, \\[\nf(x, y; R, \\lambda) = \\frac{1}{\\lambda}(Rx - y),\n\\]\nProvide a brief description of the physical interpretations of the parameters \\(\\lambda\\), \\(\\delta\\), and \\(R\\).",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>38</span>  <span class='chapter-title'>Problem set 7 solutions</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps07sol.html#q1.-non-dimensionalisation-of-the-stommel-box-model",
    "href": "part-xx-exercises/ps07sol.html#q1.-non-dimensionalisation-of-the-stommel-box-model",
    "title": "38  Problem set 7 solutions",
    "section": "",
    "text": "Solution\n\n\n\n\n\nThe final parameters were established by \\[\n\\delta = \\frac{d}{c}, \\qquad \\lambda = \\frac{c}{2\\alpha k \\Delta T^*}, \\qquad R = \\frac{\\beta \\Delta S^*}{\\alpha \\Delta T^*}.\n\\] Their interpretations are as follows: \\(\\delta\\) measures the relative relaxation temporal rates of the salt-basin exchange and the temperature-basin exchange. Since thermal energy turns out to exchange on a faster time scale than salinity, then we are typically interested in \\(\\delta \\ll 1\\).\nThe parameter \\(\\lambda\\) is a measure of the strength of the THC. For example, with \\(k\\) large, this corresponds to significant flow through the pipes connecting the boxes, and so \\(\\lambda \\to 0\\) corresponds to strong THC.\nFinally \\(R\\) allows us to compare the relative effects of temperature and salinity differences between the external basins. Salinity differences dominate if \\(R &gt; 1\\) and temperature differences dominate if \\(R &lt; 1\\).",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>38</span>  <span class='chapter-title'>Problem set 7 solutions</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps07sol.html#q2.-investigations-for-r",
    "href": "part-xx-exercises/ps07sol.html#q2.-investigations-for-r",
    "title": "38  Problem set 7 solutions",
    "section": "Q2. Investigations for \\(R\\)",
    "text": "Q2. Investigations for \\(R\\)\n\\(\\nextSection\\)\nUsing the script available on Noteable investigate the behaviour of the Stommel box model under changing values of \\(R\\) and fixed values of the other parameters. Based on your intuition, what do you expect to be the features of the bifurcation diagram, as shown in the \\((R, f)\\)-plane?\n\n\n\n\n\n\nSolution\n\n\n\n\n\nRemember that the steady states are found by examining the intersections of the curves \\(\\lambda f = \\phi\\). From (Equation 23.5), we have \\[\n\\phi(f^*) = \\frac{\\delta R}{\\delta + |f^*|} - \\frac{1}{1 + |f^*|}.\n\\] so essentially the effect of changing \\(R\\) is to multiply the curve \\(\\phi\\) by a multiplier. Using the code on the JupyterHub we obtain the following graph for different values of \\(R\\).\n\n\n\n\n\n\nFigure 38.1: Steady state intersections for Stommel’s box model\n\n\n\nFor the smallest values of \\(R\\), note that only the lowermost steady state will be present. As \\(R\\) crosses the critical value of \\(R = 1\\), two intersections are borne at \\(\\phi = 0\\). Eventually \\(R\\) crosses another critical value, and the two leftmost intersections merge then disappear, leaving only the largest steady-state.\nBecause the stability of the solution is essentially given by the ordering of the curves (if the curve \\(\\lambda f\\) is larger than the curve \\(\\phi\\) on the left of the steady-states), then we can see that, as typical for stability in this course, the first and third steady states are stable, and the middle one unstable.\nWe can now plot a bifurcation diagram using the above information.\n\n\n\n\n\n\nFigure 38.2: Bifurcation diagram for \\(R\\) vs \\(f^*\\)",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>38</span>  <span class='chapter-title'>Problem set 7 solutions</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps07sol.html#q3.-alternative-scalings-of-the-stommel-box-model",
    "href": "part-xx-exercises/ps07sol.html#q3.-alternative-scalings-of-the-stommel-box-model",
    "title": "38  Problem set 7 solutions",
    "section": "Q3. Alternative scalings of the Stommel box model",
    "text": "Q3. Alternative scalings of the Stommel box model\n\\(\\nextSection\\)\nIt is possible to scale the problem differently, and this may allow for simpler analysis. Consider the set of equations in Q1. Write instead \\[\nx = [x] s, \\qquad y = [y] \\theta, \\qquad t = [t] t',\n\\] Choose the correct scalings, \\([x]\\), \\([y]\\), and \\([t]\\), so that we obtain a re-scaled version: \\[\n\\begin{aligned}\n\\frac{\\mathrm{d}s}{\\mathrm{d}t'} &= 1 - (\\epsilon + |q|) s, \\\\\n\\frac{\\mathrm{d}\\theta}{\\mathrm{d}t'} &= 1 - (\\mu + |q|)\\theta,\n\\end{aligned}\n\\]\nwhere now the flow term is given by \\[\nq = \\kappa(-\\theta + \\tilde{R}s).\n\\] In addition to the choice of scalings, you will need to describe how the new parameters, \\(\\epsilon\\), \\(\\mu\\), \\(\\kappa\\), and \\(\\tilde{R}\\), are related to the older parameters.\n\n\n\n\n\n\nSolution\n\n\n\n\n\nPutting in the scalings, \\[\n\\begin{aligned}\n\\frac{[x]}{[t]}\\frac{\\mathrm{d}s}{\\mathrm{d}t'} &= \\delta(1 - [x]s) - [x]|f(x, y)|s, \\\\\n\\frac{[y]}{[t]}\\frac{\\mathrm{d}\\theta}{\\mathrm{d}t'} &= 1 - [y]\\theta - |f(x, y)|\\theta.\n\\end{aligned}\n\\]\nComparing the equations, we see that we should choose \\[\n[x] = \\epsilon, \\qquad \\frac{\\delta [t]}{[x]} = 1, \\qquad [t] = \\mu, \\qquad [y] = [t] = \\mu.\n\\] Under this choice, \\[\n\\begin{aligned}\n\\frac{\\mathrm{d}s}{\\mathrm{d}t'} &= 1 - \\epsilon s - [t]|f(x, y)|s, \\\\\n\\frac{\\mathrm{d}\\theta}{\\mathrm{d}t'} &= 1 - \\mu\\theta - [t]|f(x, y)|\\theta.\n\\end{aligned}\n\\] The latter quantity is \\[\n\\mu f = \\frac{\\mu[y]}{\\lambda}\\left(-\\theta + \\frac{R[x]}{[y]}s\\right).\n\\] We there write \\[\n\\kappa =  \\frac{\\mu[y]}{\\lambda}, \\qquad \\tilde{R} = \\frac{R[x]}{[y]}\n\\]\nThus we have produced \\[\n\\begin{align}\n\\frac{\\mathrm{d}s}{\\mathrm{d}t'} &= 1 - \\epsilon s - |q|s, \\\\\n\\frac{\\mathrm{d}\\theta}{\\mathrm{d}t'} &= 1 - \\mu\\theta - |q|\\theta.\n\\end{align}\n\\] where \\[\nq = \\kappa(-\\theta + \\tilde{R}s).\n\\]",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>38</span>  <span class='chapter-title'>Problem set 7 solutions</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps07sol.html#q4.-box-models-for-flooding-1",
    "href": "part-xx-exercises/ps07sol.html#q4.-box-models-for-flooding-1",
    "title": "38  Problem set 7 solutions",
    "section": "Q4. Box models for flooding 1",
    "text": "Q4. Box models for flooding 1\n\\(\\nextSection\\)\n\n\n\n\n\n\nNote\n\n\n\nTo add following lectures in Week 11",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>38</span>  <span class='chapter-title'>Problem set 7 solutions</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps07sol.html#q5.-box-models-for-flooding-2",
    "href": "part-xx-exercises/ps07sol.html#q5.-box-models-for-flooding-2",
    "title": "38  Problem set 7 solutions",
    "section": "Q5. Box models for flooding 2",
    "text": "Q5. Box models for flooding 2\n\\(\\nextSection\\)\n\n\n\n\n\n\nNote\n\n\n\nTo add following lectures in Week 11",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>38</span>  <span class='chapter-title'>Problem set 7 solutions</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/odes.html",
    "href": "part-05-techniques/odes.html",
    "title": "39  Differential equations",
    "section": "",
    "text": "39.1 First-order linear differential equations\nFirst-order linear differential equations are of the form \\[\ny'(x) + q(x) y(x) = r(x).\n\\] These are solved by integrating factors. One trick often employed us to think of placing the left hand-side of the equation into the form: \\[\n\\frac{\\mathrm{d}}{\\mathrm{d}x} \\left[ y(x) e^{\\mathrm{??}} \\right],\n\\] where the derivative of ?? yields \\(q(x)\\).\nOfficially, to do this, we multiply both sides of the original equation by the integrating factor \\[\ne^{\\int^x q(x') \\, \\mathrm{d}x'}\n\\] so that the equation can be placed in the form \\[\n\\frac{\\mathrm{d}}{\\mathrm{d}x} \\left[y(x) e^{\\int^x q(x') \\, \\mathrm{d}x'}\\right] = r(x) e^{\\int^x q(x') \\, \\mathrm{d}x'}\n\\] Then integrate and solve for \\(y\\). This gives \\[\ny(x) = \\left( \\int r(x) e^{\\int^x q(x') \\, \\mathrm{d}x'} \\, \\mathrm{d}x + C \\right)e^{-\\int^x q(x') \\, \\mathrm{d}x'}.\n\\] It is usually much easier to work with specific problems, as many of the integrals are simpler than the general form given above. You will need to impose any required boundary conditions in order to determine the constant of integration above.\nThe solution of first-order linear equations is a standard problem in most first differential equations courses. You can find many references online and here is a good one providing plenty practice: Paul’s online notes",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>39</span>  <span class='chapter-title'>Differential equations</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/odes.html#second-order-constant-coefficient-odes",
    "href": "part-05-techniques/odes.html#second-order-constant-coefficient-odes",
    "title": "39  Differential equations",
    "section": "39.2 Second-order constant coefficient ODEs",
    "text": "39.2 Second-order constant coefficient ODEs\n\\(\\nextSection\\)\nSecond-order linear constant-coefficient ODEs are of the form \\[\ny'' + ay' + by = f(x).\n\\] With both forced (\\(f \\neq 0\\)) and unforced (\\(f = 0\\)) varieties studied. For the unforced variant (homogeneous), you will remember that the equation is solved by attempting the ansatz \\(y = e^{rx}\\) and solving for \\(r\\).\nThere are many references on this topic since it is the standard second-order theory learned in most initial differential equations courses.\nReferences:\n\nPaul’s online notes",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>39</span>  <span class='chapter-title'>Differential equations</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/dynamical-systems.html",
    "href": "part-05-techniques/dynamical-systems.html",
    "title": "40  Dynamical systems",
    "section": "",
    "text": "40.1 Stability analysis for 2x2 systems\nIn the case of 2x2 systems, there is a useful classification and shortcut. The eigenvalues, \\(\\lambda_1\\) and \\(\\lambda_2\\) are given by \\[\n\\lambda_{1,2} = \\frac{1}{2} (T \\pm \\sqrt{T^2 - 4D}),\n\\] where \\(T = \\mathrm{tr}(A) = a + d\\) and \\(D = \\mathrm{det}(A) = ad - bc\\). Once \\(T\\) and \\(D\\) are known, then the fixed points can be classified based on the following diagram.\nAbove, the critical parabola is where \\(T^2 - 4D = 0\\).",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>40</span>  <span class='chapter-title'>Dynamical systems</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/dynamical-systems.html#stability-analysis-for-2x2-systems",
    "href": "part-05-techniques/dynamical-systems.html#stability-analysis-for-2x2-systems",
    "title": "40  Dynamical systems",
    "section": "",
    "text": "Figure 40.1: Classification diagram from (Kaper and Engler 2013)\n\n\n\n\n\n\n\n\nKaper, Hans, and Hans Engler. 2013. Mathematics and Climate. SIAM.",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>40</span>  <span class='chapter-title'>Dynamical systems</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/vector-calculus.html",
    "href": "part-05-techniques/vector-calculus.html",
    "title": "41  Vector calculus",
    "section": "",
    "text": "41.1 Surface integrals\nSurface integrals are generalisations of the concept of a multiple integrals to integrals over surfaces. For example, consider a flat plate of area \\(A\\) heated to a certain temperature, and thus emits a certain amount of energy, \\(E\\), per unit area (per unit time). The total energy emitted per unit time would then be \\(E A\\).\nIf we want to consider the same problem, but now posed on a general surface, say the planet \\(S\\), and where \\(E\\) varies along the surface, then we must consider adding together \\(E(\\mathbf{x}) \\mathrm{d}{S}\\). We thus chop our surface into smaller pieces, each with area \\(\\mathrm{d}S\\), multiply each piece with its corresponding energy, and then sum the result.\nThe result is the surface integral \\[\n\\iint_S E(\\mathbf{x}) \\, \\mathrm{d}S.\n\\] A tutorial for computing surface integrals can be found here.\nYou will not need to know how to calculate surface integrals in general in the course.",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>41</span>  <span class='chapter-title'>Vector calculus</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/modelling.html",
    "href": "part-05-techniques/modelling.html",
    "title": "42  Modelling",
    "section": "",
    "text": "Appendices\n\n\n\nThese appendices may contain material that is added during the term, dependent on student enquiries and need.",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>42</span>  <span class='chapter-title'>Modelling</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/finitedifference.html",
    "href": "part-05-techniques/finitedifference.html",
    "title": "43  Finite difference approximations",
    "section": "",
    "text": "43.1 Forwards, backwards, and centred differences\nWe want to learn how to use finite differences in order to approximate derivatives numerically. We know that \\[\nf'(x) = \\lim_{h \\to 0} \\frac{f(x + h) - f(x)}{h},\n\\] provided the limit exists. Therefore, a simple idea to approximating the value of \\(f'(x)\\) is to use a small numerical value for \\(h\\), and calculate (the gradient of the secant line), \\[\nf'(x) \\approx \\frac{f(x + h) - f(x)}{h},\n\\] where \\(h\\) is a specified small number. The above is known as the two-point forward-difference formula. In fact, we can determine exactly the error of such an approximation via Taylor’s theorem. If \\(f\\) is twice continuously differentiable, then \\[\nf(x + h) = f(x) + h f'(x) + \\frac{h^2}{2} f''(c),\n\\] for some point \\(c\\in [x, x+h]\\). Therefore by re-arrangement, we see the following.\nNotice that the error in using the two-point forward difference approximation is then \\(\\mathcal{O}(h)\\), and this error tends to zero as \\(h \\to 0\\) (as long as \\(f''\\) is continuous). We thus call the above formula a first-order finite-difference approximation. If the error is \\(\\mathcal{O}(h^n)\\), we call the corresponding formula an \\(n\\)th-order approximation.\nSimilar formulae can be developed for the backwards difference (send \\(h \\to -h\\)).\nA more accurate formula can be developed via subtracting the Taylor series for \\(f(x - h)\\) from that for \\(f(x + h)\\). This results in:\nThus we see that the centered difference formula is accurate to \\(O(h^2)\\).",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>43</span>  <span class='chapter-title'>Finite difference approximations</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/finitedifference.html#forwards-backwards-and-centred-differences",
    "href": "part-05-techniques/finitedifference.html#forwards-backwards-and-centred-differences",
    "title": "43  Finite difference approximations",
    "section": "",
    "text": "Two-point forward-difference formula\n\n\n\n\\[\nf'(x) = \\frac{f(x + h) - f(x)}{h} - \\frac{h}{2} f''(c),\n\\] where \\(c \\in (x, x+h)\\).\n\n\n\n\n\n\n\n\n\nExample\n\n\n\nUse the two-point forward difference formula with different values of \\(h\\) in order to approximate the derivative of \\(f(x) = 1/x\\) at \\(x = 2\\).\n\n\n\n\\(f(x)\\)\n\\(f(x + h)\\)\n\\(h\\)\n\\(f'(x)\\)\nError\n\n\n\n\n…\n…\n…\n…\n…\n\n\n…\n…\n…\n…\n…\n\n\n…\n…\n…\n…\n…\n\n\n\n\n\n\n\n\n\n\n\n\n\nThree-point centered-difference formula\n\n\n\n\\[\nf'(x) = \\frac{f(x + h) - f(x - h)}{2h} - \\frac{h^2}{6} f'''(c),\n\\] where \\(c \\in (x-h, x+h)\\).",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>43</span>  <span class='chapter-title'>Finite difference approximations</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/finitedifference.html#jacobian-matrices",
    "href": "part-05-techniques/finitedifference.html#jacobian-matrices",
    "title": "43  Finite difference approximations",
    "section": "43.2 Jacobian matrices",
    "text": "43.2 Jacobian matrices\n\\(\\nextSection\\)\n\n\n\n\n\n\nReference\n\n\n\nYou will have encountered the Jacobian, firstly in your first-year Methods courses when performing change-of-coordinates in integration formulae, and secondly in your second-year Modelling and Dynamics courses when studying differential equations. It also comes up in the second-year Vectors and PDEs course.\n\n\nThe Jacobian matrix, \\(\\mathbf{J}\\), of a vector function, \\(\\mathbf{F}: \\mathbb{R}^n \\to \\mathbb{R}^m\\), \\[\n\\mathbf{F}(\\mathbf{x}) = \\begin{pmatrix}\nf_1(\\mathbf{x}) \\\\\nf_2(\\mathbf{x}) \\\\\n\\vdots \\\\\nf_m(\\mathbf{x})\n\\end{pmatrix},\n\\] is the matrix of all its first-order partial derivatives, \\[\n\\mathbf{J}(\\mathbf{x}) = \\begin{pmatrix}\n\\frac{\\mathrm{\\partial}f_1}{\\mathrm{\\partial}x_2} & \\cdots &\n\\frac{\\mathrm{\\partial}f_1}{\\mathrm{\\partial}x_n} \\\\\n\\vdots & \\ddots & \\vdots \\\\\n\\frac{\\mathrm{\\partial}f_m}{\\mathrm{\\partial}x_1} & \\cdots &\n\\frac{\\mathrm{\\partial}f_m}{\\mathrm{\\partial}x_n}\n\\end{pmatrix}\n= \\begin{pmatrix}\n\\nabla f_1(\\mathbf{x})^T \\\\\n\\vdots \\\\\n\\nabla f_n(\\mathbf{x})^T\n\\end{pmatrix}.\n\\] We can essentially think of the Jacobian as the multi-dimensional extension of the basic derivative. It encodes all of the (first-order) information about the rate-of-change of the function.\nIt is interesting and important to consider the numerical evaluation of the Jacobian, in the event that the function \\(\\mathbf{F}\\) cannot be easily differentiated exactly. The simplest algorithm is based on approximating each entry of the matrix by a finite difference.\nFor example, let us consider approximating \\[\n\\frac{\\mathrm{\\partial}f_i}{\\mathrm{\\partial}x_j}(\\mathbf{x}_0).\n\\] We define the \\(j\\)th unit vector by \\(\\mathbf{e}_j = [0 \\, 0 \\, \\cdots \\, 1 \\, \\cdots \\, 0]\\), which the \\(j\\)th entry being one and all entries being zero. Then we can approximate the derivative by a central difference, \\[\n\\frac{\\mathrm{\\partial}f_i}{\\mathrm{\\partial}x_j}(\\mathbf{x}_0) \\approx \\frac{f_i(\\mathbf{x}_0 + \\mathbf{e}_j h) - f_i(\\mathbf{x}_0 - \\mathbf{e}_j h)}{2h},\n\\] where \\(h\\) is a small step size.\nLet us test this by calculating the Jacobian for \\[\n\\mathbf{F}(\\mathbf{x}) = \\begin{pmatrix}\nx_1^2 \\\\\nx_2^2 \\\\\nx_1 x_2\n\\end{pmatrix}.\n\\] The pseudocode for this looks like this\n\n\n\n\n\n\nPseudocode for numerical Jacobian\n\n\n\nInput: function F (size m), point x (size n), step size h\n1. Create an (m x n) matrix, J\n2. a. Loop through all the rows indexed by i\n      b. Loop through all the columns indexed by j\n             Create the ej unit vector\n         Calculate the difference of F_i(x + h e_j) - F_i(x - h e_j)\n         Divide by 2h\n         Assign this value to the (i,j)th value of the Jacobian\n\nOutput: the (mxn) Jacobian matrix J\n\n\nHere is a code that puts it into practice.\n\nimport numpy as np\n\ndef jacobian(func,initial,delta=1e-3):\n  f = func\n  nrow = len(f(initial))\n  ncol = len(initial)\n  output = np.zeros(nrow*ncol)\n  output = output.reshape(nrow,ncol)\n  for i in range(nrow):\n    for j in range(ncol):\n      ej = np.zeros(ncol)\n      ej[j] = 1\n      dij = (f(initial+ delta * ej)[i] - f(initial- delta * ej)[i])/(2*delta)\n      output[i,j] = dij\n  return output\n  \ndef myf(x):\n  x1 = x[0]\n  x2 = x[1]\n  output = np.zeros(3)\n  output[0] = x[0]**2\n  output[1] = x[1]**2\n  output[2] = x[0]*x[1]\n  return output\n  \njacobian(myf,[1,2])\n\narray([[2., 0.],\n       [0., 4.],\n       [2., 1.]])",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>43</span>  <span class='chapter-title'>Finite difference approximations</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/coding.html",
    "href": "part-05-techniques/coding.html",
    "title": "44  Coding",
    "section": "",
    "text": "44.1 Variable scope\nDuring the 27 Feb 2024 lecture, the question of variable scope came up. Firstly, here is what ChatGPT says:\nSo indeed it looks like Python uses a scheme where if a variable is not locally declared, it will use values of the variable outside of the function. This can allow us to produce this kind of thing:\ndef myfunc():\n    print(a)\n\na = 1\nmyfunc()\na = 2\nmyfunc()\na = 3\nmyfunc()\n\n1\n2\n3\nSo I was wrong! Python variables are global when defined outside the function! Here is a reference.\nThis is certainly easier to use! However it can lead to confusion because for very complex codes, you may not be sure what value of a variable is being used within a function. Because most of the programming you will do in this course is very simple, this is unlikely to lead to trouble.\nIt’s generally good to avoid this whenever it is possible, though. For instance in this particular case, it makes much more sense to pass in the variable.\ndef myfunc(a):\n    print(a)\n\na = 99\nmyfunc(1)\nmyfunc(2)\nmyfunc(3)\n\n1\n2\n3\nIn the above case, the a that appears in the function is different from the a that is declared outside the function. This makes it very easy to understand what your function is doing without knowing what is happening outside of it.\nFor example, there is no danger of values being reset:\ndef myfunc(a):\n    a = a + 1000\n    print(a)\n\na = 99\nmyfunc(1)\nmyfunc(2)\nmyfunc(3)\nprint(a)\n\n1001\n1002\n1003\n99",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>44</span>  <span class='chapter-title'>Coding</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/coding.html#variable-scope",
    "href": "part-05-techniques/coding.html#variable-scope",
    "title": "44  Coding",
    "section": "",
    "text": "What ChatGPT says on scope",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>44</span>  <span class='chapter-title'>Coding</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/coding.html#conversations-with-chatgpt",
    "href": "part-05-techniques/coding.html#conversations-with-chatgpt",
    "title": "44  Coding",
    "section": "44.2 Conversations with ChatGPT",
    "text": "44.2 Conversations with ChatGPT\n\\(\\nextSection\\)\nWe should have an informal discussion of how the use of GenAI in education. Does it help with coding? When should it shoudn’t it be used?\nAsking something simple.\n\n\n\nA nice chat with ChatGPT\n\n\nWait a minute… \nModifying.. \nModifying again to oscillate in time… \nOops!",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>44</span>  <span class='chapter-title'>Coding</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/chatgpt-goes-wrong.html",
    "href": "part-05-techniques/chatgpt-goes-wrong.html",
    "title": "45  An example of ChatGPT going wrong",
    "section": "",
    "text": "45.1 Breakdown of issues\nTo solve the differential equation\n\\[\n\\epsilon^p y'' + y^2 = \\text{sech}(x)\n\\]\nusing matched asymptotics, we’ll first identify the scales of \\(y\\) and \\(x\\). Since we’re looking for solutions near \\(x = 0\\), we’ll assume a boundary layer solution near \\(x = 0\\) where \\(\\textrm{sech}(x)\\) is significant.\nIn the outer region, we’ll look for solutions where \\(y\\) is significant.\nFor small \\(x\\), the scale of \\(\\text{sech}(x)\\) is \\(O(1)\\), while for \\(y\\), the scale is \\(O(\\sqrt{\\epsilon})\\) where \\(\\epsilon\\) is a small parameter.\nLet \\(x = \\epsilon^\\alpha X\\), where \\(\\alpha\\) is to be determined later. For the inner region, we take \\(\\epsilon \\ll X \\ll 1\\), and for the outer region, we take \\(X = O(1)\\). We will match the solutions in the overlap region \\(0 \\leq X \\leq O(\\epsilon^\\beta)\\) where \\(\\beta &gt; \\alpha\\).\nSubstituting \\(x = \\epsilon^\\alpha X\\) and \\(y(x) = \\epsilon^\\gamma Y(X)\\) into the differential equation and neglecting terms of higher order in \\(\\epsilon\\) yields:\n\\[\ne^p \\epsilon^{-2\\alpha} Y'' + \\epsilon^{2\\gamma} Y^2 = \\text{sech}(\\epsilon^\\alpha X)\n\\]\nFor balance, we choose:\n\\[\n\\begin{gathered}\n2\\gamma - 2\\alpha = 0 \\implies \\gamma = \\alpha \\\\\n2\\alpha - 2\\alpha p = 0 \\implies p = 1\n\\end{gathered}\n\\]\nThus, we need to solve:\n\\[\nY'' + Y^2 = e^X\n\\]\nEverything else is wrong.",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>45</span>  <span class='chapter-title'>An example of ChatGPT going wrong</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/chatgpt-goes-wrong.html#breakdown-of-issues",
    "href": "part-05-techniques/chatgpt-goes-wrong.html#breakdown-of-issues",
    "title": "45  An example of ChatGPT going wrong",
    "section": "",
    "text": "Solution\n\n\n\n\n\nWhy did it change “ep” to \\(\\epsilon^p\\)?\n\n\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\nWhy did it assume the boundary layer is near \\(x = 0\\)? Also, \\(\\mathrm{x}\\) is not necessarily ``significant” near \\(x = 0\\).\n\n\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\nDoesn’t really make sense.\n\n\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\nThat’s not right…\\(x\\) is not \\(O(1)\\) near \\(y = 0\\). It’s not obvious at this point what the scaling for \\(y\\) is.\n\n\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\nThis isn’t right. In the inner region \\(X  = O(1)\\) and the outer region \\(X \\to \\infty\\). Almost all the statements are wrong.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\nThe above lines don’t make any sense. For one thing, near \\(x = 0\\), you should have \\(\\mathrm{sech}{x} \\sim 1\\). Secondly if you examine what its working gives, no value of \\(\\alpha\\) is obtained. The correct inner equation is found by balancing the first and last terms, giving \\(x = \\sqrt{\\epsilon} X\\) and \\[\nY'' + \\epsilon Y^2 = \\mathrm{sech}(\\epsilon x) \\sim 1.\n\\]",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>45</span>  <span class='chapter-title'>An example of ChatGPT going wrong</span>"
    ]
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Budyko, Mikhail I. 1969. “The Effect of Solar Radiation Variations\non the Climate of the Earth.” Tellus 21 (5): 611–19.\n\n\nFourier, Joseph. 1827. “Mémoire Sur Les\nTempératures Du Globe Terrestre Et Des Espaces\nPlanétaires.” Mémoires de\nl’Académie Royale Des Sciences de l’Institut de France\n7: 570–604.\n\n\nFowler, Andrew. 2011. Mathematical Geoscience. Vol. 36.\nSpringer.\n\n\nKaper, Hans, and Hans Engler. 2013. Mathematics and Climate.\nSIAM.\n\n\nMacKay, D. J. C. 2009. Sustainable Energy – Without the Hot\nAir. UIT Cambridge Ltd.\n\n\nPouillet, Claude Servais Mathias. 1838. “Memoire Sur Le Chaleur\nSolaire.” Paris.\n\n\nStommel, Henry. 1961. “Thermohaline Convection with Two Stable\nRegimes of Flow.” Tellus 13 (2): 224–30.\n\n\nVan der Veen, CJ. 2000. “Fourier and the ‘Greenhouse\nEffect’.” Polar Geography 24 (2): 132–52.",
    "crumbs": [
      "References"
    ]
  }
]