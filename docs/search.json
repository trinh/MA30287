[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "MA30287: Mathematics of Planet Earth",
    "section": "",
    "text": "Preface\nWelcome to to the 2022-23 delivery of MA30287 Maths of Planet Earth at the University of Bath.\nHere is a picture that represents the course."
  },
  {
    "objectID": "index.html#lectures-and-office-hours",
    "href": "index.html#lectures-and-office-hours",
    "title": "MA30287: Mathematics of Planet Earth",
    "section": "Lectures and office hours",
    "text": "Lectures and office hours\nLectures take place at the following times and locations:\n\nTuesdays 9:15 in 4E 3.10\nWednesdays 11:15 in 8W 3.22\nThursdays 15:15 in 8W 3.22\n\nOffice hours: You will be able to find me for an office hour in 4W 2.18 on Thursdays (following the lecture). Typically it is best to set this up, beforehand, by email appointment."
  },
  {
    "objectID": "index.html#coursework-and-examinations",
    "href": "index.html#coursework-and-examinations",
    "title": "MA30287: Mathematics of Planet Earth",
    "section": "Coursework and examinations",
    "text": "Coursework and examinations\nYour final mark will be 25% coursework and 75% final exam.\nDetails of the coursework will be released in Week 7 and it will be due in Week 101."
  },
  {
    "objectID": "index.html#resources",
    "href": "index.html#resources",
    "title": "MA30287: Mathematics of Planet Earth",
    "section": "Resources",
    "text": "Resources\nIn general, you will have access to a few kinds of resources:\n\nThe Moodle portal will be the main organisation portal.\nLecture notes, coursework, and other resources will be found in an online format and will be linked on Moodle.\nCoding will be done via the website https://maths.jupyterhub.bath.ac.uk.\n\nNaturally, because this is an entirely new module at Bath, there will be a fair amount of activity as we settle the material over the semester. Whenever we complete a lecture note (i.e. a ‘chapter’), we will use a box like this to indicate when the material was covered and in which lecture:\n\n\n\n\n\n\n2022-23 note\n\n\n\nThe material in this note was covered in Lecture XX.\n\n\nHopefully by the time the module ends, every relevant chapter will have such a note. This allows you to judge what material has been ‘finalised’."
  },
  {
    "objectID": "index.html#prerequisites",
    "href": "index.html#prerequisites",
    "title": "MA30287: Mathematics of Planet Earth",
    "section": "Prerequisites",
    "text": "Prerequisites\nThis course officially requires MA20221 (modeling and dynamical systems) or XX20231 (mathematical and statistical methods for the life sciences).\nIt is designed to be somewhat stand-alone in the sense that applied mathematical techniques learned in other courses will be introduced in some capacity. Such techniques will involve:\n\nSolutions of ordinary differential equations (MA10230 and MA20220).\nMultivariable calculus, partial differentiation, and multiple integrals (MA10230 and MA10236); some review/introduction of concepts from MA20223.\nDynamical systems, stability, phase planes (MA20221, MA30060).\nNumerical methods in Python (MA10276).\n\nWhenever possible, I have isolated such reviews/introductions and these can be found in the Mathematical methods section of these notes."
  },
  {
    "objectID": "index.html#resources-1",
    "href": "index.html#resources-1",
    "title": "MA30287: Mathematics of Planet Earth",
    "section": "Resources",
    "text": "Resources\nThis course is designed around the following sources:\n\nSustainable energy – without the hot air by (MacKay 2009)\nMathematics & Climate by (Kaper and Engler 2013)\nMathematical Geoscience by (Fowler 2011)\n\n\n\n\n\nFowler, Andrew. 2011. Mathematical Geoscience. Vol. 36. Springer.\n\n\nKaper, Hans, and Hans Engler. 2013. Mathematics and Climate. SIAM.\n\n\nMacKay, D. J. C. 2009. Sustainable Energy – Without the Hot Air. UIT Cambridge Ltd."
  },
  {
    "objectID": "part-intro/intro.html#mathematical-modelling-and-techniques",
    "href": "part-intro/intro.html#mathematical-modelling-and-techniques",
    "title": "1  Introduction",
    "section": "1.1 Mathematical modelling and techniques",
    "text": "1.1 Mathematical modelling and techniques\nIn the first chapter of (Fowler 2011), there is a concise introduction to the different categories of techniques and approaches that you might use when doing mathematical modelling in the real world. Some of these ideas will be introduced to you in this course.\nThey are as follows.\n\n1.1.1 Partial differential equations\n\n\n\n\n\n\nVectors and PDEs\n\n\n\nVectors and PDEs is not a prerequisite for this course, but naturally in studying anything related to the physical real world, we must discuss partial differential equations. The hope is that the necessary theory for PDEs will be presented to you as this course evolves, so that it can appreciated by both newcomers and experienced readers.\n\n\nA typical partial differential equation is as follows. Consider the temperature in the room, \\(T(x, y, z, t)\\), at a point given by the coordinates \\((x,y,z)\\), and at time \\(t\\). The most basic equation governing the temperature is the heat equation. It takes the form \\[\n\\frac{\\mathrm{\\partial}T}{\\mathrm{\\partial}t} = \\kappa\n\\]\n\n\n1.1.2 Conservation laws and constitutive laws\nConservation laws can be expressed as mathematical equations that represent the idea that some quantity is conserved. In processes governing the planet, these might correspond to conservation of heat, of water, of air, of momentum, etc.\nThey often take the general form of a partial differential equation of the form \\[\n\\frac{\\mathrm{\\partial}\\phi}{\\mathrm{\\partial}t} + \\nabla \\cdot \\mathbf{f} = S,\n\\] where \\(\\phi\\) is the quantity being conserved, \\(\\mathbf{f}\\) is the ‘flux’, which represents the transport of \\(\\phi\\) in the medium, and \\(S\\) represents source (\\(S > 0\\)) or sink (\\(S < 0\\)) terms. At the most basic level, you can imagine that all physical processes on Earth are governed by equations similar to the above.\nIn Chapter 2, we will develop the simplest possible model governing the temperature on the surface of the Earth. It is a conservation equation for energy.\n\n\n1.1.3 Non-dimensionalisation and scaling\nPutting a mathematical model into non-dimensional form is fundamental (Fowler 2011).\n\n\n1.1.4 Approximations\n\n\n1.1.5 The qualitative study of differential equations\n\n\n1.1.6 Numerical analysis\n\n\n\n\nFowler, Andrew. 2011. Mathematical Geoscience. Vol. 36. Springer.\n\n\nKaper, Hans, and Hans Engler. 2013. Mathematics and Climate. SIAM.\n\n\nMacKay, D. J. C. 2009. Sustainable Energy – Without the Hot Air. UIT Cambridge Ltd."
  },
  {
    "objectID": "part-intro/basic-energy-model.html#the-basic-energy-model",
    "href": "part-intro/basic-energy-model.html#the-basic-energy-model",
    "title": "2  Basic energy models",
    "section": "2.1 The basic energy model",
    "text": "2.1 The basic energy model\nThe basic model is derived as follows.\n\nBy considering the incoming radiation from the sun, obtain an estimate for the incoming energy, \\(E_{\\text{in}}\\).\nUse a constitutive law that indicates how much outgoing energy is produced by an object heated to some temperature.\nEquate the change in internal energy to be equal to the difference between the above two items.\n\nNote that the primary components of the global energy balance are radiative fluxes: we receive short-wave radiation (UV and visible light) from the Sun, and emit longwave radiation (infra-red) to space.\n\n\n\nFigure 2.1: Radiation in the atmosphere\n\n\nFirst we consider incoming energy.\n\n\n\n\n\n\nEnergy from the Sun\n\n\n\nFirst, note that the shortwave radiation (UV and radiation) recieved from the sun is \\(Q \\approx 1370 \\text{ W$\\cdot$m$^{-2}$}\\) (which we consider measured at a point near the planet).\nIf we consider only that radiation that is absorbed into the Earth, we have \\[\nE_{\\mathrm{in}} = \\pi R^2 Q (1 - a),\n\\tag{2.2}\\] where \\(R\\) is the Earth’s radius.\nIn the above formula, we have multiplied the flux, \\(Q\\), with the visible surface area, \\(\\pi R^2\\). There is an additional multiplication by \\((1 - a)\\) where \\(a\\) is the planetary albedo, which characterises amount of energy reflected due to the surface properties. Light surfaces like snow will have high albedo, \\(a \\approx 0.9\\), while darker surfaces like the ocean have smaller albedo, \\(a \\approx 0.3\\). The global average albedo is \\(a \\approx 0.3\\).\n\n\nNext we consider outgoing energy.\n\n\n\n\n\n\nEnergy from the Earth\n\n\n\nWe now wish to characterise the energy, \\(E_{out}\\), and in the case of Earth, this will correspond to longwave radiation (infra-red) emitted into space. All bodies characterised by a temperature, say \\(T_e\\), will emit radiation, \\(Q_e\\). As a model, we can consider \\(Q_e\\) to be given by the Stefan-Boltzmann law, which states that \\[\nQ_e = \\sigma T_e^4,\n\\tag{2.3}\\] where \\(\\sigma \\approx 5.67 \\times 10^{-8} W m^{-2} K^{-4}\\) is the Stefan-Boltzmann constant.\nNow although the Earth’s surface may emit radiation according to (Equation 2.3), some of this radiation will be absorbed by the atmosphere and reflected back. This is the greenhouse effect. As a consequence of the greenhouse gas, the surface temperature of the Earth, \\(T\\), will be larger than the effective emitting temperature, \\(T_e\\). For the moment, we model this as \\[\nT_e = \\gamma^{1/4} T_e,\n\\tag{2.4}\\] where \\(\\gamma < 1\\) is a greenhouse gas factor, which depends on the properties of the atmosphere.\n\n\nNow combining the above equations, we have \\[\nE_{\\mathrm{in}} - E_{\\mathrm{out}} = \\pi R^2 Q (1 - a) - 4\\pi R^2 \\sigma \\gamma T^4,\n\\tag{2.5}\\] which gives the incoming energy per unit time.\n\n\n\n\n\n\nInternal heat energy\n\n\n\nDue to this incoming energy, the Earth will cool or heat in response. We need to know how the internal temperature of an object responds to an input in energy. The general formula is \\[\n\\text{Internal heat energy} = \\text{volume} \\times (\\rho c_p) \\times T.\n\\] The key quantity is the experimentally determined, \\(c_p\\), which corresponds to the specific heat capacity. It is given in the SI units of \\(\\mathrm{J} \\cdot \\mathrm{kg}^{-1} \\cdot \\mathrm{K}^{-1}\\), i.e. energy per unit mass per unit temperature. Note that this applied to a shell around the planet of thickness \\(d\\) in the atmosphere, and so the mass is given by \\[\n\\text{mass} = (4 \\pi R^2) d \\rho\n\\tag{2.6}\\] where \\(\\rho\\) is the average density of the atmosphere. Let us imagine the increase in temperature, \\(\\Delta T\\),during an interval of time, \\(\\Delta t\\). You can now verify that \\[\n\\Bigl[ (4 \\pi R^2) d \\rho \\Bigr] c_p (\\Delta T)\n\\] returns the units of Joules—i.e. this is the internal energy produced during the time \\(\\Delta t\\). We then have \\[\n\\Bigl[ (4 \\pi R^2) d \\rho \\Bigr] c_p \\Delta T =  \\Delta t (E_{in} - E_{out}).\n\\] Putting in (Equation 2.5) and taking the limit of \\(\\Delta t \\to 0\\), we finally have a heat equation for the Earth’s temperature given by the following ordinary differential equation (ODE) for \\(T = T(t)\\),\n\\[\nc \\frac{\\mathrm{d}T}{\\mathrm{d}t} = \\frac{1}{4} Q(1 - a) - \\sigma \\gamma T^4,\n\\tag{2.7}\\] where we have defined \\(c = \\rho c_p d\\) as the heat capacity of the atmosphere.\n\n\nThe above equation Equation 2.7 is time-dependent, but we may consider that the surface temperature, either over long-time or in an averaged sense, is dictated by the steady-state (time-independent) solution. Setting \\(\\mathrm{d}T/\\mathrm{d}t\\) to zero, we see that there is a unique steady-state given by \\[\nT = \\left(\\frac{Q(1-a)}{4\\sigma\\gamma}\\right)^{1/4}.\n\\]\nIf we take \\(Q \\approx 1370 \\,\\mathrm{W m}^{-2}\\), \\(a \\approx 0.3\\), \\(\\sigma \\approx 5.67 \\times 10^{-8} \\mathrm{W} \\,\\mathrm{m}^{-2} \\mathrm{K}^{-4}\\), we then get \\[\nT \\approx 255 \\mathrm{K} = -18^\\circ \\mathrm{C}.\n\\] under the assumption that \\(\\gamma = 1\\). That’s pretty cold! The actual average temperature is around \\(288 \\mathrm{K} \\approx 15 ^\\circ \\mathrm{C}\\).\nThe above back-of-the-envelope calculation seems to suggest that the parameter \\(\\gamma < 1\\) plays an important role in keeping the Earth warm enough for us to live on, and indeed the value of \\(\\gamma\\) inferred by the above is roughly \\(\\gamma \\approx 0.61\\). Later on in the course, we will develop a more rigorous model to predict such a \\(\\gamma\\) by studying the properties of the atmosphere."
  },
  {
    "objectID": "part-intro/basic-energy-model.html#the-history-of-global-warming",
    "href": "part-intro/basic-energy-model.html#the-history-of-global-warming",
    "title": "2  Basic energy models",
    "section": "2.2 The history of global warming",
    "text": "2.2 The history of global warming\nThe history of global warming (and hence the estimation of \\(\\gamma\\)) is convoluted, but the origins can be considered as far back as the work of (Fourier 1827) and (Pouillet 1838), and is discussed in the work by (Van der Veen 2000).\n\n\n\nFigure 2.2: An illustration of Fourier’s glass box"
  },
  {
    "objectID": "part-intro/basic-energy-model.html#references",
    "href": "part-intro/basic-energy-model.html#references",
    "title": "2  Basic energy models",
    "section": "2.3 References",
    "text": "2.3 References\n\nChap. 1 of (Kaper and Engler 2013)\nChap. 2 of (Fowler 2011)\n\n\n\n\n\nFourier, Joseph. 1827. “Mémoire Sur Les Températures Du Globe Terrestre Et Des Espaces Planétaires.” Mémoires de l’Académie Royale Des Sciences de l’Institut de France 7: 570–604.\n\n\nFowler, Andrew. 2011. Mathematical Geoscience. Vol. 36. Springer.\n\n\nKaper, Hans, and Hans Engler. 2013. Mathematics and Climate. SIAM.\n\n\nPouillet, Claude Servais Mathias. 1838. “Memoire Sur Le Chaleur Solaire.” Paris.\n\n\nVan der Veen, CJ. 2000. “Fourier and the ‘Greenhouse Effect’.” Polar Geography 24 (2): 132–52."
  },
  {
    "objectID": "part-energy.html",
    "href": "part-energy.html",
    "title": "Energy usage and energy sources",
    "section": "",
    "text": "The first part of this course is centred upon a seminal book by Cambridge physicist David MacKay (MacKay 2009) that was written a number of years ago.\n\n\n\nFigure 1: Cover of MacKay’s book\n\n\nUnlike many other books and discussions on the topic of energy, this one is written with the emphasis placed on developing simple back-of-the-envelope estimates of usage. This is a great philosophy, and one that does well to cut straight to the heart of more long-winded discussions.\nMacKay’s book was published with an open license, and can be freely downloaded at https://www.withouthotair.com/.\n\n\n\n\nMacKay, D. J. C. 2009. Sustainable Energy – Without the Hot Air. UIT Cambridge Ltd."
  },
  {
    "objectID": "part-energy/mackay-energy.html#the-industrial-revolution-and-its-effects",
    "href": "part-energy/mackay-energy.html#the-industrial-revolution-and-its-effects",
    "title": "3  The CO2 concentration",
    "section": "3.1 The Industrial Revolution and its effects",
    "text": "3.1 The Industrial Revolution and its effects\nIn his book, MacKay offers the following graph of carbon dioxide (CO2) concentration.\n\n\n\nFigure 3.1: Upper graph showing carbon dioxide concentrations (in parts per million). The middle graph shows the history of UK coal production, Saudi oil production, world oil production, and total of all greenhouse gas emissions (shown circled). The bottom graph shows the similar trends as associated with the industrial revolution. Note scales of last two graphs are logarithmic.\n\n\nIt is remarked that the sudden rise of CO2 concentration is attributed to the industrial revolution, with a key event being the invention of the steam engine in 1769. Correlations between the rise and other key industries can also be established, including correlations with population increase, the growth of British ships and pig-iron production, and oil and coal production.\nSo in a nutshell, Mackay quite strongly argues that the significant rises in measured CO2 are the result of human influence and notably the downstream effects of the Industrial Revolution.\n\n\n\n\n\n\nNote\n\n\n\nMackay notes that in the various visualisations and explanations, greenhouse gases include carbon dioxide, methane, nitrous oxide, but Mackay expresses emissions in “equivalent amounts of CO2” where equivalent means having the same warming effect over a hundred years."
  },
  {
    "objectID": "part-energy/mackay-energy.html#doubling-of-co2",
    "href": "part-energy/mackay-energy.html#doubling-of-co2",
    "title": "3  The CO2 concentration",
    "section": "3.2 Doubling of CO2",
    "text": "3.2 Doubling of CO2\nWhat happens if CO2 concentration is doubled? This is one of the key questions that McKay discusses. Models seem to indicate that a doubling of CO2 would have the same effect as increasing the intensity of the sun by 2% and global temperatures rising by 3\\(^\\circ\\)C. Mackay notes (p. 10) that\nThis is what historians call a Bad Thing. I won’t recite the whole litany of probable drastic effects, as I am sure you’ve heard it before. The litany begins “the Greenland icecap would gradually melt, and, over a period of a few 100 years, sea-level would rise by about 7 metres.” The brunt of the litany falls on future generations. Such temperatures have not been seen on earth for at least 100 000 years, and it’s conceivable that the ecosystem would be so significantly altered that the earth would stop supplying some of the goods and services that we currently take for granted.\nThere is an excellent scientific paper by (Charney et al. 1979) that is cited by Mackay in footnote 10 on p.20, and which you should be able to find in the extended references of your Moodle page. This is a very readable scientific paper that summarises the current state-of-the art in simulations from 1979—which is still largely valid today. The authors of the review essentially conclude two facts.\n\nDoubling atmospheric CO2 would change net heating of the troposphere, oceans, and land by an average power per unit area of roughly 4W/m^2. Since the average power absorbed by the atmosphere, land, and oceans is approximately 238 W/m^2, then this would be equivalent to increasing the sun’s intensity by about 1.7%.\nThe effect of global temperatures is more difficult, since this involves some complex simulations. However, the current simulations seem to predict an increase of between 2\\(^\\circ\\)C and 3.5\\(^\\circ\\)C.\n\n\n\n\n\n\n\nNote\n\n\n\nIt is possible to develop a back-of-the-envelope calculation to estimate the rise in temperature via doubling of CO2 and this was done as early as 1896 by Arrhenius(!) (Arrhenius 1896)"
  },
  {
    "objectID": "part-energy/mackay-energy.html#who-should-fix-it",
    "href": "part-energy/mackay-energy.html#who-should-fix-it",
    "title": "3  The CO2 concentration",
    "section": "3.3 Who should fix it?",
    "text": "3.3 Who should fix it?\nSo to whom does the responsibility lie to fix the issue? There are different visualisations possible in order to make this argument. For example, one can examine estimates of the rate of GG poulation per population (tons of CO2 emissions per year per person). This would tell you who are the current biggest offenders.\nHowever, an alternative viewpoint is that the responsible party should be the party who was the largest polluter in time (i.e. find each country’s total historical footprint and divide by the populace). This produces the following graph.\n\n\n\nFigure 3.2: A graph of the average pollution rate vs. the population\n\n\nNote that the units of the vertical axis are given as tons of CO2 per year per person.\nSo how much do we need to reduce in order to “guarantee” global temperatues do not rise more than 2\\(^\\circ\\)C? At the end of the chapter, Mackay summarises the situations as follows. The plans require global emissions to fall by 70% or 85% by 2050. In the UK, for instance, 11 tons of CO2/y.p would need to be changed to 1.1 tons of CO2/y.p.\n\n\n\n\n\n\nImportant\n\n\n\n“This [the necessary reduction of carbon footprint per person] is such a deep cut, I suggesst the best way to think about it is no more fossil fuels”.\n\n\n\n\n\n\nArrhenius, Svante. 1896. “XXXI. On the Influence of Carbonic Acid in the Air Upon the Temperature of the Ground.” The London, Edinburgh, and Dublin Philosophical Magazine and Journal of Science 41 (251): 237–76.\n\n\nCharney, Jule G, Akio Arakawa, D James Baker, Bert Bolin, Robert E Dickinson, Richard M Goody, Cecil E Leith, Henry M Stommel, and Carl I Wunsch. 1979. Carbon Dioxide and Climate: A Scientific Assessment. National Academy of Sciences, Washington, DC.\n\n\nMacKay, D. J. C. 2009. Sustainable Energy – Without the Hot Air. UIT Cambridge Ltd."
  },
  {
    "objectID": "part-energy/mackay-units.html#units",
    "href": "part-energy/mackay-units.html#units",
    "title": "4  Units and physics",
    "section": "4.1 Units",
    "text": "4.1 Units\n\nDefinition 4.1 (Unit of energy) The SI unit of energy is a Joule (J). In discussing usage, however, we will often use the kilowatt-hour (kWh).\n\n\nDefinition 4.2 (Unit of power) The SI unit of power is a Watt (W), equivalent to 1 J/s. Thus 1 kW of power is 1000 J/s. Power can also be measured in kWh per day.\n\nSo based on the above, let us unpack one unit of energy (kWh) in terms of Joules.\n\\[\n[E] = 1\\mathrm{kWh} = (10^3 \\mathrm{J/s}) \\times \\left(3.6 \\cdot 10^3 \\frac{\\mathrm{s}}{\\mathrm{hr}}\\right) \\cdot 1 \\mathrm{hr} = 3.6 \\cdot 10^6 \\mathrm{J}.\n\\]\n\n\n\n\n\n\nNote\n\n\n\nOne 40W lightbulb left on for a day uses about 1 kWh via the following argument.\n\\[\n40 \\mathrm{W} \\cdot 1 \\mathrm{day} = 40 \\cdot 10^{-3} \\mathrm{kW} \\cdot 24 \\mathrm{hours} = 0.96 \\mathrm{kWh}.\n\\]\n\n\nSo to repeat, for measurement of electricity, the unit we will often use is the kWh, and 1 kWh is approximately the energy required to light a (40W) lightbulb for an entire day. Given the importance of understanding your energy bills, thinking in terms of those quantities will help you remember. See below note.\n\n\n\n\n\n\nNote\n\n\n\nExamining the current Shell Energy tarifs as of mid October 2022, the unit rate of electricity is 21.6p/kWh and the unit rate of gas is 4.2p/kWh. This is about double the figures quoted in (MacKay 2009)!\n\n\n\nDefinition 4.3 (Kilo, mega, giga, tera) Kilo means a multiplier of \\(10^3\\). Similarly, Mega is a multiplier of \\(10^6\\), Giga a multiplier of \\(10^9\\), and Tera a multipier of \\(10^{12}\\)."
  },
  {
    "objectID": "part-energy/mackay-units.html#energy-equivalences",
    "href": "part-energy/mackay-units.html#energy-equivalences",
    "title": "4  Units and physics",
    "section": "4.2 Energy equivalences",
    "text": "4.2 Energy equivalences\nAs the fundamental law of thermodynamics goes, energy cannot be created nor destroyed. However, not all energies are equivalent because there are penalties and efficiencies when one converts from one energy type to another (in terms of usable energy). For example:\n\nA fossil fuel plant will convert from chemical energy to electrical energy at an efficiency of about 40%.\nAn aluminium plant will convert from elecrical energy to manufacture aluminium (and hence chemical energy) at an efficiency of about 30%.\n\nBecause of the above, in common usage, some tables of energy usage will include the conversion factors while others will not. For example, consider a power station that converts 2.5 kWh of oil into 1 kWh of electrical energy (an efficiency of 40%). We might then write \\[\nE_\\mathrm{electrical} = E_\\mathrm{oil} \\cdot 0.4\n\\] but the above is a confusing statement if you assume that there is a single intrinsic notion of energy, \\(E\\). Do we set \\(E = E_\\mathrm{oil}\\) or \\(E = E_\\mathrm{electrical}\\)?. If this further confuses you, ask the following question: what does \\(E_\\mathrm{oil}\\) mean if one does not consider a conversion process?\nIn order to avoid this confusion, MacKay uses (p. 27) the convention of treating energy values as equivalent, i.e. 1 kWh of chemical energy is the same as 1 kWh of electrical energy.\n\n\n\n\n\n\nNote\n\n\n\nAs MacKay notes (p. 27) the above assumption is not the same as assuming that all energy can be converted to one and the other without loss.\n\n\n\n\n\n\nMacKay, D. J. C. 2009. Sustainable Energy – Without the Hot Air. UIT Cambridge Ltd."
  },
  {
    "objectID": "part-energy/mackay-consumption.html#tips-for-estimates",
    "href": "part-energy/mackay-consumption.html#tips-for-estimates",
    "title": "5  Estimating consumption",
    "section": "5.1 Tips for estimates",
    "text": "5.1 Tips for estimates\n\nUse appropriate conversion of units.\n\nFor example, even though you may not know what specific heat means (see below question about the bath hot water usage), examining the units of Joules/(Litre x Celcius) should tell you that this quantity corresponds to energy per unit volume per unit degree Celcius. Specific heat is a quantity associated with certain materials that describe the energy requred to increase its volume by one degree.\n\nManipulate different forms of energy\n\nAn object of mass \\(m\\) moving at speed \\(v\\) possesses kinetic energy given by \\[\nE_\\mathrm{kinetic} = \\frac{1}{2} mv^2.\n\\] An object can also possess different kinds of potential energy. For example, an object of mass \\(m\\) that will fall when released possesses gravitational potential energy given by \\[\nE_\\rm{grav. potential} = mgh\n\\] where \\(h\\) is its distance relative to some given point and \\(g = 9.8 \\, \\mathrm{m/s^2}\\) is the standard gravitational constant on the surface.\nA hot object also possesses heat energy. The heat energy is given by \\[\nE_\\mathrm{heat} = c \\rho V T\n\\] where \\(c\\) is the specific heat capacity, \\(\\rho\\) is the density, \\(V\\) is the volume, and \\(T\\) is the temperature. An object can also possess chemical potential energy (for example, we possess such energy when we eat food). And so forth and so on.\n\n\n\n\n\n\nChecking energies\n\n\n\nIt is a good idea to check that all the above units make sense and the right hand-sides return the expected unit of energy."
  },
  {
    "objectID": "part-energy/mackay-consumption.html#heating-and-cooling",
    "href": "part-energy/mackay-consumption.html#heating-and-cooling",
    "title": "5  Estimating consumption",
    "section": "5.2 Heating and cooling",
    "text": "5.2 Heating and cooling\nWe would like to develop estimates of energy usage in heating and cooling.\n\n\n\n\n\n\nEnergy in a hot bath\n\n\n\nTo compute the heat energy in taking a hot bath, we take the specific heat capacity of water, \\(c = 4200 \\, \\mathrm{J}/(\\mathrm{L} \\, ^{\\circ}\\mathrm{C})\\). This multiplies the volume of a bath (50 cm x 15 cm x 150 cm), and the temperature of water minus the temperature of ambient water, estimated at \\(40^\\circ\\mathrm{C}\\). This gives \\[\nE_\\mathrm{hot bath} \\approx (4200 \\times 110 \\times 40) \\mathrm{J} \\approx 18 \\, \\mathrm{MJ} \\approx 5 \\, \\mathrm{kWh}.\n\\]\n\n\n\n\n\n\n\n\nEnergy in appliances\n\n\n\nFor example, consider a kettle with a voltage of \\(V = 230V\\) and a max amperage of \\(I = 13A\\). Voltage measures the potential difference of electricity, and amperage measures the current. If you multiply the two together, \\(VI = P\\), you get power, \\(P\\). So this kettle has power \\(P = 3\\mathrm{kW}\\).\nTo estimate usage, we must estimate how often the kettle is used and for how long. Considering 20 minutes per household of two people, this then requires \\[\nE_\\mathrm{kettle} \\approx (3 \\mathrm{kW}) \\times \\left(20 \\, \\mathrm{min} \\times \\frac{\\mathrm{hrs}}{60\\mathrm{min}}\\right) = 1 \\mathrm{kWh}.\n\\]\nYou may also be interested in MacKay’s estimates for microwave ovens (0.5 kWh/day), regular ovens (1.5 kWh/day), and clothes washers (1 kWh/day).\n\n\nFollowing (MacKay 2009), you can also follow similar estimates of using space heaters, regridgerators, and air conditioners.\n\n\n\n\n\n\nHot air and cooling\n\n\n\nMackay develops the following estimates of energy usage (per day per person). Considering space heaters run during the colder months, he develops\n\\[\nE_\\text{hot air} \\approx 24\\,\\text{kWh}.\n\\] while considering the regridgerator and air condition usage, he approximates \\[\nE_\\text{heat + cooling} \\approx 1.5 \\, \\mathrm{kWh}.\n\\]\n\n\nNote that the above estimates are for average domestic consumption, and hence this does not include the significant energy usages of the service and workplace industries. The total estimate from this chapter is as follows.\n\n\n\n\n\n\nTotal heating and cooling estimate\n\n\n\nMacKay estimates (p. 53) that the total energy one (domestic) person spends on heating and cooling, including home, workplace, and cooking, is 37 kWh per day per person (12 for hot water, 24 for hot air, and 1 for cooling). He notes that this seems to be close to the typical figures quoted (45 kWh/d per person) if you make use of some national tables (and some liberties—like using the University of Cambridge’s energy estimates)."
  },
  {
    "objectID": "part-energy/mackay-consumption.html#energy-usage-of-stuff",
    "href": "part-energy/mackay-consumption.html#energy-usage-of-stuff",
    "title": "5  Estimating consumption",
    "section": "5.3 Energy usage of stuff",
    "text": "5.3 Energy usage of stuff\nA significant amount of energy is expended on:\n\nproduction of raw materials\nproduction on stuff and transportation of such\nuse of stuff\ndisposal and recycling of stuff\n\n\n\n\n\n\n\nEnergy usage in a soda addict\n\n\n\nConsider someone who has a coca-cola addiction and drinks five cans of coke a day. What is their energy usage in this regard? On the assumption that the raw aluminium material phase dominates (production of metals is intensive), MacKay notes that one can needs about 0.6kWh of energy. Thus \\[\nE_\\text{coke} \\approx 5 \\times 0.6 \\, \\mathrm{kWh} = 3 \\, \\mathrm{kWh}\n\\] as the per day per person figure."
  },
  {
    "objectID": "part-energy/mackay-consumption.html#energy-usage-of-transportation",
    "href": "part-energy/mackay-consumption.html#energy-usage-of-transportation",
    "title": "5  Estimating consumption",
    "section": "5.4 Energy usage of transportation",
    "text": "5.4 Energy usage of transportation\n\n5.4.1 Cars\n\n\n5.4.2 Airplanes\n\n\n\n\nMacKay, D. J. C. 2009. Sustainable Energy – Without the Hot Air. UIT Cambridge Ltd."
  },
  {
    "objectID": "part-energy/mackay-renewables.html",
    "href": "part-energy/mackay-renewables.html",
    "title": "6  Estimating power from renawables",
    "section": "",
    "text": "2022-23 note\n\n\n\nThis material has not yet been finalised and is still under construction. Once it is covered in lectures, this banner will be replaced.\n\n\n\n\n\n\n\n\nReference\n\n\n\nThis chapter will follow the investigations of some of the various renewable sources presented in Parts 1 and 3 of (MacKay 2009).\n\n\n    \n\n\n\n\nMacKay, D. J. C. 2009. Sustainable Energy – Without the Hot Air. UIT Cambridge Ltd."
  },
  {
    "objectID": "part-box.html#physical-vs.-conceptual-vs.-statistical-models",
    "href": "part-box.html#physical-vs.-conceptual-vs.-statistical-models",
    "title": "Box models and dynamical systems",
    "section": "Physical vs. conceptual vs. statistical models",
    "text": "Physical vs. conceptual vs. statistical models"
  },
  {
    "objectID": "part-box/box-energy-model.html#steady-state-analysis",
    "href": "part-box/box-energy-model.html#steady-state-analysis",
    "title": "7  Steady-states of the basic energy model I",
    "section": "7.1 Steady-state analysis",
    "text": "7.1 Steady-state analysis\nPreviously, we have assumed that the planetary albedo, \\(a\\), is constant and independent of temperature. In actuality, water can turn to snow and ice and vice versa, and since snow and ice have much higher albedo than open water, then we should consider \\(a = a(T)\\).\nWe know that there are two relevant ranges to consider: \\[\na(T) \\approx\n\\begin{cases}\n0.7 & \\mathrm{if }\\, T < 150\\mathrm{K}, \\\\\n0.3 & \\mathrm{if }T > 280\\mathrm{K}.\n\\end{cases}\n\\] Basically, the above guarantees that more energy is reflected if temperatures are low. To model this, we can use a ramp function, \\[\na(T) = A - B \\mathrm{tanh}\\left(k(T - 265)\\right).\n\\tag{7.2}\\] where \\(A = 0.5\\), \\(B = 0.3\\), \\(k = 0.1\\), and \\(T_0 = 265\\).\nUsing parameters from (Kaper and Engler 2013) p.16 and p.17, we can study the steady-state solution, which is given by seeking the zeros of \\[\n\\frac{1}{4}Q[1 - a(T)] = \\sigma \\gamma T^4.\n\\] Note that (Kaper and Engler 2013) use \\(Q = 342\\) but they do not have the initial pre-factor of \\(1/4\\). So we shall use \\(Q = 1370\\) (noting \\(1370/4 = 342.5\\)).\n\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport scipy.optimize as sciopt\n\nQ = 1370\nsigma = 5.67e-8 \ngamma = 0.62\n\nTT = np.linspace(220,310,50)\n\ndef fun(T):\n    a = 0.5 - 0.2*np.tanh((T - 265)/10)\n    x = (1-a)*Q/4\n    return x\nLHS = fun(TT)\n\nplt.plot(TT, LHS)\nplt.plot(TT, gamma*sigma*TT**4, 'k--')\n\ndef eq(T):\n    x = fun(T) - gamma*sigma*T**4\n    return x\nT1 = sciopt.fsolve(eq, 230)\nT2 = sciopt.fsolve(eq, 265)\nT3 = sciopt.fsolve(eq, 290)\nprint(\"T1 = {:.2f}\".format(T1[0]))\nprint(\"T2 = {:.2f}\".format(T2[0]))\nprint(\"T3 = {:.2f}\".format(T3[0]))\n\nT1 = 232.63\nT2 = 265.50\nT3 = 286.86\n\n\n\n\n\nTherefore multiple equilibria are observed. You can argue (how?) that the centre equilbria is unstable while the other two are stable. The higher temperature corresponds to the one that the Earth is currently in, but according to this model, there seems to be the possibility of a colder climate (50 degrees colder) where the Earth is entirely covered with snow and ice."
  },
  {
    "objectID": "part-box/box-energy-model.html#newton-solver-for-the-steady-states",
    "href": "part-box/box-energy-model.html#newton-solver-for-the-steady-states",
    "title": "7  Steady-states of the basic energy model I",
    "section": "7.2 Newton solver for the steady states",
    "text": "7.2 Newton solver for the steady states\nIn the above code, we used the built-in Python codes (fsolve) to solve for the steady-states. It is a good idea to learn (or review, if you have learned it previously) how to design your own solver. An implementation of Newton’s solver is given by the following pseudo-code:\n\n\n\n\n\n\nPseudocode for Newton’s method\n\n\n\n1. input x0, tolerance, maxiterations, f, df\n\n2. repeat while |f(x0)| > tol and iterations < maxiterations\n\n    a. set y0 = f(x0)\n       set yp = df(x0)\n    \n    b. set x1 = x0 - y0/yp\n\n    c. print iter #, x1, and f(x1)\n\n    d. set x0 = x1\n\n\nWe discuss Newton’s method in Chapter 18.\nUsing the simplest Newton code there, we can solve for one of the roots.\n\nimport numpy as np\n\ndef Newton(f, df, x, maxiter=100, tol=1e-12, display=0):\n    i = 0\n    while (abs(f(x) - 0) > tol) and (i < maxiter):\n        err = f(x)\n        x = x - err / df(x)\n        if display == 1:\n            print(\"f(x) = \", np.abs(err), \", x = \", x)\n        i = i + 1\n    return x, err\n\n\nQ = 1370\nsigma = 5.67e-8\ngamma = 0.62\n\na = lambda T: 0.5 - 0.2*np.tanh((T - 265)/10)\nda = lambda T: -0.2*1/np.cosh((T-265)/10)**2/10\n\nf = lambda T: Q/4*(1-a(T)) - sigma*gamma*T**4\ndf = lambda T: -Q/4*da(T) - 4*sigma*gamma*T**3\n\nx = 290\nx, err = Newton(f, df, x, 10, 1e-8, 1)\nprint(\"Final approximation = \", x)\n\nf(x) =  9.804483316627028 , x =  286.98075256805225\nf(x) =  0.36161336669368893 , x =  286.85997144120904\nf(x) =  0.000725960590870045 , x =  286.8597279859311\nFinal approximation =  286.8597279859311"
  },
  {
    "objectID": "part-box/box-energy-model.html#exercises",
    "href": "part-box/box-energy-model.html#exercises",
    "title": "7  Steady-states of the basic energy model I",
    "section": "7.3 Exercises",
    "text": "7.3 Exercises\n\nDevelop asymptotic approximations of the steady state temperatures (three roots) in the limits of large and small \\(k\\) in Equation 7.2.\n\n\n\n\n\nKaper, Hans, and Hans Engler. 2013. Mathematics and Climate. SIAM."
  },
  {
    "objectID": "part-box/box-energy-model2.html#poor-persons-numerical-continuation",
    "href": "part-box/box-energy-model2.html#poor-persons-numerical-continuation",
    "title": "8  Steady-states of the basic energy model II",
    "section": "8.1 Poor person’s numerical continuation",
    "text": "8.1 Poor person’s numerical continuation\nSuppose that we are interested in studying how the steady-states (up to three) change as \\(Q\\) changes. Then we are interested in producing a diagram of \\(Q\\) vs. \\(T\\). The basic idea is to start with an initial solution at some value of \\(Q\\), increment \\(Q\\), then solve for the next value using the previous value as a guess. This involves the following pseudocode:\n\n\n\n\n\n\nPoor person’s numerical continuation\n\n\n\n1. Input guess T0, f, df, parameter Q1\n\n    a. Call Newton's method via Newton(f, df, T0, Q1) \n    b. Obtain a preliminary solution (T1, Q1)\n\n2. Increment Q1 = Q1 + dQ \n\n    a. Call Newton's method via Newton(f, df, T1, Q1)\n    b. Obtain a new solution (T1, Q1)\n\n3. Repeat 2 until we reach a desired Q value\n\n\nUnfortunately this does not work as well as we would like.\n\nimport numpy as np\nimport matplotlib.pyplot as plt\n\ndef Newton(f, df, x, maxiter=100, tol=1e-12, display=0):\n    i = 0\n    while (abs(f(x) - 0) > tol) and (i < maxiter):\n        err = f(x)\n        x = x - err / df(x)\n        if display == 1:\n            print(\"f(x) = \", np.abs(err), \", x = \", x)\n        i = i + 1\n    return x, err\n\n\nsigma = 5.67e-8\ngamma = 0.62\na = lambda T: 0.5 - 0.2*np.tanh((T - 265)/10)\nda = lambda T: -0.2*1/np.cosh((T-265)/10)**2/10\n\nQ0 = 1370\nQmat = np.linspace(1000, 1800, 30)\nTmat = 0*Qmat\nx = 220\n\nfor i, Q in enumerate(Qmat):\n    f = lambda T: Q/4*(1-a(T)) - sigma*gamma*T**4\n    df = lambda T: -Q/4*da(T) - 4*sigma*gamma*T**3\n\n    x, err = Newton(f, df, x, 10, 1e-8, 0)\n    if err > 1e-4:\n        print(\"Careful no convergence at Q/Q0 = \", Q/Q0)\n    Tmat[i] = x\n\nplt.plot(Qmat/1370, Tmat);\nplt.xlabel('Q/Q0');\nplt.ylabel('T');\n\nCareful no convergence at Q/Q0 =  1.2131890259249938\nCareful no convergence at Q/Q0 =  1.2735967782532092\nCareful no convergence at Q/Q0 =  1.2937326956959476\nCareful no convergence at Q/Q0 =  1.313868613138686\n\n\n\n\n\nAbove, we have scaled \\(Q\\) with the reference value of \\(Q_0 = 1370\\). The problem is that somewhere within \\(1.2 < Q/Q_0 < 1.3\\), two of the steady-state solutions merge."
  },
  {
    "objectID": "part-box/box-energy-model2.html#arclength-continuation",
    "href": "part-box/box-energy-model2.html#arclength-continuation",
    "title": "8  Steady-states of the basic energy model II",
    "section": "8.2 Arclength continuation",
    "text": "8.2 Arclength continuation"
  },
  {
    "objectID": "part-box/box-energy-model2.html#budyokos-model",
    "href": "part-box/box-energy-model2.html#budyokos-model",
    "title": "8  Steady-states of the basic energy model II",
    "section": "8.3 Budyoko’s model",
    "text": "8.3 Budyoko’s model\n(Sec. 2.8 of Kapler & Engler)\nPrevously we used the assumption that the outgoing radiation follows the Stefan-Boltzmann law (Equation 2.3). Based on observational data, there seems to be a simpler linear law, first suggested by Budyko (Budyko 1969). The law can be written as \\[\nE_\\text{out} = A + BT,\n\\tag{8.1}\\] where \\(A\\) and \\(B\\) will vary with location and climate. For instance, for the Northern Hemisphere, (Kaper and Engler 2013) gives the values of \\(A = 203.3\\text{Wm}^{-2}\\) and \\(B = 2.09 \\text{Wm}^{-2}\\text{deg}^{-1}\\) and where temperature is measured in degrees Celcius. One can interpret this as a linear expansion of the Stefan Boltzmann law about \\(T = 0\\) (after which similar values of \\(A\\) and \\(B\\) are derived)."
  },
  {
    "objectID": "part-box/box-energy-model2.html#bifurcation-analysis-and-plotting-tools",
    "href": "part-box/box-energy-model2.html#bifurcation-analysis-and-plotting-tools",
    "title": "8  Steady-states of the basic energy model II",
    "section": "8.4 Bifurcation analysis and plotting tools",
    "text": "8.4 Bifurcation analysis and plotting tools\n(Sec. 2.8 of (Kaper and Engler 2013))\nThere is an interesting bifurcation analysis that can be done in studying the steady-state solutions when \\(Q/Q_0\\) is varied. Students can be asked to construct the bifurcation diagram of \\(Q/Q_0\\) vs. temperature.\n\n\n\n\nBudyko, Mikhail I. 1969. “The Effect of Solar Radiation Variations on the Climate of the Earth.” Tellus 21 (5): 611–19.\n\n\nKaper, Hans, and Hans Engler. 2013. Mathematics and Climate. SIAM."
  },
  {
    "objectID": "part-box/basic-ocean-model.html#terminology-and-context",
    "href": "part-box/basic-ocean-model.html#terminology-and-context",
    "title": "9  Basic models of the ocean",
    "section": "9.1 Terminology and context",
    "text": "9.1 Terminology and context\nIntroduce thermohaline circulation (THC), temperature of the oceans, salinity of the oceans, …"
  },
  {
    "objectID": "part-box/basic-ocean-model.html#two-box-model-of-the-ocean",
    "href": "part-box/basic-ocean-model.html#two-box-model-of-the-ocean",
    "title": "9  Basic models of the ocean",
    "section": "9.2 Two-box model of the ocean",
    "text": "9.2 Two-box model of the ocean\nModelling the THC is a challenging task! In principal, this might involve the solution of multiple coupled PDEs for the flows and temperatures, which would then need to be solved on a very complicated domain. In addition, such models require a number of empirical equations of state (connecting density to temperature and salinity).\nToy models can be developed much more easily at the ‘systems level’ via box models."
  },
  {
    "objectID": "part-box/basic-ocean-model.html#a-one-dimensional-model-constant-temperature",
    "href": "part-box/basic-ocean-model.html#a-one-dimensional-model-constant-temperature",
    "title": "9  Basic models of the ocean",
    "section": "9.3 A one-dimensional model (constant temperature)",
    "text": "9.3 A one-dimensional model (constant temperature)\n\n\n\n\n\n\nNewton’s law of cooling and similar linear laws\n\n\n\nIn the following, we will follow some historical developments of physical box models, which often depend on certain assumed linear relationships. It can be very confusing if you want a derivation, via first-principles, of these relationships since often none will exist. This is an important-enough point to explain by analogy.\nConsider an object of temperature \\(T\\) placed in a room with ambient temperature \\(T_a\\). A well-known empirical law for the time-evolution of temperature is given by Newton’s Law of Cooling, i.e.  \\[\n\\frac{\\mathrm{d}T}{\\mathrm{d}t} = -c(T - T_a).\n\\tag{9.1}\\] The constant \\(c > 0\\) here has units of \\(s^{-1}\\).\nHowever, it is important to understand that the above law is often strictly used without derivation and without justification. It can be interpreted as a one-term Taylor expansion of the heat flux when \\(T - T_a\\) is small but very rarely do people use the expansion under this assumption. There is more discussion of the law and its issues in the work by (Besson 2012) and also in this online discussion.\nI personally think a better way to think of such laws is that they are assumptions that the rate-of-changes are driven by linear gradients.\n\n\nConstruction and assumptions of the box model.\n\nWe consider two boxes, labeled ‘1’ and ‘2’, respectively via subscripts. Box 1 corresponds to high latitudes (near poles) and Box 2 to low lattitudes (near equator). Each box has a corresponding temperature, \\(T_i\\), and salinity, \\(S_i\\).\nWe assume (see above) that the strength of the exchange flow between the boxes is linearly proportional to their differences of temperature and salinity.\nExternal wind forces and Coriolis effects are ignored.\nWe assume that in each box, there is an exchange of heat and salinity to the surrounding environment. For instance, salinity will exchange due to evaporation, precipitation, and runoff.\nWe assume that there is a positive salt flux \\(H\\) into Box 2 and a compensating salt flux \\(-H\\) out of Box 1.\n\nAn image of the box model is shown in [—].\n\n\n\nFigure 9.1: Two-box model of the ocean\n\n\nThe equations are given as follows.\n\\[\n\\begin{align}\n\\frac{\\mathrm{d}T_1}{\\mathrm{d}t} &= -c(T_1 - T_1^*) - |q|(T_1 - T_2) \\\\\n\\frac{\\mathrm{d}T_2}{\\mathrm{d}t} &= -c(T_2 - T_2^*) - |q|(T_2 - T_1) \\\\\n\\frac{\\mathrm{d}S_1}{\\mathrm{d}t} &= -H -d(S_1 - S_1^*) - |q|(S_1 - S_2) \\\\\n\\frac{\\mathrm{d}S_2}{\\mathrm{d}t} &= H -d(S_2 - S_2^*) - |q|(S_2 - S_1)\n\\end{align}\n\\tag{9.2}\\]\nThe symmetry in the above equations suggests we should re-write the temperature and salinity with respect to averaged values."
  },
  {
    "objectID": "part-box/basic-ocean-model.html#numerical-solutions-of-odes",
    "href": "part-box/basic-ocean-model.html#numerical-solutions-of-odes",
    "title": "9  Basic models of the ocean",
    "section": "9.4 Numerical solutions of ODEs",
    "text": "9.4 Numerical solutions of ODEs\n\n9.4.1 Euler time-stepping\n\n\n9.4.2 Use of packages\n\n\n\n\nBesson, Ugo. 2012. “The History of the Cooling Law: When the Search for Simplicity Can Be an Obstacle.” Science & Education 21 (8): 1085–1110.\n\n\nKaper, Hans, and Hans Engler. 2013. Mathematics and Climate. SIAM."
  },
  {
    "objectID": "part-box/stommel.html#non-dimensionalisation",
    "href": "part-box/stommel.html#non-dimensionalisation",
    "title": "10  Stommel box model",
    "section": "Non-dimensionalisation",
    "text": "Non-dimensionalisation\nWe can then nondimensionalise the system by setting \\[\nx = \\frac{\\Delta S}{\\Delta S^*}, \\quad y = \\frac{\\Delta T}{\\Delta T^*}, \\quad t' = ct,\n\\] where \\(t'\\) is nondimensional time. Dropping the primes henceforth, we have the following set of non-dimensional equations to study for the unknowns, \\(x = x(t)\\), and \\(y = y(t)\\): \\[\n\\begin{align}\n\\frac{\\mathrm{d}x}{\\mathrm{d}t} &= \\delta(1 - x) - |f(x, y)|x, \\\\\n\\frac{\\mathrm{d}y}{\\mathrm{d}t} &= 1 - y - |f(x, y)|y,\n\\end{align}\n\\tag{10.2}\\] where we have introduced the function, \\[\nf(x, y; R, \\lambda) = \\frac{1}{\\lambda}(Rx - y),\n\\tag{10.3}\\] where there are now three non-dimensional parameters given by \\[\n\\begin{align}\n\\delta &= d/c, \\\\\n\\lambda &= c/(2\\alpha k \\Delta T^*), \\\\\nR &= \\beta \\Delta S^*/(\\alpha \\Delta T^*).\n\\end{align}\n\\] Together Equation 10.2 and Equation 10.3 form a system of equations for \\((x(t), y(t))\\), with parameters \\(\\delta\\), \\(\\lambda\\), and \\(R\\)."
  },
  {
    "objectID": "part-box/stommel.html#equilibrium-states",
    "href": "part-box/stommel.html#equilibrium-states",
    "title": "10  Stommel box model",
    "section": "Equilibrium states",
    "text": "Equilibrium states\n\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport scipy.optimize as sciopt\n\ndef phi(f, delt, R):\n    phi = delt*R/(delt + np.abs(f)) - 1/(1 + np.abs(f))\n    return phi\n\nfmat = np.linspace(-2.5, 2.5, 101)\nplt.plot(fmat, phi(fmat, 1, 2), 'k--', label='$\\lambda = 1$, $R = 2$')\nplt.plot(fmat, phi(fmat, 1/6, 2), 'k', label='$\\lambda = 1/6$, $R = 2$')\nplt.plot(fmat, fmat, 'b--', label='$\\lambda = 1$')\nplt.plot(fmat, 1/6*fmat, 'b', label='$\\lambda = 1/6$' )\nplt.ylim((-1.5,2))\nplt.xlabel(\"$f$\")\nplt.ylabel(\"$\\phi$\")\nplt.legend()\n\n<matplotlib.legend.Legend at 0x11c1ecbb0>\n\n\n\n\n\nAbove, we can see that dependent on the parameter values, there may be one or three possible equilibrum states."
  },
  {
    "objectID": "part-box/stommel.html#stability",
    "href": "part-box/stommel.html#stability",
    "title": "10  Stommel box model",
    "section": "Stability",
    "text": "Stability\nWe let \\(x = x^* + \\xi\\) and \\(y = y^* + \\eta\\) and linearise the system about the fixed points. This gives \\[\n\\begin{pmatrix}\n\\dot{\\xi} \\\\\n\\dot{\\eta}\n\\end{pmatrix} = A\n\\begin{pmatrix}\n\\xi \\\\ \\eta\n\\end{pmatrix},\n\\] where the matrix \\(A\\) is given by \\[\nA =\n\\begin{pmatrix}\n-(\\delta + |f^*|) \\mp \\frac{Rx^*}{\\lambda} & \\pm \\frac{x^*}{\\lambda} \\\\\n\\mp \\frac{Ry^*}{\\lambda} & -(1 + |f^*|) \\pm \\frac{y^*}{\\lambda}\n\\end{pmatrix}\n\\] if \\(f^* \\gtrless 0\\).\nWe can then calculate the trace and determinant, giving \\[\n\\begin{align}\nT &= -(1 + \\delta + 3 |f^*|), \\\\\nD &= (\\delta + 2|f^*|)(1 + |f^*|) \\pm (1 - \\delta) \\frac{y^*}{\\lambda}.\n\\end{align}\n\\] Using the above, we can analytically calculate the key discriminant expression of \\(T^2 - 4D\\) (or numerically) in order to verify stability.\nIn lectures and in your assignments, you will be asked to verify the stability and phase-plane analyses. As an example test point, try \\(R = 2\\), \\(\\delta = 1/6\\), and \\(\\lambda = 1/5\\).\n\nimport matplotlib.pyplot as plt\nimport numpy as np\ndelt = 1/6\nR = 2\nlam = 1/5\nxx, yy = np.meshgrid(np.arange(0, 1, 0.05), np.arange(0, 1, 0.05))\nf = (R*xx-yy)/lam\nxdot = delt*(1 - xx)- np.abs(f)*xx\nydot = 1 - yy - np.abs(f)*yy\nplt.streamplot(xx,yy,xdot,ydot, density=2);"
  },
  {
    "objectID": "part-box/stommel.html#bifurcation-diagrams",
    "href": "part-box/stommel.html#bifurcation-diagrams",
    "title": "10  Stommel box model",
    "section": "10.1 Bifurcation diagrams",
    "text": "10.1 Bifurcation diagrams\nYou will study the generation of the bifurcation diagrams, e.g. \\(\\lambda\\) vs. \\(f^*\\). This will be done using techniques in numerical continuation."
  },
  {
    "objectID": "part-box/stommel.html#exercises",
    "href": "part-box/stommel.html#exercises",
    "title": "10  Stommel box model",
    "section": "10.2 Exercises",
    "text": "10.2 Exercises\n\nVerify the calculation of \\(A\\), \\(D\\), and \\(T\\) in the stability calculation.\nStudy the phase plane classification in order to classify the fixed points\nImplement a Newton-solving routine to study the bifurcation behaviour\nImplement an arclength continuation routine to study the bifurcation behavour\nUse perturbation theory in order to reduce the analysis\n\n\n\n\n\nKaper, Hans, and Hans Engler. 2013. Mathematics and Climate. SIAM.\n\n\nStommel, Henry. 1961. “Thermohaline Convection with Two Stable Regimes of Flow.” Tellus 13 (2): 224–30."
  },
  {
    "objectID": "lorenz.html",
    "href": "lorenz.html",
    "title": "11  Lorenz equations",
    "section": "",
    "text": "(Chap. 7 of Kapler & Engler)"
  },
  {
    "objectID": "part-box/el-nino.html",
    "href": "part-box/el-nino.html",
    "title": "12  El Nino-Southern Oscillation",
    "section": "",
    "text": "2022-23 note\n\n\n\nThis material has not yet been finalised and is still under construction. Once it is covered in lectures, this banner will be replaced.\n\n\n\n\n\n\n\n\nReference\n\n\n\nThis largely follow from Chap. 16 of (Kaper and Engler 2013).\n\n\n\n\n\n\nKaper, Hans, and Hans Engler. 2013. Mathematics and Climate. SIAM."
  },
  {
    "objectID": "part-pde/greenhouse.html",
    "href": "part-pde/greenhouse.html",
    "title": "13  The greenhouse gas effect",
    "section": "",
    "text": "14 Vertical structure of the atmosphere"
  },
  {
    "objectID": "part-pde/greenhouse.html#sec-radiative",
    "href": "part-pde/greenhouse.html#sec-radiative",
    "title": "13  The greenhouse gas effect",
    "section": "13.1 Radiative energy transfer",
    "text": "13.1 Radiative energy transfer\nRather than thinking of the greenhouse factor, \\(\\gamma\\), as an empirical parameter, we want to investigate how a mathematical model for its prediction can be studied. To do this, we must develop a deeper understanding of how energy is transferred through the atmosphere.\nRadiation is the transfer of energy by electromagnetic waves. Given a point in space, \\(\\mathbf{x}\\), we define the intensity \\(I_\\nu(\\mathbf{x}, \\mathbf{\\hat{s}})\\) as the energy flux per unit surface area of waves with frequency \\(\\nu\\) travelling in the direction \\(\\mathbf{\\hat{s}}\\) at the point \\(\\mathbf{x}\\). Remember as well that frequency is related to wavelength and speed by \\[\n\\lambda = \\frac{c}{\\nu}.\n\\]\nIn order to calculate the total radiative energy flux at a given point, we imagine surrounding the point with a unit sphere. The unit vector on the sphere is given in spherical coordinates via \\[\n\\mathbf{\\hat{s}} = (\\sin\\theta \\cos\\phi, \\sin\\theta \\sin\\phi, \\cos\\theta).\n\\]\nConsider a patch element of the sphere, with area element \\(\\mathrm{d}{\\omega}\\) given by \\[\n\\mathrm{d}{\\omega} = \\sin \\theta \\mathrm{d}{\\theta} \\mathrm{d}{\\phi}.\n\\] Then the radiative energy flux through this area element is given by \\[\nI_\\nu(\\mathbf{x}, \\mathbf{\\hat{s}}) \\mathbf{\\hat{s}} \\mathrm{d}{\\omega}.\n\\]\nTo calculate the total radiative energy flux, we then sum over all possible surface elements and over all possible frequencies: \\[\n\\mathbf{q}(\\mathbf{x}) = \\int_S \\int_0^\\infty I_\\nu(\\mathbf{x}, \\mathbf{\\hat{s}}) \\mathbf{\\hat{s}} \\, \\mathrm{d}{\\nu} \\, \\mathrm{d}{\\omega},\n\\] where note that the integral \\(\\int_S \\mathrm{d}{\\omega}\\) is a double integral over all angles \\(\\theta\\) and \\(\\phi\\).\nNext, we need a governing equation for the intensity, \\(I_\\nu\\).\n\n\n\n\n\n\nRadiative transfer equation\n\n\n\nThe radiative intensity, \\(I_\\nu\\), is given by solving the radiative transfer equation, \\[\n\\frac{\\mathrm{\\partial}I_\\nu}{\\mathrm{\\partial}s} = -\\rho \\kappa_\\nu I_\\nu + \\rho \\kappa_\\nu B_\\nu,\n\\tag{13.2}\\] where \\(\\partial/\\partial s = \\mathbf{\\hat{s}} \\cdot \\nabla_{\\mathbf{x}}\\) is the directional derivative in the direction \\(\\mathbf{\\hat{s}}\\). This is essentially an advection equation with source terms given by the first term, representing absorption by the atmosphere, and the second term representing re-emission. In addition, \\(\\rho\\) is the density and \\(\\kappa_\\nu\\) are the absorption coefficients.\nRe-emission is assumed to be independent of direction and is described by the Planck function, \\[\nB_\\nu = \\frac{2h\\nu^3}{c^2(\\mathrm{e}^{h\\nu/(kT)} - 1)},\n\\] describing the emission of radiation for a given local temperature \\(T\\). The constants correspond to Planck’s constant, \\(h \\approx 6.6 \\times 10^{-34} \\,\\mathrm{J} \\,\\mathrm{s}\\), the speed of light, \\(c\\approx 3.0 \\times 10^8 \\,\\mathrm{m s}^{-1}\\), and Boltzmann’s constant, \\(k \\approx 1.38 \\times 10^{-23} \\,\\mathrm{J K}^{-1}\\).\n\n\nWe wish to consider \\(I_\\nu\\), determined above, within the atmosphere. However, dependent on the composition of the atmosphere, \\(\\kappa_\\nu\\) is strongly dependent on the frequency (and space). For simplicity, however, we consider a ‘grey’ atmosphere, with \\(\\kappa_\\nu = \\kappa\\), independent of frequency.\nIntegrating Equation 13.2 over all frequencies, we have \\[\n\\frac{\\mathrm{\\partial}I}{\\mathrm{\\partial}s} = -\\rho \\kappa (I - B),\n\\tag{13.3}\\] where we have the total radiation intensity and emission intensity defined by \\[\nI(\\mathbf{x}, \\mathbf{s}) = \\int_0^\\infty I_\\nu \\, \\mathrm{d}{\\nu}, \\qquad\nB(\\mathbf{x}) = \\int_0^\\infty B_\\nu \\, \\mathrm{d}{\\nu}.\n\\]\nWe can integrate \\(B_\\nu\\) for \\(B\\) (exercise) to obtain \\[\nB = \\frac{\\sigma T^4}{\\pi},\n\\] where \\(\\sigma = 2\\pi^5 k^4/(15 h^3 c^2)\\) is the Stefan-Boltzmann constant, and now \\(B\\) is related to the local temperature at each point.\nAlthough the above relates \\(B\\) to temperature, \\(T\\), it is not so useful for our purposes because \\(T\\) is undetermined. Consider an infinitessimal parcel of the medium. Let us assume that there is no other energy transfer mechanism except for radiation absorption and emission. Then by energy conservation, \\(B\\) must be equal to the average radiation over all directions at each point, \\[\nB(\\mathbf{x}) = \\frac{1}{\\text{Surf. area}} \\iint_O I(\\mathbf{x}, \\mathbf{\\hat{s}}) \\, \\mathrm{d}S =  \\frac{1}{4\\pi} \\int_0^{2\\pi} \\int_0^\\pi I(\\mathbf{x}, \\mathbf{\\hat{s}}) \\sin\\theta \\, \\mathrm{d}{\\theta} \\, \\mathrm{d}{\\phi},\n\\tag{13.4}\\] where \\(O\\) is the unit sphere in \\(s\\)-space.\nThe above is the assumption of local radiative equilibrium, i.e. the total absorbed radiation at a point is equal to that determined by black body emission."
  },
  {
    "objectID": "part-pde/greenhouse.html#sec-two-stream",
    "href": "part-pde/greenhouse.html#sec-two-stream",
    "title": "13  The greenhouse gas effect",
    "section": "13.2 Two-stream approximation",
    "text": "13.2 Two-stream approximation\nThe above formulation for the intensity function, \\(I\\), is difficult to solve in general. Let us consider the case of a one-dimensional atmosphere, \\(I = I(z, \\theta)\\), where \\(\\theta\\) is the angle of \\(\\mathbf{\\hat{s}}\\) to the vertical. Then \\(\\partial_s = \\cos\\theta\\partial_z\\) and Equation 13.3 gives \\[\n\\cos\\theta \\frac{\\mathrm{\\partial}I}{\\mathrm{\\partial}z} = -\\rho \\kappa (I - B).\n\\] Since the density typically depends on \\(z\\), \\(\\rho = \\rho(z)\\), we define a new vertical coordinate that scales out the density. Let \\(\\tau\\) be the optical depth, and given by \\[\n\\tau = \\int_z^\\infty \\rho \\kappa \\, \\mathrm{d}{z}.\n\\tag{13.5}\\] Then since \\(\\partial_z = \\tau'(z) \\partial_\\tau\\), we have, for a new function, \\(I = I(\\tau, \\mu)\\), \\[\n\\mu \\frac{\\mathrm{\\partial}I}{\\mathrm{\\partial}\\tau} = I - B,\n\\tag{13.6}\\] where we have also defined \\(\\mu = \\cos\\theta\\). It should be remarked that \\(B\\) is given from Equation 13.4 and must only depend as a function of of the optical depth, \\(\\tau\\). To see this, note from Equation 13.4 that via the radiative equilibrium assumption, \\[\nB = \\frac{1}{4\\pi} \\int_0^{2\\pi} \\int_0^\\pi I \\, \\sin\\theta \\, \\mathrm{d}\\theta \\, \\mathrm{d}\\phi = \\frac{1}{2} \\int_{-1}^1 I(\\tau, \\mu) \\, \\mathrm{d}\\mu  = \\frac{1}{2}(I_+ + I_-).\n\\] This makes sense since the assumption that \\(B\\) averages all the different directions of radiation (which are measured by the coordinate \\(\\mu\\)).\nSo in fact Equation 13.6 is an integro-differential equation, \\[\n\\mu \\frac{\\mathrm{\\partial}I}{\\mathrm{\\partial}\\tau} = I - \\frac{1}{2} \\int_{-1}^1 I(\\tau, \\mu) \\, \\mathrm{d}\\mu.\n\\]\n\n13.2.1 Shuster-Schwarzschild approximation\nWe next make the Shuster-Schwarzschild approximation to reduce the radiation from all different directions to either an average over the upwards direction or an average over the downwards direction. First, note that if we integrate over the top hemisphere, \\[\n\\iint_S I \\, \\mathrm{d}{S} = \\int_{\\phi = 0}^{2\\pi} \\int_{\\theta = 0}^{\\pi/2} I \\cdot \\sin\\theta \\, \\mathrm{d}{\\theta} \\, \\mathrm{d}{\\phi}.\n\\] Since \\(I\\) is independent of the angular coordinate, \\(\\phi\\), we can integrate directly to see that \\[\n\\int_0^{2\\pi} \\mathrm{d}\\phi \\int_{\\theta = 0}^{\\pi/2} I (-\\mathrm{d}\\mu) = 2\\pi \\int_{\\mu = 0}^1 I \\, \\mathrm{d}\\mu \\equiv 2\\pi I_+,\n\\] once the integral in \\(\\theta\\) is converted to an integral in \\(\\mu\\). Doing the same for the radiation on the lower hemisphere yields the two new quantities \\[\n\\begin{align}\nI_+(\\tau) &\\equiv \\int_0^1 I(\\tau, \\mu) \\, \\mathrm{d}\\mu, \\\\\nI_-(\\tau) &\\equiv \\int_{-1}^0 I(\\tau, \\mu) \\, \\mathrm{d}\\mu.\n\\end{align}\n\\]\nWe can now write \\(B\\) in terms of these quantities: \\[\nB = \\frac{1}{2} \\int_{-1}^1 I(\\tau, \\mu) \\, \\mathrm{d}\\mu  = \\frac{1}{2}(I_+ + I_-).\n\\tag{13.7}\\]\nReturning now to Equation 13.6, we integrate with respect to \\(\\mu\\) on the interval \\(\\mu \\in [-1, 0]\\) and also on the interval \\(\\mu\\in[0, 1]\\) to obtain the two equations \\[\n\\begin{align}\n\\frac{1}{2} \\frac{\\mathrm{d}I_+}{\\mathrm{d}\\tau} &= I_+(\\tau) - B(\\tau) \\\\\n\\frac{1}{2} \\frac{\\mathrm{d}I_-}{\\mathrm{d}\\tau} &= I_-(\\tau) - B(\\tau)\n\\end{align}\n\\] and now using Equation 13.7, we have \\[\n\\begin{align}\n\\frac{\\mathrm{d}I_+}{\\mathrm{d}\\tau} &= I_+(\\tau) - I_-(\\tau)\\\\\n\\frac{\\mathrm{d}I_-}{\\mathrm{d}\\tau} &= I_+(\\tau) - I_-(\\tau).\n\\end{align}\n\\]\nWe require some bondary conditions to solve the above. First, there is no incoming radiation at the top of the atmosphere (\\(z \\to \\infty\\) or \\(\\tau \\to 0\\)), so \\[\nI_- = 0 \\quad \\text{at $\\tau = 0$}.\n\\] Next, at the surface, we have \\[\n\\pi I_+ = \\sigma T_s^4,\n\\] which expresses the flux from the surface via the Stefan-Boltzmann law, where \\(T_s\\) is surface temperature.\n\n\n\n\n\n\nNote\n\n\n\nDouble check the physicality of the above BCs.\n\n\nNote that the net upwards flux is given by \\(F = F_+ - F_- = \\pi(I_+ - I_-)\\) so we subtract the two above equations for \\(I_+\\) and \\(I_-\\) to get \\[\n\\begin{align}\nF_- &= \\pi I_- = F \\tau \\\\\nF_+ &= \\pi I_+ = F(1 + \\tau).\n\\end{align}\n\\] The surface boundary condition is thus \\[\nF = \\frac{\\sigma T_s^4}{1 + \\tau_s},\n\\] where recall the definition of optical depth from Equation 13.5 and we have written \\[\n\\tau_s = \\int_0^\\infty \\rho \\kappa \\, \\mathrm{d}z,\n\\] for the optical depth of the atmosphere.\nNote that the net upwards flux, \\(F\\), defines the effective emitting temperature, \\(T_e\\), according to \\[\nF = \\sigma T_e^4,\n\\] and thus we conclude that \\[\nT_s = (1 + \\tau_s)^{1/4} T_e.\n\\]\nThe above final result indicates why surface temperature is warmer than the effective emitting temperature, and we can also conclude that the greenhouse gas factor introduced earlier is \\[\n\\gamma = \\frac{1}{1 + \\tau_s}.\n\\]\nFinally, we can obtain an expression for the temperature, \\(T\\) throughout the atmosphere, using \\(B = F(1/2 + \\tau)/pi\\). Then \\[\nT = \\left(\\frac{1/2 + \\tau}{1 + \\tau_s}\\right)^{1/4} T_s,\n\\] so indeed temperature decreases with height."
  },
  {
    "objectID": "part-pde/greenhouse.html#problems",
    "href": "part-pde/greenhouse.html#problems",
    "title": "13  The greenhouse gas effect",
    "section": "16.1 Problems",
    "text": "16.1 Problems\n\nIn Section 13.1, the units of the various quantities such as radiation intensity, energy flux, etc. can be confusing to follow. Follow the argument from eqns (…) to eqn (…) and carefully indicate the units of each associated quantity.\n\n\n\n\n\nFowler, Andrew. 2011. Mathematical Geoscience. Vol. 36. Springer."
  },
  {
    "objectID": "part-techniques/part-techniques.html",
    "href": "part-techniques/part-techniques.html",
    "title": "Mathematical methods",
    "section": "",
    "text": "(Appendix-like) review of mathematical methods"
  },
  {
    "objectID": "part-techniques/dynamical-systems.html",
    "href": "part-techniques/dynamical-systems.html",
    "title": "14  Dynamical systems",
    "section": "",
    "text": "Insert some revew of dynamical systems."
  },
  {
    "objectID": "part-techniques/vector-calculus.html#coordinate-systems",
    "href": "part-techniques/vector-calculus.html#coordinate-systems",
    "title": "15  Vector calculus",
    "section": "15.1 Coordinate systems",
    "text": "15.1 Coordinate systems\n\nWe need some vector calculus in the section on Section 13.1 when discussing the radiation integrals.\n\n\n15.1.1 Spherical coordinates\nIn spherical coordinates, …"
  },
  {
    "objectID": "part-techniques/vector-calculus.html#directional-derivatives",
    "href": "part-techniques/vector-calculus.html#directional-derivatives",
    "title": "15  Vector calculus",
    "section": "15.2 Directional derivatives",
    "text": "15.2 Directional derivatives\nUsed in the Section 13.1, i.e. \\(\\partial\\partial s = \\mathbf{\\hat{s}} \\cdot \\nabla_{\\mathbf{x}}\\)."
  },
  {
    "objectID": "part-techniques/vector-calculus.html#integration-in-different-coordinate-systems",
    "href": "part-techniques/vector-calculus.html#integration-in-different-coordinate-systems",
    "title": "15  Vector calculus",
    "section": "15.3 Integration in different coordinate systems",
    "text": "15.3 Integration in different coordinate systems\n\n\n\n\n\n\nImportant\n\n\n\nProbably need some homework questions on spherical integration?\n\n\nIn Section 13.2, we make sure of the surface integral in spherical coordinates. This converts an integral as follows: \\[\n\\iint_S I \\, \\mathrm{d}{S} = \\iint_{\\theta, \\phi} I \\, \\sin\\theta \\, \\mathrm{d}\\theta \\, \\mathrm{d}\\phi.\n\\]"
  },
  {
    "objectID": "part-techniques/modelling.html#units",
    "href": "part-techniques/modelling.html#units",
    "title": "16  Modelling",
    "section": "16.1 Units",
    "text": "16.1 Units\nIt is good to clarify notation and analysis of scientific units. In this course, we will sometimes use square brackets to indicate the units of a quantity. For example, in the next chapter, we will discuss radiation from the sun, measured by \\(Q = 1380\\) W m^{-2}. A Watt (W) is energy per unit time, or joules per second (J/s). So alternatively, we could write \\(Q = 1380 J/(m^2 s)\\), or \\[\n[Q] = J m^{-2} s^{-1}.\n\\] This is an example of a flux—the flow (W, J/s) per unit area (m^2) of some quantity (in this case, energy). If you are ever confused about what a unit means, it is a good idea to break it into its constituent parts."
  },
  {
    "objectID": "part-techniques/modelling.html#nondimensionalisation",
    "href": "part-techniques/modelling.html#nondimensionalisation",
    "title": "16  Modelling",
    "section": "16.2 Nondimensionalisation",
    "text": "16.2 Nondimensionalisation\n\n\n\n\n\n\nImportant\n\n\n\nInsert a few words about nondimensionalisation here."
  },
  {
    "objectID": "part-techniques/finitedifference.html#forwards-backwards-and-centred-differences",
    "href": "part-techniques/finitedifference.html#forwards-backwards-and-centred-differences",
    "title": "17  Finite difference approximations",
    "section": "17.1 Forwards, backwards, and centred differences",
    "text": "17.1 Forwards, backwards, and centred differences\nWe want to learn how to use finite differences in order to approximate derivatives numerically. We know that \\[\nf'(x) = \\lim_{h \\to 0} \\frac{f(x + h) - f(x)}{h},\n\\] provided the limit exists. Therefore, a simple idea to approximating the value of \\(f'(x)\\) is to use a small numerical value for \\(h\\), and calculate (the gradient of the secant line), \\[\nf'(x) \\approx \\frac{f(x + h) - f(x)}{h},\n\\] where \\(h\\) is a specified small number. The above is known as the two-point forward-difference formula. In fact, we can determine exactly the error of such an approximation via Taylor’s theorem. If \\(f\\) is twice continuously differentiable, then \\[\nf(x + h) = f(x) + h f'(x) + \\frac{h^2}{2} f''(c),\n\\] for some point \\(c\\in [x, x+h]\\). Therefore by re-arrangement, we see the following.\n\n\n\n\n\n\nTwo-point forward-difference formula\n\n\n\n\\[\nf'(x) = \\frac{f(x + h) - f(x)}{h} - \\frac{h}{2} f''(c),\n\\] where \\(c \\in [x, x+h]\\).\n\n\nNotice that the error in using the two-point forward difference approximation is then \\(\\mathcal{O}(h)\\), and this error tends to zero as \\(h \\to 0\\) (as long as \\(f''\\) is continuous). We thus call the above formula a first-order finite-difference approximation. If the error is \\(\\mathcal{O}(h^n)\\), we call the corresponding formula an \\(n\\)th-order approximation.\n\n\n\n\n\n\nExample\n\n\n\nUse the two-point forward difference formula with different values of \\(h\\) in order to approximate the derivative of \\(f(x) = 1/x\\) at \\(x = 2\\).\n\n\n\n\\(f(x)\\)\n\\(f(x + h)\\)\n\\(h\\)\n\\(f'(x)\\)\nError\n\n\n\n\n…\n…\n…\n…\n…\n\n\n…\n…\n…\n…\n…\n\n\n…\n…\n…\n…\n…"
  },
  {
    "objectID": "part-techniques/finitedifference.html#jacobian-matrices",
    "href": "part-techniques/finitedifference.html#jacobian-matrices",
    "title": "17  Finite difference approximations",
    "section": "17.2 Jacobian matrices",
    "text": "17.2 Jacobian matrices\n\n\n\n\n\n\nReference\n\n\n\nYou will have encountered the Jacobian, firstly in your first-year Methods courses when performing change-of-coordinates in integration formulae, and secondly in your second-year Modelling and Dynamics courses when studying differential equations. It also comes up in the second-year Vectors and PDEs course.\n\n\nThe Jacobian matrix, \\(\\mathbf{J}\\), of a vector function, \\(\\mathbf{F}: \\mathbb{R}^n \\to \\mathbb{R}^m\\), \\[\n\\mathbf{F}(\\mathbf{x}) = \\begin{pmatrix}\nf_1(\\mathbf{x}) \\\\\nf_2(\\mathbf{x}) \\\\\n\\vdots \\\\\nf_m(\\mathbf{x})\n\\end{pmatrix},\n\\] is the matrix of all its first-order partial derivatives, \\[\n\\mathbf{J}(\\mathbf{x}) = \\begin{pmatrix}\n\\frac{\\mathrm{\\partial}f_1}{\\mathrm{\\partial}x_2} & \\cdots &\n\\frac{\\mathrm{\\partial}f_1}{\\mathrm{\\partial}x_n} \\\\\n\\vdots & \\ddots & \\vdots \\\\\n\\frac{\\mathrm{\\partial}f_m}{\\mathrm{\\partial}x_1} & \\cdots &\n\\frac{\\mathrm{\\partial}f_m}{\\mathrm{\\partial}x_n}\n\\end{pmatrix}\n= \\begin{pmatrix}\n\\nabla f_1(\\mathbf{x})^T \\\\\n\\vdots \\\\\n\\nabla f_n(\\mathbf{x})^T\n\\end{pmatrix}.\n\\] We can essentially think of the Jacobian as the multi-dimensional extension of the basic derivative. It encodes all of the (first-order) information about the rate-of-change of the function.\nIt is interesting and important to consider the numerical evaluation of the Jacobian, in the event that the function \\(\\mathbf{F}\\) cannot be easily differentiated exactly. The simplest algorithm is based on approximating each entry of the matrix by a finite difference.\nFor example, let us consider approximating \\[\n\\frac{\\mathrm{\\partial}f_i}{\\mathrm{\\partial}x_j}(\\mathbf{x}_0).\n\\] We define the \\(j\\)th unit vector by \\(\\mathbf{e}_j = [0 \\, 0 \\, \\cdots \\, 1 \\, \\cdots \\, 0]\\), which the \\(j\\)th entry being one and all entries being zero. Then we can approximate the derivative by a central difference, \\[\n\\frac{\\mathrm{\\partial}f_i}{\\mathrm{\\partial}x_j}(\\mathbf{x}_0) \\approx \\frac{f_i(\\mathbf{x}_0 + \\mathbf{e}_j h) - f_i(\\mathbf{x}_0 - \\mathbf{e}_j h)}{2h},\n\\] where \\(h\\) is a small step size.\nLet us test this by calculating the Jacobian for \\[\n\\mathbf{F}(\\mathbf{x}) = \\begin{pmatrix}\nx_1^2 \\\\\nx_2^2 \\\\\nx_1 x_2\n\\end{pmatrix}.\n\\] The pseudocode for this looks like this\n\n\n\n\n\n\nPseudocode for numerical Jacobian\n\n\n\nInput: function F (size m), point x (size n), step size h\n1. Create an (m x n) matrix, J\n2. a. Loop through all the rows indexed by i\n      b. Loop through all the columns indexed by j\n             Create the ej unit vector\n         Calculate the difference of F_i(x + h e_j) - F_i(x - h e_j)\n         Divide by 2h\n         Assign this value to the (i,j)th value of the Jacobian\n\nOutput: the (mxn) Jacobian matrix J\n\n\nHere is a code that puts it into practice.\n\nimport numpy as np\n\ndef jacobian(func,initial,delta=1e-3):\n  f = func\n  nrow = len(f(initial))\n  ncol = len(initial)\n  output = np.zeros(nrow*ncol)\n  output = output.reshape(nrow,ncol)\n  for i in range(nrow):\n    for j in range(ncol):\n      ej = np.zeros(ncol)\n      ej[j] = 1\n      dij = (f(initial+ delta * ej)[i] - f(initial- delta * ej)[i])/(2*delta)\n      output[i,j] = dij\n  return output\n  \ndef myf(x):\n  x1 = x[0]\n  x2 = x[1]\n  output = np.zeros(3)\n  output[0] = x[0]**2\n  output[1] = x[1]**2\n  output[2] = x[0]*x[1]\n  return output\n  \njacobian(myf,[1,2])\n\narray([[2., 0.],\n       [0., 4.],\n       [2., 1.]])\n\n\nhttps://rh8liuqy.github.io/Finite_Difference.html#ref-finite\n\n\n\n\nSauer, Timothy. 2012. Numerical Analysis. Pearson."
  },
  {
    "objectID": "part-techniques/newtons.html#demo-of-newtons-method-for-scalar-equations",
    "href": "part-techniques/newtons.html#demo-of-newtons-method-for-scalar-equations",
    "title": "18  Newton’s method",
    "section": "18.1 Demo of Newton’s method for scalar equations",
    "text": "18.1 Demo of Newton’s method for scalar equations\nHere is a simple demonstration of Newton’s method.\n\nimport numpy as np\n\ndef Newton(f, df, x, maxiter=100, tol=1e-12, display=0):\n    i = 0\n    while (abs(f(x) - 0) > tol) and (i < maxiter):\n        err = f(x)\n        x = x - err / df(x)\n        if display == 1:\n            print(\"f(x) = \", np.abs(err), \", x = \", x)\n        i = i + 1\n    return x, err\n\nf = lambda x: x**3 + 4*x**2 - 10\ndf = lambda x: 3*x**2 + 8*x\n\nx = 2\nx, err = Newton(f, df, x, 10, 1e-8, 1)\nprint(\"Final approximation = \", x)\n\nf(x) =  14 , x =  1.5\nf(x) =  2.375 , x =  1.3733333333333333\nf(x) =  0.13434548148148195 , x =  1.3652620148746266\nf(x) =  0.0005284611795151051 , x =  1.3652300139161466\nFinal approximation =  1.3652300139161466"
  },
  {
    "objectID": "part-techniques/newtons.html#newtons-method-for-systems-of-nonlinear-equations",
    "href": "part-techniques/newtons.html#newtons-method-for-systems-of-nonlinear-equations",
    "title": "18  Newton’s method",
    "section": "18.2 Newton’s method for systems of nonlinear equations",
    "text": "18.2 Newton’s method for systems of nonlinear equations\nNewton’s method generalises naturally to the case of a system of equations. Suppose we wish to solve for the \\(n\\) unknowns \\(\\mathbf{x} = (x_1, \\ldots, x_n)\\) via \\[\n\\mathbf{F(\\mathbf{x}}) =\n\\begin{pmatrix}\nF_1(\\mathbf{x}) \\\\\nF_2(\\mathbf{x}) \\\\\n\\ldots \\\\\nF_n(\\mathbf{x})\n\\end{pmatrix} = 0.\n\\]\nWe have, via Taylor’s formula, \\[\n\\mathbf{F}(\\mathbf{x}_{i+1}) \\sim  \\mathbf{F(\\mathbf{x}_i}) + J(\\mathbf{x}_i)(\\mathbf{x}_{i+1} - \\mathbf{x}_i) + \\mathcal{O}(||\\mathbf{x}_{i+1} - \\mathbf{x}_i||^2),\n\\] where \\(J\\) is the Jacobian matrix \\[\nJ(\\mathbf{x}) = \\nabla \\mathbf{F}(\\mathbf{x}) =\n\\begin{pmatrix}\n\\frac{\\mathrm{\\partial}F_1}{\\mathrm{\\partial}x_1} &\n\\cdots &\n\\frac{\\mathrm{\\partial}F_1}{\\mathrm{\\partial}x_n} \\\\\n\\vdots & \\ddots & \\vdots \\\\\n\\frac{\\mathrm{\\partial}F_n}{\\mathrm{\\partial}x_1} &\n\\cdots &\n\\frac{\\mathrm{\\partial}F_n}{\\mathrm{\\partial}x_n}\n\\end{pmatrix}.\n\\] Therefore, Newton’s method forms the iterates of \\[\n\\mathbf{x}_{i+1} = \\mathbf{x}_i + J^{-1}(\\mathbf{x}_i) \\mathbf{F}(\\mathbf{x}_i),\n\\] which takes a very similar form to the scalar case.\nHowever, solution of the inverse of \\(J\\) is typically inefficient, and it is better to instead solve for \\(\\delta_{i+1} = \\mathbf{x}_{i+1} - \\mathbf{x}_i\\) via \\[\nJ(\\mathbf{x}_i) \\delta_{i+1} = - \\mathbf{F}(\\mathbf{x}_i),\n\\] and then calculate \\(\\mathbf{x}_{i+1} = \\mathbf{x}_i + \\delta_{i+1}\\). There are many ways of solving the above matrix problem efficiently using built-in routines that perform, e.g. Gaussian elimination.\nhttp://hplgit.github.io/prog4comp/doc/pub/._p4c-solarized-Python031.html"
  },
  {
    "objectID": "part-techniques/arclength.html#parameter-continuation",
    "href": "part-techniques/arclength.html#parameter-continuation",
    "title": "19  Arclength continuation",
    "section": "19.1 Parameter continuation",
    "text": "19.1 Parameter continuation\nOur task is to investigate numerical procedures where we can solve problems like Equation 19.1 and generate the set of solutions, as illustrated in a bifurcation diagram.\n\nThe basic idea is to start with an initial guess, say \\((\\mathbf{x}^*, \\lambda^*)\\). We can apply Newton’s method and solve Equation 19.1 in order to determine a point on the solution curve, say \\((\\mathbf{x}_0, \\lambda_0\\).\nNext, we increment \\(\\lambda\\), say to \\(\\lambda_1 = \\lambda_0 + \\Delta \\lambda\\). Starting from the previous solution, \\(\\mathbf{x}_0\\), we then attempt to converge to the correct solution \\((\\mathbf{x}_1, \\lambda_1)\\).\n\nThis involves the following pseudocode:\n\n\n\n\n\n\nPoor person’s numerical continuation\n\n\n\n1. Input guess (x, lambda), f, df\n\n    a. Call Newton's method via Newton(f, df, x, lambda) \n    b. Obtain a preliminary solution (x0, lambda0)\n\n2. Increment lambda1 = lambda0 + delta \n\n    a. Call Newton's method via Newton(f, df, x0, lambda1)\n    b. Obtain a new solution (x1, lambda1)\n\n3. Repeat 2 until we have established enough values of lambda\n\n\nUnfortunately this does not work as well as we would like. We can try it on the above circle example. In this case, notice that \\[\n\\begin{align}\nF(x, \\lambda) &= x^2 + \\lambda^2 - 1, \\\\\nF_x(x, \\lambda) &= 2x.\n\\end{align}\n\\]\n\nimport numpy as np\nimport matplotlib.pyplot as plt\n\ndef Newton(f, df, x, maxiter=100, tol=1e-12, display=0):\n    i = 0\n    while (abs(f(x) - 0) > tol) and (i < maxiter):\n        err = f(x)\n        x = x - err / df(x)\n        if display == 1:\n            print(\"f(x) = \", np.abs(err), \", x = \", x)\n        i = i + 1\n    return x, err\n\nlammat = np.linspace(-1, 1.1, 20)\nxmat = 0*lammat\nx = 0.1\n\nfor i, lam in enumerate(lammat):\n    f = lambda x: x**2 + lam**2 - 1 \n    df = lambda x: 2*x \n\n    x, err = Newton(f, df, x, 10, 1e-8, 0)\n    if err > 1e-4:\n        print(\"Careful no convergence at lambda = \", lam)\n    xmat[i] = x\n# Plots\nplt.plot(lammat, xmat, '-o');\n\n# Plotting a circle\ntheta = np.linspace(0, 2*np.pi, 50)\nplt.plot(np.sin(theta), np.cos(theta), 'r--');\nplt.xlabel('lambda');\nplt.ylabel('x');\nplt.xlim([-1.5,1.5])\nplt.ylim([-1.5,1.5])\nplt.gca().set_aspect('equal')\nplt.show()\n\nCareful no convergence at lambda =  -0.8894736842105263\nCareful no convergence at lambda =  -0.6684210526315789\nCareful no convergence at lambda =  1.1\n\n\n\n\n\nYou’ll notice that there are several problems.\n\nFirst, there seems to be an issue for several points in \\(\\lambda\\) where the previous guess does not seem adequate to obtain the next solution.\nSecond, our numerical scheme cannot resolve past fold points, here at \\((1, 0)\\).\n\nOf course, we can re-do a secondary numerical calculation to resolve the lower branch of the locus. However, it would be preferable to be able to do this in a single run. Moreover, in more complicated problems, we may not know what the final locus ressembles, and it may furthermore lie in a high-dimensional space."
  },
  {
    "objectID": "part-techniques/arclength.html#pseudo-arclength-continuation",
    "href": "part-techniques/arclength.html#pseudo-arclength-continuation",
    "title": "19  Arclength continuation",
    "section": "19.2 Pseudo-arclength continuation",
    "text": "19.2 Pseudo-arclength continuation\nThere is nothing geometrically wrong about continuation past a fold point; our previous numerical difficulties are instead related to the fact that \\(\\lambda\\) is a poor choice of parameter used to describe the solution curve, \\((\\mathbf{x}, \\lambda)\\).\nInstead, it makes much more sense to consider an alternative parameter, such as the arclength along the curve. Let \\(t\\) denote the parameter along the curve (we will specify momentarily what it is). Then we are considering the computation of the arc \\((\\mathbf{x}, \\lambda) = (\\mathbf{x}(t), \\lambda(t))\\), which corresponds to points in \\(\\mathbb{R}^{n+1}\\) specified by a scalar value of \\(t\\).\nIn addition, we can calculate a tangent vector along this arc, given by the \\((N+1)\\)-component vector, \\[\n(\\dot{\\mathbf{x}}, \\, \\dot{\\lambda}) = \\left( \\frac{\\mathrm{d}\\mathbf{x}}{\\mathrm{d}t}, \\, \\frac{\\mathrm{d}\\lambda}{\\mathrm{d}t}\\right).\n\\]\nIn order to allow for continuation past a fold, we apply an idea called pseudo-arclength continuation. Assume that at some initial point, \\(t = t_0\\), we possess a solution \\(P = (\\mathbf{x}_0, \\lambda_0)\\) and its tangent \\(\\mathbf{\\tau}_0 = (\\dot{\\mathbf{x}}_0, \\dot{\\lambda})\\). We are seeking a new value, say \\((\\mathbf{x}_1, \\lambda_1)\\), at \\(t = t_1\\).\nIn order to find this new value, we construct a plane perpendicular to the vector \\(\\mathbf{\\tau}_0\\), which passes through the point \\(Q = (\\mathbf{x}_1, \\lambda_1)\\). This is shown in the diagram below.\n\n\n\nFigure 19.1: Diagram from (Spence and Graham 1999). Note that in the diagram, they use \\(\\Delta t\\) for the distance between the point and the plane; we use \\(\\Delta s\\).\n\n\nThe illustrated plane lies a distance \\(\\Delta s\\) from the point P. From planar geometry, the distance of a point, \\(P\\), from a plane with point \\(Q\\) and normal direction \\(\\mathbf{\\tau}_0\\) is given by \\[\n\\frac{\\mathbf{\\tau}_0}{||\\mathbf{\\tau}_0||} \\cdot \\mathbf{v} = \\Delta s\n\\] where \\(\\mathbf{v}\\) is the vector from \\(Q\\) to \\(P\\). Putting in the values then gives \\[\n-\\frac{(\\dot{\\mathbf{x}}_0, \\dot{\\lambda_0})}{||(\\dot{\\mathbf{x}}_0, \\dot{\\lambda_0})||}\n\\cdot (\\mathbf{x}_0 - \\mathbf{x}, \\lambda_0 - \\lambda) = \\Delta s.\n\\]\nIn other words, we are seeking to solve the coupled set of equations \\[\n\\begin{cases}\n\\mathbf{F}(\\mathbf{x}, \\lambda) = 0 \\\\\n\\frac{(\\dot{\\mathbf{x}}_0, \\dot{\\lambda_0})}{||(\\dot{\\mathbf{x}}_0, \\dot{\\lambda_0})||}\n\\cdot (\\mathbf{x} - \\mathbf{x}_0, \\lambda - \\lambda_0) - \\Delta s = 0\n\\end{cases}\n\\tag{19.2}\\]\nNotice that we seem to have the right number of equations to unknowns. There are \\((N+1)\\) unknowns in \\((\\mathbf{x}, \\lambda)\\). The equation for \\(\\mathbf{F} = 0\\) gives \\(N\\) equations, while the last (scalar) equation closes the system. The step \\(\\Delta s\\) is specified by the implementation."
  },
  {
    "objectID": "part-techniques/arclength.html#secant-continuation",
    "href": "part-techniques/arclength.html#secant-continuation",
    "title": "19  Arclength continuation",
    "section": "19.3 Secant continuation",
    "text": "19.3 Secant continuation\nWe require a method for approximating the initial tangent direction, \\((\\dot{\\mathbf{x}}_0, \\lambda_0)\\), and then we need to update this direction as the continuation proceeds. To do this, we approximate the derivative with a secant. Suppose we have two nearby solution points, \\[\n\\mathbf{v}_0 = \\begin{pmatrix}\n\\mathbf{x}_0 \\\\\n\\lambda_0\n\\end{pmatrix}\n\\quad \\text{and} \\quad\n\\mathbf{v}_1 = \\begin{pmatrix}\n\\mathbf{x}_1 \\\\\n\\lambda_1\n\\end{pmatrix}.\n\\] We can approximate the derivative using the secant line \\[\n\\mathbf{s} = \\frac{\\mathbf{v}_1 - \\mathbf{v}_0}{||\\mathbf{v_1} - \\mathbf{v_0}||}.\n\\]\nThis line has unit magnitude and is approximately aligned with \\(\\tau_0\\).\n\n\n\n\n\n\nPseudocode for pseudo-arclength continuation using the secant\n\n\n\n1. Input guess (x, lambda), f, df, initial step size, ds\n\n    a. Call Newton's method via Newton(f, df, x, lambda) \n    b. Obtain a preliminary solution (x0, lambda0)\n\n2. Increment lambda1 = lambda0 + delta \n\n    a. Call Newton's method via Newton(f, df, x0, lambda1)\n    b. Obtain a new solution (x1, lambda1)\n\n3. While lambda < desired_max\n    \n    a. Form the secant line, S, using v0 and v1\n    b. The new solution is approximately at v = v1 + S*ds\n    c. Solve the extended Newton system \n    d. Assign v0 = v1, v1 = new solution, v. Go back to a."
  },
  {
    "objectID": "part-techniques/arclength.html#exercises",
    "href": "part-techniques/arclength.html#exercises",
    "title": "19  Arclength continuation",
    "section": "19.4 Exercises",
    "text": "19.4 Exercises\n\nDo pseudo-arclength continuation using a table(?)\n\n\n\n\n\nKrauskopf, Bernd, Hinke M Osinga, and Jorge Galán-Vioque. 2007. Numerical Continuation Methods for Dynamical Systems. Vol. 2. Springer.\n\n\nSpence, Alastair, and Ivan G Graham. 1999. “Numerical Methods for Bifurcation Problems.” In The Graduate Student’s Guide to Numerical Analysis’ 98, 177–216. Springer."
  },
  {
    "objectID": "summary.html",
    "href": "summary.html",
    "title": "20  Summary",
    "section": "",
    "text": "In summary, this book has no content whatsoever."
  },
  {
    "objectID": "lectureplan.html",
    "href": "lectureplan.html",
    "title": "21  Lecture plan",
    "section": "",
    "text": "This note will be completed as the course is taught for the first time.\n\n\n\nLecture\nTopic\nChapter\n\n\n\n\n\nEstimating your energy on the back of an envelope\n\n\n\n1\nIntroduction to the course\n\n\n\n2\nUnits and nondimensionalisation\n\n\n\n3\nDerivation of the basic energy model\n\n\n\n4\nCO2 concentration and estimating consumption\n\n\n\n5\nEstimating consumption and power\n\n\n\n6\nDiscussing coursework; how to write a technical paper\n\n\n\n\nConceptual models of Planet Earth\n\n\n\n7\nPrecursor: Preliminary asymptotic approximations\n\n\n\n8\nPrecursor: Series expansions and error propagation\n\n\n\n9\nPrecursor: Finite difference approximations\n\n\n\n10\nPrecursor: Bisection, Newton’s & Secant methods, Jacobians\n\n\n\n11\n???\n\n\n\n12\nProblem class\n\n\n\n13\nSteady states of the basic energy model I\n\n\n\n14\nArclength continuation I\n\n\n\n15\nArclength continuation I\n\n\n\n16\nSteady states of the basic energy model II\n\n\n\n17\nBasic models of the ocean\n\n\n\n15\nStommel’s box model\n\n\n\n\nNumerical solution of ODEs\n\n\n\n\nLorenz equations\n\n\n\n\nEl Nino-Southern Oscillation\n\n\n\n\nZonal energy budget\n\n\n\n\nLegendre polynomials and spectral numerics\n\n\n\n\nReview of multi-dimensional calculus\n\n\n\n\nRadiative energy transfer\n\n\n\n\nTwo-stream approximation\n\n\n\n\nRunaway greenhouse effect\n\n\n\n\nIce-albedo feedback\n\n\n\n\nCarbon cycle\n\n\n\n\nOcean carbon\n\n\n\n\nProblem class\n\n\n\n\nProblem class\n\n\n\n\nDiscussing coursework\n\n\n\n\nAsymptotics for ODEs/BVPs I\n\n\n\n\nAsymptotics for ODEs/BVPS II"
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Arrhenius, Svante. 1896. “XXXI. On the Influence of Carbonic Acid\nin the Air Upon the Temperature of the Ground.” The London,\nEdinburgh, and Dublin Philosophical Magazine and Journal of Science\n41 (251): 237–76.\n\n\nBesson, Ugo. 2012. “The History of the Cooling Law: When the\nSearch for Simplicity Can Be an Obstacle.” Science &\nEducation 21 (8): 1085–1110.\n\n\nBudyko, Mikhail I. 1969. “The Effect of Solar Radiation Variations\non the Climate of the Earth.” Tellus 21 (5): 611–19.\n\n\nCharney, Jule G, Akio Arakawa, D James Baker, Bert Bolin, Robert E\nDickinson, Richard M Goody, Cecil E Leith, Henry M Stommel, and Carl I\nWunsch. 1979. Carbon Dioxide and Climate: A Scientific\nAssessment. National Academy of Sciences, Washington, DC.\n\n\nFourier, Joseph. 1827. “Mémoire Sur Les\nTempératures Du Globe Terrestre Et Des Espaces\nPlanétaires.” Mémoires de\nl’Académie Royale Des Sciences de l’Institut de France\n7: 570–604.\n\n\nFowler, Andrew. 2011. Mathematical Geoscience. Vol. 36.\nSpringer.\n\n\nKaper, Hans, and Hans Engler. 2013. Mathematics and Climate.\nSIAM.\n\n\nKrauskopf, Bernd, Hinke M Osinga, and Jorge Galán-Vioque. 2007.\nNumerical Continuation Methods for Dynamical Systems. Vol. 2.\nSpringer.\n\n\nMacKay, D. J. C. 2009. Sustainable Energy – Without the Hot\nAir. UIT Cambridge Ltd.\n\n\nPouillet, Claude Servais Mathias. 1838. “Memoire Sur Le Chaleur\nSolaire.” Paris.\n\n\nSauer, Timothy. 2012. Numerical Analysis. Pearson.\n\n\nSpence, Alastair, and Ivan G Graham. 1999. “Numerical Methods for\nBifurcation Problems.” In The Graduate Student’s Guide to\nNumerical Analysis’ 98, 177–216. Springer.\n\n\nStommel, Henry. 1961. “Thermohaline Convection with Two Stable\nRegimes of Flow.” Tellus 13 (2): 224–30.\n\n\nVan der Veen, CJ. 2000. “Fourier and the ‘Greenhouse\nEffect’.” Polar Geography 24 (2): 132–52."
  }
]