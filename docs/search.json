[
  {
    "objectID": "part-05-techniques/asymptotics01.html#a-simple-quadratic",
    "href": "part-05-techniques/asymptotics01.html#a-simple-quadratic",
    "title": "8  Asymptotic approximations",
    "section": "8.1 A simple quadratic",
    "text": "8.1 A simple quadratic\n\n\n\n\n\n\nA singular quadratic\n\n\n\nConsider the solution of \\[\n\\epsilon x^2 + x - 1 = 0,\n\\tag{8.1}\\] where \\(\\epsilon\\) is a fixed and very small positive number, say \\(0.000001\\). Forget that we know how to solve a quadratic equation: is it possible to develop a systematic approximation method?\n\n\nIf \\(\\epsilon = 0\\), then \\(x = 1\\). Moreover, if we substitute \\(x = 1\\) into the equation, then we see that the error is small and proportional to \\(\\epsilon\\). It is natural to seek an approximation in powers of \\(\\epsilon\\). We call this an . We write \\[\nx = x_0 + \\epsilon x_1 + \\epsilon^2 x_2 + \\ldots\n\\] Substitution into the equation yields \\[\n\\epsilon \\Bigl(x_0 + \\epsilon x_1 + \\epsilon^2 x_2 + \\ldots\\Bigr)^2 + \\Bigl( x_0 + \\epsilon x_1 + \\epsilon^2 x_2 + \\ldots \\Bigr) - 1 = 0.\n\\] Expand and collect terms in powers of \\(\\epsilon\\): \\[\n\\Bigl( x_0 - 1 \\Bigr) + \\epsilon\\Bigl(x_1 + x_0^2\\Bigr) + \\epsilon^2\\Bigl(x_2 + 2 x_0 x_1\\Bigr) + \\ldots = 0.\n\\] Now we equate coefficients at each order in \\(\\epsilon\\). This gives \\[\\begin{align}\nx_0 - 1 &= 0 \\Longrightarrow x_0 = 1 \\\\\nx_1 + x_0^2 &= 0 \\Longrightarrow x_1 = -1 \\\\\nx_2 + 2 x_0 x_1 &= 0 \\Longrightarrow x_2 = 2\n\\end{align}\\] We therefore have obtained the three-term approximation, \\[\nx = 1 - \\epsilon + 2\\epsilon^2 + \\ldots\n\\] Clearly we could continue this process ad infinitum obtaining increasingly accurate approximations to one of the roots.\n\n8.1.1 The singular root\nBut where has the other quadratic root gone?\nThe problem is that in considering \\(\\epsilon\\) to be small, we began by ignoring the leading term, \\(\\epsilon x^2\\). We effectively assumed that the equation was primarily balanced by setting the \\(x\\) term with the \\(-1\\) term, and the sum of the two terms approximately equalling zero.\nBut if \\(|x|\\) is large, then clearly our assumption that \\(\\epsilon x^2\\) being small may not be necessarily true for it depends on how large \\(|x|\\) is compared to \\(\\epsilon\\). Note that if \\(|x|\\) is large, then necessarily the last term, \\(-1\\), is negligible in comparison. Therefore, in order for \\(\\epsilon x^2\\) to balance \\(x\\), we see that \\(|x|\\) must be of size \\(1/\\epsilon\\).\nTherefore this suggests that we should re-scale our solution as follows \\[\nx = \\frac{X}{\\epsilon}.\n\\]\nSubstitution into the original quadratic now yields \\[\nX^2 + X - \\epsilon = 0.\n\\] Now notice that \\(\\epsilon = 0\\) expresses the correct balance in order to detect that missing root. Again we write \\[\nX = X_0 + \\epsilon X_1 + \\epsilon^2 X_2 + \\ldots\n\\] and attempt to solve order by order. Substitution into the equation yields \\[\n\\Bigl(X_0 + \\epsilon X_1 + \\epsilon^2 X_2 + \\ldots\\Bigr)^2 + \\Bigl(X_0 + \\epsilon X_1 + \\epsilon^2 X_2 + \\ldots\\Bigr) - \\epsilon = 0.\n\\] Expand and collect orders of \\(\\epsilon\\): \\[\\begin{align}\nX_0^2 + X_0 &= 0 \\Longrightarrow X_0 = -1 \\\\\n2X_0 X_1 + X_1 -1 &= 0 \\Longrightarrow X_0 = -1,\n\\end{align}\\] and thus to two orders, we have \\[\nX = -1 - \\epsilon + \\ldots \\Longrightarrow x = - \\frac{1}{\\epsilon} - 1 + \\ldots\n\\]\nOf course, we have used a very simple example (a solvable quadratic) to illustrate the idea of asymptotic approximations, but you should hopefully see that this method is extensible to much more complicated equations.\n\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nep = np.linspace(1,0.1, 20)\nroot1 = (-1 + np.sqrt(1-4*ep*(-1)))/(2*ep)\nroot2 = (-1 - np.sqrt(1-4*ep*(-1)))/(2*ep)\nasym1 = 1 - ep\nasym2 = -1/ep - 1\nplt.plot(ep, root1, 'o')\nplt.plot(ep, root2, 'o')\nplt.plot(ep, asym1, '-')\nplt.plot(ep, asym2, '-')\nplt.legend(['$x_1$', '$x_2$', '2-term asymp.', '2-term asym'])\nplt.xlabel('$\\epsilon$')\nplt.ylabel('x');"
  },
  {
    "objectID": "part-05-techniques/asymptotics01.html#order-notation-and-the-tilde-sign-for-asymptotic",
    "href": "part-05-techniques/asymptotics01.html#order-notation-and-the-tilde-sign-for-asymptotic",
    "title": "8  Asymptotic approximations",
    "section": "8.2 Order notation and the tilde sign for asymptotic",
    "text": "8.2 Order notation and the tilde sign for asymptotic\nWe define precisely what we mean when we say that two functions, say \\(f\\) and \\(g\\), exhibit the same behaviour in some limit, say \\(\\epsilon \\to 0\\) or \\(x \\to x_0\\) or \\(x \\to \\infty\\) and so forth. For instance, we claim that the graphs of \\(\\sin(x)\\) and \\(x\\) look very similar as \\(x \\to 0\\). Thus we might write \\[\n    \\sin(x) \\sim x \\quad \\text{as $x \\to 0$}.\n\\tag{8.2}\\] This notion of allows us to specify functional behaviours at a deeper level than just limits. As you can see, it is not as useful to specify that \\[\n\\lim_{x \\to 0} \\sin{x} = \\lim_{x\\to 0} x.\n\\] In contrast, (Equation 8.2) is much more prescriptive about the way that the functions are approaching the limit.\n\n\n\n\n\n\nDefinition of \\(\\sim\\), \\(\\gg\\), and \\(\\ll\\)\n\n\n\nFirst, the notation \\[\nf(x) \\ll g(x), \\qquad x \\to x_0,\n\\] is read as “\\(f(x)\\) is much smaller than \\(g(x)\\) as \\(x \\to x_0\\)” and means \\[\n\\lim_{x\\to x_0} \\frac{f(x)}{g(x)} = 0.  \n\\] We may analogously use \\(g(x) \\gg f(x)\\) for “much greater than”.\nSecond, the notation \\[\nf(x) \\sim g(x), \\qquad x \\to x_0,\n\\] is read as “\\(f(x)\\) is asymptotic to \\(g(x)\\) as \\(x \\to x_0\\)”, and means that the error between \\(f\\) and \\(g\\) tends to zero as \\(x \\to x_0\\), or \\[\n\\lim_{x\\to x_0} \\frac{f(x)}{g(x)} = 1.  \n\\] We will often say “\\(f\\) is like \\(g\\)” or “\\(f\\) behaves like \\(g\\)”,\n\n\nHere are some examples.\n\n\n\n\n\n\nExamples\n\n\n\n\n\\(\\sin x \\sim x \\sim \\tan x\\) as \\(x \\to 0\\)\n\\(x^2 + x + 1 \\sim \\dfrac{x^3 + \\sin x}{1 + x}\\) as \\(x \\to \\infty\\)\n\\(\\sin x \\ll \\cos x\\) as \\(x \\to 0\\)\n\n\n\nIn the examination of limiting processes, often the main issue of consideration is the relative sizes of quantities defined according to their powers. For example, if \\(x\\) is a very small number, with \\(x = 10^{-5}\\), then \\(x^5\\) is much smaller than \\(x\\) (in terms of our notation, \\(x^5 \\ll x\\) as \\(x \\to 0\\)). On the other hand, we might not care so much about the difference between \\[\nx^5 \\quad \\text{vs.} \\quad 5 x^5\n\\] The point is that the of \\(x^5\\) and \\(5 x^5\\) is the same as \\(x \\to 0\\). The “Big-Oh” notation formalises this distinction.\n\n\n\n\n\n\nDefinition of Big-Oh\n\n\n\nWe write \\(f = O(g)\\) as \\(x \\to x_0\\) to mean that there exists constants \\(K > 0\\) and \\(x^* > 0\\) such that \\[\n|f| < K |g| \\quad \\text{for all $|x - x_0| < x^*$}.\n\\]\n\n\nIn practice, the use of the order symbol is very natural and you will not need to work with the technical definition. For example, when you derive the terms of the Maclaurin/Taylor series, you are naturally clustering all the terms of the same order (power) together. For us, the \\(O\\) symbol provides a very convenient way of separating terms of different sizes.\n\n\n\n\n\n\nExamples\n\n\n\n\n\\(2\\sin x = O(\\tan x)\\) as \\(x \\to 0\\)\n\\(x^2 + x + 1 = O\\left(\\dfrac{5x^3 + \\sin x}{1 + x}\\right)\\) as \\(x \\to \\infty\\)\n\n\n\nLet us return to the case of the quadratic example (Equation 8.1). Using the O notation, we can write \\[\nx =\n\\begin{cases}\n1 - \\epsilon + 2 \\epsilon^2 + O(\\epsilon^3) \\\\\n-\\frac{1}{\\epsilon} - 1 + O(\\epsilon^2)\n\\end{cases}\n\\] for the two roots. Alternatively, we can truncate the expansions and simply using the \\(\\sim\\) symbol: \\[\nx \\sim\n\\begin{cases}\n1 - \\epsilon  \\\\\n-\\frac{1}{\\epsilon} - 1\n\\end{cases}\n\\]"
  },
  {
    "objectID": "part-05-techniques/asymptotics02.html#returning-to-the-projectile-problem",
    "href": "part-05-techniques/asymptotics02.html#returning-to-the-projectile-problem",
    "title": "9  Asymptotic approximations of ODEs",
    "section": "9.1 Returning to the projectile problem",
    "text": "9.1 Returning to the projectile problem\nIn Chapter 4 and Chapter 26 you studied the non-dimensionalisation of the projectile problem. Once re-scaled, it takes the following form: \\[\n\\begin{align}  \n\\frac{\\mathrm{d}^2 y}{\\mathrm{d}t^2} &= -\\frac{1}{(1 + \\epsilon y)^2}, \\qquad t > 0 \\\\\ny(0) &= 0, \\\\\ny'(0) &= 1.\n\\end{align}\n\\tag{9.1}\\] This is a difficult problem without, in fact, any explicit solutions. However, we can estimate the solution in the limit \\(\\epsilon \\to 0\\). We expand the solution as \\[\ny(t) = y_0(t) + \\epsilon y_1(t) + \\epsilon^2 y_2(t) + \\ldots\n\\] In order to expand the denominator, you can use Taylor’s theorem to expand the function \\[\nf(x) = (1 + x)^\\alpha = f(0) + f'(0)x + \\ldots = 1 + \\alpha x + \\ldots\n\\] around \\(x = 0\\).\nThe differential equation now yields \\[\ny_0'' + \\epsilon y_1'' + \\epsilon^2 y_2'' + \\ldots = -\\left[1 - 2\\epsilon \\left(y_0 + \\epsilon y_1 + \\ldots\\right) + \\ldots \\right]\n\\] so grouping terms together order-by-order yields \\[\n\\Bigl[ y_0'' + 1 \\Bigr] + \\epsilon \\Bigl[ y_1'' - 2y_0\\Bigr] + \\ldots = 0.\n\\]\nWe can similarly substitute the expansion into the initial conditions. Altogether, at leading order, we obtain the following system to solve: \\[\\begin{align}\ny_0'' + 1 &= 0, \\\\\ny_0(0) &= 0, \\\\\ny_0'(0) &= 1.\n\\end{align}\\] Integrating twice and applying the boundary conditions gives us \\[\ny_0(t) = -\\frac{1}{2}t^2 + t.\n\\] In fact, this is simply the parabolic motion you would expect from school Physics. The \\(\\epsilon = 0\\) solution corresponds to assuming that the mass at the centre of the planet is dominant and then acceleration is constant.\nHowever, we can now proceed to higher order and examine the nonlinear effects. Proceeding to \\(O(\\epsilon)\\), we have the following system to solve: \\[\\begin{align}\ny_1'' &= 2y_0, \\\\\ny_1(0) &= 0, \\\\\ny_1'(0) &= 0.\n\\end{align}\\] Again this is simple to integrate. Integrating the solution for \\(y_0\\) twice and substitution of the initial conditions yields \\[\ny_1(t) = -\\frac{1}{12}t^4 + \\frac{1}{3}t^3.\n\\] We have thus solved for the asymptotic approximation to two orders. We have \\[\ny(t) \\sim \\Bigl[ -\\frac{1}{2}t^2 + t\\Bigr] + \\epsilon \\Bigl[ -\\frac{1}{12}t^4 + \\frac{1}{3}t^3\\Bigr].\n\\] This was quite an accomplishment! We have taken a problem that was not easily solvable in explicit form and through fairly simple integrations, obtained an approximation to two orders in \\(\\epsilon\\). How good is it? Let us solve the problem numerically and compare with the asymptotic approximation."
  },
  {
    "objectID": "part-05-techniques/asymptotics02.html#numerical-solutions-of-ivps",
    "href": "part-05-techniques/asymptotics02.html#numerical-solutions-of-ivps",
    "title": "9  Asymptotic approximations of ODEs",
    "section": "9.2 Numerical solutions of IVPs",
    "text": "9.2 Numerical solutions of IVPs\nWe first demonstrate how to solve ODEs (initial-value-problems, IVPs) using black-box functions in Python. For starters, most numerical formulations for ODEs will require that the problem be posed in terms of a first-order system of equations. To convert (Equation 9.1) into such a form, create a set of unknowns for the derivatives. Set \\[\n\\mathbf{Y}(t) =\n\\begin{pmatrix}\ny_1(t) \\\\\ny_2(t)\n\\end{pmatrix}\n= \\begin{pmatrix}\ny(t) \\\\\ny'(t)\n\\end{pmatrix}\n\\]\nThen we have the following first-order system: \\[\n\\begin{align}\n\\mathbf{Y}'(t) &= \\mathbf{F}(t, \\mathbf{Y}(t)) = \\begin{pmatrix}\ny_1' \\\\\n- \\frac{1}{(1 + \\epsilon y_1)^2}\n\\end{pmatrix} \\\\\n\\mathbf{Y}(0) &= \\begin{pmatrix}\n0 \\\\\n1\n\\end{pmatrix}\n\\end{align}\n\\]\nYou can find a little guide on using solve_ivp in Python here. Here is the Python code to solve the differential equation.\n\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nep = 0.2\n\n#def F(Y, t, ep)"
  },
  {
    "objectID": "part-05-techniques/newtons.html#demo-of-newtons-method-for-scalar-equations",
    "href": "part-05-techniques/newtons.html#demo-of-newtons-method-for-scalar-equations",
    "title": "12  Newton’s method",
    "section": "12.1 Demo of Newton’s method for scalar equations",
    "text": "12.1 Demo of Newton’s method for scalar equations\nHere is a simple demonstration of Newton’s method.\n\nimport numpy as np\n\ndef Newton(f, df, x, maxiter=100, tol=1e-12, display=0):\n    i = 0\n    while (abs(f(x) - 0) > tol) and (i < maxiter):\n        err = f(x)\n        x = x - err / df(x)\n        if display == 1:\n            print(\"f(x) = \", np.abs(err), \", x = \", x)\n        i = i + 1\n    return x, err\n\nf = lambda x: x**3 + 4*x**2 - 10\ndf = lambda x: 3*x**2 + 8*x\n\nx = 2\nx, err = Newton(f, df, x, 10, 1e-8, 1)\nprint(\"Final approximation = \", x)\n\nf(x) =  14 , x =  1.5\nf(x) =  2.375 , x =  1.3733333333333333\nf(x) =  0.13434548148148195 , x =  1.3652620148746266\nf(x) =  0.0005284611795151051 , x =  1.3652300139161466\nFinal approximation =  1.3652300139161466"
  },
  {
    "objectID": "part-05-techniques/newtons.html#newtons-method-for-systems-of-nonlinear-equations",
    "href": "part-05-techniques/newtons.html#newtons-method-for-systems-of-nonlinear-equations",
    "title": "12  Newton’s method",
    "section": "12.2 Newton’s method for systems of nonlinear equations",
    "text": "12.2 Newton’s method for systems of nonlinear equations\nNewton’s method generalises naturally to the case of a system of equations. Suppose we wish to solve for the \\(n\\) unknowns \\(\\mathbf{x} = (x_1, \\ldots, x_n)\\) via \\[\n\\mathbf{F(\\mathbf{x}}) =\n\\begin{pmatrix}\nF_1(\\mathbf{x}) \\\\\nF_2(\\mathbf{x}) \\\\\n\\ldots \\\\\nF_n(\\mathbf{x})\n\\end{pmatrix} = 0.\n\\]\nWe have, via Taylor’s formula, \\[\n\\mathbf{F}(\\mathbf{x}_{i+1}) \\sim  \\mathbf{F(\\mathbf{x}_i}) + J(\\mathbf{x}_i)(\\mathbf{x}_{i+1} - \\mathbf{x}_i) + \\mathcal{O}(||\\mathbf{x}_{i+1} - \\mathbf{x}_i||^2),\n\\] where \\(J\\) is the Jacobian matrix \\[\nJ(\\mathbf{x}) = \\nabla \\mathbf{F}(\\mathbf{x}) =\n\\begin{pmatrix}\n\\frac{\\mathrm{\\partial}F_1}{\\mathrm{\\partial}x_1} &\n\\cdots &\n\\frac{\\mathrm{\\partial}F_1}{\\mathrm{\\partial}x_n} \\\\\n\\vdots & \\ddots & \\vdots \\\\\n\\frac{\\mathrm{\\partial}F_n}{\\mathrm{\\partial}x_1} &\n\\cdots &\n\\frac{\\mathrm{\\partial}F_n}{\\mathrm{\\partial}x_n}\n\\end{pmatrix}.\n\\] Therefore, Newton’s method forms the iterates of \\[\n\\mathbf{x}_{i+1} = \\mathbf{x}_i + J^{-1}(\\mathbf{x}_i) \\mathbf{F}(\\mathbf{x}_i),\n\\] which takes a very similar form to the scalar case.\nHowever, solution of the inverse of \\(J\\) is typically inefficient, and it is better to instead solve for \\(\\delta_{i+1} = \\mathbf{x}_{i+1} - \\mathbf{x}_i\\) via \\[\nJ(\\mathbf{x}_i) \\delta_{i+1} = - \\mathbf{F}(\\mathbf{x}_i),\n\\] and then calculate \\(\\mathbf{x}_{i+1} = \\mathbf{x}_i + \\delta_{i+1}\\). There are many ways of solving the above matrix problem efficiently using built-in routines that perform, e.g. Gaussian elimination.\nhttp://hplgit.github.io/prog4comp/doc/pub/._p4c-solarized-Python031.html"
  },
  {
    "objectID": "part-05-techniques/euler.html",
    "href": "part-05-techniques/euler.html",
    "title": "10  Euler’s method",
    "section": "",
    "text": "2022-23 note\n\n\n\nCovered in lectures 8-9.\n\n\nIn the previous section, we used built-in ODE solvers to develop numerical solutions. It is important to gain an understanding how a simple ODE solver works. The simplest scheme is called Euler’s method, and this we now explain.\nBegin from the system (Equation 9.2). We assume that the solution is represented by a discrete set of points, \\(\\mathbf{Y}_n = \\mathbf{Y}(t_n)\\) at the times \\(t_0 = 0\\), \\(t_1 = \\Delta t\\), \\(t_2 = 2\\Delta t\\), and so on. The time derivative is written as a discrete derivative while we approximate the right hand side by its value at the nth time step: \\[\n\\frac{\\mathbf{Y}_{n+1} - \\mathbf{Y}_{n}}{\\Delta t} = \\mathbf{F}(t_n, \\mathbf{Y}_n)\n\\]\nRearranging yields a very simple algorithm for solving the ODE: \\[\n\\mathbf{Y}_{n} = \\mathbf{Y}_{n-1} + \\mathbf{F}(t_{n-1}, \\mathbf{Y}_{n-1}) \\Delta t\n\\] for \\(n = 1, 2, 3, \\ldots\\)\nThis would be implemented via the following pseudocode:\n\n\n\n\n\n\nEuler’s method\n\n\n\n1. Input: function f(t, Y)  \n            time step, dt\n            initial condition, Y0\n\n2. Set initial condition Y = Y0\n\n2. Take one Euler step and overwrite previous value\n\n                 Y = Y + f(t, Y)\n\n3. Increment t by dt and goto 2\n\n\nEuler’s method is conceptually simple but quite inaccurate. But in this case, we see that it works fairly well in comparison to the built-in solvers.\n\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom scipy.integrate import solve_ivp\n\nep = 0.2            # epsilon value\ntmax = 2            # max time\nN = 20              # number of steps\nt = np.linspace(0, tmax, N) # mesh used for plotting\ndt = t[1] - t[0]\n\n# Define function for the ODE\ndef f(t, Y, ep):\n    y, yp = Y\n    ypp = -1/(1 + ep*y)**2\n    return np.array([yp, ypp])\n\n# define the initial condition\nY = [0.0, 1.0]\nti = 0\n\n# define the solution vector\nfor i in range(1, N):\n    ti = ti + dt  # Increment time\n    Y = Y + f(ti, Y, ep)*dt # Euler step\n    plt.plot(ti, Y[0], 'k.')\n\n# Asymptotic solutions\ny0 = -1/2*t**2 + t\ny1 = -1/12*t**4 + 1/3*t**3\nplt.plot(t, y0, '--')\nplt.plot(t, y0 + ep*y1, '--')\nplt.xlabel('t');\nplt.ylabel('y');"
  },
  {
    "objectID": "lectureplan.html",
    "href": "lectureplan.html",
    "title": "Lecture plan",
    "section": "",
    "text": "2022-23 note\n\n\n\nThis material has not yet been finalised and is still under construction.\nThis note will be completed as the course is taught for the first time.\n\n\n\n\n\n\n\n\n\n\nLecture\nTopic\nChapter\n\n\n\n\n\nEstimating your energy on the back of an envelope\n\n\n\n\nWeek 1\n\n\n\n1\nIntroduction to the course; conservation equations and deriving the heat equation\nChapter 1\n\n\n2\nUnits and nondimensionalisation\nChapter 2\n\n\n3\nMore nondimensionalisation; derivation of the basic energy model\nChapter 3\n\n\n\nWeek 2\n\n\n\n4\nProblem class; problem sheet 1 (Chapter 26)\nChapter 4\n\n\n5\nCO2 concentration and estimating consumption\nChapter 5\n\n\n6\nEstimating consumption; questions to think about (Chapter 27)\nChapter 6, Chapter 7\n\n\n\nBoot camp on practical applied mathematics\n\n\n\n\nWeek 3\n\n\n\n7\nAsymptotic approximations for algebraic equations\nChapter 8\n\n\n8\nAsymptotic approximations for ODEs, Euler’s method\nChapter 9, Chapter 10\n\n\n9\nProblem class; problem set 2 (Chapter 28)\nChapter 11\n\n\n\nWeek 4\n\n\n\n\nBisection, Newton’s & Secant methods, Jacobians\nChapter 12\n\n\n\nMatched asymptotics and BVPs\nChapter 13\n\n\n\nProblem class\n\n\n\n\nConceptual models of Planet Earth\n\n\n\n\nWeek 5\n\n\n\n\nSteady states of the basic energy model I\nChapter 14\n\n\n\nTechniques: Arclength continuation I\nChapter 24\n\n\n\nTechniques: Arclength continuation II\nChapter 24\n\n\n\nWeek 6\n\n\n\n\nSteady states of the basic energy model II\nChapter 15\n\n\n\nBasic models of the ocean\nChapter 16\n\n\n\nProblem class; problem sheet 3\n\n\n\n\nWeek 7\n\n\n\n\nTechniques: Numerical solution of ODEs\n\n\n\n\nTechniques: Method of multiple scales\n\n\n\n\nStommel’s box model and its variants\nChapter 17\n\n\n\nWeek 8\n\n\n\n\nZonal energy budget\n\n\n\n\nTechniques: Legendre polynomials and spectral numerics\n\n\n\n\nProblem class; problem sheet 4\n\n\n\nXX\nEl Nino-Southern Oscillation\n\n\n\n\nPhysical models of Planet Earth\n\n\n\n\nWeek 9\n\n\n\n\nRadiative energy transfer\n\n\n\n\nTwo-stream approximation\n\n\n\n\nRunaway greenhouse effect\n\n\n\n\nWeek 10\n\n\n\n\nIce-albedo feedback\n\n\n\n\nCarbon cycle\n\n\n\n\nOcean carbon\n\n\n\n\nProblem class; problem sheet 5"
  },
  {
    "objectID": "part-05-techniques/asymptotics02.html#sec-asym2-num",
    "href": "part-05-techniques/asymptotics02.html#sec-asym2-num",
    "title": "9  Asymptotic approximations of ODEs",
    "section": "9.2 Numerical solutions of IVPs",
    "text": "9.2 Numerical solutions of IVPs\nWe first demonstrate how to solve ODEs (initial-value-problems, IVPs) using black-box functions in Python. For starters, most numerical formulations for ODEs will require that the problem be posed in terms of a first-order system of equations. To convert (Equation 9.1) into such a form, create a set of unknowns for the derivatives. Set \\[\n\\mathbf{Y}(t) =\n\\begin{pmatrix}\ny_1(t) \\\\\ny_2(t)\n\\end{pmatrix}\n= \\begin{pmatrix}\ny(t) \\\\\ny'(t)\n\\end{pmatrix}\n\\]\nThen we have the following first-order system: \\[\n\\begin{align}\n\\mathbf{Y}'(t) &= \\mathbf{F}(t, \\mathbf{Y}(t)) = \\begin{pmatrix}\ny_1' \\\\\n- \\frac{1}{(1 + \\epsilon y_1)^2}\n\\end{pmatrix} \\\\\n\\mathbf{Y}(0) &= \\begin{pmatrix}\n0 \\\\\n1\n\\end{pmatrix}\n\\end{align}\n\\tag{9.2}\\]\nYou can find a little guide on using solve_ivp in Python here. Here is the Python code to solve the differential equation.\n\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom scipy.integrate import solve_ivp\n\nep = 0.2 # epsilon value\ntmax = 2 # max time\nt = np.linspace(0, tmax, 100) # mesh used for plotting\n\n# Define function for the ODE\ndef f(t, Y):\n    ep = 0.2\n    y, yp = Y\n    ypp = -1/(1 + ep*y)**2\n    return [yp, ypp]\n\n# define the initial condition\nY0 = [0, 1]\n\nsol = solve_ivp(f, [0, tmax], Y0, dense_output=True)\n\n# Prior to plotting, re-interpolate solution on a fine grid\nyy = sol.sol(t)\n# Asymptotic solutions\ny0 = -1/2*t**2 + t\ny1 = -1/12*t**4 + 1/3*t**3\n\n# Plot it all\nplt.plot(t, yy[0,])\nplt.plot(t, y0, '--')\nplt.plot(t, y0 + ep*y1, '--')\nplt.xlabel('t')\nplt.ylabel('y(t)')\n\nText(0, 0.5, 'y(t)')\n\n\n\n\n\nThe two-term approximation does beautifully well, even at this moderate value of \\(\\epsilon = 0.2\\)."
  },
  {
    "objectID": "part-xx-exercises/problemclass02.html",
    "href": "part-xx-exercises/problemclass02.html",
    "title": "11  Problem class 2",
    "section": "",
    "text": "2022-23 note\n\n\n\nThis material has not yet been finalised and is still under construction. Once it is covered in lectures, this banner will be replaced."
  },
  {
    "objectID": "part-xx-exercises/thought02.html",
    "href": "part-xx-exercises/thought02.html",
    "title": "27  Thinking about your own energy",
    "section": "",
    "text": "There is no problem set for the material related to MacKay’s book, i.e. Chapter 6 to Chapter 7. Instead, a portion of your coursework in Week 7 will ask you to explore some issues to your own energy usage, and to other interesting aspects from MacKay’s book.\n\n\nTherefore, instead of homework, I encourage you to read the following to get you into thinking about energy usage.\nDownload or access the book at www.withouthotair.com.\n\nRead/scan through Chap. 1 (Numbers, not adjectives).\nExamine MacKay’s arguments for those items that you find interesting. You can examine both the issue of consumption and energy production (or alternatively, use of renewables).\n\nRead/scan through MacKay’s technical sections, in Chap. 3 (technical chapters).\n\nSelect one or two items that you are interested in learning more about (e.g. energy usage in car transport), and read the technical aspects closely.\nInvestigate how much energy you are using yourself and what back-of-the-envelope calculations you would like to do.\nStart with your gas and electrical usage, but you may be interested in other energy usages that you have wondered about.\n\nMake a list of those interesting questions that you have wondered about. For example:\n\nIs it better for me to leave a hot coffee machine on the whole day, or turn it on every time I use it?\nHow important is it for me to eat less meat, in the grand scheme of things? How does this compare with the impact of going on vacation in the summers?\nMy family is thinking about selling our old car and instead buying an electric car. Is it better for the environment to do so, or is the environmental cost of electric car manufacturing, lithium battery usage, and disposing of our old car outweigh the benefits?\n\nMacKay can be accused of oversimplifying many of the modelling aspects. Moreover, the book is now ten years out-of-date.\n\nWhich of MacKay’s calculations might you be interested in digging into at a deeper level?"
  },
  {
    "objectID": "part-xx-exercises/ps01sol.html#a-source-in-the-heat-equation",
    "href": "part-xx-exercises/ps01sol.html#a-source-in-the-heat-equation",
    "title": "29  Problem set 1 solutions",
    "section": "29.1 A source in the heat equation",
    "text": "29.1 A source in the heat equation\nConsider the same heat experiment discused in Chapter 1 but now consider a bar that has an internal source or sink generating or removing heat, such as the case of a boiler with an internal heating element. By adapting a similar derivation to the one presented, explain why the modified conservation of heat equation is \\[\n\\frac{\\mathrm{\\partial}}{\\mathrm{\\partial}t} \\int_a^b \\rho c T \\, \\mathrm{d}x = q(x = b, t) - q(x = a, t) + \\int_a^b R(x, t) \\, \\mathrm{d}x.\n\\]\nIn addition:\n\nBy studying the dimensions of the other terms in the above equation, find what the dimensions of \\(R\\) are. What does \\(R > 0\\) mean and \\(R < 0\\)?\n\n\n\n\n\n\n\nImportant\n\n\n\nOn the left, density has units kg/m^3, specific heat J/(kg K), and temperature K. But then dx has units of m. And d/dt has units of 1/s. So altogether, we have the following SI units on the left: \\[\n\\frac{J}{m^2 \\cdot s}\n\\]\nSo its energy per unit area per unit time. The reason why it’s per unit area is because you have not integrated over the sides of the cylinder/bar.\nSo therefore this needs to match the units on the right, which are [R] [dx]. So you conclude that \\[\n[R] = \\frac{J}{m^3 \\cdot s}\n\\] i.e. energy per unit time per unit volume. This is energy density.\nR > 0 means heat is added into the system (source). R < 0 means heat is removed from the system (sink).\n\n\n\nHence derive the partial differential equation that governs the temperature \\(T\\).\n\n\n\n\n\n\n\nImportant\n\n\n\nThe derivation follows exactly as in the notes, except you have an additional term on the RHS. Use Fourier’s law to convert \\(q = -k \\partial T/\\partial x\\). Write everything under the integral and this yields: \\[\n\\rho c \\frac{\\mathrm{\\partial}T}{\\mathrm{\\partial}t} = k \\frac{\\mathrm{\\partial}^2 T}{\\mathrm{\\partial}x^2} + R.\n\\]\n\n\n\nBy introducing the appropriate scalings on each of the variables, \\(x\\), \\(t\\), and \\(T\\), non-dimensionalise the PDE and discuss the non-dimensional parameters (there will be two).\n\n\n\n\n\n\n\nImportant\n\n\n\nSame derivation as in the notes. Let \\[\nx = L x', T = [T]T' \\quad \\text{and} \\quad t = [t]t'.\n\\] This time you will remember to scale out the typical source strength, so \\[\nR = [R]R'.\n\\]\nThis leads to \\[\n\\frac{\\mathrm{\\partial}T'}{\\mathrm{\\partial}t'}\n= \\left(\\frac{k[t]}{L^2 \\rho c}\\right) \\frac{\\mathrm{\\partial}^2 T'}{\\mathrm{\\partial}x'^2} + \\left(\\frac{[R][t]}{\\rho c [T]}\\right)R'.\n\\] So this gives the two sets of non-dimensional numbers \\[\n\\begin{align}\n\\Pi_1 &= \\frac{k[t]}{L^2 \\rho c} \\\\\n\\Pi_2 &= \\frac{[R][t]}{\\rho c [T]}.\n\\end{align}\n\\]\nIf you want, you can write it in the alternative form by taking the time scaling to be \\([t] = L/U\\), where \\(U\\) is some unspecified velocity scale.\nFor the interpretation, you can simply take \\(\\Pi_1\\) to be a measure of diffusive effects (heat spreading out) and \\(\\Pi_2\\) to be a measure of source strength. Note that this problem can be simplified even further by choosing the time scale so as to set \\(\\Pi_1 = 1\\). If you do this, you will be left with a single non-dimensional parameter that balances diffusion with the strength of the source."
  },
  {
    "objectID": "part-xx-exercises/ps01sol.html#choice-of-scalings",
    "href": "part-xx-exercises/ps01sol.html#choice-of-scalings",
    "title": "29  Problem set 1 solutions",
    "section": "29.2 Choice of scalings",
    "text": "29.2 Choice of scalings\nConsider the dimensional problem for the motion of a projectile launched from close to the surface of the Earth. The dimensional height of the projectile, \\(y(t)\\), is given by \\[\\begin{align}\n\\frac{\\mathrm{d}^2 y}{\\mathrm{d}t^2} &= - \\frac{GM}{(R+y)^2}, \\\\\ny(0) &= 2 \\, \\mathrm{m}, \\\\\ny'(0) &= -V_0 \\, \\mathrm{m/s}.\n\\end{align}\\] Assume that the Earth is spherical and of uniform density, with its mass given by \\(M = (4/3) \\pi R^3 \\rho\\). Non-dimensionalise the height using \\(y = L \\tilde{y}\\) and time using \\(t = T\\tilde{t}\\). Consider the following cases:\n\n\\(R\\) fixed, \\(V_0 \\to \\infty\\), \\(\\rho\\) fixed;\n\\(R\\) fixed, \\(V_0\\) fixed, \\(\\rho \\to \\infty\\);\n\\(R\\) fixed, \\(V_0\\) fixed, \\(\\rho \\to 0\\);\n\\(R \\to 0\\), \\(V_0\\) fixed, \\(M\\) fixed.\n\n\n\n\n\n\n\nYikes!\n\n\n\nThis problem ended up a lot longer than expected. Nevertheless do at least of the few cases to get a feel.\n\n\nFor each case:\n\nExplain the physical interpretation of the limits.\n\n\n\n\n\n\n\nSolution\n\n\n\n\nVery fast initial velocity\nVery heavy object\nVery light object\nVery small Earth radius\n\n\n\n\nChoose the scalings \\(L\\) and \\(T\\) to normalise as many terms as possible.\nChoose the scalings so that the time it takes for the projectile to fall should be finite for the given limit, and for the speed, acceleration, and initial height to be well behaved (finite).\nWrite out the scaled problem and identify all remaining nondimensional parameters.\nIdentify the limiting small parameter for each case. Write out the problem (leading-order problem) when the parameter is set to zero.\n\n\n\n\n\n\n\nSolution\n\n\n\nThe solution for parts (b) to (d) is given below. The solution for part (e) is simply setting \\(\\epsilon = 0\\) in each case."
  },
  {
    "objectID": "part-xx-exercises/ps01sol.html#the-unique-timescale-in-the-heat-equation",
    "href": "part-xx-exercises/ps01sol.html#the-unique-timescale-in-the-heat-equation",
    "title": "29  Problem set 1 solutions",
    "section": "29.3 The unique timescale in the heat equation",
    "text": "29.3 The unique timescale in the heat equation\nDuring our investigation of the heat equation, we found that it was possible to scale time so as to scale out the only non-dimensional parameter that appears in the PDE (the Peclet number). This produced (Equation 2.3). As explained in lectures, the disappearance of all non-dimensional parameters is due to the fact that only a single sensible timescale exists.\nBy adjusting the boundary conditions, we may create a new problem involving heat flow where a unique ‘special’ timescale in (Equation 2.2) can no longer be chosen.\nConsider a system where one side of the rod is heated in some periodic fashion, e.g. set the initial and boundary conditions to be \\[\\begin{align}\nT(x, 0) &= T_0 \\\\\nT(0, t) &= T_a \\cos (\\omega t), \\\\\nT(L, t) &= T_b.\n\\end{align}\\]\n\nWhat must the units of \\(\\omega\\) be?\n\n\n\n\n\n\n\nSolution\n\n\n\nNote \\(\\omega t\\) must be unitless. Therefore \\([\\omega] = 1/s\\).\n\n\n\nNon-dimensionalise as usual and, without selecting the timescale, \\([t]\\), identify the key non-dimensional parameters that remain. Write a brief sentence to describe their physical interpretation.\n\n\n\n\n\n\n\nSolution\n\n\n\nThis is exactly the same as in the above heat question. You will still obtain\n\\[\n\\frac{\\mathrm{\\partial}T'}{\\mathrm{\\partial}t'}\n= \\Pi_1 \\frac{\\mathrm{\\partial}^2 T'}{\\mathrm{\\partial}x'^2}\n\\] where the non-dimensional parameters is the Peclet number introduced in lectures: \\[\n\\Pi_1 = \\left(\\frac{k[t]}{L^2 \\rho c}\\right).\n\\]\nThe main difference is that now, your boundary condition is \\[\nT'(0, t') = \\frac{T_a}{T_0} \\cos (\\Pi_2 t'),\n\\] where \\[\n\\Pi_2 = \\omega [t].\n\\]\n\n\n\nThere are two sensible choices for setting the timescale, \\([t]\\). Identify the two choices and present the reduced set of equations in each case.\n\n\n\n\n\n\n\nSolution\n\n\n\nSo there are now two ways of choosing the time scale. Either choose it to set \\(\\Pi_1 = 1\\) or choose it to set \\(\\Pi_2 = 1\\). In the former choice, you are choosing to set time according to the diffusive rate. In the latter, you are setting time according to how the boundary is heated."
  },
  {
    "objectID": "part-xx-exercises/ps01sol.html#timescale-in-the-surface-energy",
    "href": "part-xx-exercises/ps01sol.html#timescale-in-the-surface-energy",
    "title": "29  Problem set 1 solutions",
    "section": "29.4 Timescale in the surface energy",
    "text": "29.4 Timescale in the surface energy\nTake the basic zero-dimensional energy model studied in (Equation 3.7) for the temperature of the troposphere: \\[\nc \\frac{\\mathrm{d}T}{\\mathrm{d}t} = \\frac{1}{4} Q(1 - a) - \\sigma \\gamma T^4.\n\\]\n\nNon-dimensionalise the model by choosing \\(T = [T]T'\\), \\(t = [t]t'\\), and \\(Q = [Q]Q'\\). Show that it is possible to select the scalings on the temperature and time so as to completely remove all constants from the problem when \\(Q\\) is assumed to be constant.\n\n\n\n\n\n\n\nSolution\n\n\n\nThe question’s suggestion of setting \\(Q = [Q]Q'\\) was excessive since \\(Q\\) is just a constant in this case. So proceeding as usual:\nSet in the scalings. This time it is easier to balance the right had-side first. \\[\n\\frac{c[T]}{[t']}\\frac{\\mathrm{\\partial}T'}{\\mathrm{\\partial}t'} = \\left(\\frac{Q(1-a)}{4}\\right) - \\left(\\sigma \\gamma [T]^4\\right) T'^4.\n\\] So select the temperature scaling so that both coefficients on the RHS are equal. \\[\n[T] = \\left(\\frac{Q(1-a)}{4\\sigma \\gamma}\\right)^{1/4}.\n\\] Now choose the time scaling also to match the LHS coefficient to the RHS coefficient. \\[\nc \\frac{[T]}{[t]} = \\sigma \\gamma [T]^4 \\Longrightarrow\n[t] = \\frac{c}{\\sigma \\gamma [T]^4}\n\\] Once you have done this, the equation transforms to the one given in part b.\n\n\n\nThus, show that the analysis of the above equation is equivalent to studying \\[\n\\frac{\\mathrm{d}T}{\\mathrm{d}t} = 1 - T^4,\n\\] where we have dropped the primes and assumed that the albedo is such that \\(1 - a \\neq 0\\).\n\n\n\n\n\n\n\nSolution\n\n\n\nDone above.\n\n\n\nFrom your choice of \\([t]\\), estimate the typical dimensional value using \\(d \\approx 10 \\mathrm{km}\\), \\(\\rho \\approx 1 \\mathrm{kg} \\,\\mathrm{m}^{-3}\\), \\(c_p \\approx 10^3 \\mathrm{J} \\,\\mathrm{kg}^{-1} \\,\\mathrm{K}^{-1}\\).\n\nUse a pocket calculator to verify your calculations and conclude that this time-scale is on the order of a month. What is the relevance of this approximation as it concerns the steady-state solution?\n\n\n\n\n\n\n\nSolution\n\n\n\nBelow (Equation 3.7), we defined \\(c = \\rho c_p d\\). So the scaling on time is (put in the scaling for [T]): \\[\n[t] = \\left(\\frac{4}{(1-a)}\\right)^{3/4} \\left(\\frac{c}{(\\sigma \\gamma)^{1/4} Q^{3/4}}\\right).\n\\]\nSo we know that \\(\\sigma = 5.67 \\times 10^{-8}\\) J/(m^2 s K^4), \\(Q = 1.38 \\times 10^3\\) J/(m^2 s). We can also calculate \\[\nc = \\rho c_p d = 10^7 J/(K \\cdot m^2).\n\\]\nWe can use \\(\\gamma = 1\\) for an estimate. The right-most factor is \\[\n\\frac{10^7}{(5.67 \\times 10^{-8})^{1/4} (1.378 \\times 10^3)^{3/4}} s = 2.88 \\times 10^6 s\n\\]\nIf we use a = 0.3 then this gives a total of \\[\n[t] = 3.7 \\times 2.88 \\times 10^6 s.\n\\] To convert to days, note 1 day = 24 hours = 2460 minutes = 2460*60 seconds. This is then \\[\n[t] = \\frac{1.65 \\times 10^7}{8.64 \\times 10^4} \\text{days} = 0.19 \\times 10^3 \\text{days} = 190 \\text{days}.\n\\] So on the order of 6 months. Any answer you get that’s roughly on the order of months sounds about right. This is the rough approximation of how long time-scale effects take to appear."
  },
  {
    "objectID": "part-01-intro/intro-nondim.html#dimensional-quantities",
    "href": "part-01-intro/intro-nondim.html#dimensional-quantities",
    "title": "2  Dimensional scaling analysis",
    "section": "2.1 Dimensional quantities",
    "text": "2.1 Dimensional quantities\nEvery physical quantity, say Q, can be expressed as a product of a dimensional unit, denoted [Q], and a magnitude, say Q’. Thus we write \\[\nQ = Q'[Q]\n\\] For example, if \\(x\\) corresponds to the physical length in a problem, we might select \\([x] = \\mathrm{km}\\) or \\([x] = \\mathrm{yards}\\) or \\([x] = \\mathrm{m}\\). It is important to choose the dimensionalisation to suit the problem under consideration.\n\n2.1.1 SI units\nThe International System (SI) of Base Units sets out a distinct selection of choices for dimensions in certain physical quantities. The seven fundamental dimensional units are\n\n[Length] = metre\n[Time] = seconds\n[Mass] = kilogram\n[Temperature] = Kelvin\n[Electric current] = ampere\n[Light intensity] = candela\n[Material quantity] = mole\n\nDimensional units that can be expressed in terms of other fundamental units are known as derived units. For example:\n\n[Speed] = metre/second\n[Acceleration] = metre/second2\n[Force] = kilogram . metre/second2"
  },
  {
    "objectID": "part-01-intro/intro-nondim.html#dimensional-homogeneity-and-non-dimensionalisation",
    "href": "part-01-intro/intro-nondim.html#dimensional-homogeneity-and-non-dimensionalisation",
    "title": "2  Dimensional scaling analysis",
    "section": "2.2 Dimensional homogeneity and non-dimensionalisation",
    "text": "2.2 Dimensional homogeneity and non-dimensionalisation\nAll terms in any equation must have the same dimensions. This is the principle of dimensional homogenuity. For example, Newton’s second law expresses the fact that \\[\nF = m \\frac{\\mathrm{d}^2x}{\\mathrm{d}t^2}\n\\] We can check, then, that the units do indeed match up on either side. Here, the RHS has units of [m] [x]/[t]2 or in SI units, kg . metres / seconds2. This indeed matches our previous given SI unit decomposition for force.\nNotice in addition that the input to functions like \\(\\cos\\theta\\) and \\(e^z\\) must be non-dimensional (or dimensionless).\nThe process of nondimensionalisation is then as follows. Given an equation, we know that each term must have the same dimension. Therefore, we can scale all the dependent and independent variables by dimensional constants in order to yield a non-dimensional equation.\nWhy this is an important tool is demonstrated by the below."
  },
  {
    "objectID": "part-01-intro/intro-nondim.html#returning-to-the-heat-equation",
    "href": "part-01-intro/intro-nondim.html#returning-to-the-heat-equation",
    "title": "2  Dimensional scaling analysis",
    "section": "2.3 Returning to the heat equation",
    "text": "2.3 Returning to the heat equation\nExact units are not relevant for dynamics, and it is instead the ratio of units that we care about. To apply this principle, let us non-dimensionalise the equation Equation 1.1. We introduce typical scales for each of the variables. For example, we non-dimensionalise the temperature and distance by setting \\[\nT = T_0 T' \\quad \\text{and} \\quad x = L x',\n\\] where primes now denote non-dimensional quantities. Since it is not clear how to scale time, we set \\(t = [t] t;'\\) and choose the scale later. Substitution into the equation now yields \\[\\begin{gather}\n\\frac{\\rho c T_0}{[t]}\\frac{\\mathrm{\\partial}T'}{\\mathrm{\\partial}t'} = \\frac{kT_0}{L^2} \\frac{\\mathrm{\\partial}^2 T'}{\\mathrm{\\partial}x'^2}, \\\\\nT(x, 0) = 1 \\\\\nT(0, 0) = \\frac{T_a}{T_0}, \\\\\nT(L, 0) = \\frac{T_b}{T_0}.\n\\end{gather}\\]\nIt is useful to think of time in terms of velocity and distance. Let us then write \\[\n[t] = L/U,\n\\] where \\(U\\) is a typical velocity scale (which again, we shall specify later). Then note that the heat equation can be written as \\[\n\\frac{\\rho c}{(L/U)} \\frac{\\mathrm{\\partial}T'}{\\mathrm{\\partial}t'} = \\frac{k}{L^2}\\frac{\\mathrm{\\partial}^2 T'}{\\mathrm{\\partial}x'^2}.\n\\] We can move all the units to one side and then write \\[\n\\frac{\\mathrm{\\partial}T'}{\\mathrm{\\partial}t'} =\\text{Pe} \\frac{\\mathrm{\\partial}^2 T'}{\\mathrm{\\partial}x'^2}.\n\\tag{2.1}\\]\nWe can verify that the quantity \\[\n\\mathrm{Pe} =  \\frac{k/(\\rho c L^2)}{U/L} = \\frac{\\text{diffusive timescale}}{\\text{advective timescale}}.\n\\] known as the Peclet number is entirely non-dimensional. This number essentially charactises the balance between diffusive effects (which causes heat to spread out) versus advective effects (the transport of the heat). In the case of our problem, there is no obvious source of advection. Another way to see this is that the temporal or velocity scale is entirely free for us to select.\nWe can now choose the temporal scale so as to simplify the equation. Let us choose \\[\n[t] = \\frac{L}{U} = \\frac{\\rho c L^2}{k}.\n\\tag{2.2}\\]\nNow the system simplifies. We can now write \\[\n\\begin{gather}\n\\frac{\\mathrm{\\partial}T'}{\\mathrm{\\partial}t'} = \\frac{\\mathrm{\\partial}^2 T'}{\\mathrm{\\partial}x'^2} \\\\\nT'(x', 0) = 1 \\\\\nT'(0, 0) = A, \\\\\nT'(1, 0) = B.\n\\end{gather}\n\\tag{2.3}\\]\nWe have gone from a system where we needed to consider six parameters to one where we only need to specify two (essentially, the ratio of the initial heat to the boundary values). Imagine you are an engineer at a thermal company, and asked to study the different possible configurations of heat in the above setup. If you were to blindly perform numerical computations, you would have had to set specific values for each of the six parameters.\nInstead, some mathematical analysis has demonstrated that the six-dimensional space of parameters can be simplified to a two-dimensional one—this is an enormous simplification.\nYour analysis has further identified the key non-dimensional parameter that appears in Equation 2.1. This demonstrates that it is not the individual values of \\(k\\), \\(\\rho\\), \\(c\\), … that matter, but rather their specific combination in the form of the Peclet number."
  },
  {
    "objectID": "part-01-intro/intro-nondim.html#gi-taylor-and-the-atomic-bomb",
    "href": "part-01-intro/intro-nondim.html#gi-taylor-and-the-atomic-bomb",
    "title": "2  Dimensional scaling analysis",
    "section": "2.4 GI Taylor and the atomic bomb",
    "text": "2.4 GI Taylor and the atomic bomb\n\n\n\n\n\n\n2022-23 note\n\n\n\nDuring Lecture 3 we will cover some aspects of how non-dimensionalisation was famously used by British fluid dynamicist GI Taylor to estimate the energy of the atom bomb. Students can refer to the visualiser notes.\n\n\n\n\n\n\nFowler, Andrew. 2011. Mathematical Geoscience. Vol. 36. Springer."
  },
  {
    "objectID": "part-01-intro/basic-energy-model.html#the-basic-energy-model",
    "href": "part-01-intro/basic-energy-model.html#the-basic-energy-model",
    "title": "3  Basic energy models",
    "section": "3.1 The basic energy model",
    "text": "3.1 The basic energy model\nThe basic model is derived as follows.\n\nBy considering the incoming radiation from the sun, obtain an estimate for the incoming energy, \\(E_{\\text{in}}\\).\nUse a constitutive law that indicates how much outgoing energy is produced by an object heated to some temperature.\nEquate the change in internal energy to be equal to the difference between the above two items.\n\nNote that the primary components of the global energy balance are radiative fluxes: we receive short-wave radiation (UV and visible light) from the Sun, and emit longwave radiation (infra-red) to space.\n\n\n\nFigure 3.1: Radiation in the atmosphere\n\n\nFirst we consider incoming energy.\n\n\n\n\n\n\nEnergy from the Sun\n\n\n\nFirst, note that the shortwave radiation (UV and radiation) recieved from the sun is \\(Q \\approx 1370 \\text{ W$\\cdot$m$^{-2}$}\\) (which we consider measured at a point near the planet).\nIf we consider only that radiation that is absorbed into the Earth, we have \\[\nE_{\\mathrm{in}} = \\pi R^2 Q (1 - a),\n\\tag{3.2}\\] where \\(R\\) is the Earth’s radius.\nIn the above formula, we have multiplied the flux, \\(Q\\), with the visible surface area, \\(\\pi R^2\\). There is an additional multiplication by \\((1 - a)\\) where \\(a\\) is the planetary albedo, which characterises amount of energy reflected due to the surface properties. Light surfaces like snow will have high albedo, \\(a \\approx 0.9\\), while darker surfaces like the ocean have smaller albedo, \\(a \\approx 0.3\\). The global average albedo is \\(a \\approx 0.3\\).\n\n\nNext we consider outgoing energy.\n\n\n\n\n\n\nEnergy from the Earth\n\n\n\nWe now wish to characterise the energy, \\(E_{out}\\), and in the case of Earth, this will correspond to longwave radiation (infra-red) emitted into space. All bodies characterised by a temperature, say \\(T_e\\), will emit radiation, \\(Q_e\\). As a model, we can consider \\(Q_e\\) to be given by the Stefan-Boltzmann law, which states that \\[\nQ_e = \\sigma T_e^4,\n\\tag{3.3}\\] where \\(\\sigma \\approx 5.67 \\times 10^{-8} W m^{-2} K^{-4}\\) is the Stefan-Boltzmann constant.\nNow although the Earth’s surface may emit radiation according to (Equation 3.3), some of this radiation will be absorbed by the atmosphere and reflected back. This is the greenhouse effect. As a consequence of the greenhouse gas, the surface temperature of the Earth, \\(T\\), will be larger than the effective emitting temperature, \\(T_e\\). For the moment, we model this as \\[\nT_e = \\gamma^{1/4} T_e,\n\\tag{3.4}\\] where \\(\\gamma < 1\\) is a greenhouse gas factor, which depends on the properties of the atmosphere.\n\n\nNow combining the above equations, we have \\[\nE_{\\mathrm{in}} - E_{\\mathrm{out}} = \\pi R^2 Q (1 - a) - 4\\pi R^2 \\sigma \\gamma T^4,\n\\tag{3.5}\\] which gives the incoming energy per unit time.\n\n\n\n\n\n\nInternal heat energy\n\n\n\nDue to this incoming energy, the Earth will cool or heat in response. We need to know how the internal temperature of an object responds to an input in energy. The general formula is \\[\n\\text{Internal heat energy} = \\text{volume} \\times (\\rho c_p) \\times T.\n\\] The key quantity is the experimentally determined, \\(c_p\\), which corresponds to the specific heat capacity. It is given in the SI units of \\(\\mathrm{J} \\cdot \\mathrm{kg}^{-1} \\cdot \\mathrm{K}^{-1}\\), i.e. energy per unit mass per unit temperature. Note that this applied to a shell around the planet of thickness \\(d\\) in the atmosphere, and so the mass is given by \\[\n\\text{mass} = (4 \\pi R^2) d \\rho\n\\tag{3.6}\\] where \\(\\rho\\) is the average density of the atmosphere. Let us imagine the increase in temperature, \\(\\Delta T\\),during an interval of time, \\(\\Delta t\\). You can now verify that \\[\n\\Bigl[ (4 \\pi R^2) d \\rho \\Bigr] c_p (\\Delta T)\n\\] returns the units of Joules—i.e. this is the internal energy produced during the time \\(\\Delta t\\). We then have \\[\n\\Bigl[ (4 \\pi R^2) d \\rho \\Bigr] c_p \\Delta T =  \\Delta t (E_{in} - E_{out}).\n\\] Putting in (Equation 3.5) and taking the limit of \\(\\Delta t \\to 0\\), we finally have a heat equation for the Earth’s temperature given by the following ordinary differential equation (ODE) for \\(T = T(t)\\),\n\\[\nc \\frac{\\mathrm{d}T}{\\mathrm{d}t} = \\frac{1}{4} Q(1 - a) - \\sigma \\gamma T^4,\n\\tag{3.7}\\] where we have defined \\(c = \\rho c_p d\\) as the heat capacity of the atmosphere.\n\n\nThe above equation Equation 3.7 is time-dependent, but we may consider that the surface temperature, either over long-time or in an averaged sense, is dictated by the steady-state (time-independent) solution. Setting \\(\\mathrm{d}T/\\mathrm{d}t\\) to zero, we see that there is a unique steady-state given by \\[\nT = \\left(\\frac{Q(1-a)}{4\\sigma\\gamma}\\right)^{1/4}.\n\\]\nIf we take \\(Q \\approx 1370 \\,\\mathrm{W m}^{-2}\\), \\(a \\approx 0.3\\), \\(\\sigma \\approx 5.67 \\times 10^{-8} \\mathrm{W} \\,\\mathrm{m}^{-2} \\mathrm{K}^{-4}\\), we then get \\[\nT \\approx 255 \\mathrm{K} = -18^\\circ \\mathrm{C}.\n\\] under the assumption that \\(\\gamma = 1\\). That’s pretty cold! The actual average temperature is around \\(288 \\mathrm{K} \\approx 15 ^\\circ \\mathrm{C}\\).\nThe above back-of-the-envelope calculation seems to suggest that the parameter \\(\\gamma < 1\\) plays an important role in keeping the Earth warm enough for us to live on, and indeed the value of \\(\\gamma\\) inferred by the above is roughly \\(\\gamma \\approx 0.61\\). Later on in the course, we will develop a more rigorous model to predict such a \\(\\gamma\\) by studying the properties of the atmosphere."
  },
  {
    "objectID": "part-01-intro/basic-energy-model.html#the-history-of-global-warming",
    "href": "part-01-intro/basic-energy-model.html#the-history-of-global-warming",
    "title": "3  Basic energy models",
    "section": "3.2 The history of global warming",
    "text": "3.2 The history of global warming\nThe history of global warming (and hence the estimation of \\(\\gamma\\)) is convoluted, but the origins can be considered as far back as the work of (Fourier 1827) and (Pouillet 1838), and is discussed in the work by (Van der Veen 2000).\n\n\n\nFigure 3.2: An illustration of Fourier’s glass box\n\n\n\n\n\n\nFourier, Joseph. 1827. “Mémoire Sur Les Températures Du Globe Terrestre Et Des Espaces Planétaires.” Mémoires de l’Académie Royale Des Sciences de l’Institut de France 7: 570–604.\n\n\nPouillet, Claude Servais Mathias. 1838. “Memoire Sur Le Chaleur Solaire.” Paris.\n\n\nVan der Veen, CJ. 2000. “Fourier and the ‘Greenhouse Effect’.” Polar Geography 24 (2): 132–52."
  },
  {
    "objectID": "part-02-energy/part-energy.html",
    "href": "part-02-energy/part-energy.html",
    "title": "Energy usage and energy sources",
    "section": "",
    "text": "The first part of this course is centred upon a seminal book by Cambridge physicist David MacKay (MacKay 2009) that was written a number of years ago.\n\n\n\nFigure 1: Cover of MacKay’s book\n\n\nUnlike many other books and discussions on the topic of energy, this one is written with the emphasis placed on developing simple back-of-the-envelope estimates of usage. This is a great philosophy, and one that does well to cut straight to the heart of more long-winded discussions.\nMacKay’s book was published with an open license, and can be freely downloaded at https://www.withouthotair.com/.\n\n\n\n\nMacKay, D. J. C. 2009. Sustainable Energy – Without the Hot Air. UIT Cambridge Ltd."
  },
  {
    "objectID": "part-02-energy/mackay-consumption.html#tips-for-estimates",
    "href": "part-02-energy/mackay-consumption.html#tips-for-estimates",
    "title": "7  Estimating consumption",
    "section": "7.1 Tips for estimates",
    "text": "7.1 Tips for estimates\n\nUse appropriate conversion of units.\n\nFor example, even though you may not know what specific heat means (see below question about the bath hot water usage), examining the units of Joules/(Litre x Celcius) should tell you that this quantity corresponds to energy per unit volume per unit degree Celcius. Specific heat is a quantity associated with certain materials that describe the energy requred to increase its volume by one degree.\n\nManipulate different forms of energy\n\nAn object of mass \\(m\\) moving at speed \\(v\\) possesses kinetic energy given by \\[\nE_\\mathrm{kinetic} = \\frac{1}{2} mv^2.\n\\] An object can also possess different kinds of potential energy. For example, an object of mass \\(m\\) that will fall when released possesses gravitational potential energy given by \\[\nE_\\rm{grav. potential} = mgh\n\\] where \\(h\\) is its distance relative to some given point and \\(g = 9.8 \\, \\mathrm{m/s^2}\\) is the standard gravitational constant on the surface.\nA hot object also possesses heat energy. The heat energy is given by \\[\nE_\\mathrm{heat} = c \\rho V T\n\\] where \\(c\\) is the specific heat capacity, \\(\\rho\\) is the density, \\(V\\) is the volume, and \\(T\\) is the temperature. An object can also possess chemical potential energy (for example, we possess such energy when we eat food). And so forth and so on.\n\n\n\n\n\n\nChecking energies\n\n\n\nIt is a good idea to check that all the above units make sense and the right hand-sides return the expected unit of energy."
  },
  {
    "objectID": "part-02-energy/mackay-consumption.html#heating-and-cooling",
    "href": "part-02-energy/mackay-consumption.html#heating-and-cooling",
    "title": "7  Estimating consumption",
    "section": "7.2 Heating and cooling",
    "text": "7.2 Heating and cooling\nWe would like to develop estimates of energy usage in heating and cooling.\n\n\n\n\n\n\nEnergy in a hot bath\n\n\n\nTo compute the heat energy in taking a hot bath, we take the specific heat capacity of water, \\(c = 4200 \\, \\mathrm{J}/(\\mathrm{L} \\, ^{\\circ}\\mathrm{C})\\). This multiplies the volume of a bath (50 cm x 15 cm x 150 cm), and the temperature of water minus the temperature of ambient water, estimated at \\(40^\\circ\\mathrm{C}\\). This gives \\[\nE_\\mathrm{hot bath} \\approx (4200 \\times 110 \\times 40) \\mathrm{J} \\approx 18 \\, \\mathrm{MJ} \\approx 5 \\, \\mathrm{kWh}.\n\\]\n\n\n\n\n\n\n\n\nEnergy in appliances\n\n\n\nFor example, consider a kettle with a voltage of \\(V = 230V\\) and a max amperage of \\(I = 13A\\). Voltage measures the potential difference of electricity, and amperage measures the current. If you multiply the two together, \\(VI = P\\), you get power, \\(P\\). So this kettle has power \\(P = 3\\mathrm{kW}\\).\nTo estimate usage, we must estimate how often the kettle is used and for how long. Considering 20 minutes per household of two people, this then requires \\[\nE_\\mathrm{kettle} \\approx (3 \\mathrm{kW}) \\times \\left(20 \\, \\mathrm{min} \\times \\frac{\\mathrm{hrs}}{60\\mathrm{min}}\\right) = 1 \\mathrm{kWh}.\n\\]\nYou may also be interested in MacKay’s estimates for microwave ovens (0.5 kWh/day), regular ovens (1.5 kWh/day), and clothes washers (1 kWh/day).\n\n\nFollowing (MacKay 2009), you can also follow similar estimates of using space heaters, refrigerators, and air conditioners.\n\n\n\n\n\n\nHot air and cooling\n\n\n\nMackay develops the following estimates of energy usage (per day per person). Considering space heaters run during the colder months, he develops\n\\[\nE_\\text{hot air} \\approx 24\\,\\text{kWh}.\n\\] while considering the refrigerator and air condition usage, he approximates \\[\nE_\\text{heat + cooling} \\approx 1.5 \\, \\mathrm{kWh}.\n\\]\n\n\nNote that the above estimates are for average domestic consumption, and hence this does not include the significant energy usages of the service and workplace industries. The total estimate from this chapter is as follows.\n\n\n\n\n\n\nTotal heating and cooling estimate\n\n\n\nMacKay estimates (p. 53) that the total energy one (domestic) person spends on heating and cooling, including home, workplace, and cooking, is 37 kWh per day per person (12 for hot water, 24 for hot air, and 1 for cooling). He notes that this seems to be close to the typical figures quoted (45 kWh/d per person) if you make use of some national tables (and some liberties—like using the University of Cambridge’s energy estimates)."
  },
  {
    "objectID": "part-02-energy/mackay-consumption.html#energy-usage-of-stuff",
    "href": "part-02-energy/mackay-consumption.html#energy-usage-of-stuff",
    "title": "7  Estimating consumption",
    "section": "7.3 Energy usage of stuff",
    "text": "7.3 Energy usage of stuff\nA significant amount of energy is expended on:\n\nproduction of raw materials\nproduction on stuff and transportation of such\nuse of stuff\ndisposal and recycling of stuff\n\n\n\n\n\n\n\nEnergy usage in a soda addict\n\n\n\nConsider someone who has a coca-cola addiction and drinks five cans of coke a day. What is their energy usage in this regard? On the assumption that the raw aluminium material phase dominates (production of metals is intensive), MacKay notes that one can needs about 0.6kWh of energy. Thus \\[\nE_\\text{coke} \\approx 5 \\times 0.6 \\, \\mathrm{kWh} = 3 \\, \\mathrm{kWh}\n\\] as the per day per person figure."
  },
  {
    "objectID": "part-02-energy/mackay-consumption.html#energy-usage-of-transportation",
    "href": "part-02-energy/mackay-consumption.html#energy-usage-of-transportation",
    "title": "7  Estimating consumption",
    "section": "7.4 Energy usage of transportation",
    "text": "7.4 Energy usage of transportation\n\n7.4.1 Cars\nMacKay uses some interesting back-of-the-envelope estimates here. First \\[\n\\text{energy per day} = \\frac{\\text{distance travelled per day}}{\\text{distance over unit of fuel}} \\times \\text{energy per unit of fuel}.\n\\]\nWe take about 50km travelled per day, and a typical family car is quoted as 12 km/L.\nIn order to estimate the energy per unit (L) of fuel, MacKay notes that automobile fuel is a hydrocarbon and so we can sensibly use butter as an estimate. A packet of butter informs that it contains a calorific value of about 3000 kJ per 100g. We have that 1 kJ is 1/3600 kWh, so this gives (5/6)*10 ~ 8 kWh per kg. To get energy density in terms of volume, we need to know the density of butter. Water has a density of about 1kg/L (nearly by definition). Since butter floats on water, we might take its density to be 0.9kg/L (this is very close). Together this gives an estimate of about 8*0.9 or 7 kWh/L.\nLooking it up in a random reference, though, gives that petrol has about 10kWh/L.\nThus altogether, this gives an estimate of \\[\n\\text{energy per day} = \\frac{50 \\mathrm{km}}{12 \\mathrm{km/L}} \\times 10 \\mathrm{kWh/L} \\approx 40 \\mathrm{kWh/day}\n\\] so the equivalent of leaving 40 lightbulbs on for an entire day."
  },
  {
    "objectID": "part-02-energy/mackay-consumption.html#in-depth",
    "href": "part-02-energy/mackay-consumption.html#in-depth",
    "title": "7  Estimating consumption",
    "section": "7.5 In-depth",
    "text": "7.5 In-depth\nMacKay provides a more in-depth calculation for car transport in the Appendix A.\nThe energy in a fossil-fuel car goes into four main categories.\n\nSpeeding-up and slowing down using the brakes;\nair resistance;\nrolling resistance;\nheat – about 75% of the energy is thrown away as heat\n\n\n7.5.1 Brakes\n\nAssume a car of mass \\(m_c\\) accelerates rapidly to a constant speed, \\(v\\), and maintains this speed for a distance \\(d\\), at which point the driver brakes rapidly to a stop.\nAssume that the kinetic energy is transferred into the brakes. We can estimate \\[\n\\text{Power in brakes} = \\frac{ \\text{kinetic energy}}{ \\text{time between braking events}} = \\frac{\\frac{1}{2}m_c v^2}{(d/v)} = \\frac{1}{2} \\frac{m_c v^3}{d}.\n\\]\n\n\n\n7.5.2 Air resistance\nDrag is the most important aerodynamic force in cars at highway speeds. In order to calculate the exact drag, we would essentially need to integrate forces around the car in a fluid dynamics model. However, drag is usually approximated by the force1, \\[\nF_d = \\frac{1}{2} \\rho C_D A_f v^2,\n\\] where \\(\\rho\\) is the density of air, \\(A_f\\) is the frontal cross-sectional area of the car, and \\(C_D\\) is the drag coefficient, a non-dimensional number that encodes all of the complicated fluid dynamics. Then we know that \\[\n\\text{Power in drag} = \\frac{ \\text{Force . distance}}{ \\text{time between braking}} =  \\frac{1}{2} \\rho C_D A_f v^3.\n\\]\n\n\n7.5.3 Ratio of brake power to drag power\nRecalling our discussion of non-dimensionalisation, we can form a non-dimensional number representing the ratio of the two above powers:\n\\[\n\\Pi = \\frac{\\text{Power in brakes}}{\\text{Power in drag}} = \\frac{m_c}{d(\\rho C_D A_f)}.\n\\] Verify that the units are sensible. Note that when \\(\\Pi > 1\\), then braking effects are more dominant, and if \\(\\Pi < 1\\), then drag effects are more dominant. In order to examine the threshold, set \\(\\Pi = 1\\) and solve for \\(d\\), \\[\nd_{\\text{crit}} = \\frac{m_c}{\\rho C_D A_f}.\n\\]\nWe use the following approximations: \\(m_c = 1000 kg\\), \\(\\rho = 1.3 kg/m^3\\), \\(C_D = 1/3\\), \\(A_f = 3 m^2\\). This gives a critical distance of \\[\nd_{ \\text{crit}} = 750m.\n\\] Therefore, when travelling more than about a 1km, much of your energy expenditure between these two items is largely going into drag, while for less than 1km, more energy is going into your brakes. In order to save energy, you can (i) drive more slowly; (ii) reduce the mass of your car; (iii) get better brakes (regenerative brakes); (iv) reduce your car’s drag coefficient or reduce its cross sectional area.\n\n\n7.5.4 Rolling resistance\nRolling resistance involves the energy consumed in the tyres and bearings of the car, the energy going into the noise of the wheels against the ground, the energy of grinding rubber off the tyres, the energy in the wheel vibrating the ground, etc. The standard model assumes that the rolling resistance force is \\[\nF = C_{rr} m_c g,\n\\] where car rubber tyres are given in MacKay’s book as having a coefficient \\(C_{rr} = 0.01\\). Again, we can compare the threshold where rolling resistance is equal to drag via \\[\nC_{rr} m_c g = \\frac{1}{2} \\rho C_D A_f v^2,\n\\] which gives a critical speed of \\[\nv = \\sqrt{2 \\frac{C_{rr} m_c g}{\\rho C_D A_f}} = 7m/s = 16 mi/hr.\n\\]\n\n\n7.5.5 Power\nNotice that we can then write the total power as \\[\nP = \\sigma \\left( \\mathcal{A} v + \\mathcal{C} v^3\\right),\n\\] where \\(\\sigma\\) is an efficiency parameter that indicates how efficiently chemical energy (petrol) is converted into mechanical energy via the engine and transmission. Much of this is initial energy is ‘lost’ to heat, and MacKay indicates that petrol engines are about 25% efficient. Thus we should set \\(\\sigma = 4\\). Above, note that \\(\\mathcal{A}\\) is then associated with the rolling resistance and \\(\\mathcal{C}\\) to the drag and braking.\nPreviously in Section 7.4.1, we estimated energy consumption of 80 kWh to drive 100km (note this did not take into account any dynamics, i.e. time); this was a straight approximation based on the energy of petrol.\nFrom the table below (most figures taken from MacKay but see the footnotes)\n\n\n\nQuantity\nApproximation\n\n\n\n\n\\(m_c\\)\n1000kg\n\n\n\\(v\\)\n110km/h = 31 m/s\n\n\n\\(d\\)\n10km\n\n\n\\(\\rho\\)\n1.3 kg/m^3\n\n\n\\(C_D A_f\\)2\n0.7 m^2\n\n\n\\(C_{rr}\\)\n0.01\n\n\n\nWe seem to get the following. \\[\\begin{align}\n\\text{Power}_{\\text{brakes}} &\\approx 1500 W \\approx 1.5 kW \\\\\n\\text{Power}_{\\text{air}} &\\approx   13,600 W = 13.6 kW  \\\\\n\\text{Power}_{\\text{rolling}} &\\approx 3000 W = 3 kW.\n\\end{align}\\]\nWe see that by far, the biggest contributor at such speeds is the drag. The above numbers should be multiplied by \\(\\sigma = 4\\). If we ignore all other effects and only consider drag, this gives about 54 kW of power. Hence driving for one hour this is 54 kWh, to be compared with our prior estimate of 80 kWh3.\n\n\n7.5.6 Conclusions and caveats\nSo there are a few interesting conclusions. One conclusion is nicely summarised by this graph, which you can often see in other references.\n\n\n\nFigure 7.1: Car fuel consumption (energy per distance) from p.259 of MacKay\n\n\nThe key, really, is that energy consumption is largely dominated by the cubic term in the power. MacKay, on p.258, compares the relative energetic consumption due to drag of a cyclist versus a car. If we assume their drag-area values are about the same (cyclists are less aerodynamic but occupy less area), a cyclist travelling at 20 km/h versus a car travelling at 100 km/h would have an energy ratio of \\[\n\\frac{\\text{Energy per distance of bike}}{\\text{Energy per distance of car}} \\approx \\left(\\frac{20 }{100}\\right)^2 = 0.04,\n\\] i.e. 4% of the energy consumption of a car.\nThere is one interesting caveat that would have been nice to see more discussion, but there is a commentary on p.260 of MacKay. It is conventional knowledge that cars have a ‘sweet spot’ for fuel consumption, which is often quoted as around the range of 40-60mph4.\n\n\n\nFigure 7.2: Car fuel efficiency versus the approximations developed above\n\n\nIt seems unclear how the above alternative shape is modeled via the back-of-the-envelope estimates. For instance, can be be modeled by considering an efficiency, \\(\\sigma = \\sigma(v)\\), the depends on speed?"
  },
  {
    "objectID": "part-02-energy/mackay-consumption.html#references",
    "href": "part-02-energy/mackay-consumption.html#references",
    "title": "7  Estimating consumption",
    "section": "7.6 References",
    "text": "7.6 References\nA good reference on the so-called road load equation\n\n\n\n\nMacKay, D. J. C. 2009. Sustainable Energy – Without the Hot Air. UIT Cambridge Ltd."
  },
  {
    "objectID": "part-xx-exercises/ps02.html#getting-started-with-jupyter",
    "href": "part-xx-exercises/ps02.html#getting-started-with-jupyter",
    "title": "28  Problem set 2",
    "section": "28.1 Getting started with Jupyter",
    "text": "28.1 Getting started with Jupyter\nGo online to the Jupyter hub at https://maths.jupyterhub.bath.ac.uk.\n\nNavigate to the welcome screen for MA30287 and follow the instructions in order to create your own local directory at /MA30287_workspace/\nNavigate to the workspace folder. Click New -> Notebook. If asked, select the kernel Python 3 (ipykernel).\nIn the first line of input, select, in toolbar Code -> Markdown. This allows you to annotate your notebook with Markdown-style text input.\nIn the first line of input, type # Problem set 2. Then either type Shift + Enter or press the play button which will execute the line(s) of input. Your markdown text should render as a nicely formatted entry.\nRename the file to something appropriate, like ps02_scripts. You can do this by right-clicking the filename in the file manager and selecting Rename.\nProceed to the next question."
  },
  {
    "objectID": "part-xx-exercises/ps02.html#sec-ps2-cubic",
    "href": "part-xx-exercises/ps02.html#sec-ps2-cubic",
    "title": "28  Problem set 2",
    "section": "28.2 Testing the solutions of a cubic",
    "text": "28.2 Testing the solutions of a cubic\nIn this question, you will develop the numerical solutions for the roots of the cubic equation: \\[\n\\epsilon x^3 + x - 1 = 0.\n\\]\nType the following code into your Jupyter notebook. This code uses a command, which you will learn in a later week, called fsolve, in order to solve nonlinear equations. When writing the below code, you may want to separate the import commands into their own input field in the notebook.\n\nimport numpy as np\nfrom scipy.optimize import fsolve\n\nep = 0.2        # epsilon value\nxguess = 1.1    # Initial guess of root\n\nf = lambda x: ep*x**3 + x - 1\nxsol = fsolve(f, xguess)\nprint(\"Solved root at x = \", xsol)\n\nSolved root at x =  [0.86883002]"
  },
  {
    "objectID": "part-xx-exercises/ps02.html#analysis-of-singular-cubic-equation",
    "href": "part-xx-exercises/ps02.html#analysis-of-singular-cubic-equation",
    "title": "28  Problem set 2",
    "section": "28.3 Analysis of singular cubic equation",
    "text": "28.3 Analysis of singular cubic equation\nConsider the cubic equation \\[\n\\epsilon x^3 + x - 1 = 0,\n\\] with \\(\\epsilon \\ll 1\\).\n\nDevelop the first three terms of an asymptotic expansion about the root by setting \\[\nx = x_0 + \\epsilon x_1 + \\epsilon^2 x_2 + \\ldots\n\\]\nFill out the following table.\n\n\n\n\\(\\epsilon\\)\n\\(x_{\\text{exact}}\\)\n\\(x_{\\text{exact}} - x_0\\)\n\n\n\n\n1.0\n–\n–\n\n\n0.9\n–\n–\n\n\n0.8\n–\n–\n\n\n…\n–\n–\n\n\n0.1\n–\n–\n\n\n\nUse your code in Section 28.2 to input numerical approximations to the above entries.\nCreate a graph by hand of the data (it does not have to be extremely accurate), as plotted in the \\((\\epsilon, x_{\\text{exact}} - x_0)\\)-plane. Fit a line to this graph and estimate the gradient. Is this consistent with what you derived above?\nBy rescaling \\(x\\) appropriately in terms of \\(\\epsilon\\), derive the first three terms of the asymptotic approximations of the remaining roots."
  },
  {
    "objectID": "part-xx-exercises/ps02.html#a-damped-projectile-problem",
    "href": "part-xx-exercises/ps02.html#a-damped-projectile-problem",
    "title": "28  Problem set 2",
    "section": "28.4 A damped projectile problem",
    "text": "28.4 A damped projectile problem\nIn Chapter 9 you performed the asymptotic analysis for a projectile. The small parameter was \\(\\epsilon\\) and represented \\(v_0^2/(gR_E)\\) (a parameter that includes the initial velocity, \\(v_0\\), gravity \\(g\\), and the radius of the Earth, \\(R_E\\).\nIf air resistance is included, then the non-dimensional toy model is instead \\[\n\\begin{gather}\n\\frac{\\mathrm{d}^2 y}{\\mathrm{d}t^2} = - \\frac{1}{(1 + \\epsilon y)^2} - \\frac{\\alpha}{(1 + \\epsilon y)} \\frac{\\mathrm{d}y}{\\mathrm{d}t}, \\\\\ny(0) = 0, \\\\\ny'(0) = 1.\n\\end{gather}\n\\tag{28.1}\\] where \\(\\alpha \\geq 0\\) is the parameter that controls air resistance.\n\nBegin by assuming that \\(\\alpha\\) is a fixed number and consider the limit where \\(\\epsilon \\ll 1\\). Find a two-term asymptotic expansion of the solution for small \\(\\epsilon\\).\nIs the effect of the air resistance to increase or decrease the flight time? Justify based on your analytical solution."
  },
  {
    "objectID": "part-xx-exercises/ps02.html#ode-solvers-and-eulers-method",
    "href": "part-xx-exercises/ps02.html#ode-solvers-and-eulers-method",
    "title": "28  Problem set 2",
    "section": "28.5 ODE solvers and Euler’s method",
    "text": "28.5 ODE solvers and Euler’s method\nReturn to the setup of the above question.\n\nModify the script developed in lecture 8 or alternatively copy-and-paste the script shown in Section 9.2 in order to solve (Equation 28.1) at a prescribed value of \\(\\epsilon\\) and \\(\\alpha\\).\nUsing a pocket calculator (or your phone calculator) apply Euler’s method with \\(\\Delta t = 0.2\\), \\(\\epsilon = 0.2\\), and \\(\\alpha = 1\\) to determine the position of the projectile at \\(t = 0.6\\).\nCompare your hand calculation with the result from the Python output, as well as with your asymptotic approximations."
  }
]