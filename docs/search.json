[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "MA30287: Mathematics of Planet Earth",
    "section": "",
    "text": "Preface\nWelcome to to the 2023-24 delivery of MA30287 Maths of Planet Earth at the University of Bath.\nHere is a picture that represents the course.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#lectures-and-office-hours",
    "href": "index.html#lectures-and-office-hours",
    "title": "MA30287: Mathematics of Planet Earth",
    "section": "Lectures and office hours",
    "text": "Lectures and office hours\nLectures take place at the following times and locations:\n\nTuesdays 9:15 in 6W 1.2\nWednesdays 11:15 in 6W 1.2\nThursdays 15:15 in 8W 3.22\n\nOffice hours: You will be able to find me for an office hour in 4W 2.18 on Thursdays (following the lecture). Typically it is best to set this up, beforehand, by email appointment.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#coursework-and-examinations",
    "href": "index.html#coursework-and-examinations",
    "title": "MA30287: Mathematics of Planet Earth",
    "section": "Coursework and examinations",
    "text": "Coursework and examinations\nYour final mark will be 25% coursework and 75% final exam.\nDetails of the coursework will be released in Week 7 and it will be due in Week 101.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#resources",
    "href": "index.html#resources",
    "title": "MA30287: Mathematics of Planet Earth",
    "section": "Resources",
    "text": "Resources\nIn general, you will have access to a few kinds of resources:\n\nThe Moodle portal will be the main organisation portal.\nLecture notes, coursework, and other resources will be found in an online format and will be linked on Moodle.\nCoding will be done via Noteable, accessed via the Moodle website.\n\nNaturally, because this is a relatively new module at Bath, there will be a fair amount of activity as we settle the material over the semester. Whenever we complete a lecture note (i.e. a ‘chapter’), we will use a box like this to indicate when the material was covered and in which lecture:\n\n\n\n\n\n\n2023-24 note\n\n\n\nThe material in this note was covered in Lecture XX.\n\n\nHopefully by the time the module ends, every relevant chapter will have such a note. This allows you to judge what material has been ‘finalised’.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#prerequisites",
    "href": "index.html#prerequisites",
    "title": "MA30287: Mathematics of Planet Earth",
    "section": "Prerequisites",
    "text": "Prerequisites\nThis course officially requires MA20221 (modeling and dynamical systems) or XX20231 (mathematical and statistical methods for the life sciences).\nIt is designed to be somewhat stand-alone in the sense that applied mathematical techniques learned in other courses will be introduced in some capacity. Such techniques will involve:\n\nSolutions of ordinary differential equations (MA10230 and MA20220).\nMultivariable calculus, partial differentiation, and multiple integrals (MA10230 and MA10236); some review/introduction of concepts from MA20223.\nDynamical systems, stability, phase planes (MA20221, MA30060).\nNumerical methods in Python (MA10276).\n\nWhenever possible, I have isolated such reviews/introductions and these can be found in the Mathematical methods section of these notes.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#resources-1",
    "href": "index.html#resources-1",
    "title": "MA30287: Mathematics of Planet Earth",
    "section": "Resources",
    "text": "Resources\nThis course is designed around the following sources:\n\nSustainable energy – without the hot air by (MacKay 2009)\nMathematics & Climate by (Kaper and Engler 2013)\nMathematical Geoscience by (Fowler 2011)\nA gentle introduction to numerical simulations with Python\n\n\n\n\n\nFowler, Andrew. 2011. Mathematical Geoscience. Vol. 36. Springer.\n\n\nKaper, Hans, and Hans Engler. 2013. Mathematics and Climate. SIAM.\n\n\nMacKay, D. J. C. 2009. Sustainable Energy – Without the Hot Air. UIT Cambridge Ltd.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#footnotes",
    "href": "index.html#footnotes",
    "title": "MA30287: Mathematics of Planet Earth",
    "section": "",
    "text": "Subject to confirmation.↩︎",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "part-01-intro/intro.html",
    "href": "part-01-intro/intro.html",
    "title": "Introduction",
    "section": "",
    "text": "Mathematics of Planet Earth seems like an incredibly broad description for a course, but perhaps in order to give a rough idea of what such a course might include, we can consider the following diagram, which illustrates different categories and subject areas that are involved in the modelling of a full Earth system.\n\n\n\n\n\n\nFigure 1: The many components of a full Earth System Model\n\n\n\nIt would be possible to spend a lifetime studying any one aspects of the above categories, and they span many different areas of study, including: (i) engineering (civil, fluids, mechanical, etc.); (ii) physics (geosciences, mechanics); (iii) Earth sciences; (iv) policy and health; and so forth and so on. As mathematicians, we also have a unique perspective, and applied mathematics plays important roles in many of the above categories.\nIn essence, this course will include topics and themes are united by aspects of mathematical modelling and mathematical analysis and this is what distinguishes our style of study from adjacent areas of science and social science.\nWe will study so-called conceptual or box models of the climate. This involves some of the blue elements of the above figure, and thus we use coarse-grained models of describing the climate. This will involve applying some of the dynamical systems (phase-plane analysis of ODEs) you have learned previously, along with new methods of computation and analysis. The source for this part of the course will be (Kaper and Engler 2013).\nA secondary part of this course will involve more in-depth analysis of the physical models that govern the blue elements of the above figure. This moves us from the toy box models studied above to digging into the underlying physics—this also falls into the category of Mathematical Geoscience. For example, we will use partial differential equations to study the atmosphere and develop a deeper understanding of greenhouse gases. The source for this part of the course will be (Fowler 2011).\n\n\n\n\nFowler, Andrew. 2011. Mathematical Geoscience. Vol. 36. Springer.\n\n\nKaper, Hans, and Hans Engler. 2013. Mathematics and Climate. SIAM.",
    "crumbs": [
      "Introduction"
    ]
  },
  {
    "objectID": "part-01-intro/intro-PDEs.html",
    "href": "part-01-intro/intro-PDEs.html",
    "title": "1  Conservation laws and consitutive laws",
    "section": "",
    "text": "In the first chapter of (Fowler 2011), there is a concise introduction to the different categories of techniques and approaches that you might use when doing mathematical modelling in the real world. Some of these ideas will be introduced to you in this course.\nHere, we provide a brief intro to the highlights, involving the use of conservation laws (and PDEs) and also the concept of non-dimensionalisation (which you would have encountered previously), studied in Chapter 2.\n\n\n\n\n\n\nVectors and PDEs\n\n\n\nVectors and PDEs is not a prerequisite for this course, but naturally in studying anything related to the physical real world, we must discuss partial differential equations. The hope is that the necessary theory for PDEs will be presented to you as this course evolves, so that it can appreciated by both newcomers and experienced readers.\n\n\nConservation laws can be expressed as mathematical equations that represent the idea that some quantity is conserved. In processes governing the planet, these might correspond to conservation of heat, of water, of air, of momentum, etc.\nIn Chapter 3, we will develop the simplest possible model governing the temperature on the surface of the Earth. It is a conservation equation for energy and is zero-dimensional (does not involve time and does not involve spatial variation).\nIn order to demonstrate some of the basic principles of this course, let us demonstrate the derivation of the heat equation. We are interested in modelling the heat in a volume, \\(V\\), which, for the sake of concreteness is given by a long cylinder with its axis along \\(x \\in [0, L]\\). We assume that the side walls of the cylinder are insulated and the temperature only varies along the \\(x\\) direction.\nAt any point along this rod, the internal heat is given by \\(\\rho c T(x, t)\\), where \\(\\rho\\) is the density of the material (kg/m3), \\(c\\) is the specific heat capacity (J/(kg K)), and \\(T\\) is the temperature (K). Therefore, the heat energy along any segment in the rod is calculated from\n\n\n\n\n\n\nInternal heat energy\n\n\n\n\\[\n\\text{heat energy in $[a, b]$} = \\int_a^b \\rho c T \\, \\mathrm{d}x.\n\\]\n\n\nIf the heat changes, then the rate of change of heat energy is given the time derivative of the above quantity. By conservation of energy, any change of the internal energy must be equal to the inflow or outflow of heat at the ends, \\(x = a\\) or \\(x = b\\). We therefore write \\(q\\) for the flux (or flow) of heat.\nWe need a constitutive law that dictates how energy is exchanged at the boundaries. Based on intuition, it is sensible to assume that the flow of heat proceeds from hot to cold. For example, hot air rises towards cool air; or heat from a hot mug of tea flows and diffuses outwards into a cold room. Therefore, we write this as\n\n\n\n\n\n\nFourier’s law\n\n\n\nFourier’s law in 1D specifies that the heat flux is given by \\[\nq(x, t) = -k \\frac{\\mathrm{\\partial}T}{\\mathrm{\\partial}x}.\n\\]\n\n\nThis is known as Fourier’s law. The quantity \\(k\\) is the thermal conductivity, and its units are W/(m K). Because a Watt is a Joule/s, you can also see that the units of \\(k\\) are J/(m K s). The quantity \\(q\\) is the flux, and you can verify that it is given in units of J/(m2 s).\nTherefore by energy conservation, we have \\[\n\\frac{\\mathrm{d}}{\\mathrm{d}t}  \\int_a^b \\rho c T \\, \\mathrm{d}x = q(x = b, t) - q(x = a, t),\n\\] i.e. the change in internal heat is equal to the flow through the ends. Substitution Fourier’s law, we can then write \\[\n\\int_a^b \\rho c \\frac{\\mathrm{\\partial}T}{\\mathrm{\\partial}t} \\, \\mathrm{d}x = \\int_a^b k \\frac{\\mathrm{\\partial}^2 T}{\\mathrm{\\partial}x^2} \\, \\mathrm{d}x.\n\\] We then argue that because the above needs to be true for all segments [a, b] within the rod, then it must be true everywhere. Therefore we are left with the classic heat equation.\n\n\n\n\n\n\nHeat equation\n\n\n\n\\[\n\\rho c\\frac{\\mathrm{\\partial}T}{\\mathrm{\\partial}t} = k \\frac{\\mathrm{\\partial}^2 T}{\\mathrm{\\partial}x^2}.\n\\tag{1.1}\\]\n\n\nIn order to produce a sensible physical solution, the above equation is typically supplemented by initial conditions and boundary conditions. An example might be\n\n\n\n\n\n\nInitial and boundary conditions\n\n\n\n\\[\n\\begin{gather}\nT(x, 0) = T_0 \\\\\nT(0, 0) = T_a \\\\\nT(L, 0) = T_b\n\\end{gather}\n\\]\n\n\nwhich expresses, respectively, that the temperature starts from a constant temperature, \\(T_0\\), and where the ends of the rod are kept at temperature \\(T_a\\) and \\(T_b\\). In courses like MA20223, you may have learned how to solve the above equation.\n\n\n\n\nFowler, Andrew. 2011. Mathematical Geoscience. Vol. 36. Springer.",
    "crumbs": [
      "Introduction",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Conservation laws and consitutive laws</span>"
    ]
  },
  {
    "objectID": "part-01-intro/intro-nondim.html",
    "href": "part-01-intro/intro-nondim.html",
    "title": "2  Dimensional scaling analysis",
    "section": "",
    "text": "2.1 Dimensional quantities\nEvery physical quantity, say Q, can be expressed as a product of a dimensional unit, denoted [Q], and a magnitude, say Q’. Thus we write \\[\nQ = Q'[Q]\n\\] For example, if \\(x\\) corresponds to the physical length in a problem, we might select \\([x] = \\mathrm{km}\\) or \\([x] = \\mathrm{yards}\\) or \\([x] = \\mathrm{m}\\). It is important to choose the dimensionalisation to suit the problem under consideration.",
    "crumbs": [
      "Introduction",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Dimensional scaling analysis</span>"
    ]
  },
  {
    "objectID": "part-01-intro/intro-nondim.html#dimensional-quantities",
    "href": "part-01-intro/intro-nondim.html#dimensional-quantities",
    "title": "2  Dimensional scaling analysis",
    "section": "",
    "text": "2.1.1 SI units\nThe International System (SI) of Base Units sets out a distinct selection of choices for dimensions in certain physical quantities. The seven fundamental dimensional units are\n\n[Length] = metre\n[Time] = seconds\n[Mass] = kilogram\n[Temperature] = Kelvin\n[Electric current] = ampere\n[Light intensity] = candela\n[Material quantity] = mole\n\nDimensional units that can be expressed in terms of other fundamental units are known as derived units. For example:\n\n[Speed] = metre/second\n[Acceleration] = metre/second2\n[Force] = kilogram . metre/second2",
    "crumbs": [
      "Introduction",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Dimensional scaling analysis</span>"
    ]
  },
  {
    "objectID": "part-01-intro/intro-nondim.html#dimensional-homogeneity-and-non-dimensionalisation",
    "href": "part-01-intro/intro-nondim.html#dimensional-homogeneity-and-non-dimensionalisation",
    "title": "2  Dimensional scaling analysis",
    "section": "2.2 Dimensional homogeneity and non-dimensionalisation",
    "text": "2.2 Dimensional homogeneity and non-dimensionalisation\nAll terms in any equation must have the same dimensions. This is the principle of dimensional homogenuity. For example, Newton’s second law expresses the fact that \\[\nF = m \\frac{\\mathrm{d}^2x}{\\mathrm{d}t^2}\n\\] We can check, then, that the units do indeed match up on either side. Here, the RHS has units of [m] [x]/[t]2 or in SI units, kg . metres / seconds2. This indeed matches our previous given SI unit decomposition for force.\nNotice in addition that the input to functions like \\(\\cos\\theta\\) and \\(e^z\\) must be non-dimensional (or dimensionless).\nThe process of nondimensionalisation is then as follows. Given an equation, we know that each term must have the same dimension. Therefore, we can scale all the dependent and independent variables by dimensional constants in order to yield a non-dimensional equation.\nWhy this is an important tool is demonstrated by the below.",
    "crumbs": [
      "Introduction",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Dimensional scaling analysis</span>"
    ]
  },
  {
    "objectID": "part-01-intro/intro-nondim.html#returning-to-the-heat-equation",
    "href": "part-01-intro/intro-nondim.html#returning-to-the-heat-equation",
    "title": "2  Dimensional scaling analysis",
    "section": "2.3 Returning to the heat equation",
    "text": "2.3 Returning to the heat equation\nExact units are not relevant for dynamics, and it is instead the ratio of units that we care about. To apply this principle, let us non-dimensionalise the equation Equation 1.1. We introduce typical scales for each of the variables. For example, we non-dimensionalise the temperature and distance by setting \\[\nT = T_0 T' \\quad \\text{and} \\quad x = L x',\n\\] where primes now denote non-dimensional quantities. Since it is not clear how to scale time, we set \\(t = [t] t;'\\) and choose the scale later. Substitution into the equation now yields \\[\\begin{gather}\n\\frac{\\rho c T_0}{[t]}\\frac{\\mathrm{\\partial}T'}{\\mathrm{\\partial}t'} = \\frac{kT_0}{L^2} \\frac{\\mathrm{\\partial}^2 T'}{\\mathrm{\\partial}x'^2}, \\\\\nT(x, 0) = 1 \\\\\nT(0, 0) = \\frac{T_a}{T_0}, \\\\\nT(L, 0) = \\frac{T_b}{T_0}.\n\\end{gather}\\]\nIt is useful to think of time in terms of velocity and distance. Let us then write \\[\n[t] = L/U,\n\\] where \\(U\\) is a typical velocity scale (which again, we shall specify later). Then note that the heat equation can be written as \\[\n\\frac{\\rho c}{(L/U)} \\frac{\\mathrm{\\partial}T'}{\\mathrm{\\partial}t'} = \\frac{k}{L^2}\\frac{\\mathrm{\\partial}^2 T'}{\\mathrm{\\partial}x'^2}.\n\\] We can move all the units to one side and then write \\[\n\\frac{\\mathrm{\\partial}T'}{\\mathrm{\\partial}t'} =\\text{Pe} \\frac{\\mathrm{\\partial}^2 T'}{\\mathrm{\\partial}x'^2}.\n\\tag{2.1}\\]\nWe can verify that the quantity \\[\n\\mathrm{Pe} =  \\frac{k/(\\rho c L^2)}{U/L} = \\frac{\\text{diffusive timescale}}{\\text{advective timescale}}.\n\\] known as the Peclet number is entirely non-dimensional. This number essentially charactises the balance between diffusive effects (which causes heat to spread out) versus advective effects (the transport of the heat). In the case of our problem, there is no obvious source of advection. Another way to see this is that the temporal or velocity scale is entirely free for us to select.\nWe can now choose the temporal scale so as to simplify the equation. Let us choose \\[\n[t] = \\frac{L}{U} = \\frac{\\rho c L^2}{k}.\n\\tag{2.2}\\]\nNow the system simplifies. We can now write \\[\n\\begin{gather}\n\\frac{\\mathrm{\\partial}T'}{\\mathrm{\\partial}t'} = \\frac{\\mathrm{\\partial}^2 T'}{\\mathrm{\\partial}x'^2} \\\\\nT'(x', 0) = 1 \\\\\nT'(0, 0) = A, \\\\\nT'(1, 0) = B.\n\\end{gather}\n\\tag{2.3}\\]\nWe have gone from a system where we needed to consider six parameters to one where we only need to specify two (essentially, the ratio of the initial heat to the boundary values). Imagine you are an engineer at a thermal company, and asked to study the different possible configurations of heat in the above setup. If you were to blindly perform numerical computations, you would have had to set specific values for each of the six parameters.\nInstead, some mathematical analysis has demonstrated that the six-dimensional space of parameters can be simplified to a two-dimensional one—this is an enormous simplification.\nYour analysis has further identified the key non-dimensional parameter that appears in Equation 2.1. This demonstrates that it is not the individual values of \\(k\\), \\(\\rho\\), \\(c\\), … that matter, but rather their specific combination in the form of the Peclet number.\n\n\n\n\n\n\n\n\n\nFowler, Andrew. 2011. Mathematical Geoscience. Vol. 36. Springer.",
    "crumbs": [
      "Introduction",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Dimensional scaling analysis</span>"
    ]
  },
  {
    "objectID": "part-01-intro/basic-energy-model.html",
    "href": "part-01-intro/basic-energy-model.html",
    "title": "3  Basic energy models",
    "section": "",
    "text": "3.1 The basic energy model\nThe basic model is derived as follows.\nNote that the primary components of the global energy balance are radiative fluxes: we receive short-wave radiation (UV and visible light) from the Sun, and emit longwave radiation (infra-red) to space.\nFirst we consider incoming energy.\nNext we consider outgoing energy.\nNow combining the above equations, we have \\[\nE_{\\mathrm{in}} - E_{\\mathrm{out}} = \\pi R^2 Q (1 - a) - 4\\pi R^2 \\sigma \\gamma T^4,\n\\tag{3.5}\\] which gives the incoming energy per unit time.\nPutting in (Equation 3.5) and taking the limit of \\(\\Delta t \\to 0\\), we finally have a heat equation for the Earth’s temperature.\nThe above equation Equation 3.7 is time-dependent, but we may consider that the surface temperature, either over long-time or in an averaged sense, is dictated by the steady-state (time-independent) solution. Setting \\(\\mathrm{d}T/\\mathrm{d}t\\) to zero, we see that there is a unique steady-state given by \\[\nT = \\left(\\frac{Q(1-a)}{4\\sigma\\gamma}\\right)^{1/4}.\n\\]\nIf we take \\(Q \\approx 1370 \\,\\mathrm{W m}^{-2}\\), \\(a \\approx 0.3\\), \\(\\sigma \\approx 5.67 \\times 10^{-8} \\mathrm{W} \\,\\mathrm{m}^{-2} \\mathrm{K}^{-4}\\), we then get \\[\nT \\approx 255 \\mathrm{K} = -18^\\circ \\mathrm{C}.\n\\] under the assumption that \\(\\gamma = 1\\). That’s pretty cold! The actual average temperature is around \\(288 \\mathrm{K} \\approx 15 ^\\circ \\mathrm{C}\\).\nThe above back-of-the-envelope calculation seems to suggest that the parameter \\(\\gamma &lt; 1\\) plays an important role in keeping the Earth warm enough for us to live on, and indeed the value of \\(\\gamma\\) inferred by the above is roughly \\(\\gamma \\approx 0.61\\). Later on in the course, we will develop a more rigorous model to predict such a \\(\\gamma\\) by studying the properties of the atmosphere.",
    "crumbs": [
      "Introduction",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Basic energy models</span>"
    ]
  },
  {
    "objectID": "part-01-intro/basic-energy-model.html#the-basic-energy-model",
    "href": "part-01-intro/basic-energy-model.html#the-basic-energy-model",
    "title": "3  Basic energy models",
    "section": "",
    "text": "By considering the incoming radiation from the sun, obtain an estimate for the incoming energy, \\(E_{\\text{in}}\\).\nUse a constitutive law that indicates how much outgoing energy is produced by an object heated to some temperature.\nEquate the change in internal energy to be equal to the difference between the above two items.\n\n\n\n\n\n\n\n\nFigure 3.1: Radiation in the atmosphere\n\n\n\n\n\n\n\n\n\n\nEnergy from the Sun\n\n\n\nFirst, note that the shortwave radiation (UV and radiation) recieved from the sun is \\(Q \\approx 1370 \\text{ W$\\cdot$m$^{-2}$}\\) (which we consider measured at a point near the planet).\nIf we consider only that radiation that is absorbed into the Earth, we have \\[\nE_{\\mathrm{in}} = \\pi R^2 Q (1 - a),\n\\tag{3.2}\\] where \\(R\\) is the Earth’s radius.\nIn the above formula, we have multiplied the flux, \\(Q\\), with the visible surface area, \\(\\pi R^2\\). There is an additional multiplication by \\((1 - a)\\) where \\(a\\) is the planetary albedo, which characterises amount of energy reflected due to the surface properties. Light surfaces like snow will have high albedo, \\(a \\approx 0.9\\), while darker surfaces like the ocean have smaller albedo, \\(a \\approx 0.3\\). The global average albedo is \\(a \\approx 0.3\\).\n\n\n\n\n\n\n\n\n\nEnergy from the Earth\n\n\n\nWe now wish to characterise the energy, \\(E_{out}\\), and in the case of Earth, this will correspond to longwave radiation (infra-red) emitted into space. All bodies characterised by a temperature, say \\(T_e\\), will emit radiation, \\(Q_e\\). As a model, we can consider \\(Q_e\\) to be given by the Stefan-Boltzmann law, which states that \\[\nQ_e = \\sigma T_e^4,\n\\tag{3.3}\\] where \\(\\sigma \\approx 5.67 \\times 10^{-8} W m^{-2} K^{-4}\\) is the Stefan-Boltzmann constant.\nNow although the Earth’s surface may emit radiation according to (Equation 3.3), some of this radiation will be absorbed by the atmosphere and reflected back. This is the greenhouse effect. As a consequence of the greenhouse gas, the surface temperature of the Earth, \\(T\\), will be larger than the effective emitting temperature, \\(T_e\\). For the moment, we model this as \\[\nT_e = \\gamma^{1/4} T_e,\n\\tag{3.4}\\] where \\(\\gamma &lt; 1\\) is a greenhouse gas factor, which depends on the properties of the atmosphere.\n\n\n\n\n\n\n\n\n\nInternal heat energy\n\n\n\nDue to this incoming energy, the Earth will cool or heat in response. We need to know how the internal temperature of an object responds to an input in energy. The general formula is \\[\n\\text{Internal heat energy} = \\text{volume} \\times (\\rho c_p) \\times T.\n\\] The key quantity is the experimentally determined, \\(c_p\\), which corresponds to the specific heat capacity. It is given in the SI units of \\(\\mathrm{J} \\cdot \\mathrm{kg}^{-1} \\cdot \\mathrm{K}^{-1}\\), i.e. energy per unit mass per unit temperature. Note that this applied to a shell around the planet of thickness \\(d\\) in the atmosphere, and so the mass is given by \\[\n\\text{mass} = (4 \\pi R^2) d \\rho\n\\tag{3.6}\\] where \\(\\rho\\) is the average density of the atmosphere. Let us imagine the increase in temperature, \\(\\Delta T\\),during an interval of time, \\(\\Delta t\\). You can now verify that \\[\n\\Bigl[ (4 \\pi R^2) d \\rho \\Bigr] c_p (\\Delta T)\n\\] returns the units of Joules—i.e. this is the internal energy produced during the time \\(\\Delta t\\). We then have \\[\n\\Bigl[ (4 \\pi R^2) d \\rho \\Bigr] c_p \\Delta T =  \\Delta t (E_{in} - E_{out}).\n\\]\n\n\n\n\n\n\n\n\n\nZero-dimensional model for the surface temperature of the Earth\n\n\n\nThe Earth’s temperature, as measured on a layer of thickness \\(d\\) at the troposphere is given by the following ordinary differential equation (ODE) for \\(T = T(t)\\): \\[\nC \\frac{\\mathrm{d}T}{\\mathrm{d}t} = \\frac{1}{4} Q(1 - a) - \\sigma \\gamma T^4,\n\\tag{3.7}\\] where we have defined \\[\nC = \\rho c_p d\n\\] as the heat capacity of the atmosphere. Above, the solar flux, Q is often taken to be \\(Q = 1370\\) W/m2, \\(\\sigma = 5.67 \\times 10^{-8}\\) W/(m2K4), and \\(\\gamma \\leq 1\\) is the greenhouse gas factor.",
    "crumbs": [
      "Introduction",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Basic energy models</span>"
    ]
  },
  {
    "objectID": "part-01-intro/basic-energy-model.html#the-history-of-global-warming",
    "href": "part-01-intro/basic-energy-model.html#the-history-of-global-warming",
    "title": "3  Basic energy models",
    "section": "3.2 The history of global warming",
    "text": "3.2 The history of global warming\nThe history of global warming (and hence the estimation of \\(\\gamma\\)) is convoluted, but the origins can be considered as far back as the work of (Fourier 1827) and (Pouillet 1838), and is discussed in the work by (Van der Veen 2000).\n\n\n\n\n\n\nFigure 3.2: An illustration of Fourier’s glass box\n\n\n\n\n\n\n\nFourier, Joseph. 1827. “Mémoire Sur Les Températures Du Globe Terrestre Et Des Espaces Planétaires.” Mémoires de l’Académie Royale Des Sciences de l’Institut de France 7: 570–604.\n\n\nPouillet, Claude Servais Mathias. 1838. “Memoire Sur Le Chaleur Solaire.” Paris.\n\n\nVan der Veen, CJ. 2000. “Fourier and the ‘Greenhouse Effect’.” Polar Geography 24 (2): 132–52.",
    "crumbs": [
      "Introduction",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Basic energy models</span>"
    ]
  },
  {
    "objectID": "part-01-intro/problemclass01.html",
    "href": "part-01-intro/problemclass01.html",
    "title": "4  Problem class 1",
    "section": "",
    "text": "4.1 Projectile motion\nA projectile of mass \\(M\\) (in kg) is launched vertically with initial velocity \\(V_0\\) (in m/s) from a position \\(Y_0\\) (in m) above the surface. Thus the mass’s position, \\(Y(t)\\) is governed by Newton’s second law (applied to the mass and the mass of the Earth) and the set of equations \\[\\begin{gather}\nM Y_{tt} = - \\frac{g R_E^2 M}{(R_E + Y)^2}, \\\\\nY(0) = Y_0,\n\\end{gather}\\] where \\(g = 9.81 m/s^2\\) and \\(R_E = 6.4 \\times 10^6 m\\) is the radius of the Earth.",
    "crumbs": [
      "Introduction",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Problem class 1</span>"
    ]
  },
  {
    "objectID": "part-01-intro/problemclass01.html#projectile-motion",
    "href": "part-01-intro/problemclass01.html#projectile-motion",
    "title": "4  Problem class 1",
    "section": "",
    "text": "Non-dimensionalise the equation using arbitary length and time scales.\nIdentify the non-dimensional constants, \\(\\Pi_i\\).\nChoose a length scale of \\(L = Y_0\\) and time scale of \\(T = (L/g)^{1/2}\\). Discuss the resultant equation and the interpretation of choosing these scales.\nDoes your above choice allow you to easily study the limit of \\(R_E \\to \\infty\\)? If the limit can be taken, reduce the governing system to a simpler equation.\nDoes your choice in 3. allow you to easily study the limit of \\(Y_0 \\to 0\\)? If not, choose an alternative choice of length and time scales and in that case, reduce the set of equations.",
    "crumbs": [
      "Introduction",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Problem class 1</span>"
    ]
  },
  {
    "objectID": "part-01-intro/problemclass01.html#terminal-velocity",
    "href": "part-01-intro/problemclass01.html#terminal-velocity",
    "title": "4  Problem class 1",
    "section": "4.2 Terminal velocity",
    "text": "4.2 Terminal velocity\nA ball of radius \\(R\\) (in m) and uniform density \\(\\rho\\) (in kg/m3) falls in a viscous fluid. The fluid has density \\(\\rho_f\\) (in kg/m3) and viscosity (a measure of friction or resistance) \\(\\mu\\) (in kg/(m s)). The equation that governs the velocity is \\[\\begin{gather}\n\\frac{4}{3} \\pi R^3 \\rho \\frac{\\mathrm{d}V}{\\mathrm{d}t} = \\frac{4}{3} \\pi R^3 (\\rho - \\rho_f) g - 6\\pi \\mu R V, \\\\\nV(0) = V_0.\n\\end{gather}\\]\n\nChoose appropriate velocity and time scales to non-dimensionalise the equation so as to leave only a single non-dimensional number on the drag term (the last term on the right hand-side).\nDefine the non-dimensional parameter expressing a ratio between drag force and gravity force by the Stokes number (St) and confirm that it is \\[\nSt = \\frac{9\\mu V_0}{2(\\rho - \\rho_f) g R^3}.\n\\]\nComment on the two limits of \\(St \\to 0\\) and \\(St \\to \\infty\\). Can the problem be reduced in these two limits? If so, reduce and solve.",
    "crumbs": [
      "Introduction",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Problem class 1</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/techniques.html",
    "href": "part-05-techniques/techniques.html",
    "title": "Practical applied mathematics",
    "section": "",
    "text": "As we go deeper into formulating the equations that model or govern aspects of Planet Earth, we will quickly come to the realisation that many such equations, even for the simplest minimal models, are not exactly solvable.\nFor example, in 11  Stommel’s box model we develop the following “simple” model for the temperature in the ocean: \\[\\begin{align}\n\\frac{\\mathrm{d}x}{\\mathrm{d}t} &= \\delta(1 - x) - |f(x, y)|x, \\\\\n\\frac{\\mathrm{d}y}{\\mathrm{d}t} &= 1 - y - |f(x, y)|y,\n\\end{align}\\] where we have introduced the function, \\[\nf(x, y; R, \\lambda) = \\frac{1}{\\lambda}(Rx - y),\n\\]\nThis is quite a difficult problem! This is essentially a set of two nonlinear differential equations for two unknowns and three parameters. What kind of practical applied mathematics can we apply to study such problems?\nThe intention of this part is to introduce (and in some cases, review) three key concepts:\n\nAsymptotic approximations.\nNumerical solutions of differential equations.\nNumerical solutions of nonlinear equations (Newton’s method).",
    "crumbs": [
      "Practical applied mathematics"
    ]
  },
  {
    "objectID": "part-05-techniques/asymptotics01.html",
    "href": "part-05-techniques/asymptotics01.html",
    "title": "5  Asymptotic approximations",
    "section": "",
    "text": "5.1 A simple quadratic\nIf \\(\\epsilon = 0\\), then \\(x = 1\\). Moreover, if we substitute \\(x = 1\\) into the equation, then we see that the error is small and proportional to \\(\\epsilon\\). It is natural to seek an approximation in powers of \\(\\epsilon\\). We call this an . We write \\[\nx = x_0 + \\epsilon x_1 + \\epsilon^2 x_2 + \\ldots\n\\] Substitution into the equation yields \\[\n\\epsilon \\Bigl(x_0 + \\epsilon x_1 + \\epsilon^2 x_2 + \\ldots\\Bigr)^2 + \\Bigl( x_0 + \\epsilon x_1 + \\epsilon^2 x_2 + \\ldots \\Bigr) - 1 = 0.\n\\] Expand and collect terms in powers of \\(\\epsilon\\): \\[\n\\Bigl( x_0 - 1 \\Bigr) + \\epsilon\\Bigl(x_1 + x_0^2\\Bigr) + \\epsilon^2\\Bigl(x_2 + 2 x_0 x_1\\Bigr) + \\ldots = 0.\n\\] Now we equate coefficients at each order in \\(\\epsilon\\). This gives \\[\\begin{align}\nx_0 - 1 &= 0 \\Longrightarrow x_0 = 1 \\\\\nx_1 + x_0^2 &= 0 \\Longrightarrow x_1 = -1 \\\\\nx_2 + 2 x_0 x_1 &= 0 \\Longrightarrow x_2 = 2\n\\end{align}\\] We therefore have obtained the three-term approximation, \\[\nx = 1 - \\epsilon + 2\\epsilon^2 + \\ldots\n\\] Clearly we could continue this process ad infinitum obtaining increasingly accurate approximations to one of the roots.",
    "crumbs": [
      "Practical applied mathematics",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Asymptotic approximations</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/asymptotics01.html#a-simple-quadratic",
    "href": "part-05-techniques/asymptotics01.html#a-simple-quadratic",
    "title": "5  Asymptotic approximations",
    "section": "",
    "text": "A singular quadratic\n\n\n\nConsider the solution of \\[\n\\epsilon x^2 + x - 1 = 0,\n\\tag{5.1}\\] where \\(\\epsilon\\) is a fixed and very small positive number, say \\(0.000001\\). Forget that we know how to solve a quadratic equation: is it possible to develop a systematic approximation method?\n\n\n\n\n5.1.1 The singular root\nBut where has the other quadratic root gone?\nThe problem is that in considering \\(\\epsilon\\) to be small, we began by ignoring the leading term, \\(\\epsilon x^2\\). We effectively assumed that the equation was primarily balanced by setting the \\(x\\) term with the \\(-1\\) term, and the sum of the two terms approximately equalling zero.\nBut if \\(|x|\\) is large, then clearly our assumption that \\(\\epsilon x^2\\) being small may not be necessarily true for it depends on how large \\(|x|\\) is compared to \\(\\epsilon\\). Note that if \\(|x|\\) is large, then necessarily the last term, \\(-1\\), is negligible in comparison. Therefore, in order for \\(\\epsilon x^2\\) to balance \\(x\\), we see that \\(|x|\\) must be of size \\(1/\\epsilon\\).\nTherefore this suggests that we should re-scale our solution as follows \\[\nx = \\frac{X}{\\epsilon}.\n\\]\nSubstitution into the original quadratic now yields \\[\nX^2 + X - \\epsilon = 0.\n\\] Now notice that \\(\\epsilon = 0\\) expresses the correct balance in order to detect that missing root. Again we write \\[\nX = X_0 + \\epsilon X_1 + \\epsilon^2 X_2 + \\ldots\n\\] and attempt to solve order by order. Substitution into the equation yields \\[\n\\Bigl(X_0 + \\epsilon X_1 + \\epsilon^2 X_2 + \\ldots\\Bigr)^2 + \\Bigl(X_0 + \\epsilon X_1 + \\epsilon^2 X_2 + \\ldots\\Bigr) - \\epsilon = 0.\n\\] Expand and collect orders of \\(\\epsilon\\): \\[\\begin{align}\nX_0^2 + X_0 &= 0 \\Longrightarrow X_0 = -1 \\\\\n2X_0 X_1 + X_1 -1 &= 0 \\Longrightarrow X_0 = -1,\n\\end{align}\\] and thus to two orders, we have \\[\nX = -1 - \\epsilon + \\ldots \\Longrightarrow x = - \\frac{1}{\\epsilon} - 1 + \\ldots\n\\]\nOf course, we have used a very simple example (a solvable quadratic) to illustrate the idea of asymptotic approximations, but you should hopefully see that this method is extensible to much more complicated equations.\n\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nep = np.linspace(1,0.1, 20)\nroot1 = (-1 + np.sqrt(1-4*ep*(-1)))/(2*ep)\nroot2 = (-1 - np.sqrt(1-4*ep*(-1)))/(2*ep)\nasym1 = 1 - ep\nasym2 = -1/ep - 1\nplt.plot(ep, root1, 'o')\nplt.plot(ep, root2, 'o')\nplt.plot(ep, asym1, '-')\nplt.plot(ep, asym2, '-')\nplt.legend(['$x_1$', '$x_2$', '2-term asymp.', '2-term asym'])\nplt.xlabel('$\\epsilon$')\nplt.ylabel('x');",
    "crumbs": [
      "Practical applied mathematics",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Asymptotic approximations</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/asymptotics01.html#order-notation-and-the-tilde-sign-for-asymptotic",
    "href": "part-05-techniques/asymptotics01.html#order-notation-and-the-tilde-sign-for-asymptotic",
    "title": "5  Asymptotic approximations",
    "section": "5.2 Order notation and the tilde sign for asymptotic",
    "text": "5.2 Order notation and the tilde sign for asymptotic\nWe define precisely what we mean when we say that two functions, say \\(f\\) and \\(g\\), exhibit the same behaviour in some limit, say \\(\\epsilon \\to 0\\) or \\(x \\to x_0\\) or \\(x \\to \\infty\\) and so forth. For instance, we claim that the graphs of \\(\\sin(x)\\) and \\(x\\) look very similar as \\(x \\to 0\\). Thus we might write \\[\n    \\sin(x) \\sim x \\quad \\text{as $x \\to 0$}.\n\\tag{5.2}\\] This notion of allows us to specify functional behaviours at a deeper level than just limits. As you can see, it is not as useful to specify that \\[\n\\lim_{x \\to 0} \\sin{x} = \\lim_{x\\to 0} x.\n\\] In contrast, (Equation 5.2) is much more prescriptive about the way that the functions are approaching the limit.\n\n\n\n\n\n\nDefinition of \\(\\sim\\), \\(\\gg\\), and \\(\\ll\\)\n\n\n\nFirst, the notation \\[\nf(x) \\ll g(x), \\qquad x \\to x_0,\n\\] is read as “\\(f(x)\\) is much smaller than \\(g(x)\\) as \\(x \\to x_0\\)” and means \\[\n\\lim_{x\\to x_0} \\frac{f(x)}{g(x)} = 0.  \n\\] We may analogously use \\(g(x) \\gg f(x)\\) for “much greater than”.\nSecond, the notation \\[\nf(x) \\sim g(x), \\qquad x \\to x_0,\n\\] is read as “\\(f(x)\\) is asymptotic to \\(g(x)\\) as \\(x \\to x_0\\)”, and means that the error between \\(f\\) and \\(g\\) tends to zero as \\(x \\to x_0\\), or \\[\n\\lim_{x\\to x_0} \\frac{f(x)}{g(x)} = 1.  \n\\] We will often say “\\(f\\) is like \\(g\\)” or “\\(f\\) behaves like \\(g\\)”,\n\n\nHere are some examples.\n\n\n\n\n\n\nExamples\n\n\n\n\n\\(\\sin x \\sim x \\sim \\tan x\\) as \\(x \\to 0\\)\n\\(x^2 + x + 1 \\sim \\dfrac{x^3 + \\sin x}{1 + x}\\) as \\(x \\to \\infty\\)\n\\(\\sin x \\ll \\cos x\\) as \\(x \\to 0\\)\n\n\n\nIn the examination of limiting processes, often the main issue of consideration is the relative sizes of quantities defined according to their powers. For example, if \\(x\\) is a very small number, with \\(x = 10^{-5}\\), then \\(x^5\\) is much smaller than \\(x\\) (in terms of our notation, \\(x^5 \\ll x\\) as \\(x \\to 0\\)). On the other hand, we might not care so much about the difference between \\[\nx^5 \\quad \\text{vs.} \\quad 5 x^5\n\\] The point is that the of \\(x^5\\) and \\(5 x^5\\) is the same as \\(x \\to 0\\). The “Big-Oh” notation formalises this distinction.\n\n\n\n\n\n\nDefinition of Big-Oh\n\n\n\nWe write \\(f = O(g)\\) as \\(x \\to x_0\\) to mean that there exists constants \\(K &gt; 0\\) and \\(x^* &gt; 0\\) such that \\[\n|f| &lt; K |g| \\quad \\text{for all $|x - x_0| &lt; x^*$}.\n\\]\n\n\nIn practice, the use of the order symbol is very natural and you will not need to work with the technical definition. For example, when you derive the terms of the Maclaurin/Taylor series, you are naturally clustering all the terms of the same order (power) together. For us, the \\(O\\) symbol provides a very convenient way of separating terms of different sizes.\n\n\n\n\n\n\nExamples\n\n\n\n\n\\(2\\sin x = O(\\tan x)\\) as \\(x \\to 0\\)\n\\(x^2 + x + 1 = O\\left(\\dfrac{5x^3 + \\sin x}{1 + x}\\right)\\) as \\(x \\to \\infty\\)\n\n\n\nLet us return to the case of the quadratic example (Equation 5.1). Using the O notation, we can write \\[\nx =\n\\begin{cases}\n1 - \\epsilon + 2 \\epsilon^2 + O(\\epsilon^3) \\\\\n-\\frac{1}{\\epsilon} - 1 + O(\\epsilon^2)\n\\end{cases}\n\\] for the two roots. Alternatively, we can truncate the expansions and simply using the \\(\\sim\\) symbol: \\[\nx \\sim\n\\begin{cases}\n1 - \\epsilon  \\\\\n-\\frac{1}{\\epsilon} - 1\n\\end{cases}\n\\]",
    "crumbs": [
      "Practical applied mathematics",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Asymptotic approximations</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/asymptotics02.html",
    "href": "part-05-techniques/asymptotics02.html",
    "title": "6  Asymptotic approximations of ODEs",
    "section": "",
    "text": "6.1 Returning to the projectile problem\nIn Chapter 4 and Chapter 12 you studied the non-dimensionalisation of the projectile problem. Once re-scaled, it takes the following form: \\[\n\\begin{align}  \n\\frac{\\mathrm{d}^2 y}{\\mathrm{d}t^2} &= -\\frac{1}{(1 + \\epsilon y)^2}, \\qquad t &gt; 0 \\\\\ny(0) &= 0, \\\\\ny'(0) &= 1.\n\\end{align}\n\\tag{6.1}\\] This is a difficult problem without, in fact, any explicit solutions. However, we can estimate the solution in the limit \\(\\epsilon \\to 0\\). We expand the solution as \\[\ny(t) = y_0(t) + \\epsilon y_1(t) + \\epsilon^2 y_2(t) + \\ldots\n\\] In order to expand the denominator, you can use Taylor’s theorem to expand the function \\[\nf(x) = (1 + x)^\\alpha = f(0) + f'(0)x + \\ldots = 1 + \\alpha x + \\ldots\n\\] around \\(x = 0\\).\nThe differential equation now yields \\[\ny_0'' + \\epsilon y_1'' + \\epsilon^2 y_2'' + \\ldots = -\\left[1 - 2\\epsilon \\left(y_0 + \\epsilon y_1 + \\ldots\\right) + \\ldots \\right]\n\\] so grouping terms together order-by-order yields \\[\n\\Bigl[ y_0'' + 1 \\Bigr] + \\epsilon \\Bigl[ y_1'' - 2y_0\\Bigr] + \\ldots = 0.\n\\]\nWe can similarly substitute the expansion into the initial conditions. Altogether, at leading order, we obtain the following system to solve: \\[\\begin{align}\ny_0'' + 1 &= 0, \\\\\ny_0(0) &= 0, \\\\\ny_0'(0) &= 1.\n\\end{align}\\] Integrating twice and applying the boundary conditions gives us \\[\ny_0(t) = -\\frac{1}{2}t^2 + t.\n\\] In fact, this is simply the parabolic motion you would expect from school Physics. The \\(\\epsilon = 0\\) solution corresponds to assuming that the mass at the centre of the planet is dominant and then acceleration is constant.\nHowever, we can now proceed to higher order and examine the nonlinear effects. Proceeding to \\(O(\\epsilon)\\), we have the following system to solve: \\[\\begin{align}\ny_1'' &= 2y_0, \\\\\ny_1(0) &= 0, \\\\\ny_1'(0) &= 0.\n\\end{align}\\] Notice the boundary conditions come from the fact there are no \\(\\epsilon\\) corrections in the original boundary conditions, so \\(y_n(0) = y_n'(0) = 0\\) for all \\(n &gt; 0\\). Again this system is simple to integrate. Integrating the solution for \\(y_0\\) twice and substitution of the initial conditions yields \\[\ny_1(t) = -\\frac{1}{12}t^4 + \\frac{1}{3}t^3.\n\\] We have thus solved for the asymptotic approximation to two orders. We have \\[\ny(t) \\sim \\Bigl[ -\\frac{1}{2}t^2 + t\\Bigr] + \\epsilon \\Bigl[ -\\frac{1}{12}t^4 + \\frac{1}{3}t^3\\Bigr].\n\\] This was quite an accomplishment! We have taken a problem that was not easily solvable in explicit form and through fairly simple integrations, obtained an approximation to two orders in \\(\\epsilon\\). How good is it? Let us solve the problem numerically and compare with the asymptotic approximation.",
    "crumbs": [
      "Practical applied mathematics",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Asymptotic approximations of ODEs</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/asymptotics02.html#sec-asym2-num",
    "href": "part-05-techniques/asymptotics02.html#sec-asym2-num",
    "title": "6  Asymptotic approximations of ODEs",
    "section": "6.2 Numerical solutions of IVPs",
    "text": "6.2 Numerical solutions of IVPs\nWe first demonstrate how to solve ODEs (initial-value-problems, IVPs) using black-box functions in Python. For starters, most numerical formulations for ODEs will require that the problem be posed in terms of a first-order system of equations. To convert (Equation 6.1) into such a form, create a set of unknowns for the derivatives. Set \\[\n\\mathbf{Y}(t) =\n\\begin{pmatrix}\ny_1(t) \\\\\ny_2(t)\n\\end{pmatrix}\n= \\begin{pmatrix}\ny(t) \\\\\ny'(t)\n\\end{pmatrix}\n\\]\nThen we have the following first-order system: \\[\n\\begin{align}\n\\mathbf{Y}'(t) &= \\mathbf{F}(t, \\mathbf{Y}(t)) = \\begin{pmatrix}\ny_1' \\\\\n- \\frac{1}{(1 + \\epsilon y_1)^2}\n\\end{pmatrix} \\\\\n\\mathbf{Y}(0) &= \\begin{pmatrix}\n0 \\\\\n1\n\\end{pmatrix}\n\\end{align}\n\\tag{6.2}\\]\nYou can find a little guide on using solve_ivp in Python here. Here is the Python code to solve the differential equation.\n\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom scipy.integrate import solve_ivp\n\nep = 0.2 # epsilon value\ntmax = 2 # max time\nt = np.linspace(0, tmax, 100) # mesh used for plotting\n\n# Define function for the ODE\ndef f(t, Y):\n    ep = 0.2\n    y, yp = Y\n    ypp = -1/(1 + ep*y)**2\n    return [yp, ypp]\n\n# define the initial condition\nY0 = [0, 1]\n\nsol = solve_ivp(f, [0, tmax], Y0, dense_output=True)\n\n# Prior to plotting, re-interpolate solution on a fine grid\nyy = sol.sol(t)\n# Asymptotic solutions\ny0 = -1/2*t**2 + t\ny1 = -1/12*t**4 + 1/3*t**3\n\n# Plot it all\nplt.plot(t, yy[0,])\nplt.plot(t, y0, '--')\nplt.plot(t, y0 + ep*y1, '--')\nplt.xlabel('t')\nplt.ylabel('y(t)')\n\nText(0, 0.5, 'y(t)')\n\n\n\n\n\n\n\n\n\nThe two-term approximation does beautifully well, even at this moderate value of \\(\\epsilon = 0.2\\).",
    "crumbs": [
      "Practical applied mathematics",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Asymptotic approximations of ODEs</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/euler.html",
    "href": "part-05-techniques/euler.html",
    "title": "7  Euler’s method",
    "section": "",
    "text": "In the previous section, we used built-in ODE solvers to develop numerical solutions. It is important to gain an understanding how a simple ODE solver works. The simplest scheme is called Euler’s method, and this we now explain.\nBegin from the system (Equation 6.2). We assume that the solution is represented by a discrete set of points, \\(\\mathbf{Y}_n = \\mathbf{Y}(t_n)\\) at the times \\(t_0 = 0\\), \\(t_1 = \\Delta t\\), \\(t_2 = 2\\Delta t\\), and so on. The time derivative is written as a discrete derivative while we approximate the right hand side by its value at the nth time step: \\[\n\\frac{\\mathbf{Y}_{n+1} - \\mathbf{Y}_{n}}{\\Delta t} = \\mathbf{F}(t_n, \\mathbf{Y}_n)\n\\]\nRearranging yields a very simple algorithm for solving the ODE: \\[\n\\mathbf{Y}_{n} = \\mathbf{Y}_{n-1} + \\mathbf{F}(t_{n-1}, \\mathbf{Y}_{n-1}) \\Delta t\n\\] for \\(n = 1, 2, 3, \\ldots\\)\nThis would be implemented via the following pseudocode:\n\n\n\n\n\n\nEuler’s method\n\n\n\n1. Input: function f(t, Y)  \n            time step, dt\n            initial condition, Y0\n\n2. Set initial condition Y = Y0\n\n2. Take one Euler step and overwrite previous value\n\n                 Y = Y + f(t, Y)\n\n3. Increment t by dt and goto 2\n\n\nEuler’s method is conceptually simple but quite inaccurate. But in this case, we see that it works fairly well in comparison to the built-in solvers.\n\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom scipy.integrate import solve_ivp\n\nep = 0.2            # epsilon value\ntmax = 2            # max time\nN = 20              # number of steps\nt = np.linspace(0, tmax, N) # mesh used for plotting\ndt = t[1] - t[0]\n\n# Define function for the ODE\ndef f(t, Y, ep):\n    y, yp = Y\n    ypp = -1/(1 + ep*y)**2\n    return np.array([yp, ypp])\n\n# define the initial condition\nY = [0.0, 1.0]\nti = 0\n\n# define the solution vector\nfor i in range(1, N):\n    ti = ti + dt  # Increment time\n    Y = Y + f(ti, Y, ep)*dt # Euler step\n    plt.plot(ti, Y[0], 'k.')\n\n# Asymptotic solutions\ny0 = -1/2*t**2 + t\ny1 = -1/12*t**4 + 1/3*t**3\nplt.plot(t, y0, '--')\nplt.plot(t, y0 + ep*y1, '--')\nplt.xlabel('t');\nplt.ylabel('y');",
    "crumbs": [
      "Practical applied mathematics",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Euler's method</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/asymptotics03.html",
    "href": "part-05-techniques/asymptotics03.html",
    "title": "8  Matched asymptotics",
    "section": "",
    "text": "8.1 Boundary layer theory\nWe seek a method that will allow us to develop a uniformly valid approximation, i.e. an approximation that is good everywhere in the relevant domain, \\(t \\geq 0\\). Begin by performing the usual asymptotic approximation: \\[\nT(t) = T_0(t) + \\epsilon T_1(t) + \\epsilon^2 T_2(t) + \\ldots\n\\] Substitution into the ODE (Equation 8.1) yields at leading order, \\[\n0 = R(t) - T_0(t) \\Longrightarrow T_0(t) = R(t) = 1 + A \\cos(t).\n\\] As we have noted, this approximation fails to satisfy the initial condition, \\(T(0) = T^*\\) in general. It is possible to go to higher order but this is not so important at the moment. So for now, we have obtained: \\[\nT_{\\text{outer}} \\sim \\Bigl[ 1 + A\\cos t\\Bigr].\n\\] We have chosen to refer to this as the outer solution for reasons that will be abundantly clear. But rather than satisfying \\(T(0) = T^*\\), this approximation has the limiting behaviour of \\[\n\\lim_{t \\to 0} T_{\\text{outer}} \\sim \\Bigl[ 1 + A\\Bigr]\n\\] Above, we have only included the leading term in the limit expression.",
    "crumbs": [
      "Practical applied mathematics",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Matched asymptotics</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/asymptotics03.html#boundary-layer-theory",
    "href": "part-05-techniques/asymptotics03.html#boundary-layer-theory",
    "title": "8  Matched asymptotics",
    "section": "",
    "text": "8.1.1 The inner scaling\nOur intuition follows a very similar logic to the examination of the singular root in Section 5.1.1. Above, our naive assumption was that \\(\\epsilon T'(t)\\) could be ignored since \\(\\epsilon\\) is a small number. However, this may not be the case if the gradient is very large.\nOur intuition further suggests that the boundary layer occurs near \\(t = 0\\) and that it scales in size with \\(\\epsilon\\). Therefore, let us set \\[\nt = \\epsilon^{\\alpha} s,\n\\] as a change of coordinates. We expect \\(\\alpha &gt; 0\\) (otherwise \\(t\\) is not small), and within this region, we expect the new coordinate, \\(s\\), to be \\(O(1)\\) (of moderate size). We then transform the unknown function: \\[\nT(t) = T(\\epsilon s) = U(s),\n\\] and seek a new differential equation for \\(U\\). By the chain rule, \\[\n\\frac{\\mathrm{d}T}{\\mathrm{d}t} = \\epsilon^{-\\alpha} \\frac{\\mathrm{d}U}{\\mathrm{d}s}.\n\\] Before substituting into the equation, we are prudent to examine the behaviour of \\(R(t)\\) near \\(t = 0\\). We know by Taylor’s theorem that \\[\nR(t) = 1 + A \\left(1 - \\frac{t^2}{2} + \\ldots \\right).\n\\] Therefore, under the substitution, we may approximate \\(R\\) by its leading terms: \\[\nR( \\epsilon^{\\alpha} s) \\sim 1 + A.\n\\] For now, we will not need more terms than this. Substituting into the ODE now gives \\[\n\\epsilon^{1-\\alpha} \\frac{\\mathrm{d}U}{\\mathrm{d}s} \\sim \\Bigl[1 + A\\Bigr] - U.\n\\] Now in order to involve the first term, it is sensible to select \\[\n1 - \\alpha = 0 \\Longrightarrow \\alpha = 1.\n\\]\n\n\n8.1.2 The inner equation\nTherefore, the correct coordinate re-scaling was the ‘obvious’ one: \\[\nt = \\epsilon s.\n\\]\nSubstituting this again in (Equation 8.1): \\[\n\\begin{align}\n\\frac{\\mathrm{d}U}{\\mathrm{d}s} &= 1 + A\\cos(\\epsilon s) - U, \\\\\nU(0) &= T^*.\n\\end{align}\n\\]\nThe procedure is now exactly the same. We expand \\[\nU(s) = U_0(s) + \\epsilon U_1(s) + \\epsilon^2 U_2(s) + \\ldots\n\\] At leading order, we get \\[\n\\begin{align}\nU_0' &= 1 + A - U_0 \\\\\nU_0(0) &= T^*.\n\\end{align}\n\\] The above ODE can be solved by integrating factors. Multiplying both sides be \\(e^s\\), we have \\[\n(U_0 e^s)' = (1 + A)e^s.\n\\] Integrate and use the initial condition: \\[\nU_0(s) = (1 + A) + (T^* - (1 +A))e^{-s}.\n\\] This is exactly what we expect. Notice that \\[\n\\lim_{s \\to \\infty} U_0(s) = \\lim_{t \\to 0} T_{\\text{outer}}\n\\tag{8.2}\\] therefore the outer limit of our inner solution matches the inner limit of our outer solution. In terms of outer coordinates, our inner solution is approximated as follows: \\[\nT_{\\text{inner}} \\sim (1 + A) + (T^* - (1 +A))e^{-t/\\epsilon}.\n\\]\nLet’s finally plot this with our previous curves:\n\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom scipy.integrate import solve_ivp\n\nTs = 0\nep = 0.2\nA = 0.1\nf = lambda t, T: 1/ep*(1 + A*np.cos(t) - T)\n\ntmax = 20\nsol = solve_ivp(f, [0, tmax], [Ts], dense_output=True)\n\nt = np.linspace(0, tmax, 1000)\ny = sol.sol(t)\nplt.plot(t, y[0])\nplt.plot(t, 1 + A*np.cos(t), '--')\nplt.plot(t, (1 + A) + (Ts - (1 + A))*np.exp(-t/ep), '--')\n\n\n\n\n\n\n\n\nIt works beautifully!\n\n\n8.1.3 Summary\nLet us summarise the procedure of matched asymptotics.\n\nExpand the solution of the differential equation naively in the typical asymptotic expansion (e.g. in powers of \\(\\epsilon\\)).\nNotice that the approximation does not satisfy certain boundary conditions.\nRe-scale the coordinates in the ‘inner’ regions.\nDevelop an inner solution that satisfies the boundary condition. Ensure it matches the outer solution.\n\nYou will get more practice of this procedure in the problem sets.",
    "crumbs": [
      "Practical applied mathematics",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Matched asymptotics</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/newtons.html",
    "href": "part-05-techniques/newtons.html",
    "title": "9  Newton’s method",
    "section": "",
    "text": "9.1 Demo of Newton’s method for scalar equations\nHere is a simple demonstration of Newton’s method in order to solve for one of the roots of the following: \\[\nf(x) = x^3 + x - 1.\n\\]\nWe will start with the initial guess of \\(x_0 = 0\\). We can do this by hand in lectures using a pocket calculator. The solution is \\(x^* \\approx 0.6823278..\\)\nimport numpy as np\n\nx0 = 0\nN = 10\n\ndef Newton(f, df, x, maxiter=10):\n    i = 0\n    while (i &lt; maxiter):\n        err = f(x)\n        x = x - err / df(x)\n        print(\"f(x) = \", np.abs(err), \", x = \", x)\n        i = i + 1\n    return x, err\n\nf = lambda x: x**3 + x - 1\ndf = lambda x: 3*x**2 + 1\n\nx, err = Newton(f, df, x0, N)\nprint(\"Final approximation = \", x)\n\nf(x) =  1 , x =  1.0\nf(x) =  1.0 , x =  0.75\nf(x) =  0.171875 , x =  0.686046511627907\nf(x) =  0.008941036638283384 , x =  0.6823395825973142\nf(x) =  2.823062168566537e-05 , x =  0.6823278039465127\nf(x) =  2.839946056099052e-10 , x =  0.6823278038280194\nf(x) =  2.220446049250313e-16 , x =  0.6823278038280193\nf(x) =  1.1102230246251565e-16 , x =  0.6823278038280193\nf(x) =  1.1102230246251565e-16 , x =  0.6823278038280193\nf(x) =  1.1102230246251565e-16 , x =  0.6823278038280193\nFinal approximation =  0.6823278038280193\nIt is a good idea to also learn how to do this using built-in packages. The ‘fsolve’ function provides a Newton-like nonlinear solver. In fact, it can estimate the Jacobian (derivative), so only the function values need to be provided.\nimport numpy as np\nfrom scipy.optimize import fsolve\n\nf = lambda x: x**3 + x - 1\n\nx0 = 1\nx, info, ier, msg = fsolve(f, x0, full_output=True)\n\nprint(msg)\nprint(x)\n\nThe solution converged.\n[0.6823278]",
    "crumbs": [
      "Practical applied mathematics",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Newton's method</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/newtons.html#demo-of-newtons-method-for-scalar-equations",
    "href": "part-05-techniques/newtons.html#demo-of-newtons-method-for-scalar-equations",
    "title": "9  Newton’s method",
    "section": "",
    "text": "i\nxi\nf(xi)\nf’(xi)\n-f(xi)/f’(xi)\nerror\n\n\n\n\n0\n\n\n\n\n\n\n\n1\n\n\n\n\n\n\n\n2",
    "crumbs": [
      "Practical applied mathematics",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Newton's method</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/newtons.html#newtons-method-for-systems-of-nonlinear-equations",
    "href": "part-05-techniques/newtons.html#newtons-method-for-systems-of-nonlinear-equations",
    "title": "9  Newton’s method",
    "section": "9.2 Newton’s method for systems of nonlinear equations",
    "text": "9.2 Newton’s method for systems of nonlinear equations\nNewton’s method generalises naturally to the case of a system of equations. Suppose we wish to solve for the \\(n\\) unknowns \\(\\mathbf{x} = (x_1, \\ldots, x_n)\\) via \\[\n\\mathbf{F(\\mathbf{x}}) =\n\\begin{pmatrix}\nF_1(\\mathbf{x}) \\\\\nF_2(\\mathbf{x}) \\\\\n\\ldots \\\\\nF_n(\\mathbf{x})\n\\end{pmatrix} = 0.\n\\]\nWe have, via Taylor’s formula, \\[\n\\mathbf{F}(\\mathbf{x}_{i+1}) \\sim  \\mathbf{F(\\mathbf{x}_i}) + J(\\mathbf{x}_i)(\\mathbf{x}_{i+1} - \\mathbf{x}_i) + \\mathcal{O}(||\\mathbf{x}_{i+1} - \\mathbf{x}_i||^2),\n\\] where \\(J\\) is the Jacobian matrix \\[\nJ(\\mathbf{x}) = \\nabla \\mathbf{F}(\\mathbf{x}) =\n\\begin{pmatrix}\n\\frac{\\mathrm{\\partial}F_1}{\\mathrm{\\partial}x_1} &\n\\cdots &\n\\frac{\\mathrm{\\partial}F_1}{\\mathrm{\\partial}x_n} \\\\\n\\vdots & \\ddots & \\vdots \\\\\n\\frac{\\mathrm{\\partial}F_n}{\\mathrm{\\partial}x_1} &\n\\cdots &\n\\frac{\\mathrm{\\partial}F_n}{\\mathrm{\\partial}x_n}\n\\end{pmatrix}.\n\\] Therefore, Newton’s method forms the iterates of \\[\n\\mathbf{x}_{i+1} = \\mathbf{x}_i {\\color{blue}-} J^{-1}(\\mathbf{x}_i) \\mathbf{F}(\\mathbf{x}_i),\n\\] which takes a very similar form to the scalar case.\nHowever, solution of the inverse of \\(J\\) is typically inefficient, and it is better to instead solve for \\(\\delta_{i+1} = \\mathbf{x}_{i+1} - \\mathbf{x}_i\\) via \\[\nJ(\\mathbf{x}_i) \\delta_{i+1} = - \\mathbf{F}(\\mathbf{x}_i),\n\\] and then calculate \\(\\mathbf{x}_{i+1} = \\mathbf{x}_i + \\delta_{i+1}\\). There are many ways of solving the above matrix problem efficiently using built-in routines that perform, e.g. Gaussian elimination.",
    "crumbs": [
      "Practical applied mathematics",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Newton's method</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/newtons.html#secant-method",
    "href": "part-05-techniques/newtons.html#secant-method",
    "title": "9  Newton’s method",
    "section": "9.3 Secant method",
    "text": "9.3 Secant method\nIn many situations, evaluation of the Jacobian (or derivative) is the most time-consuming or difficult part of a nonlinear solver. Built-in solvers like ‘fsolve’, in fact, have the ability to approximate the derivative numerically.\nThe Secant Method is similar to Newton’s Method but replaces the derivative by a finite difference. Geometrically, the tangent line is replaced with a line through the two last known guesses. The algorithm goes as follows.\n\n\n\n\n\n\nSecant method\n\n\n\n\nDevelop two initial guesses to the solution, x0 and x1\nCompute \\[\nx_{n+1} = x_n - \\frac{f(x_n)}{\\frac{f(x_n) - f(x_{n-1})}{x_n - x_{n-1}}} =  x_n - \\frac{f(x_n)(x_n - x_{n-1})}{f(x_n) - f(x_{n-1})}.\n\\]",
    "crumbs": [
      "Practical applied mathematics",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Newton's method</span>"
    ]
  },
  {
    "objectID": "part-03-box/basic-ocean-model.html",
    "href": "part-03-box/basic-ocean-model.html",
    "title": "10  Basic models of the ocean",
    "section": "",
    "text": "10.1 Terminology and context\nThe ocean plays a significant role in regulating the Earth’s climate, as it acts as a massive heat sink and helps to distribute heat and moisture around the planet. In addition, carbon dioxide is water soluble, and through precipitation and wave motion, is transferred into the oceans. Thus the ocean acts as a sink, absorbing large amounts of this greenhouse gas from the atmosphere.\nThe thermohaline circulation (THC), also known as the global ocean conveyor belt, is a complex ocean circulation pattern that is driven by differences in water temperature and salinity. It is an important component of the Earth’s climate system, as it helps to distribute heat and other properties throughout the planet’s oceans.\nThe thermohaline circulation is driven by the sinking of cold, dense water in the polar regions, which then spreads out and flows towards the equator. As the water warms and becomes less dense, it rises to the surface and returns to the poles, creating a continuous loop of ocean currents. The role of salinity in driving the thermohaline circulation is due to the fact that the dissolved salts in seawater increase its density.\nThis circulation pattern has a significant impact on global climate, as it helps to regulate the exchange of heat and other properties between the oceans and the atmosphere. Changes in the thermohaline circulation, such as those caused by global warming, can have far-reaching effects on the planet’s climate and weather patterns.",
    "crumbs": [
      "Box models of the ocean",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Basic models of the ocean</span>"
    ]
  },
  {
    "objectID": "part-03-box/basic-ocean-model.html#terminology-and-context",
    "href": "part-03-box/basic-ocean-model.html#terminology-and-context",
    "title": "10  Basic models of the ocean",
    "section": "",
    "text": "Figure 10.1: The thermohaline circulation. In the Atlantic, the circulation carries warm water (red) north near the surface and cold deep water (blue) south. Image from NASA/JPL.",
    "crumbs": [
      "Box models of the ocean",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Basic models of the ocean</span>"
    ]
  },
  {
    "objectID": "part-03-box/basic-ocean-model.html#temperature",
    "href": "part-03-box/basic-ocean-model.html#temperature",
    "title": "10  Basic models of the ocean",
    "section": "10.2 Temperature",
    "text": "10.2 Temperature\n\n\n\n\n\n\nExtra content\n\n\n\nThe material in this subsection is not examinable in 2022-23 and is given here for further context.\n\n\nIn regards to the temperature, the ocean can be divided into three layers.\n\nThe top layer is thin (on the order of metres) and is heated from the Sun. Mixing is a dominant effect due to wind and waves, and so the temperature in this region is mostly constant.\nThe thermocline region is the intermediate layer. Here, the temperature decreaes approximately linearly.\nThe deep abyssal zone comprises 98% of the total volume of the oceans. The temperature in this region is mostly constant, and a few degrees above freezing.\n\nWithin the intermediate region, the temperature can be modelled by an advection diffusion equation, \\[\n\\frac{\\mathrm{\\partial}T}{\\mathrm{\\partial}t} + w \\frac{\\mathrm{\\partial}T}{\\mathrm{\\partial}z} = \\kappa \\frac{\\mathrm{\\partial}^2 T}{\\mathrm{\\partial}z^2},\n\\tag{10.1}\\] where \\(w\\) is the upswelling velocity and \\(\\kappa\\) is the diffusion coefficient of the fluid.\nLet us assume that the temperature in this region is near steady state and that the upwards velocity is constant. Then we integrate the ODE to find \\[\nT(z) = T_0 + T_1 \\mathrm{e}^{-z/z^*},\n\\] where \\(T_0\\) and \\(T_1\\) are constants. From (Kaper and Engler 2013), the typical orders for the parameters are \\(\\kappa \\sim 10^{-2} \\,\\mathrm{m}^{2} \\,\\mathrm{s}^{-1}\\) and \\(z^* \\sim 10^2 \\, \\mathrm{m}\\), so \\(w \\sim 10^{-4} \\,\\mathrm{m} \\,\\mathrm{s}^{-1}\\), which is quite slow.\n\n\n\n\n\n\nFigure 10.2: Cross section of the Atlantic Ocean, showing the temperature and salinity profiles on the right. Image from (Kaper and Engler 2013).",
    "crumbs": [
      "Box models of the ocean",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Basic models of the ocean</span>"
    ]
  },
  {
    "objectID": "part-03-box/basic-ocean-model.html#salinity-and-density",
    "href": "part-03-box/basic-ocean-model.html#salinity-and-density",
    "title": "10  Basic models of the ocean",
    "section": "10.3 Salinity and density",
    "text": "10.3 Salinity and density\nSalinity is a key component in the oceans since the salts have a large effect on the water density (which consequently drives motion). Salinity is measured in psu or practical salinity units, which is a non-dimensional ratio of conductivities. In the mixed layer, the sainity ranges from 31-39 psu, and is about 35 in the abyssal zone. You can inspect the profile in Figure 10.2.\nBelow in the study of the ocean, we will need a so-called equation of state, which connects the density, \\(\\rho\\), with the salinity, say \\(S\\), and temperature, say \\(T\\). Here is a typical graph of the relationship.\n\n\n\n\n\n\nFigure 10.3: Image from (Kaper and Engler 2013)",
    "crumbs": [
      "Box models of the ocean",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Basic models of the ocean</span>"
    ]
  },
  {
    "objectID": "part-03-box/basic-ocean-model.html#two-box-model-of-the-ocean",
    "href": "part-03-box/basic-ocean-model.html#two-box-model-of-the-ocean",
    "title": "10  Basic models of the ocean",
    "section": "10.4 Two-box model of the ocean",
    "text": "10.4 Two-box model of the ocean\nModelling the THC is a challenging task! In principal, this might involve the solution of multiple coupled PDEs for the flows and temperatures, which would then need to be solved on a very complicated domain. In addition, such models require a number of empirical equations of state (connecting density to temperature and salinity).\nToy models can be developed much more easily at the ‘systems level’ via box models.",
    "crumbs": [
      "Box models of the ocean",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Basic models of the ocean</span>"
    ]
  },
  {
    "objectID": "part-03-box/basic-ocean-model.html#a-one-dimensional-model-constant-temperature",
    "href": "part-03-box/basic-ocean-model.html#a-one-dimensional-model-constant-temperature",
    "title": "10  Basic models of the ocean",
    "section": "10.5 A one-dimensional model (constant temperature)",
    "text": "10.5 A one-dimensional model (constant temperature)\nConstruction and assumptions of the box model.\n\nWe consider two boxes, labeled ‘1’ and ‘2’, respectively via subscripts. Box 1 corresponds to high latitudes (near poles) and Box 2 to low latitudes (near equator). Each box has a corresponding temperature, \\(T_i\\), and salinity, \\(S_i\\). In each box, the temperature and salinities are well mixed, so they take different values in either box, in general.\nDifferences between the two boxes will drive a flow through the capillary pipe that connects the boxes at the bottom. A compensating flow at the surface ensures that the volume of water in each box does not change. Together, these two exchanges (top and bottom) represent the overturning circulation of the THC.\nWe assume (see above) that the strength of the exchange flow between the boxes is linearly proportional to their differences of temperature and salinity. In particular, let \\(\\rho_1\\) and \\(\\rho_2\\) be the two densities in the corresponding boxes. The flow \\(q\\) in the capillary pipe is driven by the difference \\[\nq = k \\frac{\\rho_1 - \\rho_2}{\\rho_0},\n\\tag{10.2}\\] where \\(k\\) is the hydraulic constant and takes the typical value of \\(k = 1.5 \\cdot 10^{-6} \\, \\mathrm{s}^{-1}\\). The reference density \\(\\rho_0\\) is defined in conjunction with the equation of state.\nIn the normal state of the planet, \\(q &gt; 0\\) when the flow through the capillary goes in the direction of the equator as a result of higher densities at high latitudes.\nWe need an equation of state that connects the densities, \\(\\rho\\), with the temperature and salinities. This concerns the figure Figure 10.3. We assume that \\[\n\\rho = \\rho_0(1 - \\alpha(T - T_0) + \\beta(S - S_0)),\n\\tag{10.3}\\] where \\(T_0\\) and \\(S_0\\) are average values of temperature and salinity; \\(\\rho_0\\) is the density if \\(T = T_0\\) and \\(S = S_0\\); \\(\\alpha\\) and \\(\\beta\\) are constants with typical values \\(\\alpha = 1.5 \\times 10^{-4} \\mathrm{deg}^{-1}\\) and \\(\\beta = 8 \\times 10^{-4} \\mathrm{psu}^{-1}\\). Combining (Equation 10.2) with (Equation 10.3) gives \\[\nq = k[ \\alpha(T_2 - T_1) - \\beta(S_2 - S_1)].\n\\tag{10.4}\\]\nExternal wind forces and Coriolis effects are ignored.\nWe assume that in each box, there is an exchange of heat and salinity to the surrounding environment. For instance, salinity will exchange due to evaporation, precipitation, and runoff. These will have constant of proportionalities of \\(c\\) and \\(d\\) in the equations below.\nPrecipitation, evaporation, and runoff from the continents and atmosphere will also cause the salinity in either box to change. We therefore assume that this is modeled by a flux \\(H\\).\nRemember that in general, \\(T_2 &gt; T_1\\) (the temperatures at the equator are higher). Consequently, evaporation dominates Box 2; there is a net loss of salt-free moisture in the atmosphere and this causes a compensating virtual flux of salt, \\(H &gt; 0\\), into Box 2. At the same time, there is higher precipitation and runoff into Box 1 (due to lower temperatures), causing a net gain of salt-free moisture and therefore a loss of virtual salt, say \\(-H &lt; 0\\). We assume these two virtual salt fluxes sum to zero.\nNote that in the normal state of affairs, \\(S_2 &gt; S_1\\), and the lower latitude water is saltier than that of high latitudes.\n\nAn image of the box model is shown below.\n\n\n\n\n\n\nFigure 10.4: Two-box model of the North Atlantic with evaporation and precipitation. Image from (Kaper and Engler 2013)\n\n\n\nThe equations are given as follows.\n\\[\n\\begin{align}\n\\frac{\\mathrm{d}T_1}{\\mathrm{d}t} &= c(T_1^* - T_1) + |q|(T_2 - T_1) \\\\\n\\frac{\\mathrm{d}T_2}{\\mathrm{d}t} &= c(T_2^* - T_2) + |q|(T_1 - T_2) \\\\\n\\frac{\\mathrm{d}S_1}{\\mathrm{d}t} &= -H + d(S_1^* - S_1) + |q|(S_2 - S_1) \\\\\n\\frac{\\mathrm{d}S_2}{\\mathrm{d}t} &= H + d(S_2^* - S_2) + |q|(S_1 - S_2)\n\\end{align}\n\\tag{10.5}\\]\nNote that in the exchange terms corresponding to the flow \\(q\\) in the capillary pipes, we use an absolute value since it does not matter (flows are exchanged in both lower and upper pipes).\nNote also that \\(q = q(T_1, T_2, S_1, S_2)\\) as given in (Equation 10.4).",
    "crumbs": [
      "Box models of the ocean",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Basic models of the ocean</span>"
    ]
  },
  {
    "objectID": "part-03-box/basic-ocean-model.html#reducing-the-equations-via-symmetry",
    "href": "part-03-box/basic-ocean-model.html#reducing-the-equations-via-symmetry",
    "title": "10  Basic models of the ocean",
    "section": "10.6 Reducing the equations via symmetry",
    "text": "10.6 Reducing the equations via symmetry\n\nBy adding the equations (Equation 10.5), it can be verified that in the limit \\(t \\to \\infty\\), the average temperature in the system, \\(1/2(T_1 + T_2)\\) tends to the average temperature in the surrounding basins \\(1/2(T_1^* + T_2^*)\\). The same conclusion can be drawn for the corresponding salinities.\nIt is then sensible to write all temperature and salinity in terms of this baseline scenario. So let us write \\[\\begin{align}\nT_1 &= \\frac{1}{2}m + U_1, \\\\\nT_2 &= \\frac{1}{2}m + U_2,\n\\end{align}\\] where \\(m = T_1^* + T_2^*\\). Then the first equation becomes \\[\\begin{align}\n\\frac{\\mathrm{d}U_1}{\\mathrm{d}t} &= c\\left(T_1^* - U_1 - \\frac{1}{2}m\\right) + |q| (U_2 - U_1)\\\\\n&= c\\left(- T^*  - U_1\\right) + |q| (U_2 - U_1).\n\\end{align}\\] where \\(T^* = \\frac{1}{2}(T_2^* - T_1^*)\\).\nThe analgous manipulations are done to the quantities for the salinity. In the end, if we (confusingly) re-write \\(T\\) for \\(U\\), then we obtain \\[\n\\begin{align}\n\\frac{\\mathrm{d}T_1}{\\mathrm{d}t} &= c(-T^* - T_1) + |q|(T_2 - T_1) \\\\\n\\frac{\\mathrm{d}T_2}{\\mathrm{d}t} &= c(T^* - T_2) + |q|(T_1 - T_2) \\\\\n\\frac{\\mathrm{d}S_1}{\\mathrm{d}t} &= -H + d(-S^* - S_1) + |q|(S_2 - S_1) \\\\\n\\frac{\\mathrm{d}S_2}{\\mathrm{d}t} &= H + d(S^* - S_2) + |q|(S_1 - S_2)\n\\end{align}\n\\tag{10.6}\\]\nComparing the above to Equation 10.5, the main difference is that, in expressing the temperature and salinities with respect to the average values in the basin, we have eliminated two of the constants from the set \\((T_1^*, T_1^*, S_1^*, S_2^*)\\) now only into two constants \\((T^*, S^*)\\).\nIn the situation of zero salt flux. \\(H = 0\\), the above model reduces to Stommel’s box model studied in Chapter 11.",
    "crumbs": [
      "Box models of the ocean",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Basic models of the ocean</span>"
    ]
  },
  {
    "objectID": "part-03-box/basic-ocean-model.html#sec-ocean-toysalinity",
    "href": "part-03-box/basic-ocean-model.html#sec-ocean-toysalinity",
    "title": "10  Basic models of the ocean",
    "section": "10.7 Analysis of a reduced 1D model for the salinity",
    "text": "10.7 Analysis of a reduced 1D model for the salinity\nIt is possible to do some analysis on the system (Equation 10.6), though we may prefer to simply move on to study the more historically well-known reduction called Stommel’s box model in Chapter 11.\nWe make the following assumptions:\n\nWe assume that on the timescale of interest in the THC, the temperature of each box equilibrates quickly with the surrounding basin. Therefore the system can be regarded as being in steady state.\n\nThe difference in temperatures between the two boxes is small; together with the top assumption, this implies that \\(T_1(t) = -T^*\\) and \\(T_2(t) = T^*\\).\nSalinity exchanges by negligible amounts with its surrounding basin, i.e. \\(d = 0\\)\n\nThis leaves us with \\[\\begin{align}\n\\frac{\\mathrm{d}S_1}{\\mathrm{d}t} &= -H + |q|(S_2 - S_1) \\\\\n\\frac{\\mathrm{d}S_2}{\\mathrm{d}t} &= H + |q| (S_1 - S_2),\n\\end{align}\\] where \\(q = k(2\\alpha T^* - \\beta(S_2 - S_1))\\).\nNow, the formulation for the salinities can be placed into a single equation for \\(\\Delta S = S_2 - S_1\\), which satisfies \\[\n\\frac{\\mathrm{d}\\Delta S}{\\mathrm{d}t} = 2H - 2k|\\alpha \\Delta T - \\beta \\Delta S| \\Delta S.\n\\tag{10.7}\\]\nThis is now a much simpler and elegant formulation for study. Under a suitable non-dimensionalisation and scaling, we can even place the above equation in the final simplified form of \\[\n\\dot{x} = \\lambda - |1 - x| x,\n\\] where \\(\\lambda &gt; 0\\) (for temperatures in the usual configuration, with \\(T_2 - T_1 &gt; 0\\), and a suitably defined function \\(x = x(t)\\).\n\n\n\n\n\nKaper, Hans, and Hans Engler. 2013. Mathematics and Climate. SIAM.",
    "crumbs": [
      "Box models of the ocean",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Basic models of the ocean</span>"
    ]
  },
  {
    "objectID": "part-03-box/stommel.html",
    "href": "part-03-box/stommel.html",
    "title": "11  Stommel’s box model",
    "section": "",
    "text": "11.1 Non-dimensionalisation\nWe can then nondimensionalise the system by setting \\[\nx = \\frac{\\Delta S}{\\Delta S^*}, \\quad y = \\frac{\\Delta T}{\\Delta T^*}, \\quad t' = ct,\n\\] where \\(t'\\) is nondimensional time. Dropping the primes henceforth, we have the following set of non-dimensional equations to study for the unknowns, \\(x = x(t)\\), and \\(y = y(t)\\): \\[\n\\begin{align}\n\\frac{\\mathrm{d}x}{\\mathrm{d}t} &= \\delta(1 - x) - |f(x, y)|x, \\\\\n\\frac{\\mathrm{d}y}{\\mathrm{d}t} &= 1 - y - |f(x, y)|y,\n\\end{align}\n\\tag{11.2}\\] where we have introduced the function, \\[\nf(x, y; R, \\lambda) = \\frac{1}{\\lambda}(Rx - y),\n\\tag{11.3}\\] where there are now three non-dimensional parameters given by \\[\n\\begin{align}\n\\delta &= d/c, \\\\\n\\lambda &= c/(2\\alpha k \\Delta T^*), \\\\\nR &= \\beta \\Delta S^*/(\\alpha \\Delta T^*).\n\\end{align}\n\\] Together Equation 11.2 and Equation 11.3 form a system of equations for \\((x(t), y(t))\\), with parameters \\(\\delta\\), \\(\\lambda\\), and \\(R\\).\nAlthough there are many parameters, it is important to note that the quantity \\(f\\) is crucial since it corresponds to the direction of flow in the bottom pipe of the Ocean model. By convention, the system was set up so that \\(f &gt; 0\\) corresponds to flow through the bottom pipe goes in the direction of the equator (Box 1) as a result of higher densities at the high latitudes. We are subsequently interested in whether it is possible for \\(f\\) to switch sign, which would correspond to a bottom flow going from equator to poles, and the entire system switching direction.",
    "crumbs": [
      "Box models of the ocean",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Stommel's box model</span>"
    ]
  },
  {
    "objectID": "part-03-box/stommel.html#sec-ocean2-equil",
    "href": "part-03-box/stommel.html#sec-ocean2-equil",
    "title": "11  Stommel’s box model",
    "section": "11.2 Equilibrium states",
    "text": "11.2 Equilibrium states\nLet the equilibrium states be given by \\((x^*, y^*)\\) with \\(f(x^*, y^*) = f^*\\). Then setting the right hand sides of (Equation 11.2) to zero and solving, we find \\[\nx^* = \\frac{\\delta}{\\delta + |f^*|} \\quad \\text{and} \\quad\ny^* = \\frac{1}{1 + |f^*|}.\n\\tag{11.4}\\] We can solve for \\(f^*\\) in both equations and equate the result to one another. This gives \\[\n\\delta \\frac{1-x^*}{x^*} = \\frac{1 - y^*}{y^*} = |f^*|.\n\\] Therefore the equilibrium points lie along the above curve. Let us generate different values of \\(f^*\\) and plot the combination.\n\nimport numpy as np\nimport matplotlib.pyplot as plt\n\ndelt = 1/6\nfmat = np.linspace(1e-3, 10, 101)\nxs = delt/(delt + np.abs(fmat))\nys = 1/(1 + np.abs(fmat))\nplt.plot(xs, ys, '.-')\nplt.xlim((0,1))\nplt.ylim((0,1))\nplt.xlabel(\"$x^*$\"); plt.ylabel(\"$y^*$\");\nplt.grid(1)\n\n\n\n\n\n\n\n\nThe above shows the steady-state values at \\(\\delta = 1/6\\). Each point refers to a different value of \\(|f^*|\\). Note that as \\(|f^*| \\to \\infty\\), then \\((x^*, y^*) \\to (0, 0)\\) while as \\(|f^*| \\to 0\\), then \\((x^*, y^*) \\to (1,1)\\).\nNow the above does not tell us what equilibrium states will exist at a specific value of \\(\\delta\\) since it requires information about \\(f^*\\). We take (Equation 11.3) and combine with (Equation 11.4). We conclude that the equilibrium points must satisfy \\[\n\\lambda f^* = \\phi(f^*),\n\\] where we have defined the function \\(\\phi\\) according to \\[\n\\phi(f^*) = \\frac{\\delta R}{\\delta + |f^*|} - \\frac{1}{1 + |f^*|}.\n\\tag{11.5}\\] Therefore, for each combination of the parameters \\((\\lambda, \\delta, R)\\), we must solve \\(\\delta f^* = \\phi(f^*)\\) to determine \\(f^*\\). Once the values of \\(f^*\\) are known, then the steady-states \\((x^*, y^*)\\) are also known. Here is a typical graph showing the potential intersections at the values of \\(\\lambda = 1/5\\), \\(\\delta = 1/6\\) and \\(R = 2\\).\n\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport scipy.optimize as sciopt\n\nlam = 1/5;\ndelt = 1/6;\nR = 2;\n\nf = np.linspace(-2.5, 2.5, 101)\nphi = delt*R/(delt + np.abs(f)) - 1/(1 + np.abs(f))\n\nplt.plot(f, phi, 'k', label='$\\phi$')\nplt.plot(f, lam*f, 'b', label='$\\lambda f$' )\nplt.ylim((-1.5,2))\nplt.xlabel(\"$f$\")\nplt.ylabel(\"$\\phi$\")\nplt.legend()\nplt.grid(1)\n\n\n\n\n\n\n\n\nAlthough there are many parameters that can alter the shape of the overall graphs, note that if \\(\\lambda\\) is increased from its current value of \\(\\lambda = 1/6\\), then two of the left roots will disappear, leaving only a single root.",
    "crumbs": [
      "Box models of the ocean",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Stommel's box model</span>"
    ]
  },
  {
    "objectID": "part-03-box/stommel.html#stability",
    "href": "part-03-box/stommel.html#stability",
    "title": "11  Stommel’s box model",
    "section": "11.3 Stability",
    "text": "11.3 Stability\nWe let \\(x = x^* + \\xi\\) and \\(y = y^* + \\eta\\) and linearise the system about the fixed points. This gives \\[\n\\begin{pmatrix}\n\\dot{\\xi} \\\\\n\\dot{\\eta}\n\\end{pmatrix} = A\n\\begin{pmatrix}\n\\xi \\\\ \\eta\n\\end{pmatrix},\n\\] where the matrix \\(A\\) is given by \\[\nA =\n\\begin{pmatrix}\n-(\\delta + |f^*|) \\mp \\frac{Rx^*}{\\lambda} & \\pm \\frac{x^*}{\\lambda} \\\\\n\\mp \\frac{Ry^*}{\\lambda} & -(1 + |f^*|) \\pm \\frac{y^*}{\\lambda}\n\\end{pmatrix}\n\\] if \\(f^* \\gtrless 0\\).\nThere are two ways or proceeding. We can numerically substitute the fixed points into the above matrix for \\(A\\) and then calculate the eigenvalues (numerically or otherwise). Or we can directly proceed analytically.\nIf proceeding analytically, we can then calculate the trace and determinant, giving \\[\n\\begin{align}\nT &= -(1 + \\delta + 3 |f^*|), \\\\\nD &= (\\delta + 2|f^*|)(1 + |f^*|) \\pm (1 - \\delta) \\frac{y^*}{\\lambda}.\n\\end{align}\n\\] Using the above, we can analytically calculate the key discriminant expression of \\(T^2 - 4D\\) (or numerically) in order to verify stability. The details of the classification scheme is given in the appendix Chapter 14.\nFor our purposes, we will mainly proceed using numerics, and bypass the need to study the above results analytically.\nIn the accompanying lecture script, we will obtain the eigenvalues numerically, and generate the phase plane. At the test point \\(R = 2\\), \\(\\delta = 1/6\\), and \\(\\lambda = 1/5\\), we generate the following phase plane picture.\n\n\n\n\n\n\nFigure 11.1: Phase plane for \\(R = 2\\), \\(\\lambda = 1/5\\) and \\(\\delta = 1/6\\). The blue, red, and green fixed points correspond to \\(f_1\\), \\(f_2\\), and \\(f_3\\) in order. The blue point is a stable node, the red point is an unstable saddle, and the green point is a stable spiral.",
    "crumbs": [
      "Box models of the ocean",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Stommel's box model</span>"
    ]
  },
  {
    "objectID": "part-03-box/stommel.html#bifurcation-diagrams",
    "href": "part-03-box/stommel.html#bifurcation-diagrams",
    "title": "11  Stommel’s box model",
    "section": "11.4 Bifurcation diagrams",
    "text": "11.4 Bifurcation diagrams\nOnce the above stability analysis, it is possible to sketch the final bifurcation diagram.\nFirst, we can note that as \\(\\lambda\\) increases, the graph in Section 11.2 indicates that there may either be three intersections (as shown) or if \\(\\lambda\\) increases then two of the intersections may disappear. We can note that:\n\n\n\n\\(f_i^*\\)\n\\(\\lambda \\to 0^+\\)\n\\(\\lambda \\to \\infty\\)\n\n\n\n\n\\(f_1^*\\)\n\\(-\\infty\\)\nnone\n\n\n\\(f_2^*\\)\nfixed point &lt; 0\nnone\n\n\n\\(f_3^*\\)\nfixed point &gt; 0\n0\n\n\n\nWe can also ascertain that there should be a point, say \\(\\lambda = \\lambda^*\\) where the two roots coalesce, \\(f_1^* = f_2^*\\), and thereafter disappear. This allows us to now plot the bifurcation \\((\\lambda, f^*)\\)-plane:\n\n\n\n\n\n\nFigure 11.2",
    "crumbs": [
      "Box models of the ocean",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Stommel's box model</span>"
    ]
  },
  {
    "objectID": "part-03-box/stommel.html#stommels-conclusion",
    "href": "part-03-box/stommel.html#stommels-conclusion",
    "title": "11  Stommel’s box model",
    "section": "11.5 Stommel’s conclusion",
    "text": "11.5 Stommel’s conclusion\nWhat is the final takeaway message(s)?\n\nIt is possible to pose a conceptual model of the ocean and the thermohaline circulation, which governs the exchange of hot-and-cold waters and salty waters from equatorial-to-pole zones.\nThis conceptual model suggests that tipping points and hysteresis are possible in such systems. In particular, it is possible, according to these models, for the flow directions to entirely change!\n\n\n\n\n\n\n\nAs noted by (Kaper and Engler 2013):\n\n\n\n“Clearly, two-box models are only a caricature of the THC. At best, they account for the pole-to-equator circulation in single ocean basin (the North Atlantic). They certainly do not account for the fact that all the Earth’s oceans are connected, nor for the fact that the oceans are coupled to the atmosphere and other components of the climate system. Nevertheless, the finding that such simple models predict the possibility of two distinct stable modes of circulation, and that transitions from one more to another can be induced by changing the forcing parameters [–] has had a significant impact in oceanography and climate science.”\n\n\n\n\n\n\nKaper, Hans, and Hans Engler. 2013. Mathematics and Climate. SIAM.\n\n\nStommel, Henry. 1961. “Thermohaline Convection with Two Stable Regimes of Flow.” Tellus 13 (2): 224–30.",
    "crumbs": [
      "Box models of the ocean",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Stommel's box model</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/part-exercises.html",
    "href": "part-xx-exercises/part-exercises.html",
    "title": "Exercises",
    "section": "",
    "text": "Exercises and problem sets to be released as the term progresses.",
    "crumbs": [
      "Exercises"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps01.html",
    "href": "part-xx-exercises/ps01.html",
    "title": "12  Problem set 1",
    "section": "",
    "text": "12.1 A source in the heat equation\nConsider the same heat experiment discused in Chapter 1 but now consider a bar that has an internal source or sink generating or removing heat, such as the case of a boiler with an internal heating element. By adapting a similar derivation to the one presented, explain why the modified conservation of heat equation is \\[\n\\frac{\\mathrm{\\partial}}{\\mathrm{\\partial}t} \\int_a^b \\rho c T \\, \\mathrm{d}x = q(x = b, t) - q(x = a, t) + \\int_a^b R(x, t) \\, \\mathrm{d}x.\n\\]\nIn addition:",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Problem set 1</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps01.html#a-source-in-the-heat-equation",
    "href": "part-xx-exercises/ps01.html#a-source-in-the-heat-equation",
    "title": "12  Problem set 1",
    "section": "",
    "text": "By studying the dimensions of the other terms in the above equation, find what the dimensions of \\(R\\) are. What does \\(R &gt; 0\\) mean and \\(R &lt; 0\\)?\nHence derive the partial differential equation that governs the temperature \\(T\\).\nBy introducing the appropriate scalings on each of the variables, \\(x\\), \\(t\\), and \\(T\\), non-dimensionalise the PDE and discuss the non-dimensional parameters (there will be two).",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Problem set 1</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps01.html#choice-of-scalings",
    "href": "part-xx-exercises/ps01.html#choice-of-scalings",
    "title": "12  Problem set 1",
    "section": "12.2 Choice of scalings",
    "text": "12.2 Choice of scalings\nConsider the dimensional problem for the motion of a projectile launched from close to the surface of the Earth. The dimensional height of the projectile, \\(y(t)\\), is given by \\[\\begin{align}\n\\frac{\\mathrm{d}^2 y}{\\mathrm{d}t^2} &= - \\frac{GM}{(R+y)^2}, \\\\\ny(0) &= 2 \\, \\mathrm{m}, \\\\\ny'(0) &= -V_0 \\, \\mathrm{m/s}.\n\\end{align}\\] Assume that the Earth is spherical and of uniform density, with its mass given by \\(M = (4/3) \\pi R^3 \\rho\\). Non-dimensionalise the height using \\(y = L \\tilde{y}\\) and time using \\(t = T\\tilde{t}\\). Consider the following cases:\n\n\\(R\\) fixed, \\(V_0 \\to \\infty\\), \\(\\rho\\) fixed;\n\\(R\\) fixed, \\(V_0\\) fixed, \\(\\rho \\to \\infty\\);\n\\(R\\) fixed, \\(V_0\\) fixed, \\(\\rho \\to 0\\);\n\\(R \\to 0\\), \\(V_0\\) fixed, \\(M\\) fixed.\n\nFor each case:\n\nExplain the physical interpretation of the limits.\nChoose the scalings \\(L\\) and \\(T\\) to normalise as many terms as possible.\nChoose the scalins so that the time it takes for the projectile to fall should be finite for the given limit, and for the speed, acceleration, and initial height to be well behaved (finite).\nWrite out the scaled problem and identify all remaining nondimensional parameters.\nIdentify the limiting small parameter for each case. Write out the problem (leading-order problem) when the parameter is set to zero.",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Problem set 1</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps01.html#the-unique-timescale-in-the-heat-equation",
    "href": "part-xx-exercises/ps01.html#the-unique-timescale-in-the-heat-equation",
    "title": "12  Problem set 1",
    "section": "12.3 The unique timescale in the heat equation",
    "text": "12.3 The unique timescale in the heat equation\nDuring our investigation of the heat equation, we found that it was possible to scale time so as to scale out the only non-dimensional parameter that appears in the PDE (the Peclet number). This produced (Equation 2.3). As explained in lectures, the disappearance of all non-dimensional parameters is due to the fact that only a single sensible timescale exists.\nBy adjusting the boundary conditions, we may create a new problem involving heat flow where a unique ‘special’ timescale in (Equation 2.2) can no longer be chosen.\nConsider a system where one side of the rod is heated in some periodic fashion, e.g. set the initial and boundary conditions to be \\[\\begin{align}\nT(x, 0) &= T_0 \\\\\nT(0, t) &= T_a \\cos (\\omega t), \\\\\nT(L, t) &= T_b.\n\\end{align}\\]\n\nWhat must the units of \\(\\omega\\) be?\nNon-dimensionalise as usual and, without selecting the timescale, \\([t]\\), identify the key non-dimensional parameters that remain. Write a brief sentence to describe their physical interpretation.\nThere are two sensible choices for setting the timescale, \\([t]\\). Identify the two choices and present the reduced set of equations in each case.",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Problem set 1</span>"
    ]
  },
  {
    "objectID": "part-xx-exercises/ps01.html#timescale-in-the-surface-energy",
    "href": "part-xx-exercises/ps01.html#timescale-in-the-surface-energy",
    "title": "12  Problem set 1",
    "section": "12.4 Timescale in the surface energy",
    "text": "12.4 Timescale in the surface energy\nTake the basic zero-dimensional energy model studied in (Equation 3.7) for the temperature of the troposphere: \\[\nC \\frac{\\mathrm{d}T}{\\mathrm{d}t} = \\frac{1}{4} Q(1 - a) - \\sigma \\gamma T^4.\n\\]\n\nNon-dimensionalise the model by choosing \\(T = [T]T'\\), \\(t = [t]t'\\), and \\(Q = [Q]Q'\\). Show that it is possible to select the scalings on the temperature and time so as to completely remove all constants from the problem when \\(Q\\) is assumed to be constant.\nThus, show that the analysis of the above equation is equivalent to studying \\[\n\\frac{\\mathrm{d}T}{\\mathrm{d}t} = 1 - T^4,\n\\] where we have dropped the primes and assumed that the albedo is such that \\(1 - a \\neq 0\\).\nFrom your choice of \\([t]\\), estimate the typical dimensional value using \\(d \\approx 10 \\mathrm{km}\\), \\(\\rho \\approx 1 \\mathrm{kg} \\,\\mathrm{m}^{-3}\\), \\(c_p \\approx 10^3 \\mathrm{J} \\,\\mathrm{kg}^{-1} \\,\\mathrm{K}^{-1}\\).\n\nUse a pocket calculator to verify your calculations and conclude that this time-scale is on the order of a month. What is the relevance of this approximation as it concerns the steady-state solution?",
    "crumbs": [
      "Exercises",
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Problem set 1</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/odes.html",
    "href": "part-05-techniques/odes.html",
    "title": "13  Differential equations",
    "section": "",
    "text": "13.1 First-order linear differential equations\nFirst-order linear differential equations are of the form \\[\ny' + q(x) y = r(x).\n\\] These are solved by integrating factors. Multiply both sides by \\[\ne^{\\int^x q(x') \\, \\mathrm{d}x'}\n\\] so that the equation can be placed in the form \\[\n\\frac{\\mathrm{d}}{\\mathrm{d}x} \\left(y e^{\\int^x q(x') \\, \\mathrm{d}x'}\\right) = r(x) e^{\\int^x q(x') \\, \\mathrm{d}x'}\n\\] Then integrate and solve for \\(y\\).\nReferences",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Differential equations</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/odes.html#first-order-linear-differential-equations",
    "href": "part-05-techniques/odes.html#first-order-linear-differential-equations",
    "title": "13  Differential equations",
    "section": "",
    "text": "Paul’s online notes",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Differential equations</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/odes.html#second-order-constant-coefficient-odes",
    "href": "part-05-techniques/odes.html#second-order-constant-coefficient-odes",
    "title": "13  Differential equations",
    "section": "13.2 Second-order constant coefficient ODEs",
    "text": "13.2 Second-order constant coefficient ODEs\nSecond-order linear constant-coefficient ODEs are of the form \\[\ny'' + ay' + by = f(x).\n\\] With both forced (\\(f \\neq 0\\)) and unforced (\\(f = 0\\)) varieties studied. For the unforced variant (homogeneous), you will remember that the equation is solved by attempting the ansatz \\(y = e^{rx}\\) and solving for \\(r\\).\nThere are many references on this topic since it is the standard second-order theory learned in most initial differential equations courses.\nReferences:\n\nPaul’s online notes",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Differential equations</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/dynamical-systems.html",
    "href": "part-05-techniques/dynamical-systems.html",
    "title": "14  Dynamical systems",
    "section": "",
    "text": "14.1 Stability analysis for 2x2 systems\nIn the case of 2x2 systems, there is a useful classification and shortcut. The eigenvalues, \\(\\lambda_1\\) and \\(\\lambda_2\\) are given by \\[\n\\lambda_{1,2} = \\frac{1}{2} (T \\pm \\sqrt{T^2 - 4D}),\n\\] where \\(T = \\mathrm{tr}(A) = a + d\\) and \\(D = \\mathrm{det}(A) = ad - bc\\). Once \\(T\\) and \\(D\\) are known, then the fixed points can be classified based on the following diagram.\nAbove, the critical parabola is where \\(T^2 - 4D = 0\\).",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Dynamical systems</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/dynamical-systems.html#stability-analysis-for-2x2-systems",
    "href": "part-05-techniques/dynamical-systems.html#stability-analysis-for-2x2-systems",
    "title": "14  Dynamical systems",
    "section": "",
    "text": "Figure 14.1: Classification diagram from (Kaper and Engler 2013)\n\n\n\n\n\n\n\n\nKaper, Hans, and Hans Engler. 2013. Mathematics and Climate. SIAM.",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Dynamical systems</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/vector-calculus.html",
    "href": "part-05-techniques/vector-calculus.html",
    "title": "15  Vector calculus",
    "section": "",
    "text": "15.1 Surface integrals\nSurface integrals are generalisations of the concept of a multiple integrals to integrals over surfaces. For example, consider a flat plate of area \\(A\\) heated to a certain temperature, and thus emits a certain amount of energy, \\(E\\), per unit area (per unit time). The total energy emitted per unit time would then be \\(E A\\).\nIf we want to consider the same problem, but now posed on a general surface, say the planet \\(S\\), and where \\(E\\) varies along the surface, then we must consider adding together \\(E(\\mathbf{x}) \\mathrm{d}{S}\\). We thus chop our surface into smaller pieces, each with area \\(\\mathrm{d}S\\), multiply each piece with its corresponding energy, and then sum the result.\nThe result is the surface integral \\[\n\\iint_S E(\\mathbf{x}) \\, \\mathrm{d}S.\n\\] A tutorial for computing surface integrals can be found here.\nYou will not need to know how to calculate surface integrals in general in the course.",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>Vector calculus</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/modelling.html",
    "href": "part-05-techniques/modelling.html",
    "title": "16  Modelling",
    "section": "",
    "text": "16.1 Units\nIt is good to clarify notation and analysis of scientific units. In this course, we will sometimes use square brackets to indicate the units of a quantity. For example, in the next chapter, we will discuss radiation from the sun, measured by \\(Q = 1380\\) W m^{-2}. A Watt (W) is energy per unit time, or joules per second (J/s). So alternatively, we could write \\(Q = 1380 J/(m^2 s)\\), or \\[\n[Q] = J m^{-2} s^{-1}.\n\\] This is an example of a flux—the flow (W, J/s) per unit area (m^2) of some quantity (in this case, energy). If you are ever confused about what a unit means, it is a good idea to break it into its constituent parts.",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>Modelling</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/modelling.html#nondimensionalisation",
    "href": "part-05-techniques/modelling.html#nondimensionalisation",
    "title": "16  Modelling",
    "section": "16.2 Nondimensionalisation",
    "text": "16.2 Nondimensionalisation\n\n\n\n\n\n\nImportant\n\n\n\nInsert a few words about nondimensionalisation here.",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>Modelling</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/finitedifference.html",
    "href": "part-05-techniques/finitedifference.html",
    "title": "17  Finite difference approximations",
    "section": "",
    "text": "17.1 Forwards, backwards, and centred differences\nWe want to learn how to use finite differences in order to approximate derivatives numerically. We know that \\[\nf'(x) = \\lim_{h \\to 0} \\frac{f(x + h) - f(x)}{h},\n\\] provided the limit exists. Therefore, a simple idea to approximating the value of \\(f'(x)\\) is to use a small numerical value for \\(h\\), and calculate (the gradient of the secant line), \\[\nf'(x) \\approx \\frac{f(x + h) - f(x)}{h},\n\\] where \\(h\\) is a specified small number. The above is known as the two-point forward-difference formula. In fact, we can determine exactly the error of such an approximation via Taylor’s theorem. If \\(f\\) is twice continuously differentiable, then \\[\nf(x + h) = f(x) + h f'(x) + \\frac{h^2}{2} f''(c),\n\\] for some point \\(c\\in [x, x+h]\\). Therefore by re-arrangement, we see the following.\nNotice that the error in using the two-point forward difference approximation is then \\(\\mathcal{O}(h)\\), and this error tends to zero as \\(h \\to 0\\) (as long as \\(f''\\) is continuous). We thus call the above formula a first-order finite-difference approximation. If the error is \\(\\mathcal{O}(h^n)\\), we call the corresponding formula an \\(n\\)th-order approximation.\nSimilar formulae can be developed for the backwards difference (send \\(h \\to -h\\)).\nA more accurate formula can be developed via subtracting the Taylor series for \\(f(x - h)\\) from that for \\(f(x + h)\\). This results in:\nThus we see that the centered difference formula is accurate to \\(O(h^2)\\).",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>17</span>  <span class='chapter-title'>Finite difference approximations</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/finitedifference.html#forwards-backwards-and-centred-differences",
    "href": "part-05-techniques/finitedifference.html#forwards-backwards-and-centred-differences",
    "title": "17  Finite difference approximations",
    "section": "",
    "text": "Two-point forward-difference formula\n\n\n\n\\[\nf'(x) = \\frac{f(x + h) - f(x)}{h} - \\frac{h}{2} f''(c),\n\\] where \\(c \\in (x, x+h)\\).\n\n\n\n\n\n\n\n\n\nExample\n\n\n\nUse the two-point forward difference formula with different values of \\(h\\) in order to approximate the derivative of \\(f(x) = 1/x\\) at \\(x = 2\\).\n\n\n\n\\(f(x)\\)\n\\(f(x + h)\\)\n\\(h\\)\n\\(f'(x)\\)\nError\n\n\n\n\n…\n…\n…\n…\n…\n\n\n…\n…\n…\n…\n…\n\n\n…\n…\n…\n…\n…\n\n\n\n\n\n\n\n\n\n\n\n\n\nThree-point centered-difference formula\n\n\n\n\\[\nf'(x) = \\frac{f(x + h) - f(x - h)}{2h} - \\frac{h^2}{6} f'''(c),\n\\] where \\(c \\in (x-h, x+h)\\).",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>17</span>  <span class='chapter-title'>Finite difference approximations</span>"
    ]
  },
  {
    "objectID": "part-05-techniques/finitedifference.html#jacobian-matrices",
    "href": "part-05-techniques/finitedifference.html#jacobian-matrices",
    "title": "17  Finite difference approximations",
    "section": "17.2 Jacobian matrices",
    "text": "17.2 Jacobian matrices\n\n\n\n\n\n\nReference\n\n\n\nYou will have encountered the Jacobian, firstly in your first-year Methods courses when performing change-of-coordinates in integration formulae, and secondly in your second-year Modelling and Dynamics courses when studying differential equations. It also comes up in the second-year Vectors and PDEs course.\n\n\nThe Jacobian matrix, \\(\\mathbf{J}\\), of a vector function, \\(\\mathbf{F}: \\mathbb{R}^n \\to \\mathbb{R}^m\\), \\[\n\\mathbf{F}(\\mathbf{x}) = \\begin{pmatrix}\nf_1(\\mathbf{x}) \\\\\nf_2(\\mathbf{x}) \\\\\n\\vdots \\\\\nf_m(\\mathbf{x})\n\\end{pmatrix},\n\\] is the matrix of all its first-order partial derivatives, \\[\n\\mathbf{J}(\\mathbf{x}) = \\begin{pmatrix}\n\\frac{\\mathrm{\\partial}f_1}{\\mathrm{\\partial}x_2} & \\cdots &\n\\frac{\\mathrm{\\partial}f_1}{\\mathrm{\\partial}x_n} \\\\\n\\vdots & \\ddots & \\vdots \\\\\n\\frac{\\mathrm{\\partial}f_m}{\\mathrm{\\partial}x_1} & \\cdots &\n\\frac{\\mathrm{\\partial}f_m}{\\mathrm{\\partial}x_n}\n\\end{pmatrix}\n= \\begin{pmatrix}\n\\nabla f_1(\\mathbf{x})^T \\\\\n\\vdots \\\\\n\\nabla f_n(\\mathbf{x})^T\n\\end{pmatrix}.\n\\] We can essentially think of the Jacobian as the multi-dimensional extension of the basic derivative. It encodes all of the (first-order) information about the rate-of-change of the function.\nIt is interesting and important to consider the numerical evaluation of the Jacobian, in the event that the function \\(\\mathbf{F}\\) cannot be easily differentiated exactly. The simplest algorithm is based on approximating each entry of the matrix by a finite difference.\nFor example, let us consider approximating \\[\n\\frac{\\mathrm{\\partial}f_i}{\\mathrm{\\partial}x_j}(\\mathbf{x}_0).\n\\] We define the \\(j\\)th unit vector by \\(\\mathbf{e}_j = [0 \\, 0 \\, \\cdots \\, 1 \\, \\cdots \\, 0]\\), which the \\(j\\)th entry being one and all entries being zero. Then we can approximate the derivative by a central difference, \\[\n\\frac{\\mathrm{\\partial}f_i}{\\mathrm{\\partial}x_j}(\\mathbf{x}_0) \\approx \\frac{f_i(\\mathbf{x}_0 + \\mathbf{e}_j h) - f_i(\\mathbf{x}_0 - \\mathbf{e}_j h)}{2h},\n\\] where \\(h\\) is a small step size.\nLet us test this by calculating the Jacobian for \\[\n\\mathbf{F}(\\mathbf{x}) = \\begin{pmatrix}\nx_1^2 \\\\\nx_2^2 \\\\\nx_1 x_2\n\\end{pmatrix}.\n\\] The pseudocode for this looks like this\n\n\n\n\n\n\nPseudocode for numerical Jacobian\n\n\n\nInput: function F (size m), point x (size n), step size h\n1. Create an (m x n) matrix, J\n2. a. Loop through all the rows indexed by i\n      b. Loop through all the columns indexed by j\n             Create the ej unit vector\n         Calculate the difference of F_i(x + h e_j) - F_i(x - h e_j)\n         Divide by 2h\n         Assign this value to the (i,j)th value of the Jacobian\n\nOutput: the (mxn) Jacobian matrix J\n\n\nHere is a code that puts it into practice.\n\nimport numpy as np\n\ndef jacobian(func,initial,delta=1e-3):\n  f = func\n  nrow = len(f(initial))\n  ncol = len(initial)\n  output = np.zeros(nrow*ncol)\n  output = output.reshape(nrow,ncol)\n  for i in range(nrow):\n    for j in range(ncol):\n      ej = np.zeros(ncol)\n      ej[j] = 1\n      dij = (f(initial+ delta * ej)[i] - f(initial- delta * ej)[i])/(2*delta)\n      output[i,j] = dij\n  return output\n  \ndef myf(x):\n  x1 = x[0]\n  x2 = x[1]\n  output = np.zeros(3)\n  output[0] = x[0]**2\n  output[1] = x[1]**2\n  output[2] = x[0]*x[1]\n  return output\n  \njacobian(myf,[1,2])\n\narray([[2., 0.],\n       [0., 4.],\n       [2., 1.]])",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>17</span>  <span class='chapter-title'>Finite difference approximations</span>"
    ]
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Fourier, Joseph. 1827. “Mémoire Sur Les\nTempératures Du Globe Terrestre Et Des Espaces\nPlanétaires.” Mémoires de\nl’Académie Royale Des Sciences de l’Institut de France\n7: 570–604.\n\n\nFowler, Andrew. 2011. Mathematical Geoscience. Vol. 36.\nSpringer.\n\n\nKaper, Hans, and Hans Engler. 2013. Mathematics and Climate.\nSIAM.\n\n\nMacKay, D. J. C. 2009. Sustainable Energy – Without the Hot\nAir. UIT Cambridge Ltd.\n\n\nPouillet, Claude Servais Mathias. 1838. “Memoire Sur Le Chaleur\nSolaire.” Paris.\n\n\nStommel, Henry. 1961. “Thermohaline Convection with Two Stable\nRegimes of Flow.” Tellus 13 (2): 224–30.\n\n\nVan der Veen, CJ. 2000. “Fourier and the ‘Greenhouse\nEffect’.” Polar Geography 24 (2): 132–52.",
    "crumbs": [
      "References"
    ]
  }
]