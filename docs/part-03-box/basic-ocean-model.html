<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>MA30287: Mathematics of Planet Earth - 18&nbsp; Basic models of the ocean</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../part-03-box/stommel.html" rel="next">
<link href="../part-03-box/part-ocean.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../part-03-box/part-ocean.html">Box models of the ocean</a></li><li class="breadcrumb-item"><a href="../part-03-box/basic-ocean-model.html"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Basic models of the ocean</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">MA30287: Mathematics of Planet Earth</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part-01-intro/intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-01-intro/intro-PDEs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Conservation laws and constitutive laws</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-01-intro/intro-nondim.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Dimensional scaling analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-01-intro/basic-energy-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Basic energy models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-01-intro/problemclass01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Problem class 1</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part-05-techniques/techniques.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Practical applied mathematics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-05-techniques/asymptotics01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Asymptotic approximations I</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-05-techniques/asymptotics02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Asymptotic approximations II</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-05-techniques/euler.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Numerical solutions of IVPs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-xx-exercises/problemclass02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Problem class 2</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-05-techniques/asymptotics03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Asymptotic approximations III</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-05-techniques/newtons.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Newton’s method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-xx-exercises/problemclass03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Problem class 3</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part-03-box/part-box.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Energy balance models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-03-box/box-energy-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">The basic EBM (steady-state)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-03-box/box-energy-model2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">EBM with latitude I</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-03-box/latitude2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">EBM with latitude II</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-xx-exercises/problemclass04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Problem class 4</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-03-box/latitude3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">EBM with latitude III</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-03-box/latitude4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">EBM with latitude IV</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part-03-box/part-ocean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Box models of the ocean</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-03-box/basic-ocean-model.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Basic models of the ocean</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-03-box/stommel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Stommel’s box model</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part-xx-exercises/part-exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercises</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-xx-exercises/ps01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Problem set 1</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-xx-exercises/ps02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Problem set 2</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-xx-exercises/ps03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Problem set 3</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-xx-exercises/ps04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Problem set 4</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-xx-exercises/ps01sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Problem set 1 solutions</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part-05-techniques/part-techniques.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-05-techniques/odes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Differential equations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-05-techniques/dynamical-systems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Dynamical systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-05-techniques/vector-calculus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Vector calculus</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-05-techniques/modelling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Modelling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-05-techniques/finitedifference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Finite difference approximations</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#terminology-and-context" id="toc-terminology-and-context" class="nav-link active" data-scroll-target="#terminology-and-context"><span class="header-section-number">18.1</span> Terminology and context</a></li>
  <li><a href="#temperature" id="toc-temperature" class="nav-link" data-scroll-target="#temperature"><span class="header-section-number">18.2</span> Temperature</a></li>
  <li><a href="#salinity-and-density" id="toc-salinity-and-density" class="nav-link" data-scroll-target="#salinity-and-density"><span class="header-section-number">18.3</span> Salinity and density</a></li>
  <li><a href="#two-box-model-of-the-ocean" id="toc-two-box-model-of-the-ocean" class="nav-link" data-scroll-target="#two-box-model-of-the-ocean"><span class="header-section-number">18.4</span> Two-box model of the ocean</a></li>
  <li><a href="#a-one-dimensional-model-constant-temperature" id="toc-a-one-dimensional-model-constant-temperature" class="nav-link" data-scroll-target="#a-one-dimensional-model-constant-temperature"><span class="header-section-number">18.5</span> A one-dimensional model (constant temperature)</a></li>
  <li><a href="#reducing-the-equations-via-symmetry" id="toc-reducing-the-equations-via-symmetry" class="nav-link" data-scroll-target="#reducing-the-equations-via-symmetry"><span class="header-section-number">18.6</span> Reducing the equations via symmetry</a></li>
  <li><a href="#sec-ocean-toysalinity" id="toc-sec-ocean-toysalinity" class="nav-link" data-scroll-target="#sec-ocean-toysalinity"><span class="header-section-number">18.7</span> Analysis of a reduced 1D model for the salinity</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../part-03-box/part-ocean.html">Box models of the ocean</a></li><li class="breadcrumb-item"><a href="../part-03-box/basic-ocean-model.html"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Basic models of the ocean</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-oceanbox" class="quarto-section-identifier"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Basic models of the ocean</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="terminology-and-context" class="level2" data-number="18.1">
<h2 data-number="18.1" class="anchored" data-anchor-id="terminology-and-context"><span class="header-section-number">18.1</span> Terminology and context</h2>
<p>The ocean plays a significant role in regulating the Earth’s climate, as it acts as a massive heat sink and helps to distribute heat and moisture around the planet. In addition, carbon dioxide is water soluble, and through precipitation and wave motion, is transferred into the oceans. Thus the ocean acts as a sink, absorbing large amounts of this greenhouse gas from the atmosphere.</p>
<p>The thermohaline circulation (THC), also known as the global ocean conveyor belt, is a complex ocean circulation pattern that is driven by differences in water temperature and salinity. It is an important component of the Earth’s climate system, as it helps to distribute heat and other properties throughout the planet’s oceans.</p>
<p>The thermohaline circulation is driven by the sinking of cold, dense water in the polar regions, which then spreads out and flows towards the equator. As the water warms and becomes less dense, it rises to the surface and returns to the poles, creating a continuous loop of ocean currents. The role of salinity in driving the thermohaline circulation is due to the fact that the dissolved salts in seawater increase its density.</p>
<p>This circulation pattern has a significant impact on global climate, as it helps to regulate the exchange of heat and other properties between the oceans and the atmosphere. Changes in the thermohaline circulation, such as those caused by global warming, can have far-reaching effects on the planet’s climate and weather patterns.</p>
<div id="fig-THC" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-THC-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/THC.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-THC-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;18.1: The thermohaline circulation. In the Atlantic, the circulation carries warm water (red) north near the surface and cold deep water (blue) south. Image from NASA/JPL.
</figcaption>
</figure>
</div>
</section>
<section id="temperature" class="level2" data-number="18.2">
<h2 data-number="18.2" class="anchored" data-anchor-id="temperature"><span class="header-section-number">18.2</span> Temperature</h2>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Extra content
</div>
</div>
<div class="callout-body-container callout-body">
<p>The material in this subsection is not examinable in 2022-23 and is given here for further context.</p>
</div>
</div>
<p>In regards to the temperature, the ocean can be divided into three layers.</p>
<ol type="1">
<li><p>The top layer is thin (on the order of metres) and is heated from the Sun. Mixing is a dominant effect due to wind and waves, and so the temperature in this region is mostly constant.</p></li>
<li><p>The <em>thermocline region</em> is the intermediate layer. Here, the temperature decreaes approximately linearly.</p></li>
<li><p>The deep <em>abyssal zone</em> comprises 98% of the total volume of the oceans. The temperature in this region is mostly constant, and a few degrees above freezing.</p></li>
</ol>
<p>Within the intermediate region, the temperature can be modelled by an <strong>advection diffusion</strong> equation, <span id="eq-heatocean"><span class="math display">\[
\frac{\mathrm{\partial}T}{\mathrm{\partial}t} + w \frac{\mathrm{\partial}T}{\mathrm{\partial}z} = \kappa \frac{\mathrm{\partial}^2 T}{\mathrm{\partial}z^2},
\tag{18.1}\]</span></span> where <span class="math inline">\(w\)</span> is the upswelling velocity and <span class="math inline">\(\kappa\)</span> is the diffusion coefficient of the fluid.</p>
<p>Let us assume that the temperature in this region is near steady state and that the upwards velocity is constant. Then we integrate the ODE to find <span class="math display">\[
T(z) = T_0 + T_1 \mathrm{e}^{-z/z^*},
\]</span> where <span class="math inline">\(T_0\)</span> and <span class="math inline">\(T_1\)</span> are constants. From <span class="citation" data-cites="kaper_book">(<a href="../references.html#ref-kaper_book" role="doc-biblioref">Kaper and Engler 2013</a>)</span>, the typical orders for the parameters are <span class="math inline">\(\kappa \sim 10^{-2} \,\mathrm{m}^{2} \,\mathrm{s}^{-1}\)</span> and <span class="math inline">\(z^* \sim 10^2 \, \mathrm{m}\)</span>, so <span class="math inline">\(w \sim 10^{-4} \,\mathrm{m} \,\mathrm{s}^{-1}\)</span>, which is quite slow.</p>
<div id="fig-oceanslice" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-oceanslice-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/2023-02-11-01-50-02.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-oceanslice-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;18.2: Cross section of the Atlantic Ocean, showing the temperature and salinity profiles on the right. Image from <span class="citation" data-cites="kaper_book">(<a href="../references.html#ref-kaper_book" role="doc-biblioref">Kaper and Engler 2013</a>)</span>.
</figcaption>
</figure>
</div>
</section>
<section id="salinity-and-density" class="level2" data-number="18.3">
<h2 data-number="18.3" class="anchored" data-anchor-id="salinity-and-density"><span class="header-section-number">18.3</span> Salinity and density</h2>
<p>Salinity is a key component in the oceans since the salts have a large effect on the water density (which consequently drives motion). Salinity is measured in psu or <em>practical salinity units</em>, which is a non-dimensional ratio of conductivities. In the mixed layer, the sainity ranges from 31-39 psu, and is about 35 in the abyssal zone. You can inspect the profile in <a href="#fig-oceanslice" class="quarto-xref">Figure&nbsp;<span>18.2</span></a>.</p>
<p>Below in the study of the ocean, we will need a so-called <em>equation of state</em>, which connects the density, <span class="math inline">\(\rho\)</span>, with the salinity, say <span class="math inline">\(S\)</span>, and temperature, say <span class="math inline">\(T\)</span>. Here is a typical graph of the relationship.</p>
<div id="fig-salinity" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-salinity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/2023-02-11-01-57-26.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-salinity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;18.3: Image from <span class="citation" data-cites="kaper_book">(<a href="../references.html#ref-kaper_book" role="doc-biblioref">Kaper and Engler 2013</a>)</span>
</figcaption>
</figure>
</div>
</section>
<section id="two-box-model-of-the-ocean" class="level2" data-number="18.4">
<h2 data-number="18.4" class="anchored" data-anchor-id="two-box-model-of-the-ocean"><span class="header-section-number">18.4</span> Two-box model of the ocean</h2>
<p>Modelling the THC is a challenging task! In principal, this might involve the solution of multiple coupled PDEs for the flows and temperatures, which would then need to be solved on a very complicated domain. In addition, such models require a number of empirical equations of state (connecting density to temperature and salinity).</p>
<p>Toy models can be developed much more easily at the ‘systems level’ via box models.</p>
</section>
<section id="a-one-dimensional-model-constant-temperature" class="level2" data-number="18.5">
<h2 data-number="18.5" class="anchored" data-anchor-id="a-one-dimensional-model-constant-temperature"><span class="header-section-number">18.5</span> A one-dimensional model (constant temperature)</h2>
<p>Construction and assumptions of the box model.</p>
<ol type="1">
<li><p>We consider two boxes, labeled ‘1’ and ‘2’, respectively via subscripts. Box 1 corresponds to high latitudes (near poles) and Box 2 to low latitudes (near equator). Each box has a corresponding temperature, <span class="math inline">\(T_i\)</span>, and salinity, <span class="math inline">\(S_i\)</span>. In each box, the temperature and salinities are well mixed, so they take different values in either box, in general.</p>
<p>Differences between the two boxes will drive a flow through the capillary pipe that connects the boxes at the bottom. A compensating flow at the surface ensures that the volume of water in each box does not change. Together, these two exchanges (top and bottom) represent the overturning circulation of the THC.</p></li>
<li><p>We assume (see above) that the strength of the exchange flow between the boxes is linearly proportional to their differences of temperature and salinity. In particular, let <span class="math inline">\(\rho_1\)</span> and <span class="math inline">\(\rho_2\)</span> be the two densities in the corresponding boxes. The flow <span class="math inline">\(q\)</span> in the capillary pipe is driven by the difference <span id="eq-ocean-q"><span class="math display">\[
q = k \frac{\rho_1 - \rho_2}{\rho_0},
\tag{18.2}\]</span></span> where <span class="math inline">\(k\)</span> is the hydraulic constant and takes the typical value of <span class="math inline">\(k = 1.5 \cdot 10^{-6} \, \mathrm{s}^{-1}\)</span>. The reference density <span class="math inline">\(\rho_0\)</span> is defined in conjunction with the equation of state.</p>
<p>In the normal state of the planet, <span class="math inline">\(q &gt; 0\)</span> when the flow through the capillary goes in the direction of the equator as a result of higher densities at high latitudes.</p></li>
<li><p>We need an equation of state that connects the densities, <span class="math inline">\(\rho\)</span>, with the temperature and salinities. This concerns the figure <a href="#fig-salinity" class="quarto-xref">Figure&nbsp;<span>18.3</span></a>. We assume that <span id="eq-ocean-state"><span class="math display">\[
\rho = \rho_0(1 - \alpha(T - T_0) + \beta(S - S_0)),
\tag{18.3}\]</span></span> where <span class="math inline">\(T_0\)</span> and <span class="math inline">\(S_0\)</span> are average values of temperature and salinity; <span class="math inline">\(\rho_0\)</span> is the density if <span class="math inline">\(T = T_0\)</span> and <span class="math inline">\(S = S_0\)</span>; <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> are constants with typical values <span class="math inline">\(\alpha = 1.5 \times 10^{-4} \mathrm{deg}^{-1}\)</span> and <span class="math inline">\(\beta = 8 \times 10^{-4} \mathrm{psu}^{-1}\)</span>. Combining (<a href="#eq-ocean-q" class="quarto-xref">Equation&nbsp;<span>18.2</span></a>) with (<a href="#eq-ocean-state" class="quarto-xref">Equation&nbsp;<span>18.3</span></a>) gives <span id="eq-ocean-qfinal"><span class="math display">\[
q = k[ \alpha(T_2 - T_1) - \beta(S_2 - S_1)].
\tag{18.4}\]</span></span></p></li>
<li><p>External wind forces and Coriolis effects are ignored.</p></li>
<li><p>We assume that in each box, there is an exchange of heat and salinity to the surrounding environment. For instance, salinity will exchange due to evaporation, precipitation, and runoff. These will have constant of proportionalities of <span class="math inline">\(c\)</span> and <span class="math inline">\(d\)</span> in the equations below.</p></li>
<li><p>Precipitation, evaporation, and runoff from the continents and atmosphere will also cause the salinity in either box to change. We therefore assume that this is modeled by a flux <span class="math inline">\(H\)</span>.</p>
<p>Remember that in general, <span class="math inline">\(T_2 &gt; T_1\)</span> (the temperatures at the equator are higher). Consequently, evaporation dominates Box 2; there is a net loss of salt-free moisture in the atmosphere and this causes a compensating virtual flux of salt, <span class="math inline">\(H &gt; 0\)</span>, into Box 2. At the same time, there is higher precipitation and runoff into Box 1 (due to lower temperatures), causing a net gain of salt-free moisture and therefore a loss of virtual salt, say <span class="math inline">\(-H &lt; 0\)</span>. We assume these two virtual salt fluxes sum to zero.</p>
<p>Note that in the normal state of affairs, <span class="math inline">\(S_2 &gt; S_1\)</span>, and the lower latitude water is saltier than that of high latitudes.</p></li>
</ol>
<p>An image of the box model is shown below.</p>
<div id="fig-2box" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-2box-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/2023-02-11-02-36-47.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-2box-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;18.4: Two-box model of the North Atlantic with evaporation and precipitation. Image from <span class="citation" data-cites="kaper_book">(<a href="../references.html#ref-kaper_book" role="doc-biblioref">Kaper and Engler 2013</a>)</span>
</figcaption>
</figure>
</div>
<p>The equations are given as follows. <span class="math display">\[\begin{align}
\frac{\mathrm{d}T_1}{\mathrm{d}t} &amp;= c(T_1^* - T_1) + |q|(T_2 - T_1) \\
\frac{\mathrm{d}T_2}{\mathrm{d}t} &amp;= c(T_2^* - T_2) + |q|(T_1 - T_2) \\
\frac{\mathrm{d}S_1}{\mathrm{d}t} &amp;= -H + d(S_1^* - S_1) + |q|(S_2 - S_1) \\
\frac{\mathrm{d}S_2}{\mathrm{d}t} &amp;= H + d(S_2^* - S_2) + |q|(S_1 - S_2)
\end{align}\]</span> {#eq-2box}</p>
<p>Note that in the exchange terms corresponding to the flow <span class="math inline">\(q\)</span> in the capillary pipes, we use an absolute value since it does not matter (flows are exchanged in both lower and upper pipes).</p>
<p>Note also that <span class="math inline">\(q = q(T_1, T_2, S_1, S_2)\)</span> as given in (<a href="#eq-ocean-qfinal" class="quarto-xref">Equation&nbsp;<span>18.4</span></a>).</p>
</section>
<section id="reducing-the-equations-via-symmetry" class="level2" data-number="18.6">
<h2 data-number="18.6" class="anchored" data-anchor-id="reducing-the-equations-via-symmetry"><span class="header-section-number">18.6</span> Reducing the equations via symmetry</h2>
<!--

The symmetry in the above equations suggests we should re-write the temperature and salinity with respect to averaged values. In particular, notice that if we add the two first equations, we see that the steady-state temperatures satisfy
$$
T_1 + T_2 = T_1^* + T_2^*,
$$
and therefore the average temperature in the two ocean regions will tend to the average of the basin regions. A similar conclusion is made for the salinities. 
-->
<p>By adding the equations (<span class="quarto-unresolved-ref">?eq-2box</span>), it can be verified that in the limit <span class="math inline">\(t \to \infty\)</span>, the average temperature in the system, <span class="math inline">\(1/2(T_1 + T_2)\)</span> tends to the average temperature in the surrounding basins <span class="math inline">\(1/2(T_1^* + T_2^*)\)</span>. The same conclusion can be drawn for the corresponding salinities.</p>
<p>It is then sensible to write all temperature and salinity in terms of this baseline scenario. So let us write <span class="math display">\[\begin{align}
T_1 &amp;= \frac{1}{2}m + U_1, \\
T_2 &amp;= \frac{1}{2}m + U_2,
\end{align}\]</span> where <span class="math inline">\(m = T_1^* + T_2^*\)</span>. Then the first equation becomes <span class="math display">\[\begin{align}
\frac{\mathrm{d}U_1}{\mathrm{d}t} &amp;= c\left(T_1^* - U_1 - \frac{1}{2}m\right) + |q| (U_2 - U_1)\\
&amp;= c\left(- T^*  - U_1\right) + |q| (U_2 - U_1).
\end{align}\]</span> where <span class="math inline">\(T^* = \frac{1}{2}(T_2^* - T_1^*)\)</span>.</p>
<p>The analgous manipulations are done to the quantities for the salinity. In the end, if we (confusingly) re-write <span class="math inline">\(T\)</span> for <span class="math inline">\(U\)</span>, then we obtain <span class="math display">\[\begin{align}
\frac{\mathrm{d}T_1}{\mathrm{d}t} &amp;= c(-T^* - T_1) + |q|(T_2 - T_1) \\
\frac{\mathrm{d}T_2}{\mathrm{d}t} &amp;= c(T^* - T_2) + |q|(T_1 - T_2) \\
\frac{\mathrm{d}S_1}{\mathrm{d}t} &amp;= -H + d(-S^* - S_1) + |q|(S_2 - S_1) \\
\frac{\mathrm{d}S_2}{\mathrm{d}t} &amp;= H + d(S^* - S_2) + |q|(S_1 - S_2)
\end{align}\]</span> {#eq-2box-again}</p>
<p>Comparing the above to <span class="quarto-unresolved-ref">?eq-2box</span>, the main difference is that, in expressing the temperature and salinities with respect to the average values in the basin, we have eliminated two of the constants from the set <span class="math inline">\((T_1^*, T_1^*, S_1^*, S_2^*)\)</span> now only into two constants <span class="math inline">\((T^*, S^*)\)</span>.</p>
<p>In the situation of zero salt flux. <span class="math inline">\(H = 0\)</span>, the above model reduces to Stommel’s box model studied in <a href="stommel.html" class="quarto-xref"><span>Chapter 19</span></a>.</p>
</section>
<section id="sec-ocean-toysalinity" class="level2" data-number="18.7">
<h2 data-number="18.7" class="anchored" data-anchor-id="sec-ocean-toysalinity"><span class="header-section-number">18.7</span> Analysis of a reduced 1D model for the salinity</h2>
<p>It is possible to do some analysis on the system (<span class="quarto-unresolved-ref">?eq-2box-again</span>), though we may prefer to simply move on to study the more historically well-known reduction called <em>Stommel’s box model</em> in <a href="stommel.html" class="quarto-xref"><span>Chapter 19</span></a>.</p>
<p>We make the following assumptions:</p>
<ul>
<li>We assume that on the timescale of interest in the THC, the temperature of each box equilibrates quickly with the surrounding basin. Therefore the system can be regarded as being in steady state.<br>
</li>
<li>The difference in temperatures between the two boxes is small; together with the top assumption, this implies that <span class="math inline">\(T_1(t) = -T^*\)</span> and <span class="math inline">\(T_2(t) = T^*\)</span>.</li>
<li>Salinity exchanges by negligible amounts with its surrounding basin, i.e.&nbsp;<span class="math inline">\(d = 0\)</span></li>
</ul>
<p>This leaves us with <span class="math display">\[\begin{align}
\frac{\mathrm{d}S_1}{\mathrm{d}t} &amp;= -H + |q|(S_2 - S_1) \\
\frac{\mathrm{d}S_2}{\mathrm{d}t} &amp;= H + |q| (S_1 - S_2),
\end{align}\]</span> where <span class="math inline">\(q = k(2\alpha T^* - \beta(S_2 - S_1))\)</span>.</p>
<p>Now, the formulation for the salinities can be placed into a single equation for <span class="math inline">\(\Delta S = S_2 - S_1\)</span>, which satisfies <span id="eq-ocean-final-dimensional"><span class="math display">\[
\frac{\mathrm{d}\Delta S}{\mathrm{d}t} = 2H - 2k|\alpha \Delta T - \beta \Delta S| \Delta S.
\tag{18.5}\]</span></span></p>
<p>This is now a much simpler and elegant formulation for study. Under a suitable non-dimensionalisation and scaling, we can even place the above equation in the final simplified form of <span class="math display">\[
\dot{x} = \lambda - |1 - x| x,
\]</span> where <span class="math inline">\(\lambda &gt; 0\)</span> (for temperatures in the usual configuration, with <span class="math inline">\(T_2 - T_1 &gt; 0\)</span>, and a suitably defined function <span class="math inline">\(x = x(t)\)</span>.</p>
<!-- 
From here...

1. Non-dimensionalise

2. Study the equilibrium states and their stability

3. Discuss the tipping phenomena
-->


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-kaper_book" class="csl-entry" role="listitem">
Kaper, Hans, and Hans Engler. 2013. <em>Mathematics and Climate</em>. SIAM.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../part-03-box/part-ocean.html" class="pagination-link  aria-label=" box="" models="" of="" the="" ocean"="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Box models of the ocean</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../part-03-box/stommel.html" class="pagination-link" aria-label="<span class='chapter-number'>19</span>&nbsp; <span class='chapter-title'>Stommel's box model</span>">
        <span class="nav-page-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Stommel’s box model</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>